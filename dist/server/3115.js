"use strict";exports.id=3115,exports.ids=[3115,7094],exports.modules={13115:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES,ValidateEmailErrorStateMatcher:()=>ValidateEmailErrorStateMatcher});var core=__webpack_require__(71508),i18n_breadcrumb_resolver=__webpack_require__(21870),group_administrator_guard=__webpack_require__(30012),site_administrator_guard=__webpack_require__(22658),access_control_routing_paths=__webpack_require__(60856),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),bulk_access_control_service=__webpack_require__(76415),selectable_list_service=__webpack_require__(1050),common=__webpack_require__(84739),ng_bootstrap=__webpack_require__(71781),fesm2022_core=__webpack_require__(68014);class PaginationService{constructor(){this.change=new fesm2022_core.bkB,this.instances={},this.DEFAULT_ID="DEFAULT_PAGINATION_ID"}defaultId(){return this.DEFAULT_ID}register(instance){return null==instance.id&&(instance.id=this.DEFAULT_ID),this.instances[instance.id]?this.updateInstance(instance):(this.instances[instance.id]=instance,!0)}updateInstance(instance){let changed=!1;for(let prop in this.instances[instance.id])instance[prop]!==this.instances[instance.id][prop]&&(this.instances[instance.id][prop]=instance[prop],changed=!0);return changed}getCurrentPage(id){return this.instances[id]?this.instances[id].currentPage:1}setCurrentPage(id,page){if(this.instances[id]){let instance=this.instances[id];page<=Math.ceil(instance.totalItems/instance.itemsPerPage)&&1<=page&&(this.instances[id].currentPage=page,this.change.emit(id))}}setTotalItems(id,totalItems){this.instances[id]&&0<=totalItems&&(this.instances[id].totalItems=totalItems,this.change.emit(id))}setItemsPerPage(id,itemsPerPage){this.instances[id]&&(this.instances[id].itemsPerPage=itemsPerPage,this.change.emit(id))}getInstance(id=this.DEFAULT_ID){return this.instances[id]?this.clone(this.instances[id]):{}}clone(obj){var target={};for(var i in obj)obj.hasOwnProperty(i)&&(target[i]=obj[i]);return target}}const LARGE_NUMBER=Number.MAX_SAFE_INTEGER;let PaginatePipe=(()=>{class PaginatePipe2{constructor(service){this.service=service,this.state={}}transform(collection,args){if(!(collection instanceof Array)){let _id=args.id||this.service.defaultId();return this.state[_id]?this.state[_id].slice:collection}let start,end,serverSideMode=args.totalItems&&args.totalItems!==collection.length,instance=this.createInstance(collection,args),id=instance.id,perPage=instance.itemsPerPage,emitChange=this.service.register(instance);if(!serverSideMode&&collection instanceof Array){if(perPage=+perPage||LARGE_NUMBER,start=(instance.currentPage-1)*perPage,end=start+perPage,this.stateIsIdentical(id,collection,start,end))return this.state[id].slice;{let slice=collection.slice(start,end);return this.saveState(id,collection,slice,start,end),this.service.change.emit(id),slice}}return emitChange&&this.service.change.emit(id),this.saveState(id,collection,collection,start,end),collection}createInstance(collection,config){return this.checkConfig(config),{id:null!=config.id?config.id:this.service.defaultId(),itemsPerPage:+config.itemsPerPage||0,currentPage:+config.currentPage||1,totalItems:+config.totalItems||collection.length}}checkConfig(config){const missing=["itemsPerPage","currentPage"].filter(prop=>!(prop in config));if(0<missing.length)throw new Error(`PaginatePipe: Argument is missing the following required properties: ${missing.join(", ")}`)}saveState(id,collection,slice,start,end){this.state[id]={collection,size:collection.length,slice,start,end}}stateIsIdentical(id,collection,start,end){let state=this.state[id];return!(!state||state.size!==collection.length||state.start!==start||state.end!==end)&&state.slice.every((element,index)=>element===collection[start+index])}}return PaginatePipe2.\u0275fac=function(t){return new(t||PaginatePipe2)(fesm2022_core.rXU(PaginationService,16))},PaginatePipe2.\u0275pipe=fesm2022_core.EJ8({name:"paginate",type:PaginatePipe2,pure:!1}),PaginatePipe2})(),NgxPaginationModule=(()=>{class NgxPaginationModule2{}return NgxPaginationModule2.\u0275fac=function(t){return new(t||NgxPaginationModule2)},NgxPaginationModule2.\u0275mod=fesm2022_core.$C({type:NgxPaginationModule2}),NgxPaginationModule2.\u0275inj=fesm2022_core.G2t({providers:[PaginationService],imports:[[common.MD]]}),NgxPaginationModule2})();var paginated_list_model=__webpack_require__(12383),page_info_model=__webpack_require__(59136),search_configuration_service=__webpack_require__(90435),my_dspace_configuration_service=__webpack_require__(3581),empty_util=__webpack_require__(77028),listable_object_component_loader_component=__webpack_require__(95776),selectable_list_item_control_component=__webpack_require__(80574),pagination_component=__webpack_require__(91904),pagination_component_options_model=__webpack_require__(64694),remote_data_utils=__webpack_require__(81307),themed_search_component=__webpack_require__(84057),browser_only_pipe=__webpack_require__(87154);const _c0=a0=>({number:a0}),_c1=a0=>({repeatable:!0,listId:a0}),_c2=(a0,a1,a2)=>({itemsPerPage:a0,currentPage:a1,totalItems:a2});function BulkAccessBrowseComponent_ng_template_3_span_6_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"span",12)}function BulkAccessBrowseComponent_ng_template_3_span_7_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"span",13)}function BulkAccessBrowseComponent_ng_template_3_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",6),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r1),fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);return fesm2022_core.Njj(acc_r2.toggle("browse"))}),fesm2022_core.j41(1,"button",7),fesm2022_core.bIt("click",function($event){return fesm2022_core.eBV(_r1),fesm2022_core.Njj($event.preventDefault())}),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(4,"div",8)(5,"div",9),fesm2022_core.DNE(6,BulkAccessBrowseComponent_ng_template_3_span_6_Template,1,0,"span",10)(7,BulkAccessBrowseComponent_ng_template_3_span_7_Template,1,0,"span",11),fesm2022_core.k0s()()()}if(2&rf){fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);fesm2022_core.R7$(),fesm2022_core.BMQ("aria-expanded",acc_r2.isExpanded("browse")),fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,4,"admin.access-control.bulk-access-browse.header")," "),fesm2022_core.R7$(4),fesm2022_core.Y8G("ngIf",acc_r2.isExpanded("browse")),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",!acc_r2.isExpanded("browse"))}}function BulkAccessBrowseComponent_ng_template_4_ng_template_7_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",20),fesm2022_core.nrm(1,"ds-search",21),fesm2022_core.k0s()),2&rf){const ctx_r3=fesm2022_core.XpG(2);fesm2022_core.R7$(),fesm2022_core.Y8G("configuration","administrativeBulkAccess")("selectable",!0)("selectionConfig",fesm2022_core.eq3(4,_c1,ctx_r3.listId))("showThumbnails",!1)}}function BulkAccessBrowseComponent_ng_template_4_ng_template_14_ul_4_li_1_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"li",26),fesm2022_core.nI1(1,"dsBrowserOnly"),fesm2022_core.nrm(2,"ds-selectable-list-item-control",27)(3,"ds-listable-object-component-loader",28),fesm2022_core.k0s()),2&rf){const object_r6=ctx.$implicit,i_r7=ctx.index,ctx_r3=fesm2022_core.XpG(4);fesm2022_core.BMQ("data-test",fesm2022_core.bMT(1,9,"list-object")),fesm2022_core.R7$(2),fesm2022_core.Y8G("index",i_r7)("object",object_r6)("selectionConfig",fesm2022_core.eq3(11,_c1,ctx_r3.listId)),fesm2022_core.R7$(),fesm2022_core.Y8G("listID",ctx_r3.listId)("index",i_r7)("object",object_r6)("showThumbnails",!1)("viewMode","list")}}function BulkAccessBrowseComponent_ng_template_4_ng_template_14_ul_4_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ul",24),fesm2022_core.DNE(1,BulkAccessBrowseComponent_ng_template_4_ng_template_14_ul_4_li_1_Template,4,13,"li",25),fesm2022_core.nI1(2,"async"),fesm2022_core.nI1(3,"async"),fesm2022_core.nI1(4,"async"),fesm2022_core.nI1(5,"async"),fesm2022_core.nI1(6,"paginate"),fesm2022_core.k0s()),2&rf){let tmp_5_0;const ctx_r3=fesm2022_core.XpG(3);fesm2022_core.R7$(),fesm2022_core.Y8G("ngForOf",fesm2022_core.i5U(6,9,null==(tmp_5_0=fesm2022_core.bMT(2,1,ctx_r3.objectsSelected$))||null==tmp_5_0.payload?null:tmp_5_0.payload.page,fesm2022_core.sMw(12,_c2,fesm2022_core.bMT(3,3,ctx_r3.paginationOptions$).pageSize,fesm2022_core.bMT(4,5,ctx_r3.paginationOptions$).currentPage,null==(tmp_5_0=fesm2022_core.bMT(5,7,ctx_r3.objectsSelected$))||null==tmp_5_0.payload?null:tmp_5_0.payload.page.length)))}}function BulkAccessBrowseComponent_ng_template_4_ng_template_14_Template(rf,ctx){if(1&rf){const _r5=fesm2022_core.RV6();fesm2022_core.j41(0,"ds-pagination",22),fesm2022_core.nI1(1,"async"),fesm2022_core.nI1(2,"async"),fesm2022_core.nI1(3,"async"),fesm2022_core.bIt("prev",function(){fesm2022_core.eBV(_r5);const ctx_r3=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r3.pagePrev())})("next",function(){fesm2022_core.eBV(_r5);const ctx_r3=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r3.pageNext())}),fesm2022_core.DNE(4,BulkAccessBrowseComponent_ng_template_4_ng_template_14_ul_4_Template,7,16,"ul",23),fesm2022_core.nI1(5,"async"),fesm2022_core.k0s()}if(2&rf){let tmp_5_0,tmp_8_0;const ctx_r3=fesm2022_core.XpG(2);fesm2022_core.Y8G("paginationOptions",fesm2022_core.bMT(1,5,ctx_r3.paginationOptions$))("collectionSize",null==(tmp_5_0=fesm2022_core.bMT(2,7,ctx_r3.objectsSelected$))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements)("objects",fesm2022_core.bMT(3,9,ctx_r3.objectsSelected$))("showPaginator",!1),fesm2022_core.R7$(4),fesm2022_core.Y8G("ngIf",null==(tmp_8_0=fesm2022_core.bMT(5,11,ctx_r3.objectsSelected$))?null:tmp_8_0.hasSucceeded)}}function BulkAccessBrowseComponent_ng_template_4_Template(rf,ctx){if(1&rf){const _r3=fesm2022_core.RV6();fesm2022_core.j41(0,"div",14)(1,"ul",15,1),fesm2022_core.mxI("activeIdChange",function($event){fesm2022_core.eBV(_r3);const ctx_r3=fesm2022_core.XpG();return fesm2022_core.DH7(ctx_r3.activateId,$event)||(ctx_r3.activateId=$event),fesm2022_core.Njj($event)}),fesm2022_core.j41(3,"li",16)(4,"a",17),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(7,BulkAccessBrowseComponent_ng_template_4_ng_template_7_Template,2,6,"ng-template",18),fesm2022_core.k0s(),fesm2022_core.j41(8,"li",16)(9,"a",17),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"async"),fesm2022_core.nI1(12,"async"),fesm2022_core.nI1(13,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(14,BulkAccessBrowseComponent_ng_template_4_ng_template_14_Template,6,13,"ng-template",18),fesm2022_core.k0s()(),fesm2022_core.nrm(15,"div",19),fesm2022_core.k0s()}if(2&rf){let tmp_7_0;const nav_r8=fesm2022_core.sdS(2),ctx_r3=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.R50("activeId",ctx_r3.activateId),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngbNavItem","search"),fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(6,6,"admin.access-control.bulk-access-browse.search.header")),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngbNavItem","selected"),fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.i5U(13,12,"admin.access-control.bulk-access-browse.selected.header",fesm2022_core.eq3(15,_c0,null!=(tmp_7_0=fesm2022_core.bMT(11,8,ctx_r3.objectsSelected$))&&null!=tmp_7_0.payload&&tmp_7_0.payload.totalElements?null==(tmp_7_0=fesm2022_core.bMT(12,10,ctx_r3.objectsSelected$))||null==tmp_7_0.payload?null:tmp_7_0.payload.totalElements:"0"))," "),fesm2022_core.R7$(5),fesm2022_core.Y8G("ngbNavOutlet",nav_r8)}}let BulkAccessBrowseComponent=(()=>{class BulkAccessBrowseComponent2{constructor(selectableListService){this.selectableListService=selectableListService,this.activateId="search",this.objectsSelected$=new cjs.BehaviorSubject(null),this.paginationOptions$=new cjs.BehaviorSubject(Object.assign(new pagination_component_options_model.W,{id:"bas",pageSize:5,currentPage:1})),this.subs=[]}ngOnInit(){this.subs.push(this.selectableListService.getSelectableList(this.listId).pipe((0,operators.F)(),(0,operators.Tj)(list=>this.generatePaginatedListBySelectedElements(list))).subscribe(this.objectsSelected$))}pageNext(){this.paginationOptions$.next(Object.assign(new pagination_component_options_model.W,this.paginationOptions$.value,{currentPage:this.paginationOptions$.value.currentPage+1}))}pagePrev(){this.paginationOptions$.next(Object.assign(new pagination_component_options_model.W,this.paginationOptions$.value,{currentPage:this.paginationOptions$.value.currentPage-1}))}calculatePageCount(pageSize,totalCount=0){return totalCount<pageSize?1:Math.ceil(totalCount/pageSize)}generatePaginatedListBySelectedElements(list){const pageInfo=new page_info_model.Q({elementsPerPage:this.paginationOptions$.value.pageSize,totalElements:list?.selection.length,totalPages:this.calculatePageCount(this.paginationOptions$.value.pageSize,list?.selection.length),currentPage:this.paginationOptions$.value.currentPage});return pageInfo.currentPage>pageInfo.totalPages&&(pageInfo.currentPage=pageInfo.totalPages,this.paginationOptions$.next(Object.assign(new pagination_component_options_model.W,this.paginationOptions$.value,{currentPage:pageInfo.currentPage}))),(0,remote_data_utils.SP)((0,paginated_list_model.g)(pageInfo,list?.selection||[]))}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),this.selectableListService.deselectAll(this.listId)}static#_=this.\u0275fac=function(t){return new(t||BulkAccessBrowseComponent2)(fesm2022_core.rXU(selectable_list_service.K))};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:BulkAccessBrowseComponent2,selectors:[["ds-bulk-access-browse"]],inputs:{listId:"listId"},standalone:!0,features:[fesm2022_core.Jv_([{provide:my_dspace_configuration_service.EN,useClass:search_configuration_service.g}]),fesm2022_core.aNF],decls:5,vars:2,consts:[["acc","ngbAccordion"],["nav","ngbNav"],[3,"activeIds"],[3,"id"],["ngbPanelHeader",""],["ngbPanelContent",""],["ngbPanelToggle","","data-test","browse",1,"w-100","d-flex","gap-3","justify-content-between","collapse-toggle",3,"click"],["type","button","aria-controls","bulk-access-browse-panel-content",1,"btn","btn-link","p-0",3,"click"],[1,"text-right","d-flex","gap-2"],[1,"d-flex","my-auto"],["class","fas fa-chevron-up fa-fw",4,"ngIf"],["class","fas fa-chevron-down fa-fw",4,"ngIf"],[1,"fas","fa-chevron-up","fa-fw"],[1,"fas","fa-chevron-down","fa-fw"],["id","bulk-access-browse-panel-content"],["ngbNav","",1,"nav-pills",3,"activeIdChange","activeId"],["role","presentation",3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-5",3,"ngbNavOutlet"],[1,"mx-n3"],[3,"configuration","selectable","selectionConfig","showThumbnails"],[3,"prev","next","paginationOptions","collectionSize","objects","showPaginator"],["class","list-unstyled ml-4",4,"ngIf"],[1,"list-unstyled","ml-4"],["class","mt-4 mb-4 d-flex",4,"ngFor","ngForOf"],[1,"mt-4","mb-4","d-flex"],[3,"index","object","selectionConfig"],[3,"listID","index","object","showThumbnails","viewMode"]],template:function(rf,ctx){1&rf&&(fesm2022_core.j41(0,"ngb-accordion",2,0)(2,"ngb-panel",3),fesm2022_core.DNE(3,BulkAccessBrowseComponent_ng_template_3_Template,8,6,"ng-template",4)(4,BulkAccessBrowseComponent_ng_template_4_Template,16,17,"ng-template",5),fesm2022_core.k0s()()),2&rf&&(fesm2022_core.Y8G("activeIds","browse"),fesm2022_core.R7$(2),fesm2022_core.Y8G("id","browse"))},dependencies:[pagination_component.e,common.Jj,ng_bootstrap._f,ng_bootstrap.W1,ng_bootstrap.CT,ng_bootstrap.t3,ng_bootstrap.Xc,ngx_translate_core.h,ngx_translate_core.D9,common.bT,ng_bootstrap.Pv,ng_bootstrap.Um,ng_bootstrap.X9,ng_bootstrap.sy,ng_bootstrap.Ri,ng_bootstrap.m_,themed_search_component.N,browser_only_pipe.L,common.Sq,NgxPaginationModule,PaginatePipe,selectable_list_item_control_component.Y,listable_object_component_loader_component.v]})}return BulkAccessBrowseComponent2})();var access_control_form_container_component=__webpack_require__(61085);const bulk_access_settings_component_c0=["dsAccessControlForm"];function BulkAccessSettingsComponent_ng_template_3_span_6_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"span",12)}function BulkAccessSettingsComponent_ng_template_3_span_7_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"span",13)}function BulkAccessSettingsComponent_ng_template_3_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",6),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r1),fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);return fesm2022_core.Njj(acc_r2.toggle("settings"))}),fesm2022_core.j41(1,"button",7),fesm2022_core.bIt("click",function($event){return fesm2022_core.eBV(_r1),fesm2022_core.Njj($event.preventDefault())}),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(4,"div",8)(5,"div",9),fesm2022_core.DNE(6,BulkAccessSettingsComponent_ng_template_3_span_6_Template,1,0,"span",10)(7,BulkAccessSettingsComponent_ng_template_3_span_7_Template,1,0,"span",11),fesm2022_core.k0s()()()}if(2&rf){fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);fesm2022_core.R7$(),fesm2022_core.BMQ("aria-expanded",acc_r2.isExpanded("settings")),fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,4,"admin.access-control.bulk-access-settings.header")," "),fesm2022_core.R7$(4),fesm2022_core.Y8G("ngIf",acc_r2.isExpanded("settings")),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",!acc_r2.isExpanded("settings"))}}function BulkAccessSettingsComponent_ng_template_4_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-access-control-form-container",14,1),2&rf&&fesm2022_core.Y8G("showSubmit",!1)}let BulkAccessSettingsComponent=(()=>{class BulkAccessSettingsComponent2{getValue(){return this.controlForm.getFormValue()}reset(){this.controlForm.reset()}static#_=this.\u0275fac=function(t){return new(t||BulkAccessSettingsComponent2)};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:BulkAccessSettingsComponent2,selectors:[["ds-bulk-access-settings"]],viewQuery:function(rf,ctx){if(1&rf&&fesm2022_core.GBs(bulk_access_settings_component_c0,5),2&rf){let _t;fesm2022_core.mGM(_t=fesm2022_core.lsd())&&(ctx.controlForm=_t.first)}},exportAs:["dsBulkSettings"],standalone:!0,features:[fesm2022_core.aNF],decls:5,vars:2,consts:[["acc","ngbAccordion"],["dsAccessControlForm",""],[3,"activeIds"],[3,"id"],["ngbPanelHeader",""],["ngbPanelContent",""],["ngbPanelToggle","","data-test","settings",1,"w-100","d-flex","gap-3","justify-content-between","collapse-toggle",3,"click"],["type","button","aria-controls","bulk-access-settings-panel-content",1,"btn","btn-link","p-0",3,"click"],[1,"text-right","d-flex","gap-2"],[1,"d-flex","my-auto"],["class","fas fa-chevron-up fa-fw",4,"ngIf"],["class","fas fa-chevron-down fa-fw",4,"ngIf"],[1,"fas","fa-chevron-up","fa-fw"],[1,"fas","fa-chevron-down","fa-fw"],["id","bulk-access-settings-panel-content",3,"showSubmit"]],template:function(rf,ctx){1&rf&&(fesm2022_core.j41(0,"ngb-accordion",2,0)(2,"ngb-panel",3),fesm2022_core.DNE(3,BulkAccessSettingsComponent_ng_template_3_Template,8,6,"ng-template",4)(4,BulkAccessSettingsComponent_ng_template_4_Template,2,1,"ng-template",5),fesm2022_core.k0s()()),2&rf&&(fesm2022_core.Y8G("activeIds","settings"),fesm2022_core.R7$(2),fesm2022_core.Y8G("id","settings"))},dependencies:[ng_bootstrap._f,ng_bootstrap.W1,ng_bootstrap.CT,ng_bootstrap.t3,ng_bootstrap.Xc,ngx_translate_core.h,ngx_translate_core.D9,common.bT,access_control_form_container_component.o]})}return BulkAccessSettingsComponent2})();const bulk_access_component_c0=["dsBulkSettings"];let BulkAccessComponent=(()=>{class BulkAccessComponent2{constructor(bulkAccessControlService,selectableListService){this.bulkAccessControlService=bulkAccessControlService,this.selectableListService=selectableListService,this.listId="bulk-access-list",this.objectsSelected$=new cjs.BehaviorSubject([]),this.subs=[]}ngOnInit(){this.subs.push(this.selectableListService.getSelectableList(this.listId).pipe((0,operators.F)(),(0,operators.Tj)(list=>this.generateIdListBySelectedElements(list))).subscribe(this.objectsSelected$))}canExport(){return this.objectsSelected$.value?.length>0}reset(){this.settings.reset()}submit(){const settings=this.settings.getValue(),bitstreamAccess=settings.bitstream,itemAccess=settings.item,{file}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess,itemAccess,state:settings.state});this.bulkAccessControlService.executeScript(this.objectsSelected$.value||[],file).subscribe()}generateIdListBySelectedElements(list){return list?.selection?.map(entry=>entry.indexableObject.uuid)}static#_=this.\u0275fac=function(t){return new(t||BulkAccessComponent2)(fesm2022_core.rXU(bulk_access_control_service.r),fesm2022_core.rXU(selectable_list_service.K))};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:BulkAccessComponent2,selectors:[["ds-bulk-access"]],viewQuery:function(rf,ctx){if(1&rf&&fesm2022_core.GBs(bulk_access_component_c0,5),2&rf){let _t;fesm2022_core.mGM(_t=fesm2022_core.lsd())&&(ctx.settings=_t.first)}},standalone:!0,features:[fesm2022_core.aNF],decls:16,vars:11,consts:[["dsBulkSettings",""],[1,"container"],[3,"listId"],[1,"clearfix","mb-3"],[1,"d-flex","justify-content-end"],[1,"btn","btn-outline-primary","mr-3",3,"click"],[1,"btn","btn-primary",3,"click","disabled"]],template:function(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",1)(1,"h1"),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.nrm(4,"ds-bulk-access-browse",2)(5,"div",3)(6,"ds-bulk-access-settings",null,0)(8,"hr"),fesm2022_core.j41(9,"div",4)(10,"button",5),fesm2022_core.bIt("click",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.reset())}),fesm2022_core.EFF(11),fesm2022_core.nI1(12,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(13,"button",6),fesm2022_core.bIt("click",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.submit())}),fesm2022_core.EFF(14),fesm2022_core.nI1(15,"translate"),fesm2022_core.k0s()()()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,5,"admin.access-control.bulk-access.title")),fesm2022_core.R7$(2),fesm2022_core.Y8G("listId",ctx.listId),fesm2022_core.R7$(7),fesm2022_core.SpI(" ",fesm2022_core.bMT(12,7,"access-control-cancel")," "),fesm2022_core.R7$(2),fesm2022_core.Y8G("disabled",!ctx.canExport()),fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(15,9,"access-control-execute")," "))},dependencies:[ngx_translate_core.h,ngx_translate_core.D9,BulkAccessSettingsComponent,BulkAccessBrowseComponent]})}return BulkAccessComponent2})();var fesm2022_forms=__webpack_require__(28955),router=__webpack_require__(64247),dso_name_service=__webpack_require__(91735),authorization_data_service=__webpack_require__(30289),feature_id=__webpack_require__(29321),request_service=__webpack_require__(72744),eperson_data_service=__webpack_require__(62120),eperson_dto_model=__webpack_require__(14176),pagination_service=__webpack_require__(39304),shared_operators=__webpack_require__(82656),confirmation_modal_component=__webpack_require__(32007),themed_loading_component=__webpack_require__(32943),notifications_service=__webpack_require__(10117);const epeople_registry_component_c0=a0=>({"table-primary":a0}),epeople_registry_component_c1=a0=>({name:a0});function EPeopleRegistryComponent_ds_loading_39_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading")}function EPeopleRegistryComponent_ds_pagination_41_tr_19_button_13_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"button",33),fesm2022_core.nI1(1,"translate"),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r1);const epersonDto_r2=fesm2022_core.XpG().$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.deleteEPerson(epersonDto_r2.eperson))}),fesm2022_core.nrm(2,"i",34),fesm2022_core.k0s()}if(2&rf){const epersonDto_r2=fesm2022_core.XpG().$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.FS9("title",fesm2022_core.i5U(1,1,ctx_r2.labelPrefix+"table.edit.buttons.remove",fesm2022_core.eq3(4,epeople_registry_component_c1,ctx_r2.dsoNameService.getName(epersonDto_r2.eperson))))}}function EPeopleRegistryComponent_ds_pagination_41_tr_19_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"tr",28),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"td"),fesm2022_core.EFF(3),fesm2022_core.k0s(),fesm2022_core.j41(4,"td"),fesm2022_core.EFF(5),fesm2022_core.k0s(),fesm2022_core.j41(6,"td"),fesm2022_core.EFF(7),fesm2022_core.k0s(),fesm2022_core.j41(8,"td")(9,"div",29)(10,"button",30),fesm2022_core.nI1(11,"translate"),fesm2022_core.nrm(12,"i",31),fesm2022_core.k0s(),fesm2022_core.DNE(13,EPeopleRegistryComponent_ds_pagination_41_tr_19_button_13_Template,3,6,"button",32),fesm2022_core.k0s()()()),2&rf){const epersonDto_r2=ctx.$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.Y8G("ngClass",fesm2022_core.eq3(12,epeople_registry_component_c0,fesm2022_core.bMT(1,7,ctx_r2.isActive(epersonDto_r2.eperson)))),fesm2022_core.R7$(3),fesm2022_core.JRh(epersonDto_r2.eperson.id),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r2.dsoNameService.getName(epersonDto_r2.eperson)),fesm2022_core.R7$(2),fesm2022_core.JRh(epersonDto_r2.eperson.email),fesm2022_core.R7$(3),fesm2022_core.FS9("title",fesm2022_core.i5U(11,9,ctx_r2.labelPrefix+"table.edit.buttons.edit",fesm2022_core.eq3(14,epeople_registry_component_c1,ctx_r2.dsoNameService.getName(epersonDto_r2.eperson)))),fesm2022_core.Y8G("routerLink",ctx_r2.getEditEPeoplePage(epersonDto_r2.eperson.id)),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngIf",epersonDto_r2.ableToDelete)}}function EPeopleRegistryComponent_ds_pagination_41_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",23),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",24)(3,"table",25)(4,"thead")(5,"tr")(6,"th",26),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",26),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",26),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th"),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(18,"tbody"),fesm2022_core.DNE(19,EPeopleRegistryComponent_ds_pagination_41_tr_19_Template,14,16,"tr",27),fesm2022_core.nI1(20,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_9_0;const ctx_r2=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r2.config)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,9,ctx_r2.pageInfoState$))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,11,ctx_r2.labelPrefix+"table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,13,ctx_r2.labelPrefix+"table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,15,ctx_r2.labelPrefix+"table.email")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,17,ctx_r2.labelPrefix+"table.edit")),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngForOf",null==(tmp_9_0=fesm2022_core.bMT(20,19,ctx_r2.ePeopleDto$))?null:tmp_9_0.page)}}function EPeopleRegistryComponent_div_44_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",35),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.labelPrefix+"no-items")," ")}}let EPeopleRegistryComponent=(()=>{class EPeopleRegistryComponent2{constructor(epersonService,translateService,notificationsService,authorizationService,formBuilder,router2,modalService,paginationService,requestService,dsoNameService){this.epersonService=epersonService,this.translateService=translateService,this.notificationsService=notificationsService,this.authorizationService=authorizationService,this.formBuilder=formBuilder,this.router=router2,this.modalService=modalService,this.paginationService=paginationService,this.requestService=requestService,this.dsoNameService=dsoNameService,this.labelPrefix="admin.access-control.epeople.",this.ePeople$=new cjs.BehaviorSubject((0,paginated_list_model.g)(new page_info_model.Q,[])),this.ePeopleDto$=new cjs.BehaviorSubject({}),this.pageInfoState$=new cjs.BehaviorSubject(void 0),this.searching$=new cjs.BehaviorSubject(!1),this.config=Object.assign(new pagination_component_options_model.W,{id:"elp",pageSize:5,currentPage:1}),this.subs=[],this.currentSearchQuery="",this.currentSearchScope="metadata",this.searchForm=this.formBuilder.group({scope:"metadata",query:""})}ngOnInit(){this.initialisePage()}initialisePage(){this.searching$.next(!0),this.search({scope:this.currentSearchScope,query:this.currentSearchQuery}),this.subs.push(this.ePeople$.pipe((0,operators.nx)(epeople=>epeople.pageInfo.totalElements>0?(0,cjs.combineLatest)(epeople.page.map(eperson=>this.authorizationService.isAuthorized(feature_id._.CanDelete,(0,empty_util.a4)(eperson)?eperson.self:void 0).pipe((0,operators.Tj)(authorized=>{const epersonDtoModel=new eperson_dto_model.h;return epersonDtoModel.ableToDelete=authorized,epersonDtoModel.eperson=eperson,epersonDtoModel})))).pipe((0,operators.Tj)(dtos=>(0,paginated_list_model.g)(epeople.pageInfo,dtos))):[epeople])).subscribe(value=>{this.searching$.next(!1),this.ePeopleDto$.next(value),this.pageInfoState$.next(value.pageInfo)}))}search(data){this.searching$.next(!0),(0,empty_util.a4)(this.findListOptionsSub)&&this.findListOptionsSub.unsubscribe(),this.findListOptionsSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.nx)(findListOptions=>{const query=data.query,scope=data.scope;return null!=query&&this.currentSearchQuery!==query&&(this.router.navigate([(0,access_control_routing_paths.bL)()],{queryParamsHandling:"merge"}),this.currentSearchQuery=query,this.paginationService.resetPage(this.config.id)),null!=scope&&this.currentSearchScope!==scope&&(this.router.navigate([(0,access_control_routing_paths.bL)()],{queryParamsHandling:"merge"}),this.currentSearchScope=scope,this.paginationService.resetPage(this.config.id)),this.epersonService.searchByScope(this.currentSearchScope,this.currentSearchQuery,{currentPage:findListOptions.currentPage,elementsPerPage:findListOptions.pageSize})}),(0,shared_operators.v7)()).subscribe(peopleRD=>{this.ePeople$.next(peopleRD.payload),this.pageInfoState$.next(peopleRD.payload.pageInfo)})}isActive(eperson){return this.getActiveEPerson().pipe((0,operators.Tj)(activeEPerson=>eperson===activeEPerson))}getActiveEPerson(){return this.epersonService.getActiveEPerson()}deleteEPerson(ePerson){if((0,empty_util.a4)(ePerson.id)){const modalRef=this.modalService.open(confirmation_modal_component.M);modalRef.componentInstance.name=this.dsoNameService.getName(ePerson),modalRef.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",modalRef.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",modalRef.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",modalRef.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.s)(1)).subscribe(confirm=>{confirm&&(0,empty_util.a4)(ePerson.id)&&this.epersonService.deleteEPerson(ePerson).pipe((0,shared_operators.qD)()).subscribe(restResponse=>{restResponse.hasSucceeded?this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:this.dsoNameService.getName(ePerson)})):this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.deleted.success",{id:ePerson.id,statusCode:restResponse.statusCode,errorMessage:restResponse.errorMessage}))})})}}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe())}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}getEditEPeoplePage(id){return(0,access_control_routing_paths.Ax)(id)}static#_=this.\u0275fac=function(t){return new(t||EPeopleRegistryComponent2)(fesm2022_core.rXU(eperson_data_service.EPersonDataService),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(fesm2022_forms.ze),fesm2022_core.rXU(router.Ix),fesm2022_core.rXU(ng_bootstrap.Bq),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:EPeopleRegistryComponent2,selectors:[["ds-epeople-registry"]],standalone:!0,features:[fesm2022_core.aNF],decls:46,vars:40,consts:[[1,"container"],[1,"epeople-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"mr-auto","btn","btn-success","addEPerson-button",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline","ml-1"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],["name","scope","id","scope","formControlName","scope","aria-label","Search scope",1,"form-control"],["value","metadata"],["value","email"],[1,"flex-grow-1","mr-3","ml-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"search-button","btn","btn-secondary",3,"click"],[4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","epeople",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],["class","delete-button btn btn-outline-danger btn-sm access-control-deleteEPersonButton",3,"title","click",4,"ngIf"],[1,"delete-button","btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"]],template:function(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(7,"div")(8,"button",5),fesm2022_core.nrm(9,"i",6),fesm2022_core.j41(10,"span",7),fesm2022_core.EFF(11),fesm2022_core.nI1(12,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(13,"h2",8),fesm2022_core.EFF(14),fesm2022_core.nI1(15,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(16,"form",9),fesm2022_core.bIt("ngSubmit",function(){return ctx.search(ctx.searchForm.value)}),fesm2022_core.j41(17,"div")(18,"select",10)(19,"option",11),fesm2022_core.EFF(20),fesm2022_core.nI1(21,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(22,"option",12),fesm2022_core.EFF(23),fesm2022_core.nI1(24,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(25,"div",13)(26,"div",14),fesm2022_core.nrm(27,"input",15),fesm2022_core.nI1(28,"translate"),fesm2022_core.nI1(29,"translate"),fesm2022_core.j41(30,"span",16)(31,"button",17),fesm2022_core.nrm(32,"i",18),fesm2022_core.EFF(33),fesm2022_core.nI1(34,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(35,"div")(36,"button",19),fesm2022_core.bIt("click",function(){return ctx.clearFormAndResetResult()}),fesm2022_core.EFF(37),fesm2022_core.nI1(38,"translate"),fesm2022_core.k0s()()(),fesm2022_core.DNE(39,EPeopleRegistryComponent_ds_loading_39_Template,1,0,"ds-loading",20),fesm2022_core.nI1(40,"async"),fesm2022_core.DNE(41,EPeopleRegistryComponent_ds_pagination_41_Template,21,21,"ds-pagination",21),fesm2022_core.nI1(42,"async"),fesm2022_core.nI1(43,"async"),fesm2022_core.DNE(44,EPeopleRegistryComponent_div_44_Template,3,3,"div",22),fesm2022_core.nI1(45,"async"),fesm2022_core.k0s()()()),2&rf){let tmp_12_0,tmp_13_0;fesm2022_core.R7$(5),fesm2022_core.JRh(fesm2022_core.bMT(6,14,ctx.labelPrefix+"head")),fesm2022_core.R7$(3),fesm2022_core.Y8G("routerLink","create"),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(12,16,ctx.labelPrefix+"button.add")),fesm2022_core.R7$(3),fesm2022_core.SpI(" ",fesm2022_core.bMT(15,18,ctx.labelPrefix+"search.head")," "),fesm2022_core.R7$(2),fesm2022_core.Y8G("formGroup",ctx.searchForm),fesm2022_core.R7$(4),fesm2022_core.JRh(fesm2022_core.bMT(21,20,ctx.labelPrefix+"search.scope.metadata")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(24,22,ctx.labelPrefix+"search.scope.email")),fesm2022_core.R7$(4),fesm2022_core.Y8G("placeholder",fesm2022_core.bMT(28,24,ctx.labelPrefix+"search.placeholder")),fesm2022_core.BMQ("aria-label",fesm2022_core.bMT(29,26,ctx.labelPrefix+"search.placeholder")),fesm2022_core.R7$(6),fesm2022_core.SpI(" ",fesm2022_core.bMT(34,28,ctx.labelPrefix+"search.button")," "),fesm2022_core.R7$(4),fesm2022_core.JRh(fesm2022_core.bMT(38,30,ctx.labelPrefix+"button.see-all")),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(40,32,ctx.searching$)),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",(null==(tmp_12_0=fesm2022_core.bMT(42,34,ctx.pageInfoState$))?null:tmp_12_0.totalElements)>0&&!0!==fesm2022_core.bMT(43,36,ctx.searching$)),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngIf",0===(null==(tmp_13_0=fesm2022_core.bMT(45,38,ctx.pageInfoState$))?null:tmp_13_0.totalElements))}},dependencies:[ngx_translate_core.h,ngx_translate_core.D9,router.iI,router.Wk,common.Jj,common.bT,fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.me,fesm2022_forms.wz,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,themed_loading_component.v,pagination_component.e,common.YU,common.Sq],encapsulation:2})}return EPeopleRegistryComponent2})();var auth_service=__webpack_require__(41543),eperson_registration_service=__webpack_require__(2195),group_data_service=__webpack_require__(97195),eperson_model=__webpack_require__(1324),register_email_form_component=__webpack_require__(59081),form_builder_service=__webpack_require__(80152),form_component=__webpack_require__(49148),follow_link_config_model=__webpack_require__(32181),has_no_value_pipe=__webpack_require__(89705);class ValidateEmailNotTaken{static createValidator(ePersonDataService){return control=>ePersonDataService.getEPersonByEmail(control.value).pipe((0,shared_operators.yd)(),(0,operators.Tj)(res=>res.payload?{emailTaken:!0}:null))}}const eperson_form_component_c0=a0=>[a0];function EPersonFormComponent_div_3_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"div")}function EPersonFormComponent_ng_template_5_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"h1",14),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(2,1,ctx_r1.messagePrefix+".create"))}}function EPersonFormComponent_ng_template_7_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"h1",14),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(2,1,ctx_r1.messagePrefix+".edit"))}}function EPersonFormComponent_div_15_Template(rf,ctx){if(1&rf){const _r3=fesm2022_core.RV6();fesm2022_core.j41(0,"div",15)(1,"button",16),fesm2022_core.nI1(2,"async"),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r3);const ctx_r1=fesm2022_core.XpG();return fesm2022_core.Njj(ctx_r1.resetPassword())}),fesm2022_core.nrm(3,"i",17),fesm2022_core.EFF(4),fesm2022_core.nI1(5,"translate"),fesm2022_core.k0s()()}if(2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.Y8G("disabled",!0!==fesm2022_core.bMT(2,2,ctx_r1.canReset$)),fesm2022_core.R7$(3),fesm2022_core.SpI(" ",fesm2022_core.bMT(5,4,"admin.access-control.epeople.actions.reset")," ")}}function EPersonFormComponent_div_16_button_1_Template(rf,ctx){if(1&rf){const _r4=fesm2022_core.RV6();fesm2022_core.j41(0,"button",19),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r4);const ctx_r1=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r1.impersonate())}),fesm2022_core.nrm(1,"i",20),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,1,"admin.access-control.epeople.actions.impersonate")," "))}function EPersonFormComponent_div_16_button_2_Template(rf,ctx){if(1&rf){const _r5=fesm2022_core.RV6();fesm2022_core.j41(0,"button",19),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r5);const ctx_r1=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r1.stopImpersonating())}),fesm2022_core.nrm(1,"i",20),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,1,"admin.access-control.epeople.actions.stop-impersonating")," "))}function EPersonFormComponent_div_16_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",15),fesm2022_core.DNE(1,EPersonFormComponent_div_16_button_1_Template,4,3,"button",18)(2,EPersonFormComponent_div_16_button_2_Template,4,3,"button",18),fesm2022_core.k0s()),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",!ctx_r1.isImpersonated),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",ctx_r1.isImpersonated)}}function EPersonFormComponent_button_18_Template(rf,ctx){if(1&rf){const _r6=fesm2022_core.RV6();fesm2022_core.j41(0,"button",21),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r6);const ctx_r1=fesm2022_core.XpG();return fesm2022_core.Njj(ctx_r1.delete())}),fesm2022_core.nrm(1,"i",22),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,1,"admin.access-control.epeople.actions.delete")," "))}function EPersonFormComponent_ds_loading_20_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading",23),2&rf&&fesm2022_core.Y8G("showMessage",!1)}function EPersonFormComponent_div_21_ds_loading_4_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading",23),2&rf&&fesm2022_core.Y8G("showMessage",!1)}function EPersonFormComponent_div_21_ds_pagination_7_tr_16_Template(rf,ctx){if(1&rf){const _r8=fesm2022_core.RV6();fesm2022_core.j41(0,"tr")(1,"td",31),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td",31)(4,"a",32),fesm2022_core.bIt("click",function(){const group_r9=fesm2022_core.eBV(_r8).$implicit,ctx_r1=fesm2022_core.XpG(3);return fesm2022_core.Njj(ctx_r1.groupsDataService.startEditingNewGroup(group_r9))}),fesm2022_core.EFF(5),fesm2022_core.k0s()(),fesm2022_core.j41(6,"td",31),fesm2022_core.EFF(7),fesm2022_core.k0s()()}if(2&rf){const group_r9=ctx.$implicit,ctx_r1=fesm2022_core.XpG(3);fesm2022_core.R7$(2),fesm2022_core.JRh(group_r9.id),fesm2022_core.R7$(2),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(4,eperson_form_component_c0,ctx_r1.groupsDataService.getGroupEditPageRouterLink(group_r9))),fesm2022_core.R7$(),fesm2022_core.SpI(" ",ctx_r1.dsoNameService.getName(group_r9)," "),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r1.dsoNameService.getName(void 0))}}function EPersonFormComponent_div_21_ds_pagination_7_Template(rf,ctx){if(1&rf){const _r7=fesm2022_core.RV6();fesm2022_core.j41(0,"ds-pagination",26),fesm2022_core.nI1(1,"async"),fesm2022_core.bIt("pageChange",function($event){fesm2022_core.eBV(_r7);const ctx_r1=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r1.onPageChange($event))}),fesm2022_core.j41(2,"div",27)(3,"table",28)(4,"thead")(5,"tr")(6,"th",29),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",29),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",29),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(15,"tbody"),fesm2022_core.DNE(16,EPersonFormComponent_div_21_ds_pagination_7_tr_16_Template,8,6,"tr",30),fesm2022_core.nI1(17,"async"),fesm2022_core.k0s()()()()}if(2&rf){let tmp_5_0,tmp_11_0;const ctx_r1=fesm2022_core.XpG(2);fesm2022_core.Y8G("paginationOptions",ctx_r1.config)("collectionSize",null==(tmp_5_0=fesm2022_core.bMT(1,8,ctx_r1.groups$))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,10,ctx_r1.messagePrefix+".table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,12,ctx_r1.messagePrefix+".table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,14,ctx_r1.messagePrefix+".table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngForOf",null==(tmp_11_0=fesm2022_core.bMT(17,16,ctx_r1.groups$))||null==tmp_11_0.payload?null:tmp_11_0.payload.page)}}function EPersonFormComponent_div_21_div_9_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",33)(1,"div"),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(4,"div")(5,"button",34),fesm2022_core.EFF(6),fesm2022_core.nI1(7,"translate"),fesm2022_core.k0s()()()),2&rf){const ctx_r1=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,3,ctx_r1.messagePrefix+".memberOfNoGroups")),fesm2022_core.R7$(3),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(7,eperson_form_component_c0,ctx_r1.groupsDataService.getGroupRegistryRouterLink())),fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(7,5,ctx_r1.messagePrefix+".goToGroups"))}}function EPersonFormComponent_div_21_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div")(1,"h2"),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(4,EPersonFormComponent_div_21_ds_loading_4_Template,1,1,"ds-loading",12),fesm2022_core.nI1(5,"async"),fesm2022_core.nI1(6,"dsHasNoValue"),fesm2022_core.DNE(7,EPersonFormComponent_div_21_ds_pagination_7_Template,18,18,"ds-pagination",24),fesm2022_core.nI1(8,"async"),fesm2022_core.DNE(9,EPersonFormComponent_div_21_div_9_Template,8,9,"div",25),fesm2022_core.nI1(10,"async"),fesm2022_core.k0s()),2&rf){let tmp_5_0,tmp_6_0;const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,4,ctx_r1.messagePrefix+".groupsEPersonIsMemberOf")),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(6,8,fesm2022_core.bMT(5,6,ctx_r1.groups$))),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngIf",(null==(tmp_5_0=fesm2022_core.bMT(8,10,ctx_r1.groups$))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements)>0),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",0===(null==(tmp_6_0=fesm2022_core.bMT(10,12,ctx_r1.groups$))||null==tmp_6_0.payload?null:tmp_6_0.payload.totalElements))}}let EPersonFormComponent=(()=>{class EPersonFormComponent2{constructor(changeDetectorRef,epersonService,groupsDataService,formBuilderService,translateService,notificationsService,authService,authorizationService,modalService,paginationService,requestService,epersonRegistrationService,dsoNameService,route,router2){this.changeDetectorRef=changeDetectorRef,this.epersonService=epersonService,this.groupsDataService=groupsDataService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.notificationsService=notificationsService,this.authService=authService,this.authorizationService=authorizationService,this.modalService=modalService,this.paginationService=paginationService,this.requestService=requestService,this.epersonRegistrationService=epersonRegistrationService,this.dsoNameService=dsoNameService,this.route=route,this.router=router2,this.labelPrefix="admin.access-control.epeople.form.",this.formId="eperson-form",this.messagePrefix="admin.access-control.epeople.form",this.formLayout={firstName:{grid:{host:"row"}},lastName:{grid:{host:"row"}},email:{grid:{host:"row"}},canLogIn:{grid:{host:"col col-sm-6 d-inline-block"}},requireCertificate:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new fesm2022_core.bkB,this.cancelForm=new fesm2022_core.bkB,this.subs=[],this.config=Object.assign(new pagination_component_options_model.W,{id:"gem",pageSize:5,currentPage:1}),this.isImpersonated=!1,this.displayResetPassword=!1,this.submitLabel="form.create",this.subs.push(this.epersonService.getActiveEPerson().subscribe(eperson=>{this.epersonInitial=eperson,(0,empty_util.a4)(eperson)&&(this.isImpersonated=this.authService.isImpersonatingUser(eperson.id),this.displayResetPassword=!0,this.submitLabel="form.submit")}))}ngOnInit(){this.initialisePage()}initialisePage(){this.subs.push(this.epersonService.findById(this.route.snapshot.params.id).subscribe(ePersonRD=>{this.epersonService.editEPerson(ePersonRD.payload)})),(0,cjs.combineLatest)([this.translateService.get(`${this.messagePrefix}.firstName`),this.translateService.get(`${this.messagePrefix}.lastName`),this.translateService.get(`${this.messagePrefix}.email`),this.translateService.get(`${this.messagePrefix}.canLogIn`),this.translateService.get(`${this.messagePrefix}.requireCertificate`),this.translateService.get(`${this.messagePrefix}.emailHint`)]).subscribe(([firstName,lastName,email,canLogIn,requireCertificate,emailHint])=>{this.firstName=new core.rA_({id:"firstName",label:firstName,name:"firstName",validators:{required:null},required:!0}),this.lastName=new core.rA_({id:"lastName",label:lastName,name:"lastName",validators:{required:null},required:!0}),this.email=new core.rA_({id:"email",label:email,name:"email",validators:{required:null,pattern:"^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"},required:!0,errorMessages:{emailTaken:"error.validation.emailTaken",pattern:"error.validation.NotValidEmail"},hint:emailHint}),this.canLogIn=new core.M7d({id:"canLogIn",label:canLogIn,name:"canLogIn",value:null==this.epersonInitial||this.epersonInitial.canLogIn}),this.requireCertificate=new core.M7d({id:"requireCertificate",label:requireCertificate,name:"requireCertificate",value:null!=this.epersonInitial&&this.epersonInitial.requireCertificate}),this.formModel=[this.firstName,this.lastName,this.email,this.canLogIn,this.requireCertificate],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.subs.push(this.epersonService.getActiveEPerson().subscribe(eperson=>{null!=eperson&&(this.groups$=this.groupsDataService.findListByHref(eperson._links.groups.href,{currentPage:1,elementsPerPage:this.config.pageSize})),this.formGroup.patchValue({firstName:null!=eperson?eperson.firstMetadataValue("eperson.firstname"):"",lastName:null!=eperson?eperson.firstMetadataValue("eperson.lastname"):"",email:null!=eperson?eperson.email:"",canLogIn:null==eperson||eperson.canLogIn,requireCertificate:null!=eperson&&eperson.requireCertificate}),null===eperson&&this.formGroup.controls.email&&(this.formGroup.controls.email.setAsyncValidators(ValidateEmailNotTaken.createValidator(this.epersonService)),this.emailValueChangeSubscribe=this.email.valueChanges.pipe((0,operators.BL)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()}))}));const activeEPerson$=this.epersonService.getActiveEPerson();this.groups$=activeEPerson$.pipe((0,operators.nx)(eperson=>(0,cjs.combineLatest)([(0,cjs.of)(eperson),this.paginationService.getFindListOptions(this.config.id,{currentPage:1,elementsPerPage:this.config.pageSize})])),(0,operators.nx)(([eperson,findListOptions])=>null!=eperson?this.groupsDataService.findListByHref(eperson._links.groups.href,findListOptions,!0,!0,(0,follow_link_config_model.s)("object")):(0,cjs.of)(void 0))),this.groupsPageInfoState$=this.groups$.pipe((0,operators.Tj)(groupsRD=>groupsRD.payload.pageInfo)),this.canImpersonate$=activeEPerson$.pipe((0,operators.nx)(eperson=>(0,empty_util.a4)(eperson)?this.authorizationService.isAuthorized(feature_id._.LoginOnBehalfOf,eperson.self):(0,cjs.of)(!1))),this.canDelete$=activeEPerson$.pipe((0,operators.nx)(eperson=>this.authorizationService.isAuthorized(feature_id._.CanDelete,(0,empty_util.a4)(eperson)?eperson.self:void 0))),this.canReset$=(0,cjs.of)(!0)})}onCancel(){this.epersonService.cancelEditEPerson(),this.cancelForm.emit(),this.router.navigate([(0,access_control_routing_paths.bL)()])}onSubmit(){this.epersonService.getActiveEPerson().pipe((0,operators.s)(1)).subscribe(ePerson=>{const values={metadata:{"eperson.firstname":[{value:this.firstName.value}],"eperson.lastname":[{value:this.lastName.value}]},email:this.email.value,canLogIn:this.canLogIn.value,requireCertificate:this.requireCertificate.value};null==ePerson?this.createNewEPerson(values):this.editEPerson(ePerson,values)})}createNewEPerson(values){const ePersonToCreate=Object.assign(new eperson_model.f,values);this.epersonService.create(ePersonToCreate).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.created.success",{name:this.dsoNameService.getName(ePersonToCreate)})),this.submitForm.emit(ePersonToCreate),this.epersonService.clearEPersonRequests(),this.router.navigateByUrl((0,access_control_routing_paths.bL)())):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.created.failure",{name:this.dsoNameService.getName(ePersonToCreate)})),this.cancelForm.emit())}),this.showNotificationIfEmailInUse(ePersonToCreate,"created")}editEPerson(ePerson,values){const editedEperson=Object.assign(new eperson_model.f,{id:ePerson.id,metadata:{"eperson.firstname":[{value:this.firstName.value?this.firstName.value:ePerson.firstMetadataValue("eperson.firstname")}],"eperson.lastname":[{value:this.lastName.value?this.lastName.value:ePerson.firstMetadataValue("eperson.lastname")}]},email:(0,empty_util.a4)(values.email)?values.email:ePerson.email,canLogIn:(0,empty_util.a4)(values.canLogIn)?values.canLogIn:ePerson.canLogIn,requireCertificate:(0,empty_util.a4)(values.requireCertificate)?values.requireCertificate:ePerson.requireCertificate,_links:ePerson._links});this.epersonService.updateEPerson(editedEperson).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.edited.success",{name:this.dsoNameService.getName(editedEperson)})),this.submitForm.emit(editedEperson),this.router.navigateByUrl((0,access_control_routing_paths.bL)())):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.edited.failure",{name:this.dsoNameService.getName(editedEperson)})),this.cancelForm.emit())}),null!=values.email&&values.email!==ePerson.email&&this.showNotificationIfEmailInUse(editedEperson,"edited")}onPageChange(event){this.updateGroups({currentPage:event,elementsPerPage:this.config.pageSize})}impersonate(){this.authService.impersonate(this.epersonInitial.id),this.isImpersonated=!0}delete(){this.epersonService.getActiveEPerson().pipe((0,operators.s)(1),(0,operators.nx)(eperson=>{const modalRef=this.modalService.open(confirmation_modal_component.M);return modalRef.componentInstance.name=this.dsoNameService.getName(eperson),modalRef.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",modalRef.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",modalRef.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",modalRef.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.s)(1),(0,operators.nx)(confirm=>confirm&&(0,empty_util.a4)(eperson.id)?(this.canDelete$=(0,cjs.of)(!1),this.epersonService.deleteEPerson(eperson).pipe((0,shared_operators.qD)(),(0,operators.Tj)(restResponse=>({restResponse,eperson})))):(0,cjs.of)(null)),(0,operators.jE)(()=>this.canDelete$=(0,cjs.of)(!0)))})).subscribe(({restResponse,eperson})=>{restResponse?.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:this.dsoNameService.getName(eperson)})),this.router.navigate([(0,access_control_routing_paths.bL)()])):this.notificationsService.error(`Error occurred when trying to delete EPerson with id: ${eperson?.id} with code: ${restResponse?.statusCode} and message: ${restResponse?.errorMessage}`),this.cancelForm.emit()})}stopImpersonating(){this.authService.stopImpersonatingAndRefresh(),this.isImpersonated=!1}resetPassword(){(0,empty_util.a4)(this.epersonInitial.email)&&this.epersonRegistrationService.registerEmail(this.epersonInitial.email,null,register_email_form_component.TYPE_REQUEST_FORGOT).pipe((0,shared_operators.qD)()).subscribe(response=>{response.hasSucceeded?this.notificationsService.success(this.translateService.get("admin.access-control.epeople.actions.reset"),this.translateService.get("forgot-email.form.success.content",{email:this.epersonInitial.email})):this.notificationsService.error(this.translateService.get("forgot-email.form.error.head"),this.translateService.get("forgot-email.form.error.content",{email:this.epersonInitial.email}))})}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),this.paginationService.clearPagination(this.config.id),(0,empty_util.a4)(this.emailValueChangeSubscribe)&&this.emailValueChangeSubscribe.unsubscribe()}showNotificationIfEmailInUse(ePerson,notificationSection){this.subs.push(this.epersonService.searchByScope("email",ePerson.email,{currentPage:1,elementsPerPage:0}).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(list=>{list.totalElements>0&&this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification."+notificationSection+".failure.emailInUse",{name:this.dsoNameService.getName(ePerson),email:ePerson.email}))}))}updateGroups(options){this.subs.push(this.epersonService.getActiveEPerson().subscribe(eperson=>{this.groups$=this.groupsDataService.findListByHref(eperson._links.groups.href,options)}))}static#_=this.\u0275fac=function(t){return new(t||EPersonFormComponent2)(fesm2022_core.rXU(fesm2022_core.gRc),fesm2022_core.rXU(eperson_data_service.EPersonDataService),fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(form_builder_service.j),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(auth_service.uR),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(ng_bootstrap.Bq),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(eperson_registration_service.f),fesm2022_core.rXU(dso_name_service.f),fesm2022_core.rXU(router.nX),fesm2022_core.rXU(router.Ix))};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:EPersonFormComponent2,selectors:[["ds-eperson-form"]],outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},standalone:!0,features:[fesm2022_core.aNF],decls:23,vars:25,consts:[["createHeader",""],["editHeader",""],[1,"container"],[1,"group-form","row"],[1,"col-12"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"submitForm","formId","formModel","formGroup","formLayout","displayCancel","submitLabel"],["before","",1,"btn-group"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["between","","class","btn-group",4,"ngIf"],["after","","class","btn btn-danger delete-button","type","button",3,"click",4,"ngIf"],[3,"showMessage",4,"ngIf"],[4,"ngIf"],[1,"border-bottom","pb-2"],["between","",1,"btn-group"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"fa","fa-key"],["class","btn btn-primary","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-user-secret"],["after","","type","button",1,"btn","btn-danger","delete-button",3,"click"],[1,"fas","fa-trash"],[3,"showMessage"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage","pageChange",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"pageChange","paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[4,"ngFor","ngForOf"],[1,"align-middle"],[3,"click","routerLink"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"btn","btn-primary",3,"routerLink"]],template:function(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",2)(1,"div",3)(2,"div",4),fesm2022_core.DNE(3,EPersonFormComponent_div_3_Template,1,0,"div",5),fesm2022_core.nI1(4,"async"),fesm2022_core.DNE(5,EPersonFormComponent_ng_template_5_Template,3,3,"ng-template",null,0,fesm2022_core.C5r)(7,EPersonFormComponent_ng_template_7_Template,3,3,"ng-template",null,1,fesm2022_core.C5r),fesm2022_core.j41(9,"ds-form",6),fesm2022_core.bIt("submitForm",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.onSubmit())}),fesm2022_core.j41(10,"div",7)(11,"button",8),fesm2022_core.bIt("click",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.onCancel())}),fesm2022_core.nrm(12,"i",9),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s()(),fesm2022_core.DNE(15,EPersonFormComponent_div_15_Template,6,6,"div",10)(16,EPersonFormComponent_div_16_Template,3,2,"div",10),fesm2022_core.nI1(17,"async"),fesm2022_core.DNE(18,EPersonFormComponent_button_18_Template,4,3,"button",11),fesm2022_core.nI1(19,"async"),fesm2022_core.k0s(),fesm2022_core.DNE(20,EPersonFormComponent_ds_loading_20_Template,1,1,"ds-loading",12)(21,EPersonFormComponent_div_21_Template,11,14,"div",13),fesm2022_core.nI1(22,"async"),fesm2022_core.k0s()()()}if(2&rf){const createHeader_r10=fesm2022_core.sdS(6),editHeader_r11=fesm2022_core.sdS(8);fesm2022_core.R7$(3),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(4,15,ctx.epersonService.getActiveEPerson()))("ngIfThen",editHeader_r11)("ngIfElse",createHeader_r10),fesm2022_core.R7$(6),fesm2022_core.Y8G("formId",ctx.formId)("formModel",ctx.formModel)("formGroup",ctx.formGroup)("formLayout",ctx.formLayout)("displayCancel",!1)("submitLabel",ctx.submitLabel),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(14,17,ctx.messagePrefix+".return")," "),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",ctx.displayResetPassword),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(17,19,ctx.canImpersonate$)),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(19,21,ctx.canDelete$)),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",!ctx.formGroup),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(22,23,ctx.epersonService.getActiveEPerson()))}},dependencies:[form_component.s,common.bT,common.pM,common.Jj,ngx_translate_core.h,ngx_translate_core.D9,themed_loading_component.v,pagination_component.e,router.Wk,has_no_value_pipe.n],encapsulation:2})}return EPersonFormComponent2})();var resolver_actions=__webpack_require__(71012),ngrx_store=__webpack_require__(5136);const EPERSON_EDIT_FOLLOW_LINKS=[(0,follow_link_config_model.s)("groups")];let EPersonResolver=(()=>{class EPersonResolver2{constructor(ePersonService,store){this.ePersonService=ePersonService,this.store=store}resolve(route,state){const ePersonRD$=this.ePersonService.findById(route.params.id,!0,!1,...EPERSON_EDIT_FOLLOW_LINKS).pipe((0,shared_operators.qD)());return ePersonRD$.subscribe(ePersonRD=>{this.store.dispatch(new resolver_actions.j(state.url,ePersonRD.payload))}),ePersonRD$}static#_=this.\u0275fac=function(t){return new(t||EPersonResolver2)(fesm2022_core.KVO(eperson_data_service.EPersonDataService),fesm2022_core.KVO(ngrx_store.il))};static#_2=this.\u0275prov=fesm2022_core.jDH({token:EPersonResolver2,factory:EPersonResolver2.\u0275fac,providedIn:"root"})}return EPersonResolver2})();var environment=__webpack_require__(72035),collection_page_routing_paths=__webpack_require__(72330),community_page_routing_paths=__webpack_require__(27546),dspace_object_data_service=__webpack_require__(78358),group_model=__webpack_require__(52177),collection_model=__webpack_require__(28410),community_model=__webpack_require__(61935),alert_component=__webpack_require__(14467),alert_type=__webpack_require__(82555),context_help_directive=__webpack_require__(80960),members_list_component=__webpack_require__(32443);const subgroups_list_component_c0=()=>["top","right","bottom"],subgroups_list_component_c1=a0=>({content:"admin.access-control.groups.form.tooltip.editGroup.addSubgroups",id:"edit-group-add-subgroups",iconPlacement:"right",tooltipPlacement:a0}),subgroups_list_component_c2=a0=>[a0],_c3=a0=>({name:a0});function SubgroupsListComponent_ds_pagination_7_tr_19_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"tr")(1,"td",18),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td",18)(4,"a",19),fesm2022_core.bIt("click",function(){const group_r2=fesm2022_core.eBV(_r1).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.groupDataService.startEditingNewGroup(group_r2))}),fesm2022_core.EFF(5),fesm2022_core.k0s()(),fesm2022_core.j41(6,"td",18),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"async"),fesm2022_core.k0s(),fesm2022_core.j41(9,"td",18)(10,"div",20)(11,"button",21),fesm2022_core.nI1(12,"translate"),fesm2022_core.bIt("click",function(){const group_r2=fesm2022_core.eBV(_r1).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.deleteSubgroupFromGroup(group_r2))}),fesm2022_core.nrm(13,"i",22),fesm2022_core.k0s()()()()}if(2&rf){let tmp_6_0;const group_r2=ctx.$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(group_r2.id),fesm2022_core.R7$(2),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(10,subgroups_list_component_c2,ctx_r2.groupDataService.getGroupEditPageRouterLink(group_r2))),fesm2022_core.R7$(),fesm2022_core.SpI(" ",ctx_r2.dsoNameService.getName(group_r2)," "),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r2.dsoNameService.getName(null==(tmp_6_0=fesm2022_core.bMT(8,5,group_r2.object))?null:tmp_6_0.payload)),fesm2022_core.R7$(4),fesm2022_core.FS9("title",fesm2022_core.i5U(12,7,ctx_r2.messagePrefix+".table.edit.buttons.remove",fesm2022_core.eq3(12,_c3,ctx_r2.dsoNameService.getName(group_r2))))}}function SubgroupsListComponent_ds_pagination_7_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",13),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",14)(3,"table",15)(4,"thead")(5,"tr")(6,"th",16),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",16),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",16),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th"),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(18,"tbody"),fesm2022_core.DNE(19,SubgroupsListComponent_ds_pagination_7_tr_19_Template,14,14,"tr",17),fesm2022_core.nI1(20,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_9_0;const ctx_r2=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r2.config)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,9,ctx_r2.subGroups$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,11,ctx_r2.messagePrefix+".table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,13,ctx_r2.messagePrefix+".table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,15,ctx_r2.messagePrefix+".table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,17,ctx_r2.messagePrefix+".table.edit")),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngForOf",null==(tmp_9_0=fesm2022_core.bMT(20,19,ctx_r2.subGroups$))||null==tmp_9_0.payload?null:tmp_9_0.payload.page)}}function SubgroupsListComponent_div_9_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",23),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.messagePrefix+".no-subgroups-yet")," ")}}function SubgroupsListComponent_span_12_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"span"),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.messagePrefix+".search.head")," ")}}function SubgroupsListComponent_ds_pagination_26_tr_19_Template(rf,ctx){if(1&rf){const _r4=fesm2022_core.RV6();fesm2022_core.j41(0,"tr")(1,"td",18),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td",18)(4,"a",19),fesm2022_core.bIt("click",function(){const group_r5=fesm2022_core.eBV(_r4).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.groupDataService.startEditingNewGroup(group_r5))}),fesm2022_core.EFF(5),fesm2022_core.k0s()(),fesm2022_core.j41(6,"td",18),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"async"),fesm2022_core.k0s(),fesm2022_core.j41(9,"td",18)(10,"div",20)(11,"button",25),fesm2022_core.nI1(12,"translate"),fesm2022_core.bIt("click",function(){const group_r5=fesm2022_core.eBV(_r4).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.addSubgroupToGroup(group_r5))}),fesm2022_core.nrm(13,"i",26),fesm2022_core.k0s()()()()}if(2&rf){let tmp_6_0;const group_r5=ctx.$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(group_r5.id),fesm2022_core.R7$(2),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(10,subgroups_list_component_c2,ctx_r2.groupDataService.getGroupEditPageRouterLink(group_r5))),fesm2022_core.R7$(),fesm2022_core.SpI(" ",ctx_r2.dsoNameService.getName(group_r5)," "),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r2.dsoNameService.getName(null==(tmp_6_0=fesm2022_core.bMT(8,5,group_r5.object))?null:tmp_6_0.payload)),fesm2022_core.R7$(4),fesm2022_core.FS9("title",fesm2022_core.i5U(12,7,ctx_r2.messagePrefix+".table.edit.buttons.add",fesm2022_core.eq3(12,_c3,ctx_r2.dsoNameService.getName(group_r5))))}}function SubgroupsListComponent_ds_pagination_26_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",13),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",14)(3,"table",24)(4,"thead")(5,"tr")(6,"th",16),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",16),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",16),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th",18),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(18,"tbody"),fesm2022_core.DNE(19,SubgroupsListComponent_ds_pagination_26_tr_19_Template,14,14,"tr",17),fesm2022_core.nI1(20,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_9_0;const ctx_r2=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r2.configSearch)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,9,ctx_r2.searchResults$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,11,ctx_r2.messagePrefix+".table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,13,ctx_r2.messagePrefix+".table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,15,ctx_r2.messagePrefix+".table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,17,ctx_r2.messagePrefix+".table.edit")),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngForOf",null==(tmp_9_0=fesm2022_core.bMT(20,19,ctx_r2.searchResults$))||null==tmp_9_0.payload?null:tmp_9_0.payload.page)}}function SubgroupsListComponent_div_28_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",23),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.messagePrefix+".no-items")," ")}}var SubKey=function(SubKey2){return SubKey2[SubKey2.Members=0]="Members",SubKey2[SubKey2.ActiveGroup=1]="ActiveGroup",SubKey2[SubKey2.SearchResults=2]="SearchResults",SubKey2}(SubKey||{});let SubgroupsListComponent=(()=>{class SubgroupsListComponent2{constructor(groupDataService,translateService,notificationsService,formBuilder,paginationService,router2,dsoNameService){this.groupDataService=groupDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.formBuilder=formBuilder,this.paginationService=paginationService,this.router=router2,this.dsoNameService=dsoNameService,this.searchResults$=new cjs.BehaviorSubject(void 0),this.subGroups$=new cjs.BehaviorSubject(void 0),this.subs=new Map,this.configSearch=Object.assign(new pagination_component_options_model.W,{id:"ssgl",pageSize:5,currentPage:1}),this.config=Object.assign(new pagination_component_options_model.W,{id:"sgl",pageSize:5,currentPage:1}),this.currentSearchQuery=""}ngOnInit(){this.searchForm=this.formBuilder.group({query:""}),this.subs.set(SubKey.ActiveGroup,this.groupDataService.getActiveGroup().subscribe(activeGroup=>{null!=activeGroup&&(this.groupBeingEdited=activeGroup,this.retrieveSubGroups(),this.search({query:""}))})),this.subGroupsPageInfoState$=this.subGroups$.pipe((0,operators.Tj)(subGroupsRD=>subGroupsRD?.payload?.pageInfo))}retrieveSubGroups(){this.unsubFrom(SubKey.Members),this.subs.set(SubKey.Members,this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.nx)(config=>this.groupDataService.findListByHref(this.groupBeingEdited._links.subgroups.href,{currentPage:config.currentPage,elementsPerPage:config.pageSize},!0,!0,(0,follow_link_config_model.s)("object")))).subscribe(rd=>{this.subGroups$.next(rd)}))}deleteSubgroupFromGroup(subgroup){this.groupDataService.getActiveGroup().pipe((0,operators.s)(1)).subscribe(activeGroup=>{if(null!=activeGroup){const response=this.groupDataService.deleteSubGroupFromGroup(activeGroup,subgroup);this.showNotifications("deleteSubgroup",response,this.dsoNameService.getName(subgroup),activeGroup),null!=this.currentSearchQuery&&this.search({query:this.currentSearchQuery})}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}addSubgroupToGroup(subgroup){this.groupDataService.getActiveGroup().pipe((0,operators.s)(1)).subscribe(activeGroup=>{if(null!=activeGroup)if(activeGroup.uuid!==subgroup.uuid){const response=this.groupDataService.addSubGroupToGroup(activeGroup,subgroup);this.showNotifications("addSubgroup",response,this.dsoNameService.getName(subgroup),activeGroup),null!=this.currentSearchQuery&&this.search({query:this.currentSearchQuery})}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.subgroupToAddIsActiveGroup"));else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}search(data){this.unsubFrom(SubKey.SearchResults),this.subs.set(SubKey.SearchResults,this.paginationService.getCurrentPagination(this.configSearch.id,this.configSearch).pipe((0,operators.nx)(paginationOptions=>{const query=data.query;return null!=query&&this.currentSearchQuery!==query&&this.groupBeingEdited&&(this.currentSearchQuery=query,this.paginationService.resetPage(this.configSearch.id)),this.searchDone=!0,this.groupDataService.searchNonMemberGroups(this.currentSearchQuery,this.groupBeingEdited.id,{currentPage:paginationOptions.currentPage,elementsPerPage:paginationOptions.pageSize},!1,!0,(0,follow_link_config_model.s)("object"))}),(0,shared_operators.bD)(),(0,operators.Tj)(rd=>{if(!rd.hasFailed)return rd;this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure",{cause:rd.errorMessage}))})).subscribe(rd=>{this.searchResults$.next(rd)}))}unsubFrom(key){this.subs.has(key)&&(this.subs.get(key).unsubscribe(),this.subs.delete(key))}ngOnDestroy(){for(const key of this.subs.keys())this.unsubFrom(key);this.paginationService.clearPagination(this.config.id),this.paginationService.clearPagination(this.configSearch.id)}showNotifications(messageSuffix,response,nameObject,activeGroup){response.pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.success."+messageSuffix,{name:nameObject})),this.groupDataService.clearGroupLinkRequests(activeGroup._links.subgroups.href)):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure."+messageSuffix,{name:nameObject}))})}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}static#_=this.\u0275fac=function(t){return new(t||SubgroupsListComponent2)(fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(fesm2022_forms.ze),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(router.Ix),fesm2022_core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:SubgroupsListComponent2,selectors:[["ds-subgroups-list"]],inputs:{messagePrefix:"messagePrefix"},standalone:!0,features:[fesm2022_core.aNF],decls:30,vars:29,consts:[[1,"border-bottom","pb-2"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],["id","search",1,"border-bottom","pb-2"],[4,"dsContextHelp"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],[1,"flex-grow-1","mr-3"],[1,"form-group","input-group","mr-3"],["type","text","name","query","id","query","formControlName","query","aria-label","Search input",1,"form-control"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary","float-right",3,"click"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","subgroupsOfGroup",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[4,"ngFor","ngForOf"],[1,"align-middle"],[3,"click","routerLink"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-danger","btn-sm","deleteButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["id","groupsSearch",1,"table","table-striped","table-hover","table-bordered"],[1,"btn","btn-outline-primary","btn-sm","addButton",3,"click","title"],[1,"fas","fa-plus","fa-fw"]],template:function(rf,ctx){if(1&rf&&(fesm2022_core.qex(0),fesm2022_core.j41(1,"h3",0),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(4,"h4"),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(7,SubgroupsListComponent_ds_pagination_7_Template,21,21,"ds-pagination",1),fesm2022_core.nI1(8,"async"),fesm2022_core.DNE(9,SubgroupsListComponent_div_9_Template,3,3,"div",2),fesm2022_core.nI1(10,"async"),fesm2022_core.j41(11,"h4",3),fesm2022_core.DNE(12,SubgroupsListComponent_span_12_Template,3,3,"span",4),fesm2022_core.k0s(),fesm2022_core.j41(13,"form",5),fesm2022_core.bIt("ngSubmit",function(){return ctx.search(ctx.searchForm.value)}),fesm2022_core.j41(14,"div",6)(15,"div",7),fesm2022_core.nrm(16,"input",8),fesm2022_core.j41(17,"span",9)(18,"button",10),fesm2022_core.nrm(19,"i",11),fesm2022_core.EFF(20),fesm2022_core.nI1(21,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(22,"div")(23,"button",12),fesm2022_core.bIt("click",function(){return ctx.clearFormAndResetResult()}),fesm2022_core.EFF(24),fesm2022_core.nI1(25,"translate"),fesm2022_core.k0s()()(),fesm2022_core.DNE(26,SubgroupsListComponent_ds_pagination_26_Template,21,21,"ds-pagination",1),fesm2022_core.nI1(27,"async"),fesm2022_core.DNE(28,SubgroupsListComponent_div_28_Template,3,3,"div",2),fesm2022_core.nI1(29,"async"),fesm2022_core.bVm()),2&rf){let tmp_2_0,tmp_3_0,tmp_8_0,tmp_9_0;fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,10,ctx.messagePrefix+".head")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(6,12,ctx.messagePrefix+".headSubgroups")),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",(null==(tmp_2_0=fesm2022_core.bMT(8,14,ctx.subGroups$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)>0),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",0===(null==(tmp_3_0=fesm2022_core.bMT(10,16,ctx.subGroups$))||null==tmp_3_0.payload?null:tmp_3_0.payload.totalElements)),fesm2022_core.R7$(3),fesm2022_core.Y8G("dsContextHelp",fesm2022_core.eq3(27,subgroups_list_component_c1,fesm2022_core.lJ4(26,subgroups_list_component_c0))),fesm2022_core.R7$(),fesm2022_core.Y8G("formGroup",ctx.searchForm),fesm2022_core.R7$(7),fesm2022_core.SpI(" ",fesm2022_core.bMT(21,18,ctx.messagePrefix+".search.button")," "),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(25,20,ctx.messagePrefix+".button.see-all")," "),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",(null==(tmp_8_0=fesm2022_core.bMT(27,22,ctx.searchResults$))||null==tmp_8_0.payload?null:tmp_8_0.payload.totalElements)>0),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",0===(null==(tmp_9_0=fesm2022_core.bMT(29,24,ctx.searchResults$))||null==tmp_9_0.payload?null:tmp_9_0.payload.totalElements)&&ctx.searchDone)}},dependencies:[router.Wk,common.Jj,common.Sq,context_help_directive.G,ngx_translate_core.h,ngx_translate_core.D9,fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,pagination_component.e,common.bT],encapsulation:2})}return SubgroupsListComponent2})();class ValidateGroupExists{static createValidator(groupDataService){return control=>groupDataService.searchGroups(control.value,{currentPage:1,elementsPerPage:100}).pipe((0,shared_operators.Ar)(),(0,operators.Tj)(groups=>groups.filter(group=>group.name===control.value)),(0,operators.Tj)(groups=>groups.length>0?{groupExists:!0}:null))}}const group_form_component_c0=()=>["right","bottom"],group_form_component_c1=a0=>({content:"admin.access-control.groups.form.tooltip.editGroupPage",id:"edit-group-page",iconPlacement:"right",tooltipPlacement:a0}),group_form_component_c2=(a0,a1,a2)=>({name:a0,comcol:a1,comcolEditRolesRoute:a2});function GroupFormComponent_div_3_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"div")}function GroupFormComponent_ng_template_5_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"h1",14),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(2,1,ctx_r1.messagePrefix+".head.create"))}}function GroupFormComponent_ng_template_7_span_1_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"span"),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r1=fesm2022_core.XpG(2);fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r1.messagePrefix+".head.edit")," ")}}function GroupFormComponent_ng_template_7_Template(rf,ctx){1&rf&&(fesm2022_core.j41(0,"h1",14),fesm2022_core.DNE(1,GroupFormComponent_ng_template_7_span_1_Template,3,3,"span",15),fesm2022_core.k0s()),2&rf&&(fesm2022_core.R7$(),fesm2022_core.Y8G("dsContextHelp",fesm2022_core.eq3(2,group_form_component_c1,fesm2022_core.lJ4(1,group_form_component_c0))))}function GroupFormComponent_ds_alert_9_Template(rf,ctx){if(1&rf&&fesm2022_core.nrm(0,"ds-alert",16),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.Y8G("type",ctx_r1.AlertTypeEnum.Warning)("content",ctx_r1.messagePrefix+".alert.permanent")}}function GroupFormComponent_ds_alert_10_Template(rf,ctx){if(1&rf&&(fesm2022_core.nrm(0,"ds-alert",16),fesm2022_core.nI1(1,"async"),fesm2022_core.nI1(2,"async"),fesm2022_core.nI1(3,"async"),fesm2022_core.nI1(4,"translate")),2&rf){let tmp_4_0;const ctx_r1=fesm2022_core.XpG();fesm2022_core.Y8G("type",ctx_r1.AlertTypeEnum.Warning)("content",fesm2022_core.i5U(4,8,ctx_r1.messagePrefix+".alert.workflowGroup",fesm2022_core.sMw(11,group_form_component_c2,ctx_r1.dsoNameService.getName(null==(tmp_4_0=fesm2022_core.bMT(1,2,ctx_r1.getLinkedDSO(ctx_r1.groupBeingEdited)))?null:tmp_4_0.payload),null==(tmp_4_0=fesm2022_core.bMT(2,4,ctx_r1.getLinkedDSO(ctx_r1.groupBeingEdited)))||null==tmp_4_0.payload?null:tmp_4_0.payload.type,fesm2022_core.bMT(3,6,ctx_r1.getLinkedEditRolesRoute(ctx_r1.groupBeingEdited)))))}}function GroupFormComponent_div_19_Template(rf,ctx){if(1&rf){const _r3=fesm2022_core.RV6();fesm2022_core.j41(0,"div",17)(1,"button",18),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r3);const ctx_r1=fesm2022_core.XpG();return fesm2022_core.Njj(ctx_r1.delete())}),fesm2022_core.nrm(2,"i",19),fesm2022_core.EFF(3),fesm2022_core.nI1(4,"translate"),fesm2022_core.k0s()()}if(2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(3),fesm2022_core.SpI(" ",fesm2022_core.bMT(4,1,ctx_r1.messagePrefix+".actions.delete")," ")}}function GroupFormComponent_ds_members_list_22_Template(rf,ctx){if(1&rf&&fesm2022_core.nrm(0,"ds-members-list",20),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.Y8G("messagePrefix",ctx_r1.messagePrefix+".members-list")}}function GroupFormComponent_ds_subgroups_list_23_Template(rf,ctx){if(1&rf&&fesm2022_core.nrm(0,"ds-subgroups-list",20),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.Y8G("messagePrefix",ctx_r1.messagePrefix+".subgroups-list")}}let GroupFormComponent=(()=>{class GroupFormComponent2{constructor(groupDataService,ePersonDataService,dSpaceObjectDataService,formBuilderService,translateService,notificationsService,route,router2,authorizationService,modalService,requestService,changeDetectorRef,dsoNameService){this.groupDataService=groupDataService,this.ePersonDataService=ePersonDataService,this.dSpaceObjectDataService=dSpaceObjectDataService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.notificationsService=notificationsService,this.route=route,this.router=router2,this.authorizationService=authorizationService,this.modalService=modalService,this.requestService=requestService,this.changeDetectorRef=changeDetectorRef,this.dsoNameService=dsoNameService,this.messagePrefix="admin.access-control.groups.form",this.formId="group-form",this.formLayout={groupName:{grid:{host:"row"}},groupDescription:{grid:{host:"row"}}},this.submitForm=new fesm2022_core.bkB,this.cancelForm=new fesm2022_core.bkB,this.subs=[],this.AlertTypeEnum=alert_type.v}ngOnInit(){this.initialisePage()}initialisePage(){this.subs.push(this.route.params.subscribe(params=>{"newGroup"!==params.groupId&&this.setActiveGroup(params.groupId)})),this.canEdit$=this.groupDataService.getActiveGroup().pipe((0,empty_util.Az)(),(0,operators.nx)(group=>(0,cjs.combineLatest)([this.authorizationService.isAuthorized(feature_id._.CanDelete,(0,empty_util.hj)(group)?group.self:void 0),this.hasLinkedDSO(group)]).pipe((0,operators.Tj)(([isAuthorized,hasLinkedDSO])=>isAuthorized&&!hasLinkedDSO)))),(0,cjs.combineLatest)([this.translateService.get(`${this.messagePrefix}.groupName`),this.translateService.get(`${this.messagePrefix}.groupCommunity`),this.translateService.get(`${this.messagePrefix}.groupDescription`)]).subscribe(([groupName,groupCommunity,groupDescription])=>{this.groupName=new core.rA_({id:"groupName",label:groupName,name:"groupName",validators:{required:null},required:!0}),this.groupCommunity=new core.rA_({id:"groupCommunity",label:groupCommunity,name:"groupCommunity",required:!1,readOnly:!0}),this.groupDescription=new core.Zex({id:"groupDescription",label:groupDescription,name:"groupDescription",required:!1,spellCheck:environment.c.form.spellCheck}),this.formModel=[this.groupName,this.groupDescription],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.formGroup.controls.groupName&&(this.formGroup.controls.groupName.setAsyncValidators(ValidateGroupExists.createValidator(this.groupDataService)),this.groupNameValueChangeSubscribe=this.groupName.valueChanges.pipe((0,operators.BL)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()})),this.subs.push((0,cjs.combineLatest)([this.groupDataService.getActiveGroup(),this.canEdit$,this.groupDataService.getActiveGroup().pipe((0,operators.pb)(activeGroup=>(0,empty_util.a4)(activeGroup)),(0,operators.nx)(activeGroup=>this.getLinkedDSO(activeGroup).pipe((0,shared_operators.ak)())))]).subscribe(([activeGroup,canEdit,linkedObject])=>{null!=activeGroup&&(this.formGroup.controls.groupName.clearAsyncValidators(),this.groupBeingEdited=activeGroup,linkedObject?.name?this.formGroup.controls.groupCommunity||(this.formBuilderService.insertFormGroupControl(1,this.formGroup,this.formModel,this.groupCommunity),this.formGroup.patchValue({groupName:activeGroup.name,groupCommunity:linkedObject?.name??"",groupDescription:activeGroup.firstMetadataValue("dc.description")})):(this.formModel=[this.groupName,this.groupDescription],this.formGroup.patchValue({groupName:activeGroup.name,groupDescription:activeGroup.firstMetadataValue("dc.description")})),setTimeout(()=>{(!canEdit||activeGroup.permanent)&&this.formGroup.disable()},200))}))})}onCancel(){this.groupDataService.cancelEditGroup(),this.cancelForm.emit(),this.router.navigate([(0,access_control_routing_paths.mK)()])}onSubmit(){this.groupDataService.getActiveGroup().pipe((0,operators.s)(1)).subscribe(group=>{null===group?this.createNewGroup({name:this.groupName.value,metadata:{"dc.description":[{value:this.groupDescription.value}]}}):this.editGroup(group)})}createNewGroup(values){const groupToCreate=Object.assign(new group_model.Y,values);this.groupDataService.create(groupToCreate).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.created.success",{name:groupToCreate.name})),this.submitForm.emit(groupToCreate),(0,empty_util.hj)(rd.payload)&&(this.setActiveGroupWithLink(rd.payload._links.self.href),this.groupDataService.clearGroupsRequests(),this.router.navigateByUrl((0,access_control_routing_paths.xl)(rd.payload.uuid)))):(this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.created.failure",{name:groupToCreate.name})),this.showNotificationIfNameInUse(groupToCreate,"created"),this.cancelForm.emit())})}showNotificationIfNameInUse(group,notificationSection){this.subs.push(this.groupDataService.searchGroups(group.name,{currentPage:1,elementsPerPage:0}).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(list=>{list.totalElements>0&&this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification."+notificationSection+".failure.groupNameInUse",{name:this.dsoNameService.getName(group)}))}))}editGroup(group){let operations=[];(0,empty_util.a4)(this.groupDescription.value)&&(operations=[...operations,{op:"add",path:"/metadata/dc.description",value:this.groupDescription.value}]),(0,empty_util.a4)(this.groupName.value)&&(operations=[...operations,{op:"replace",path:"/name",value:this.groupName.value}]),this.groupDataService.patch(group,operations).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.edited.success",{name:this.dsoNameService.getName(rd.payload)})),this.submitForm.emit(rd.payload)):(this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.edited.failure",{name:this.dsoNameService.getName(group)})),this.cancelForm.emit())})}setActiveGroup(groupId){this.groupDataService.cancelEditGroup(),this.groupDataService.findById(groupId).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(group=>{this.groupDataService.editGroup(group)})}setActiveGroupWithLink(groupSelfLink){this.groupDataService.getActiveGroup().pipe((0,operators.s)(1)).subscribe(activeGroup=>{null===activeGroup&&(this.groupDataService.cancelEditGroup(),this.groupDataService.findByHref(groupSelfLink,!1,!1,(0,follow_link_config_model.s)("subgroups"),(0,follow_link_config_model.s)("epersons"),(0,follow_link_config_model.s)("object")).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(group=>{this.groupDataService.editGroup(group)}))})}delete(){this.groupDataService.getActiveGroup().pipe((0,operators.s)(1)).subscribe(group=>{const modalRef=this.modalService.open(confirmation_modal_component.M);modalRef.componentInstance.name=this.dsoNameService.getName(group),modalRef.componentInstance.headerLabel=this.messagePrefix+".delete-group.modal.header",modalRef.componentInstance.infoLabel=this.messagePrefix+".delete-group.modal.info",modalRef.componentInstance.cancelLabel=this.messagePrefix+".delete-group.modal.cancel",modalRef.componentInstance.confirmLabel=this.messagePrefix+".delete-group.modal.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.s)(1)).subscribe(confirm=>{confirm&&(0,empty_util.a4)(group.id)&&this.groupDataService.delete(group.id).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.deleted.success",{name:this.dsoNameService.getName(group)})),this.onCancel()):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.deleted.failure.title",{name:this.dsoNameService.getName(group)}),this.translateService.get(this.messagePrefix+".notification.deleted.failure.content",{cause:rd.errorMessage}))})})})}ngOnDestroy(){this.groupDataService.cancelEditGroup(),this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),(0,empty_util.a4)(this.groupNameValueChangeSubscribe)&&this.groupNameValueChangeSubscribe.unsubscribe()}hasLinkedDSO(group){if((0,empty_util.a4)(group)&&(0,empty_util.a4)(group._links.object.href))return this.getLinkedDSO(group).pipe((0,operators.Tj)(rd=>(0,empty_util.a4)(rd)&&(0,empty_util.a4)(rd.payload)),(0,operators.WL)(()=>(0,cjs.of)(!1)))}getLinkedDSO(group){if((0,empty_util.a4)(group)&&(0,empty_util.a4)(group._links.object.href))return void 0===group.object?this.dSpaceObjectDataService.findByHref(group._links.object.href):group.object}getLinkedEditRolesRoute(group){if((0,empty_util.a4)(group)&&(0,empty_util.a4)(group._links.object.href))return this.getLinkedDSO(group).pipe((0,operators.Tj)(rd=>{if((0,empty_util.a4)(rd)&&(0,empty_util.a4)(rd.payload))switch(rd.payload.type){case community_model.E.type.value:return(0,community_page_routing_paths.EU)(rd.payload.id);case collection_model.p.type.value:return(0,collection_page_routing_paths.BW)(rd.payload.id)}}))}static#_=this.\u0275fac=function(t){return new(t||GroupFormComponent2)(fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(eperson_data_service.EPersonDataService),fesm2022_core.rXU(dspace_object_data_service.DSpaceObjectDataService),fesm2022_core.rXU(form_builder_service.j),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(router.nX),fesm2022_core.rXU(router.Ix),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(ng_bootstrap.Bq),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(fesm2022_core.gRc),fesm2022_core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:GroupFormComponent2,selectors:[["ds-group-form"]],hostBindings:function(rf,ctx){1&rf&&fesm2022_core.bIt("beforeunload",function(){return ctx.ngOnDestroy()},!1,fesm2022_core.tSv)},outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},standalone:!0,features:[fesm2022_core.aNF],decls:24,vars:24,consts:[["createHeader",""],["editHeader",""],[1,"container"],[1,"group-form","row"],[1,"col-12"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"type","content",4,"ngIf"],[3,"submitForm","formId","formModel","formGroup","formLayout","displayCancel"],["before","",1,"btn-group"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["after","","class","btn-group",4,"ngIf"],[1,"mb-5"],[3,"messagePrefix",4,"ngIf"],[1,"border-bottom","pb-2"],[4,"dsContextHelp"],[3,"type","content"],["after","",1,"btn-group"],["type","button",1,"btn","btn-danger","delete-button",3,"click"],[1,"fa","fa-trash"],[3,"messagePrefix"]],template:function(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",2)(1,"div",3)(2,"div",4),fesm2022_core.DNE(3,GroupFormComponent_div_3_Template,1,0,"div",5),fesm2022_core.nI1(4,"async"),fesm2022_core.DNE(5,GroupFormComponent_ng_template_5_Template,3,3,"ng-template",null,0,fesm2022_core.C5r)(7,GroupFormComponent_ng_template_7_Template,2,4,"ng-template",null,1,fesm2022_core.C5r)(9,GroupFormComponent_ds_alert_9_Template,1,2,"ds-alert",6)(10,GroupFormComponent_ds_alert_10_Template,5,15,"ds-alert",6),fesm2022_core.nI1(11,"async"),fesm2022_core.nI1(12,"async"),fesm2022_core.j41(13,"ds-form",7),fesm2022_core.bIt("submitForm",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.onSubmit())}),fesm2022_core.j41(14,"div",8)(15,"button",9),fesm2022_core.bIt("click",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.onCancel())}),fesm2022_core.nrm(16,"i",10),fesm2022_core.EFF(17),fesm2022_core.nI1(18,"translate"),fesm2022_core.k0s()(),fesm2022_core.DNE(19,GroupFormComponent_div_19_Template,5,3,"div",11),fesm2022_core.nI1(20,"async"),fesm2022_core.k0s(),fesm2022_core.j41(21,"div",12),fesm2022_core.DNE(22,GroupFormComponent_ds_members_list_22_Template,1,1,"ds-members-list",13),fesm2022_core.k0s(),fesm2022_core.DNE(23,GroupFormComponent_ds_subgroups_list_23_Template,1,1,"ds-subgroups-list",13),fesm2022_core.k0s()()()}if(2&rf){const createHeader_r4=fesm2022_core.sdS(6),editHeader_r5=fesm2022_core.sdS(8);fesm2022_core.R7$(3),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(4,14,ctx.groupDataService.getActiveGroup()))("ngIfThen",editHeader_r5)("ngIfElse",createHeader_r4),fesm2022_core.R7$(6),fesm2022_core.Y8G("ngIf",null==ctx.groupBeingEdited?null:ctx.groupBeingEdited.permanent),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",!0!==fesm2022_core.bMT(11,16,ctx.canEdit$)&&fesm2022_core.bMT(12,18,ctx.groupDataService.getActiveGroup())),fesm2022_core.R7$(3),fesm2022_core.Y8G("formId",ctx.formId)("formModel",ctx.formModel)("formGroup",ctx.formGroup)("formLayout",ctx.formLayout)("displayCancel",!1),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(18,20,ctx.messagePrefix+".return"),""),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(20,22,ctx.canEdit$)&&!(null!=ctx.groupBeingEdited&&ctx.groupBeingEdited.permanent)),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngIf",void 0!==ctx.groupBeingEdited),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",void 0!==ctx.groupBeingEdited)}},dependencies:[form_component.s,alert_component.C,common.bT,common.Jj,ngx_translate_core.h,ngx_translate_core.D9,context_help_directive.G,members_list_component.v,SubgroupsListComponent],encapsulation:2})}return GroupFormComponent2})();var some_feature_authorization_guard=__webpack_require__(90254),hal_endpoint_service=__webpack_require__(91365);const defaultGroupPageGetObjectUrl=(route,state)=>(0,fesm2022_core.WQX)(hal_endpoint_service.Y).getEndpoint("groups").pipe((0,operators.Tj)(groupsUrl=>`${groupsUrl}/${route?.params?.groupId}`));class GroupDtoModel{}var route_service=__webpack_require__(86759);const groups_registry_component_c0=a0=>({name:a0});function GroupsRegistryComponent_ds_loading_31_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading")}function GroupsRegistryComponent_ds_pagination_33_tr_22_button_13_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"button",30),fesm2022_core.nI1(1,"translate"),fesm2022_core.nrm(2,"i",31),fesm2022_core.k0s()),2&rf){const groupDto_r1=fesm2022_core.XpG().$implicit,ctx_r1=fesm2022_core.XpG(2);fesm2022_core.FS9("title",fesm2022_core.i5U(1,2,ctx_r1.messagePrefix+"table.edit.buttons.edit",fesm2022_core.eq3(5,groups_registry_component_c0,ctx_r1.dsoNameService.getName(groupDto_r1.group)))),fesm2022_core.Y8G("routerLink",ctx_r1.groupService.getGroupEditPageRouterLink(groupDto_r1.group))}}function GroupsRegistryComponent_ds_pagination_33_tr_22_button_14_Template(rf,ctx){1&rf&&(fesm2022_core.j41(0,"button",32),fesm2022_core.nI1(1,"translate"),fesm2022_core.nrm(2,"i",31),fesm2022_core.k0s()),2&rf&&fesm2022_core.Y8G("disabled",!0)("ngbTooltip",fesm2022_core.bMT(1,2,"admin.access-control.epeople.table.edit.buttons.edit-disabled"))}function GroupsRegistryComponent_ds_pagination_33_tr_22_button_15_Template(rf,ctx){if(1&rf){const _r3=fesm2022_core.RV6();fesm2022_core.j41(0,"button",33),fesm2022_core.nI1(1,"translate"),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r3);const groupDto_r1=fesm2022_core.XpG().$implicit,ctx_r1=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r1.deleteGroup(groupDto_r1))}),fesm2022_core.nrm(2,"i",34),fesm2022_core.k0s()}if(2&rf){const groupDto_r1=fesm2022_core.XpG().$implicit,ctx_r1=fesm2022_core.XpG(2);fesm2022_core.FS9("title",fesm2022_core.i5U(1,1,ctx_r1.messagePrefix+"table.edit.buttons.remove",fesm2022_core.eq3(4,groups_registry_component_c0,ctx_r1.dsoNameService.getName(groupDto_r1.group))))}}function GroupsRegistryComponent_ds_pagination_33_tr_22_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"tr")(1,"td"),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td"),fesm2022_core.EFF(4),fesm2022_core.k0s(),fesm2022_core.j41(5,"td"),fesm2022_core.EFF(6),fesm2022_core.nI1(7,"async"),fesm2022_core.k0s(),fesm2022_core.j41(8,"td"),fesm2022_core.EFF(9),fesm2022_core.k0s(),fesm2022_core.j41(10,"td")(11,"div",25),fesm2022_core.qex(12,26),fesm2022_core.DNE(13,GroupsRegistryComponent_ds_pagination_33_tr_22_button_13_Template,3,7,"button",27)(14,GroupsRegistryComponent_ds_pagination_33_tr_22_button_14_Template,3,4,"button",28),fesm2022_core.bVm(),fesm2022_core.DNE(15,GroupsRegistryComponent_ds_pagination_33_tr_22_button_15_Template,3,6,"button",29),fesm2022_core.k0s()()()),2&rf){let tmp_5_0;const groupDto_r1=ctx.$implicit,ctx_r1=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(groupDto_r1.group.id),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r1.dsoNameService.getName(groupDto_r1.group)),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r1.dsoNameService.getName(null==(tmp_5_0=fesm2022_core.bMT(7,8,groupDto_r1.group.object))?null:tmp_5_0.payload)),fesm2022_core.R7$(3),fesm2022_core.JRh((null==groupDto_r1.epersons?null:groupDto_r1.epersons.totalElements)+(null==groupDto_r1.subgroups?null:groupDto_r1.subgroups.totalElements)),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngSwitch",groupDto_r1.ableToEdit),fesm2022_core.R7$(),fesm2022_core.Y8G("ngSwitchCase",!0),fesm2022_core.R7$(),fesm2022_core.Y8G("ngSwitchCase",!1),fesm2022_core.R7$(),fesm2022_core.Y8G("ngIf",!(null!=groupDto_r1.group&&groupDto_r1.group.permanent)&&groupDto_r1.ableToDelete)}}function GroupsRegistryComponent_ds_pagination_33_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",20),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",21)(3,"table",22)(4,"thead")(5,"tr")(6,"th",23),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",23),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",23),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th",23),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(18,"th"),fesm2022_core.EFF(19),fesm2022_core.nI1(20,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(21,"tbody"),fesm2022_core.DNE(22,GroupsRegistryComponent_ds_pagination_33_tr_22_Template,16,10,"tr",24),fesm2022_core.nI1(23,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_10_0;const ctx_r1=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r1.config)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,10,ctx_r1.pageInfoState$))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,12,ctx_r1.messagePrefix+"table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,14,ctx_r1.messagePrefix+"table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,16,ctx_r1.messagePrefix+"table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,18,ctx_r1.messagePrefix+"table.members")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(20,20,ctx_r1.messagePrefix+"table.edit")),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngForOf",null==(tmp_10_0=fesm2022_core.bMT(23,22,ctx_r1.groupsDto$))?null:tmp_10_0.page)}}function GroupsRegistryComponent_div_36_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",35),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r1.messagePrefix+"no-items")," ")}}const ValidateEmailErrorStateMatcher=(control,model,hasFocus)=>control.touched&&!hasFocus||control.errors?.emailTaken&&hasFocus,providers=[{provide:core.P3,useValue:ValidateEmailErrorStateMatcher}],ROUTES=[{path:access_control_routing_paths.P5,component:EPeopleRegistryComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.epeople.title",breadcrumbKey:"admin.access-control.epeople"},canActivate:[site_administrator_guard.Y]},{path:`${access_control_routing_paths.P5}/create`,component:EPersonFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.epeople.add.title",breadcrumbKey:"admin.access-control.epeople.add"},canActivate:[site_administrator_guard.Y]},{path:`${access_control_routing_paths.P5}/:id/edit`,component:EPersonFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S,ePerson:EPersonResolver},providers,data:{title:"admin.access-control.epeople.edit.title",breadcrumbKey:"admin.access-control.epeople.edit"},canActivate:[site_administrator_guard.Y]},{path:access_control_routing_paths.w4,component:(()=>{class GroupsRegistryComponent2{constructor(groupService,ePersonDataService,dSpaceObjectDataService,translateService,notificationsService,formBuilder,routeService,authorizationService,paginationService,requestService,dsoNameService){this.groupService=groupService,this.ePersonDataService=ePersonDataService,this.dSpaceObjectDataService=dSpaceObjectDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.formBuilder=formBuilder,this.routeService=routeService,this.authorizationService=authorizationService,this.paginationService=paginationService,this.requestService=requestService,this.dsoNameService=dsoNameService,this.messagePrefix="admin.access-control.groups.",this.config=Object.assign(new pagination_component_options_model.W,{id:"gl",pageSize:5,currentPage:1}),this.groupsDto$=new cjs.BehaviorSubject({}),this.deletedGroupsIds=[],this.pageInfoState$=new cjs.BehaviorSubject(void 0),this.loading$=new cjs.BehaviorSubject(!1),this.subs=[],this.currentSearchQuery="",this.searchForm=this.formBuilder.group({query:this.currentSearchQuery})}ngOnInit(){this.search({query:this.currentSearchQuery})}search(data){(0,empty_util.a4)(this.searchSub)&&(this.searchSub.unsubscribe(),this.subs=this.subs.filter(sub=>sub!==this.searchSub)),this.searchSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.Mi)(()=>this.loading$.next(!0)),(0,operators.nx)(paginationOptions=>{const query=data.query;return null!=query&&this.currentSearchQuery!==query&&(this.currentSearchQuery=query,this.paginationService.updateRouteWithUrl(this.config.id,[],{page:1})),this.groupService.searchGroups(this.currentSearchQuery.trim(),{currentPage:paginationOptions.currentPage,elementsPerPage:paginationOptions.pageSize},!0,!0,(0,follow_link_config_model.s)("object"))}),(0,shared_operators.v7)(),(0,shared_operators.Bo)(),(0,operators.nx)(groups=>0===groups.page.length?(0,cjs.of)((0,paginated_list_model.g)(groups.pageInfo,[])):this.authorizationService.isAuthorized(feature_id._.AdministratorOf).pipe((0,operators.nx)(isSiteAdmin=>(0,cjs.combineLatest)([...groups.page.map(group=>(0,empty_util.a4)(group)&&!this.deletedGroupsIds.includes(group.id)?(0,cjs.combineLatest)([this.authorizationService.isAuthorized(feature_id._.CanDelete,group.self),this.canManageGroup$(isSiteAdmin,group),this.hasLinkedDSO(group),this.getSubgroups(group),this.getMembers(group)]).pipe((0,operators.Tj)(([canDelete,canManageGroup,hasLinkedDSO,subgroups,members])=>{const groupDtoModel=new GroupDtoModel;return groupDtoModel.ableToDelete=canDelete&&!hasLinkedDSO,groupDtoModel.ableToEdit=canManageGroup,groupDtoModel.group=group,groupDtoModel.subgroups=subgroups.payload,groupDtoModel.epersons=members.payload,groupDtoModel})):cjs.EMPTY)]).pipe((0,operators.US)([]),(0,operators.Tj)(dtos=>(0,paginated_list_model.g)(groups.pageInfo,dtos))))))).subscribe(value=>{this.groupsDto$.next(value),this.pageInfoState$.next(value.pageInfo),this.loading$.next(!1)}),this.subs.push(this.searchSub)}canManageGroup$(isSiteAdmin,group){return isSiteAdmin?(0,cjs.of)(!0):this.authorizationService.isAuthorized(feature_id._.CanManageGroup,group.self)}deleteGroup(group){(0,empty_util.a4)(group.group.id)&&this.groupService.delete(group.group.id).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.deletedGroupsIds=[...this.deletedGroupsIds,group.group.id],this.notificationsService.success(this.translateService.get(this.messagePrefix+"notification.deleted.success",{name:this.dsoNameService.getName(group.group)}))):this.notificationsService.error(this.translateService.get(this.messagePrefix+"notification.deleted.failure.title",{name:this.dsoNameService.getName(group.group)}),this.translateService.get(this.messagePrefix+"notification.deleted.failure.content",{cause:rd.errorMessage}))})}getMembers(group){return this.ePersonDataService.findListByHref(group._links.epersons.href,{currentPage:1,elementsPerPage:1}).pipe((0,shared_operators.yd)())}getSubgroups(group){return this.groupService.findListByHref(group._links.subgroups.href,{currentPage:1,elementsPerPage:1}).pipe((0,shared_operators.yd)())}hasLinkedDSO(group){return this.dSpaceObjectDataService.findByHref(group._links.object.href).pipe((0,shared_operators.yd)(),(0,operators.Tj)(rd=>(0,empty_util.a4)(rd)&&(0,empty_util.a4)(rd.payload)),(0,operators.WL)(()=>(0,cjs.of)(!1)))}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){(0,empty_util.a4)(this.paginationSub)&&this.paginationSub.unsubscribe(),this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),this.paginationService.clearPagination(this.config.id)}static#_=this.\u0275fac=function(t){return new(t||GroupsRegistryComponent2)(fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(eperson_data_service.EPersonDataService),fesm2022_core.rXU(dspace_object_data_service.DSpaceObjectDataService),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(fesm2022_forms.ze),fesm2022_core.rXU(route_service.v$),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=fesm2022_core.VBU({type:GroupsRegistryComponent2,selectors:[["ds-groups-registry"]],standalone:!0,features:[fesm2022_core.aNF],decls:38,vars:34,consts:[[1,"container"],[1,"groups-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"mr-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline","ml-1"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],[1,"flex-grow-1","mr-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary",3,"click"],[4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],[1,"btn-group","edit-field"],[3,"ngSwitch"],["class","btn btn-outline-primary btn-sm btn-edit",3,"routerLink","title",4,"ngSwitchCase"],["class","btn btn-outline-primary btn-sm btn-edit","placement","left",3,"disabled","ngbTooltip",4,"ngSwitchCase"],["class","btn btn-outline-danger btn-sm btn-delete",3,"title","click",4,"ngIf"],[1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],["placement","left",1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"disabled","ngbTooltip"],[1,"btn","btn-outline-danger","btn-sm","btn-delete",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"]],template:function(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(7,"div")(8,"button",5),fesm2022_core.nrm(9,"i",6),fesm2022_core.j41(10,"span",7),fesm2022_core.EFF(11),fesm2022_core.nI1(12,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(13,"h2",8),fesm2022_core.EFF(14),fesm2022_core.nI1(15,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(16,"form",9),fesm2022_core.bIt("ngSubmit",function(){return ctx.search(ctx.searchForm.value)}),fesm2022_core.j41(17,"div",10)(18,"div",11),fesm2022_core.nrm(19,"input",12),fesm2022_core.nI1(20,"translate"),fesm2022_core.nI1(21,"translate"),fesm2022_core.j41(22,"span",13)(23,"button",14),fesm2022_core.nrm(24,"i",15),fesm2022_core.EFF(25),fesm2022_core.nI1(26,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(27,"div")(28,"button",16),fesm2022_core.bIt("click",function(){return ctx.clearFormAndResetResult()}),fesm2022_core.EFF(29),fesm2022_core.nI1(30,"translate"),fesm2022_core.k0s()()(),fesm2022_core.DNE(31,GroupsRegistryComponent_ds_loading_31_Template,1,0,"ds-loading",17),fesm2022_core.nI1(32,"async"),fesm2022_core.DNE(33,GroupsRegistryComponent_ds_pagination_33_Template,24,24,"ds-pagination",18),fesm2022_core.nI1(34,"async"),fesm2022_core.nI1(35,"async"),fesm2022_core.DNE(36,GroupsRegistryComponent_div_36_Template,3,3,"div",19),fesm2022_core.nI1(37,"async"),fesm2022_core.k0s()()()),2&rf){let tmp_10_0,tmp_11_0;fesm2022_core.R7$(5),fesm2022_core.JRh(fesm2022_core.bMT(6,12,ctx.messagePrefix+"head")),fesm2022_core.R7$(3),fesm2022_core.Y8G("routerLink","create"),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(12,14,ctx.messagePrefix+"button.add")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(15,16,ctx.messagePrefix+"search.head")),fesm2022_core.R7$(2),fesm2022_core.Y8G("formGroup",ctx.searchForm),fesm2022_core.R7$(3),fesm2022_core.Y8G("placeholder",fesm2022_core.bMT(20,18,ctx.messagePrefix+"search.placeholder")),fesm2022_core.BMQ("aria-label",fesm2022_core.bMT(21,20,ctx.messagePrefix+"search.placeholder")),fesm2022_core.R7$(6),fesm2022_core.SpI(" ",fesm2022_core.bMT(26,22,ctx.messagePrefix+"search.button")," "),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(30,24,ctx.messagePrefix+"button.see-all")," "),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",fesm2022_core.bMT(32,26,ctx.loading$)),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngIf",(null==(tmp_10_0=fesm2022_core.bMT(34,28,ctx.pageInfoState$))?null:tmp_10_0.totalElements)>0&&!0!==fesm2022_core.bMT(35,30,ctx.loading$)),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngIf",0===(null==(tmp_11_0=fesm2022_core.bMT(37,32,ctx.pageInfoState$))?null:tmp_11_0.totalElements))}},dependencies:[themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9,router.Wk,fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,common.Jj,common.bT,pagination_component.e,common.ux,common.e1,ng_bootstrap.n8,ng_bootstrap.md,common.Sq],encapsulation:2})}return GroupsRegistryComponent2})(),resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.groups.title",breadcrumbKey:"admin.access-control.groups"},canActivate:[group_administrator_guard.i]},{path:`${access_control_routing_paths.w4}/create`,component:GroupFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.groups.title.addGroup",breadcrumbKey:"admin.access-control.groups.addGroup"},canActivate:[group_administrator_guard.i]},{path:`${access_control_routing_paths.w4}/:groupId/edit`,component:GroupFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.groups.title.singleGroup",breadcrumbKey:"admin.access-control.groups.singleGroup"},canActivate:[(getObjectUrl=defaultGroupPageGetObjectUrl,getEPersonUuid)=>(0,some_feature_authorization_guard.h)(()=>(0,cjs.of)([feature_id._.CanManageGroup]),getObjectUrl,getEPersonUuid)]},{path:"bulk-access",component:BulkAccessComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},data:{title:"admin.access-control.bulk-access.title",breadcrumbKey:"admin.access-control.bulk-access"},canActivate:[site_administrator_guard.Y]}]},96622:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>Breadcrumb});class Breadcrumb{constructor(text,url){this.text=text,this.url=url}}},21870:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>i18nBreadcrumbResolver});var core=__webpack_require__(68014),empty_util=__webpack_require__(77028),route_utils=__webpack_require__(39609),cjs=__webpack_require__(74785),breadcrumb_model=__webpack_require__(96622);let I18nBreadcrumbsService=(()=>{class I18nBreadcrumbsService2{getBreadcrumbs(key,url){return(0,cjs.of)([new breadcrumb_model.Q(key+".breadcrumbs",url)])}static#_=this.\u0275fac=function(t){return new(t||I18nBreadcrumbsService2)};static#_2=this.\u0275prov=core.jDH({token:I18nBreadcrumbsService2,factory:I18nBreadcrumbsService2.\u0275fac,providedIn:"root"})}return I18nBreadcrumbsService2})();const i18nBreadcrumbResolver=(route,state,breadcrumbService=(0,core.WQX)(I18nBreadcrumbsService))=>{const key=route.data.breadcrumbKey;if((0,empty_util.Tn)(key))throw new Error('You provided an i18nBreadcrumbResolver for url "'+route.url+"\" but no breadcrumbKey in the route's data");return{provider:breadcrumbService,key,url:(0,route_utils.F)(route)}}},47094:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BulkAccessConfigDataService:()=>BulkAccessConfigDataService});var _cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(86786),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(40017),_data_request_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72744),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(91365),_config_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(55686),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(68014);let BulkAccessConfigDataService=(()=>{class BulkAccessConfigDataService2 extends _config_data_service__WEBPACK_IMPORTED_MODULE_4__.O{constructor(requestService,rdbService,objectCache,halService){super("bulkaccessconditionoptions",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService}static#_=this.\u0275fac=function(t){return new(t||BulkAccessConfigDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_2__.B),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__.o),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__.$),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_5__.jDH({token:BulkAccessConfigDataService2,factory:BulkAccessConfigDataService2.\u0275fac,providedIn:"root"})}return BulkAccessConfigDataService2})()},55686:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>ConfigDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10743),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68134),_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(82656);class ConfigDataService extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__.W{findByHref(href,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findByHref(href,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.Tj)(rd=>{if(rd.hasFailed)throw new Error("Couldn't retrieve the config");return rd}))}findByName(name,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findById(name,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}}},2195:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{f:()=>EpersonRegistrationService});var http=__webpack_require__(38068),operators=__webpack_require__(10743),empty_util=__webpack_require__(77028),remote_data_build_service=__webpack_require__(86786),hal_endpoint_service=__webpack_require__(91365),shared_operators=__webpack_require__(82656),registration_model=__webpack_require__(16212),response_models=__webpack_require__(50979),core=__webpack_require__(68014);let RegistrationResponseParsingService=(()=>{class RegistrationResponseParsingService2{parse(request,data){const payload=data.payload,registration=Object.assign(new registration_model.c,payload);return new response_models.hT(data.statusCode,void 0,registration)}static#_=this.\u0275fac=function(t){return new(t||RegistrationResponseParsingService2)};static#_2=this.\u0275prov=core.jDH({token:RegistrationResponseParsingService2,factory:RegistrationResponseParsingService2.\u0275fac,providedIn:"root"})}return RegistrationResponseParsingService2})();var request_models=__webpack_require__(87457),request_service=__webpack_require__(72744);let EpersonRegistrationService=(()=>{class EpersonRegistrationService2{constructor(requestService,rdbService,halService){this.requestService=requestService,this.rdbService=rdbService,this.halService=halService,this.linkPath="registrations",this.searchByTokenPath="/search/findByToken?token="}getRegistrationEndpoint(){return this.halService.getEndpoint(this.linkPath)}getTokenSearchEndpoint(token){return this.halService.getEndpoint(this.linkPath).pipe((0,operators.pb)(href=>(0,empty_util.hj)(href)),(0,operators.Tj)(href=>`${href}${this.searchByTokenPath}${token}`))}registerEmail(email,captchaToken=null,type){const registration=new registration_model.c;registration.email=email;const requestId=this.requestService.generateRequestId(),href$=this.getRegistrationEndpoint(),options=Object.create({});let headers=new http.Lr;return captchaToken&&(headers=headers.append("x-recaptcha-token",captchaToken)),options.headers=headers,(0,empty_util.a4)(type)&&(options.params=type?new http.Nl({fromString:"accountRequestType="+type}):new http.Nl),href$.pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)),(0,operators.Tj)(href=>{const request=new request_models.Qf(requestId,href,registration,options);this.requestService.send(request)})).subscribe(),this.rdbService.buildFromRequestUUID(requestId).pipe((0,shared_operators.qD)())}searchByToken(token){const requestId=this.requestService.generateRequestId(),href$=this.getTokenSearchEndpoint(token).pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)));return href$.subscribe(href=>{const request=new request_models.IP(requestId,href);Object.assign(request,{getResponseParser:()=>RegistrationResponseParsingService}),this.requestService.send(request,!0)}),this.rdbService.buildSingle(href$).pipe((0,operators.Tj)(rd=>rd.hasSucceeded&&(0,empty_util.a4)(rd.payload)?Object.assign(rd,{payload:Object.assign(rd.payload,{token})}):rd))}static#_=this.\u0275fac=function(t){return new(t||EpersonRegistrationService2)(core.KVO(request_service.B),core.KVO(remote_data_build_service.o),core.KVO(hal_endpoint_service.Y))};static#_2=this.\u0275prov=core.jDH({token:EpersonRegistrationService2,factory:EpersonRegistrationService2.\u0275fac,providedIn:"root"})}return EpersonRegistrationService2})()},71012:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>ResolvedAction});const ResolverActionTypes={RESOLVED:(0,__webpack_require__(38299).N)("dspace/resolver/RESOLVED")};class ResolvedAction{constructor(url,dso){this.type=ResolverActionTypes.RESOLVED,this.payload={url,dso}}}},59081:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RegisterEmailFormComponent:()=>RegisterEmailFormComponent,TYPE_REQUEST_FORGOT:()=>TYPE_REQUEST_FORGOT,TYPE_REQUEST_REGISTER:()=>TYPE_REQUEST_REGISTER});var common=__webpack_require__(84739),fesm2022_forms=__webpack_require__(28955),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),configuration_data_service=__webpack_require__(44994),eperson_registration_service=__webpack_require__(2195),empty_util=__webpack_require__(77028),cookie_service=__webpack_require__(52161),window_service=__webpack_require__(25955),shared_operators=__webpack_require__(82656),core=__webpack_require__(68014);let GoogleRecaptchaService=(()=>{class GoogleRecaptchaService2{captchaKey(){return this.captchaKeySubject$.asObservable()}captchaMode(){return this.captchaModeSubject$.asObservable()}captchaVersion(){return this.captchaVersionSubject$.asObservable()}constructor(cookieService,_document,_window,rendererFactory,configService){this.cookieService=cookieService,this._document=_document,this._window=_window,this.configService=configService,this.captchaVersionSubject$=new cjs.BehaviorSubject(null),this.captchaKeySubject$=new cjs.BehaviorSubject(null),this.captchaModeSubject$=new cjs.BehaviorSubject(null),this.refreshCaptchaScript=()=>{this.loadRecaptchaProperties().subscribe()},this._window.nativeWindow&&(this._window.nativeWindow.refreshCaptchaScript=this.refreshCaptchaScript),this.renderer=rendererFactory.createRenderer(null,null),this.configService.findByPropertyName("registration.verification.enabled").pipe((0,operators.s)(1),(0,shared_operators.qD)(),(0,operators.Tj)(res=>res.hasSucceeded&&res.payload&&(0,empty_util.hj)(res.payload.values)&&"true"===res.payload.values[0].toLowerCase())).pipe((0,operators.nx)(registrationVerification=>registrationVerification?this.loadRecaptchaProperties():cjs.EMPTY)).subscribe()}loadRecaptchaProperties(){const recaptchaKeyRD$=this.configService.findByPropertyName("google.recaptcha.key.site").pipe((0,shared_operators.qD)()),recaptchaVersionRD$=this.configService.findByPropertyName("google.recaptcha.version").pipe((0,shared_operators.qD)()),recaptchaModeRD$=this.configService.findByPropertyName("google.recaptcha.mode").pipe((0,shared_operators.qD)());return(0,cjs.combineLatest)([recaptchaVersionRD$,recaptchaModeRD$,recaptchaKeyRD$]).pipe((0,operators.Mi)(([recaptchaVersionRD,recaptchaModeRD,recaptchaKeyRD])=>{if(this.cookieService.get("klaro-anonymous")&&this.cookieService.get("klaro-anonymous")["google-recaptcha"]&&recaptchaKeyRD.hasSucceeded&&recaptchaVersionRD.hasSucceeded&&(0,empty_util.hj)(recaptchaVersionRD.payload?.values)&&(0,empty_util.hj)(recaptchaKeyRD.payload?.values)){const key=recaptchaKeyRD.payload?.values[0],version=recaptchaVersionRD.payload?.values[0];let captchaUrl;switch(this.captchaKeySubject$.next(key),this.captchaVersionSubject$.next(version),version){case"v3":recaptchaKeyRD.hasSucceeded&&(0,empty_util.hj)(recaptchaKeyRD.payload?.values)&&(captchaUrl=this.buildCaptchaUrl(key),this.captchaModeSubject$.next("invisible"));break;case"v2":recaptchaModeRD.hasSucceeded&&(0,empty_util.hj)(recaptchaModeRD.payload?.values)&&(captchaUrl=this.buildCaptchaUrl(),this.captchaModeSubject$.next(recaptchaModeRD.payload?.values[0]))}captchaUrl&&this.loadScript(captchaUrl)}}))}getRecaptchaToken(action){return this.captchaKey().pipe((0,operators.nx)(key=>grecaptcha.execute(key,{action})))}executeRecaptcha(){return(0,cjs.of)(grecaptcha.execute())}getRecaptchaTokenResponse(){return grecaptcha.getResponse()}buildCaptchaUrl(key){const apiUrl="https://www.google.com/recaptcha/api.js";return key?`${apiUrl}?render=${key}`:apiUrl}loadScript(url){return new Promise((resolve,reject)=>{const script=this.renderer.createElement("script");script.type="text/javascript",script.src=url,script.text="",script.onload=resolve,script.onerror=reject,this.renderer.appendChild(this._document.head,script)})}static#_=this.\u0275fac=function(t){return new(t||GoogleRecaptchaService2)(core.KVO(cookie_service.O),core.KVO(common.qQ),core.KVO(window_service.lc),core.KVO(core._9s),core.KVO(configuration_data_service.ConfigurationDataService))};static#_2=this.\u0275prov=core.jDH({token:GoogleRecaptchaService2,factory:GoogleRecaptchaService2.\u0275fac,providedIn:"root"})}return GoogleRecaptchaService2})();var alert_component=__webpack_require__(14467),alert_type=__webpack_require__(82555),google_recaptcha_component=__webpack_require__(49579),notifications_service=__webpack_require__(10117),router=__webpack_require__(64247),klaro_service=__webpack_require__(72069);const _c0=a0=>({domains:a0});function RegisterEmailFormComponent_p_7_Template(rf,ctx){if(1&rf&&(core.j41(0,"p"),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Lme(" ",core.bMT(2,2,ctx_r0.MESSAGE_PREFIX+".info.maildomain")," ",ctx_r0.validMailDomains.join(", ")," ")}}function RegisterEmailFormComponent_div_16_span_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"span"),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const ctx_r0=core.XpG(2);core.R7$(),core.SpI(" ",core.bMT(2,1,ctx_r0.MESSAGE_PREFIX+".email.error.required")," ")}}function RegisterEmailFormComponent_div_16_span_2_ng_container_3_Template(rf,ctx){if(1&rf&&(core.qex(0),core.EFF(1),core.nI1(2,"translate"),core.bVm()),2&rf){const ctx_r0=core.XpG(3);core.R7$(),core.SpI(" ",core.i5U(2,1,ctx_r0.MESSAGE_PREFIX+".email.error.not-valid-domain",core.eq3(4,_c0,ctx_r0.validMailDomains.join(", ")))," ")}}function RegisterEmailFormComponent_div_16_span_2_Template(rf,ctx){if(1&rf&&(core.j41(0,"span"),core.EFF(1),core.nI1(2,"translate"),core.DNE(3,RegisterEmailFormComponent_div_16_span_2_ng_container_3_Template,3,6,"ng-container",2),core.k0s()),2&rf){const ctx_r0=core.XpG(2);core.R7$(),core.SpI(" ",core.bMT(2,2,ctx_r0.MESSAGE_PREFIX+".email.error.not-email-form")," "),core.R7$(2),core.Y8G("ngIf",ctx_r0.validMailDomains.length>0)}}function RegisterEmailFormComponent_div_16_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",13),core.DNE(1,RegisterEmailFormComponent_div_16_span_1_Template,3,3,"span",2)(2,RegisterEmailFormComponent_div_16_span_2_Template,4,4,"span",2),core.k0s()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("ngIf",ctx_r0.email.errors&&ctx_r0.email.errors.required),core.R7$(),core.Y8G("ngIf",ctx_r0.email.errors&&(ctx_r0.email.errors.pattern&&ctx_r0.typeRequest===ctx_r0.TYPE_REQUEST_REGISTER||ctx_r0.email.errors.email))}}function RegisterEmailFormComponent_ds_alert_20_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"ds-alert",14),core.nrm(1,"p",15),core.nI1(2,"translate"),core.j41(3,"p",16)(4,"a",17),core.bIt("click",function(){core.eBV(_r2);const ctx_r0=core.XpG();return core.Njj(ctx_r0.klaroService.showSettings())}),core.EFF(5),core.nI1(6,"translate"),core.k0s()()()}if(2&rf){const ctx_r0=core.XpG();core.Y8G("type",ctx_r0.AlertTypeEnum.Warning),core.R7$(),core.Y8G("innerHTML",core.bMT(2,3,ctx_r0.MESSAGE_PREFIX+".google-recaptcha.must-accept-cookies"),core.npT),core.R7$(4),core.JRh(core.bMT(6,5,ctx_r0.MESSAGE_PREFIX+".google-recaptcha.open-cookie-settings"))}}function RegisterEmailFormComponent_div_21_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"div",18)(1,"ds-google-recaptcha",19),core.nI1(2,"async"),core.bIt("executeRecaptcha",function($event){core.eBV(_r3);const ctx_r0=core.XpG();return core.Njj(ctx_r0.register($event))})("checkboxChecked",function($event){core.eBV(_r3);const ctx_r0=core.XpG();return core.Njj(ctx_r0.onCheckboxChecked($event))})("showNotification",function($event){core.eBV(_r3);const ctx_r0=core.XpG();return core.Njj(ctx_r0.showNotification($event))}),core.k0s()()}if(2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("captchaMode",core.bMT(2,1,ctx_r0.googleRecaptchaService.captchaMode()))}}function RegisterEmailFormComponent_ng_container_23_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.qex(0),core.j41(1,"button",20),core.bIt("click",function(){core.eBV(_r4);const ctx_r0=core.XpG();return core.Njj(ctx_r0.register())}),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.bVm()}if(2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("disabled",ctx_r0.form.invalid||ctx_r0.registrationVerification&&!ctx_r0.isRecaptchaCookieAccepted()||ctx_r0.disableUntilChecked),core.R7$(),core.SpI(" ",core.bMT(3,2,ctx_r0.MESSAGE_PREFIX+".submit")," ")}}function RegisterEmailFormComponent_ng_template_26_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"button",20),core.bIt("click",function(){core.eBV(_r5);const ctx_r0=core.XpG();return core.Njj(ctx_r0.executeRecaptcha())}),core.EFF(1),core.nI1(2,"translate"),core.k0s()}if(2&rf){const ctx_r0=core.XpG();core.Y8G("disabled",ctx_r0.form.invalid),core.R7$(),core.SpI(" ",core.bMT(2,2,ctx_r0.MESSAGE_PREFIX+".submit")," ")}}const TYPE_REQUEST_FORGOT="forgot",TYPE_REQUEST_REGISTER="register";let RegisterEmailFormComponent=(()=>{class RegisterEmailFormComponent2{captchaVersion(){return this.googleRecaptchaService.captchaVersion()}captchaMode(){return this.googleRecaptchaService.captchaMode()}constructor(epersonRegistrationService,notificationService,translateService,router2,formBuilder,configService,googleRecaptchaService,cookieService,klaroService,changeDetectorRef,notificationsService){this.epersonRegistrationService=epersonRegistrationService,this.notificationService=notificationService,this.translateService=translateService,this.router=router2,this.formBuilder=formBuilder,this.configService=configService,this.googleRecaptchaService=googleRecaptchaService,this.cookieService=cookieService,this.klaroService=klaroService,this.changeDetectorRef=changeDetectorRef,this.notificationsService=notificationsService,this.typeRequest=null,this.AlertTypeEnum=alert_type.v,this.registrationVerification=!1,this.checkboxCheckedSubject$=new cjs.BehaviorSubject(!1),this.disableUntilChecked=!0,this.TYPE_REQUEST_REGISTER=TYPE_REQUEST_REGISTER,this.subscriptions=[]}ngOnDestroy(){this.subscriptions.forEach(sub=>sub.unsubscribe())}ngOnInit(){const validators=[fesm2022_forms.k0.required,fesm2022_forms.k0.email,fesm2022_forms.k0.pattern("^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$")];this.form=this.formBuilder.group({email:new fesm2022_forms.hs("",{validators})}),this.validMailDomains=[],this.typeRequest===TYPE_REQUEST_REGISTER&&this.subscriptions.push(this.configService.findByPropertyName("authentication-password.domain.valid").pipe((0,shared_operators.Hz)()).subscribe(remoteData=>{this.validMailDomains=remoteData.values;for(const remoteValue of remoteData.values)0!==this.validMailDomains.length&&(this.form.get("email").setValidators([...validators,fesm2022_forms.k0.pattern(this.validMailDomains.map(domain=>"(^.*"+domain.replace(new RegExp("\\.","g"),"\\.")+"$)").join("|"))]),this.form.updateValueAndValidity());this.changeDetectorRef.detectChanges()})),this.subscriptions.push(this.configService.findByPropertyName("registration.verification.enabled").pipe((0,shared_operators.ak)(),(0,operators.Tj)(res=>"true"===res?.values[0].toLowerCase())).subscribe(res=>{this.registrationVerification=res})),this.subscriptions.push(this.disableUntilCheckedFcn().subscribe(res=>{this.disableUntilChecked=res,this.changeDetectorRef.detectChanges()}))}executeRecaptcha(){this.googleRecaptchaService.executeRecaptcha()}register(tokenV2){this.form.invalid||(this.registrationVerification?this.subscriptions.push((0,cjs.combineLatest)([this.captchaVersion(),this.captchaMode()]).pipe((0,cjs.switchMap)(([captchaVersion,captchaMode])=>"v3"===captchaVersion?this.googleRecaptchaService.getRecaptchaToken("register_email"):"v2"===captchaVersion&&"checkbox"===captchaMode?(0,cjs.of)(this.googleRecaptchaService.getRecaptchaTokenResponse()):"v2"===captchaVersion&&"invisible"===captchaMode?(0,cjs.of)(tokenV2):(console.error(`Invalid reCaptcha configuration: version = ${captchaVersion}, mode = ${captchaMode}`),void this.showNotification("error"))),(0,operators.s)(1)).subscribe(token=>{(0,empty_util.hj)(token)?this.registration(token):(console.error("reCaptcha error"),this.showNotification("error"))})):this.registration())}registration(captchaToken=null){const registerEmail$=this.epersonRegistrationService.registerEmail(this.email.value,captchaToken||null,this.typeRequest);this.subscriptions.push(registerEmail$.subscribe(response=>{response.hasSucceeded?(this.notificationService.success(this.translateService.get(`${this.MESSAGE_PREFIX}.success.head`),this.translateService.get(`${this.MESSAGE_PREFIX}.success.content`,{email:this.email.value})),this.router.navigate(["/home"])):this.notificationService.error(this.translateService.get(`${this.MESSAGE_PREFIX}.error.head`),422===response.statusCode?this.translateService.get(`${this.MESSAGE_PREFIX}.error.maildomain`,{domains:this.validMailDomains.join(", ")}):this.translateService.get(`${this.MESSAGE_PREFIX}.error.content`,{email:this.email.value}))}))}isRecaptchaCookieAccepted(){const klaroAnonymousCookie=this.cookieService.get("klaro-anonymous");return!!(0,empty_util.hj)(klaroAnonymousCookie)&&klaroAnonymousCookie["google-recaptcha"]}disableUntilCheckedFcn(){const checked$=this.checkboxCheckedSubject$.asObservable();return(0,cjs.combineLatest)([this.captchaVersion(),this.captchaMode(),checked$]).pipe((0,cjs.switchMap)(([captchaVersion,captchaMode,checked])=>(0,cjs.of)("v2"===captchaVersion&&"checkbox"===captchaMode&&!checked)),(0,operators.ql)(!0))}get email(){return this.form.get("email")}onCheckboxChecked(checked){this.checkboxCheckedSubject$.next(checked)}showNotification(key){const notificationTitle=this.translateService.get(this.MESSAGE_PREFIX+".google-recaptcha.notification.title"),notificationErrorMsg=this.translateService.get(this.MESSAGE_PREFIX+".google-recaptcha.notification.message.error"),notificationExpiredMsg=this.translateService.get(this.MESSAGE_PREFIX+".google-recaptcha.notification.message.expired");switch(key){case"expired":this.notificationsService.warning(notificationTitle,notificationExpiredMsg);break;case"error":this.notificationsService.error(notificationTitle,notificationErrorMsg);break;default:console.warn(`Unimplemented notification '${key}' from reCaptcha service`)}}static#_=this.\u0275fac=function(t){return new(t||RegisterEmailFormComponent2)(core.rXU(eperson_registration_service.f),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.Ix),core.rXU(fesm2022_forms.ze),core.rXU(configuration_data_service.ConfigurationDataService),core.rXU(GoogleRecaptchaService),core.rXU(cookie_service.O),core.rXU(klaro_service.$,8),core.rXU(core.gRc),core.rXU(notifications_service.I))};static#_2=this.\u0275cmp=core.VBU({type:RegisterEmailFormComponent2,selectors:[["ds-base-register-email-form"]],inputs:{MESSAGE_PREFIX:"MESSAGE_PREFIX",typeRequest:"typeRequest"},standalone:!0,features:[core.aNF],decls:28,vars:28,consts:[["v2Invisible",""],[1,"container"],[4,"ngIf"],[3,"formGroup"],[1,"form-group"],[1,"row"],[1,"col-12"],["for","email",1,"font-weight-bold"],["type","text","id","email","formControlName","email",3,"className"],["class","invalid-feedback show-feedback",4,"ngIf"],[3,"type",4,"ngIf"],["class","my-3",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"invalid-feedback","show-feedback"],[3,"type"],[1,"m-0",3,"innerHTML"],[1,"m-0"],["href","javascript:void(0);",3,"click"],[1,"my-3"],[3,"executeRecaptcha","checkboxChecked","showNotification","captchaMode"],[1,"btn","btn-primary",3,"click","disabled"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",1)(1,"h1"),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"p"),core.EFF(5),core.nI1(6,"translate"),core.k0s(),core.DNE(7,RegisterEmailFormComponent_p_7_Template,3,4,"p",2),core.j41(8,"form",3)(9,"div",4)(10,"div",5)(11,"div",6)(12,"label",7),core.EFF(13),core.nI1(14,"translate"),core.k0s(),core.nrm(15,"input",8),core.DNE(16,RegisterEmailFormComponent_div_16_Template,3,2,"div",9),core.k0s(),core.j41(17,"div",6),core.EFF(18),core.nI1(19,"translate"),core.k0s()()(),core.DNE(20,RegisterEmailFormComponent_ds_alert_20_Template,7,7,"ds-alert",10)(21,RegisterEmailFormComponent_div_21_Template,3,3,"div",11),core.nI1(22,"async"),core.DNE(23,RegisterEmailFormComponent_ng_container_23_Template,4,4,"ng-container",12),core.nI1(24,"async"),core.nI1(25,"async"),core.DNE(26,RegisterEmailFormComponent_ng_template_26_Template,3,4,"ng-template",null,0,core.C5r),core.k0s()()),2&rf){const v2Invisible_r6=core.sdS(27);core.R7$(2),core.JRh(core.bMT(3,14,ctx.MESSAGE_PREFIX+".header")),core.R7$(3),core.JRh(core.bMT(6,16,ctx.MESSAGE_PREFIX+".info")),core.R7$(2),core.Y8G("ngIf",0!==ctx.validMailDomains.length&&ctx.typeRequest===ctx.TYPE_REQUEST_REGISTER),core.R7$(),core.HbH("ng-invalid"),core.Y8G("formGroup",ctx.form),core.R7$(5),core.JRh(core.bMT(14,18,ctx.MESSAGE_PREFIX+".email")),core.R7$(2),core.Y8G("className",ctx.email.invalid&&(ctx.email.dirty||ctx.email.touched)?"form-control is-invalid":"form-control"),core.R7$(),core.Y8G("ngIf",ctx.email.invalid&&(ctx.email.dirty||ctx.email.touched)),core.R7$(2),core.SpI(" ",core.bMT(19,20,ctx.MESSAGE_PREFIX+".email.hint")," "),core.R7$(2),core.Y8G("ngIf",ctx.registrationVerification&&!ctx.isRecaptchaCookieAccepted()),core.R7$(),core.Y8G("ngIf",ctx.isRecaptchaCookieAccepted()&&"v2"===core.bMT(22,22,ctx.googleRecaptchaService.captchaVersion())),core.R7$(2),core.Y8G("ngIf",!ctx.registrationVerification||"v2"!==core.bMT(24,24,ctx.googleRecaptchaService.captchaVersion())&&"invisible"===core.bMT(25,26,ctx.googleRecaptchaService.captchaMode()))("ngIfElse",v2Invisible_r6)}},dependencies:[common.bT,fesm2022_forms.YN,fesm2022_forms.qT,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.X1,fesm2022_forms.j4,fesm2022_forms.JD,alert_component.C,google_recaptcha_component.U,common.Jj,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}return RegisterEmailFormComponent2})()},61085:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>AccessControlFormContainerComponent});var common=__webpack_require__(84739),fesm2022_forms=__webpack_require__(28955),ngx_translate_core=__webpack_require__(43750),ngx_ui_switch=__webpack_require__(25702),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),bulk_access_config_data_service=__webpack_require__(47094),shared_operators=(__webpack_require__(4617),__webpack_require__(82656)),alert_component=__webpack_require__(14467),alert_type=__webpack_require__(82555),selectable_list_service=__webpack_require__(1050),ng_bootstrap=__webpack_require__(71781),date_util=__webpack_require__(7840),core=__webpack_require__(68014);let ToDatePipe=(()=>{class ToDatePipe2{transform(dateValue){if(!dateValue)return null;const date=new Date(dateValue);return{year:date.getFullYear(),month:date.getMonth()+1,day:date.getDate()}}static#_=this.\u0275fac=function(t){return new(t||ToDatePipe2)};static#_2=this.\u0275pipe=core.EJ8({name:"toDate",type:ToDatePipe2,pure:!1,standalone:!0})}return ToDatePipe2})();const _c0=["ngForm"];function AccessControlArrayFormComponent_div_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",7),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-no-access-conditions-warning-message")," "))}function AccessControlArrayFormComponent_ng_container_3_option_9_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",20),core.EFF(1),core.k0s()),2&rf){const option_r5=ctx.$implicit;core.Y8G("value",option_r5.name),core.R7$(),core.SpI(" ",option_r5.name," ")}}function AccessControlArrayFormComponent_ng_container_3_div_13_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",21)(1,"label",10),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",17)(5,"input",22,1),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r6);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.startDate,$event)||(control_r3.startDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",23)(9,"button",24),core.bIt("click",function(){core.eBV(_r6);const d_r7=core.sdS(6);return core.Njj(d_r7.toggle())}),core.k0s()()(),core.j41(10,"small",14),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolstartdate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-start-date")," "),core.R7$(3),core.Mz_("id","accesscontrolstartdate-",control_r3.id,""),core.Mz_("name","startDate-",control_r3.id,""),core.R50("ngModel",control_r3.startDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxStartDate)),core.R7$(4),core.Y8G("disabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-start-date-note")," ")}}function AccessControlArrayFormComponent_ng_container_3_div_14_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"div",21)(1,"label",10),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",17)(5,"input",22,2),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r9);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.endDate,$event)||(control_r3.endDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",23)(9,"button",24),core.bIt("click",function(){core.eBV(_r9);const d1_r10=core.sdS(6);return core.Njj(d1_r10.toggle())}),core.k0s()()(),core.j41(10,"small",14),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolenddate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-end-date")," "),core.R7$(3),core.Mz_("id","accesscontrolenddate-",control_r3.id,""),core.Mz_("name","endDate-",control_r3.id,""),core.R50("ngModel",control_r3.endDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxEndDate)),core.R7$(4),core.Y8G("disabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-end-date-note")," ")}}function AccessControlArrayFormComponent_ng_container_3_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.qex(0),core.j41(1,"div",8)(2,"div",9)(3,"div")(4,"label",10),core.EFF(5),core.nI1(6,"translate"),core.k0s(),core.j41(7,"select",11),core.mxI("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit;return core.DH7(control_r3.itemName,$event)||(control_r3.itemName=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.accessControlChanged(control_r3,$event))}),core.nrm(8,"option",12),core.DNE(9,AccessControlArrayFormComponent_ng_container_3_option_9_Template,2,2,"option",13),core.k0s(),core.j41(10,"small",14),core.EFF(11),core.nI1(12,"translate"),core.k0s()(),core.DNE(13,AccessControlArrayFormComponent_ng_container_3_div_13_Template,13,17,"div",15)(14,AccessControlArrayFormComponent_ng_container_3_div_14_Template,13,17,"div",15),core.k0s(),core.j41(15,"div")(16,"span",16),core.EFF(17,"\xa0"),core.k0s(),core.j41(18,"div",17)(19,"button",18),core.nI1(20,"translate"),core.bIt("click",function(){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.removeAccessControlItem(control_r3.id))}),core.nrm(21,"i",19),core.k0s()()()(),core.bVm()}if(2&rf){const control_r3=ctx.$implicit,ctx_r3=core.XpG(),ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("ngModelGroup","access-control-item-",control_r3.id,""),core.R7$(3),core.Mz_("for","accesscontroloption-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(6,17,"access-control-option-label")," "),core.R7$(2),core.Mz_("id","accesscontroloption-",control_r3.id,""),core.Mz_("name","itemName-",control_r3.id,""),core.Y8G("disabled",ngForm_r8.disabled),core.R50("ngModel",control_r3.itemName),core.R7$(2),core.Y8G("ngForOf",ctx_r3.dropdownOptions),core.R7$(2),core.SpI(" ",core.bMT(12,19,"access-control-option-note")," "),core.R7$(2),core.Y8G("ngIf",control_r3.hasStartDate),core.R7$(),core.Y8G("ngIf",control_r3.hasEndDate),core.R7$(5),core.Y8G("disabled",ngForm_r8.disabled||1===ctx_r3.form.accessControls.length),core.BMQ("aria-label",core.bMT(20,21,"access-control-remove"))}}let AccessControlArrayFormComponent=(()=>{class AccessControlArrayFormComponent2{constructor(){this.dropdownOptions=[],this.form={accessControls:[emptyAccessControlItem()]},this.formDisabled=!0,this.disable=()=>{this.ngForm.form.disable(),this.formDisabled=!0},this.enable=()=>{this.ngForm.form.enable(),this.formDisabled=!1}}ngOnInit(){this.disable()}get allControlsAreEmpty(){return this.form.accessControls.every(x=>null===x.itemName||""===x.itemName)}get showWarning(){return"replace"===this.mode&&this.allControlsAreEmpty&&!this.formDisabled}addAccessControlItem(itemName=null){this.form.accessControls=[...this.form.accessControls,{...emptyAccessControlItem(),itemName}]}removeAccessControlItem(id){this.form.accessControls=this.form.accessControls.filter(item=>item.id!==id)}getValue(){return this.form.accessControls.filter(x=>null!==x.itemName&&""!==x.itemName).map(x=>({name:x.itemName,startDate:x.startDate?(0,date_util.Sd)(x.startDate):null,endDate:x.endDate?(0,date_util.Sd)(x.endDate):null}))}reset(){this.form.accessControls=[],this.addAccessControlItem(),this.disable()}accessControlChanged(control,selectedItem){const item=this.dropdownOptions.find(x=>x.name===selectedItem);control.startDate=null,control.endDate=null,control.hasStartDate=item?.hasStartDate||!1,control.hasEndDate=item?.hasEndDate||!1,control.maxStartDate=item?.maxStartDate||null,control.maxEndDate=item?.maxEndDate||null}trackById(index,item){return item.id}static#_=this.\u0275fac=function(t){return new(t||AccessControlArrayFormComponent2)};static#_2=this.\u0275cmp=core.VBU({type:AccessControlArrayFormComponent2,selectors:[["ds-access-control-array-form"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(_c0,7),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.ngForm=_t.first)}},inputs:{dropdownOptions:"dropdownOptions",mode:"mode",type:"type"},exportAs:["accessControlArrayForm"],standalone:!0,features:[core.aNF],decls:8,vars:9,consts:[["ngForm","ngForm"],["d","ngbDatepicker"],["d1","ngbDatepicker"],["class","alert alert-warning",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-outline-primary","mt-3",3,"click","id","disabled"],[1,"fas","fa-plus"],[1,"alert","alert-warning"],[1,"access-control-item","mt-3",3,"ngModelGroup"],[1,"d-flex","flex-column"],[3,"for"],[1,"form-control",3,"ngModelChange","id","disabled","ngModel","name"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-text","text-muted"],["class","mt-3",4,"ngIf"],["aria-hidden","true",1,"mb-2","d-inline-block"],[1,"input-group"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-trash"],[3,"value"],[1,"mt-3"],["placeholder","yyyy-mm-dd","ngbDatepicker","","placement","top-start top-end bottom-start bottom-end",1,"form-control",3,"ngModelChange","id","ngModel","name","maxDate"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","fas","fa-calendar",3,"click","disabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"form",null,0),core.DNE(2,AccessControlArrayFormComponent_div_2_Template,3,3,"div",3)(3,AccessControlArrayFormComponent_ng_container_3_Template,22,23,"ng-container",4),core.j41(4,"button",5),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.addAccessControlItem())}),core.nrm(5,"i",6),core.EFF(6),core.nI1(7,"translate"),core.k0s()()}if(2&rf){const ngForm_r8=core.sdS(1);core.R7$(2),core.Y8G("ngIf",ctx.showWarning),core.R7$(),core.Y8G("ngForOf",ctx.form.accessControls)("ngForTrackBy",ctx.trackById),core.R7$(),core.Mz_("id","add-btn-",ctx.type,""),core.Y8G("disabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(7,7,"access-control-add-more")," ")}},dependencies:[fesm2022_forms.YN,fesm2022_forms.qT,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.me,fesm2022_forms.wz,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.vS,fesm2022_forms.Y4,fesm2022_forms.cV,common.bT,common.pM,ng_bootstrap.IQ,ng_bootstrap.cw,ngx_translate_core.h,ngx_translate_core.D9,ToDatePipe],styles:[".access-control-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 50px;grid-gap:10px;padding-bottom:15px;border-bottom:2px dotted gray}"]})}return AccessControlArrayFormComponent2})();const emptyAccessControlItem=()=>({id:randomID(),itemName:null,startDate:null,hasStartDate:!1,maxStartDate:null,endDate:null,hasEndDate:!1,maxEndDate:null}),randomID=()=>Math.floor(1e6*Math.random());var bulk_access_control_service=__webpack_require__(76415),context_model=__webpack_require__(34069),bitstream_data_service=__webpack_require__(36505),pagination_service=__webpack_require__(39304),empty_util=(__webpack_require__(6721),__webpack_require__(77028)),object_collection_component=__webpack_require__(60047),pagination_component_options_model=__webpack_require__(64694);const item_access_control_select_bitstreams_modal_component_c0=a0=>({repeatable:!0,listId:a0});function ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_ds_viewable_collection_1_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"ds-viewable-collection",10),core.bIt("pageChange",function($event){core.eBV(_r1);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.loadForPage($event))}),core.k0s()}if(2&rf){const data_r3=core.XpG().ngIf,ctx_r1=core.XpG();core.Y8G("config",ctx_r1.paginationConfig)("context",ctx_r1.context)("objects",data_r3)("selectable",!0)("selectionConfig",core.eq3(6,item_access_control_select_bitstreams_modal_component_c0,ctx_r1.LIST_ID))("showPaginator",!0)}}function ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_div_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",11),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-select-bitstreams-modal.no-items")," "))}function ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_ds_viewable_collection_1_Template,1,8,"ds-viewable-collection",8)(2,ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_div_2_Template,3,3,"div",9),core.bVm()),2&rf){const data_r3=ctx.ngIf;core.R7$(),core.Y8G("ngIf",data_r3.payload.page.length>0),core.R7$(),core.Y8G("ngIf",data_r3&&0===data_r3.payload.page.length)}}let ItemAccessControlSelectBitstreamsModalComponent=(()=>{class ItemAccessControlSelectBitstreamsModalComponent2{constructor(bitstreamService,paginationService,translateService,activeModal){this.bitstreamService=bitstreamService,this.paginationService=paginationService,this.translateService=translateService,this.activeModal=activeModal,this.LIST_ID="item-access-control-select-bitstreams",this.selectedBitstreams=[],this.data$=new cjs.BehaviorSubject(null),this.pageSize=5,this.context=context_model.o.Bitstream}ngOnInit(){this.loadForPage(1),this.paginationConfig=new pagination_component_options_model.W,this.paginationConfig.id="iacsbm",this.paginationConfig.currentPage=1,(0,empty_util.a4)(this.pageSize)&&(this.paginationConfig.pageSize=this.pageSize)}loadForPage(page){this.bitstreamService.findAllByItemAndBundleName(this.item,"ORIGINAL",{currentPage:page},!1).pipe((0,shared_operators.qD)()).subscribe(this.data$)}static#_=this.\u0275fac=function(t){return new(t||ItemAccessControlSelectBitstreamsModalComponent2)(core.rXU(bitstream_data_service.BitstreamDataService),core.rXU(pagination_service.m),core.rXU(ngx_translate_core.c$),core.rXU(ng_bootstrap.Lw))};static#_2=this.\u0275cmp=core.VBU({type:ItemAccessControlSelectBitstreamsModalComponent2,selectors:[["ds-item-access-control-select-bitstreams-modal"]],inputs:{item:"item",selectedBitstreams:"selectedBitstreams"},standalone:!0,features:[core.aNF],decls:14,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"config","context","objects","selectable","selectionConfig","showPaginator","pageChange",4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[3,"pageChange","config","context","objects","selectable","selectionConfig","showPaginator"],["role","alert",1,"alert","alert-info","w-100"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"h4",1),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",2),core.bIt("click",function(){return ctx.activeModal.dismiss("Cross click")}),core.j41(5,"span",3),core.EFF(6,"\xd7"),core.k0s()()(),core.j41(7,"div",4),core.DNE(8,ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_Template,3,2,"ng-container",5),core.nI1(9,"async"),core.k0s(),core.j41(10,"div",6)(11,"button",7),core.bIt("click",function(){return ctx.activeModal.close("Close click")}),core.EFF(12),core.nI1(13,"translate"),core.k0s()()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-select-bitstreams-modal.title")," "),core.R7$(6),core.Y8G("ngIf",core.bMT(9,5,ctx.data$)),core.R7$(4),core.SpI(" ",core.bMT(13,7,"access-control-select-bitstreams-modal.close")," "))},dependencies:[common.bT,object_collection_component.h,common.Jj,ngx_translate_core.h,ngx_translate_core.D9]})}return ItemAccessControlSelectBitstreamsModalComponent2})();const access_control_form_container_component_c0=["bitstreamAccessCmp"],_c1=["itemAccessCmp"],_c2=()=>[];function AccessControlFormContainerComponent_ds_alert_3_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-alert",29),2&rf){const ctx_r1=core.XpG();core.Y8G("type",ctx_r1.AlertType.Info)("content",ctx_r1.titleMessage)}}function AccessControlFormContainerComponent_div_43_button_15_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",37),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r4);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.openSelectBitstreamsModal(ctx_r1.itemRD.payload))}),core.nrm(2,"i",38),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus||"selected"!==ctx_r1.state.bitstream.changesLimit),core.BMQ("aria-label",core.bMT(1,2,"access-control-bitstreams-select"))}}function AccessControlFormContainerComponent_div_43_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"div",11)(1,"fieldset",30)(2,"legend",31),core.EFF(3),core.nI1(4,"translate"),core.k0s(),core.j41(5,"div",14)(6,"input",32),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(7,"label",33),core.EFF(8),core.nI1(9,"translate"),core.k0s()(),core.j41(10,"div",14)(11,"input",34),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(12,"label",35),core.EFF(13),core.nI1(14,"translate"),core.DNE(15,AccessControlFormContainerComponent_div_43_button_15_Template,3,4,"button",36),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(3),core.SpI(" ",core.bMT(4,9,"access-control-limit-to-specific")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.SpI(" ",core.bMT(9,11,"access-control-process-all-bitstreams")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.Lme(" ",ctx_r1.state.bitstream.selectedBitstreams.length," ",core.bMT(14,13,"access-control-bitstreams-selected")," "),core.R7$(2),core.Y8G("ngIf",ctx_r1.itemRD)}}function AccessControlFormContainerComponent_hr_66_Template(rf,ctx){1&rf&&core.nrm(0,"hr")}function AccessControlFormContainerComponent_div_67_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",39)(1,"button",40),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.reset())}),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",41),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-cancel")," "),core.R7$(2),core.Y8G("disabled",!ctx_r1.state.item.toggleStatus&&!ctx_r1.state.bitstream.toggleStatus),core.R7$(),core.SpI(" ",core.bMT(6,5,"access-control-execute")," ")}}let AccessControlFormContainerComponent=(()=>{class AccessControlFormContainerComponent2{constructor(bulkAccessConfigService,bulkAccessControlService,selectableListService,modalService,cdr){this.bulkAccessConfigService=bulkAccessConfigService,this.bulkAccessControlService=bulkAccessControlService,this.selectableListService=selectableListService,this.modalService=modalService,this.cdr=cdr,this.showLimitToSpecificBitstreams=!1,this.titleMessage="",this.showSubmit=!0,this.AlertType=alert_type.v,this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}},this.dropdownData$=this.bulkAccessConfigService.findByName("default").pipe((0,shared_operators.qD)(),(0,operators.Tj)(configRD=>configRD.hasSucceeded?configRD.payload:null),(0,cjs.shareReplay)({refCount:!1,bufferSize:1}))}getFormValue(){return console.log({bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}),{bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}}reset(){this.bitstreamAccessCmp.reset(),this.itemAccessCmp.reset(),this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}}}submit(){const bitstreamAccess=this.bitstreamAccessCmp.getValue(),itemAccess=this.itemAccessCmp.getValue(),{file}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess,itemAccess,state:this.state});this.bulkAccessControlService.executeScript([this.itemRD.payload.uuid],file).pipe((0,operators.s)(1)).subscribe(res=>{console.log("success",res)})}handleStatusChange(type,active){"bitstream"===type?active?this.bitstreamAccessCmp.enable():this.bitstreamAccessCmp.disable():"item"===type&&(active?this.itemAccessCmp.enable():this.itemAccessCmp.disable())}openSelectBitstreamsModal(item){const ref=this.modalService.open(ItemAccessControlSelectBitstreamsModalComponent);ref.componentInstance.selectedBitstreams=this.state.bitstream.selectedBitstreams,ref.componentInstance.item=item,ref.closed.pipe((0,cjs.concatMap)(()=>this.selectableListService.getSelectableList("item-access-control-select-bitstreams")),(0,operators.s)(1)).subscribe(list=>{this.state.bitstream.selectedBitstreams=list?.selection||[],this.cdr.detectChanges()})}ngOnDestroy(){this.selectableListService.deselectAll("item-access-control-select-bitstreams")}static#_=this.\u0275fac=function(t){return new(t||AccessControlFormContainerComponent2)(core.rXU(bulk_access_config_data_service.BulkAccessConfigDataService),core.rXU(bulk_access_control_service.r),core.rXU(selectable_list_service.K),core.rXU(ng_bootstrap.Bq),core.rXU(core.gRc))};static#_2=this.\u0275cmp=core.VBU({type:AccessControlFormContainerComponent2,selectors:[["ds-access-control-form-container"]],viewQuery:function(rf,ctx){if(1&rf&&(core.GBs(access_control_form_container_component_c0,7),core.GBs(_c1,7)),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.bitstreamAccessCmp=_t.first),core.mGM(_t=core.lsd())&&(ctx.itemAccessCmp=_t.first)}},inputs:{showLimitToSpecificBitstreams:"showLimitToSpecificBitstreams",titleMessage:"titleMessage",itemRD:"itemRD",showSubmit:"showSubmit"},exportAs:["dsAccessControlForm"],standalone:!0,features:[core.aNF],decls:68,vars:62,consts:[["itemAccessCmp",""],["bitstreamAccessCmp",""],[1,"container"],[1,"card","border-0"],[1,"card-body"],["class","d-block pb-3",3,"type","content",4,"ngIf"],[1,"row"],[1,"col-12","col-md-6","border-right","d-flex","flex-column","justify-content-between"],[1,"d-flex","align-items-center"],[1,"h3","mb-0","mr-4"],[3,"ngModelChange","ariaLabel","ngModel"],[1,"row","mt-3"],[1,"h4","col-12","col-md-3"],[1,"col-12","col-md-8"],[1,"form-check"],["type","radio","name","itemMode","id","itemReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemReplace",1,"form-check-label"],["type","radio","name","itemMode","id","itemAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemAdd",1,"form-check-label"],[1,"h4","mt-3"],[3,"type","mode","dropdownOptions"],[1,"col-12","col-md-6","d-flex","flex-column","justify-content-between"],["class","row mt-3",4,"ngIf"],["type","radio","name","bitstreamMode","id","bitstreamReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamReplace",1,"form-check-label"],["type","radio","name","bitstreamMode","id","bitstreamAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamAdd",1,"form-check-label"],[4,"ngIf"],["class","d-flex justify-content-end",4,"ngIf"],[1,"d-block","pb-3",3,"type","content"],[1,"col-12"],[1,"h4"],["type","radio","name","changesLimit","id","processAll","value","all",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","processAll",1,"form-check-label"],["type","radio","name","changesLimit","id","processSelected","value","selected",1,"form-check-input","mt-2",3,"ngModelChange","disabled","ngModel"],["for","processSelected",1,"form-check-label"],["class","btn btn-outline-dark border-0","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"btn","btn-outline-dark","border-0",3,"click","disabled"],[1,"fa","fa-search"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-primary","mr-3",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",2)(1,"div",3)(2,"div",4),core.DNE(3,AccessControlFormContainerComponent_ds_alert_3_Template,1,2,"ds-alert",5),core.j41(4,"div",6)(5,"div",7)(6,"div")(7,"div",8)(8,"h2",9),core.EFF(9),core.nI1(10,"translate"),core.k0s(),core.j41(11,"ui-switch",10),core.nI1(12,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.toggleStatus,$event)||(ctx.state.item.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("item",$event))}),core.k0s()(),core.j41(13,"fieldset",11)(14,"legend",12),core.EFF(15),core.nI1(16,"translate"),core.k0s(),core.j41(17,"div",13)(18,"div",14)(19,"input",15),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(20,"label",16),core.EFF(21),core.nI1(22,"translate"),core.k0s()(),core.j41(23,"div",14)(24,"input",17),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(25,"label",18),core.EFF(26),core.nI1(27,"translate"),core.k0s()()()()(),core.j41(28,"div")(29,"h3",19),core.EFF(30),core.nI1(31,"translate"),core.k0s(),core.nrm(32,"ds-access-control-array-form",20,0),core.nI1(34,"async"),core.k0s()(),core.j41(35,"div",21)(36,"div")(37,"div",8)(38,"h2",9),core.EFF(39),core.nI1(40,"translate"),core.k0s(),core.j41(41,"ui-switch",10),core.nI1(42,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.toggleStatus,$event)||(ctx.state.bitstream.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("bitstream",$event))}),core.k0s()(),core.DNE(43,AccessControlFormContainerComponent_div_43_Template,16,15,"div",22),core.k0s(),core.j41(44,"fieldset",11)(45,"legend",12),core.EFF(46),core.nI1(47,"translate"),core.k0s(),core.j41(48,"div",13)(49,"div",14)(50,"input",23),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(51,"label",24),core.EFF(52),core.nI1(53,"translate"),core.k0s()(),core.j41(54,"div",14)(55,"input",25),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(56,"label",26),core.EFF(57),core.nI1(58,"translate"),core.k0s()()()(),core.j41(59,"div")(60,"h3",19),core.EFF(61),core.nI1(62,"translate"),core.k0s(),core.nrm(63,"ds-access-control-array-form",20,1),core.nI1(65,"async"),core.k0s()()(),core.DNE(66,AccessControlFormContainerComponent_hr_66_Template,1,0,"hr",27)(67,AccessControlFormContainerComponent_div_67_Template,7,7,"div",28),core.k0s()()()}if(2&rf){let tmp_16_0,tmp_31_0;core.R7$(3),core.Y8G("ngIf",ctx.titleMessage),core.R7$(6),core.SpI(" ",core.bMT(10,32,"access-control-item-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(12,34,ctx.state.bitstream.toggleStatus?"access-control-item-toggle.disable":"access-control-item-toggle.enable")),core.R50("ngModel",ctx.state.item.toggleStatus),core.R7$(4),core.SpI(" ",core.bMT(16,36,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(22,38,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(27,40,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(31,42,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","item")("mode",ctx.state.item.accessMode)("dropdownOptions",(null==(tmp_16_0=core.bMT(34,44,ctx.dropdownData$))?null:tmp_16_0.itemAccessConditionOptions)||core.lJ4(60,_c2)),core.R7$(7),core.SpI(" ",core.bMT(40,46,"access-control-bitstream-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(42,48,ctx.state.bitstream.toggleStatus?"access-control-bitstream-toggle.disable":"access-control-bitstream-toggle.enable")),core.R50("ngModel",ctx.state.bitstream.toggleStatus),core.R7$(2),core.Y8G("ngIf",ctx.showLimitToSpecificBitstreams),core.R7$(3),core.SpI(" ",core.bMT(47,50,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(53,52,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(58,54,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(62,56,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","bitstream")("mode",ctx.state.bitstream.accessMode)("dropdownOptions",(null==(tmp_31_0=core.bMT(65,58,ctx.dropdownData$))?null:tmp_31_0.bitstreamAccessConditionOptions)||core.lJ4(61,_c2)),core.R7$(3),core.Y8G("ngIf",ctx.showSubmit),core.R7$(),core.Y8G("ngIf",ctx.showSubmit)}},dependencies:[common.bT,alert_component.C,ngx_ui_switch.z,fesm2022_forms.me,fesm2022_forms.Fm,fesm2022_forms.BC,fesm2022_forms.vS,ngx_ui_switch.S,fesm2022_forms.YN,AccessControlArrayFormComponent,common.Jj,ngx_translate_core.h,ngx_translate_core.D9]})}return AccessControlFormContainerComponent2})()},76415:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{r:()=>BulkAccessControlService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10743),_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54257),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(82656),_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(33549),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(77028),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10117),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(64247),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(43750);let BulkAccessControlService=(()=>{class BulkAccessControlService2{constructor(notificationsService,router,scriptService,translationService){this.notificationsService=notificationsService,this.router=router,this.scriptService=scriptService,this.translationService=translationService}createPayloadFile(payload){const content=convertToBulkAccessControlFileModel(payload),blob=new Blob([JSON.stringify(content,null,2)],{type:"application/json"}),file=new File([blob],"data.json",{type:"application/json"});return{url:URL.createObjectURL(file),file}}executeScript(uuids,file){console.log("execute",{uuids,file});const params=[{name:"-f",value:file.name}];return uuids.forEach(uuid=>{params.push({name:"-u",value:uuid})}),this.scriptService.invoke("bulk-access-control",params,[file]).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Tj)(rd=>{if(rd.hasSucceeded){const title=this.translationService.get("process.new.notification.success.title"),content=this.translationService.get("process.new.notification.success.content");return this.notificationsService.success(title,content),(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.hj)(rd.payload)&&this.router.navigateByUrl((0,_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__.yJ)(rd.payload.processId)),!0}{const title=this.translationService.get("process.new.notification.error.title"),content=this.translationService.get("process.new.notification.error.content");return this.notificationsService.error(title,content),!1}}))}static#_=this.\u0275fac=function(t){return new(t||BulkAccessControlService2)(_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__.I),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_angular_router__WEBPACK_IMPORTED_MODULE_7__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__.ScriptDataService),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__.c$))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_6__.jDH({token:BulkAccessControlService2,factory:BulkAccessControlService2.\u0275fac,providedIn:"root"})}return BulkAccessControlService2})();const convertToBulkAccessControlFileModel=payload=>{const finalPayload={},bitstreamEnabled=payload.state.bitstream.toggleStatus;if(payload.state.item.toggleStatus&&(finalPayload.item={mode:payload.state.item.accessMode,accessConditions:payload.itemAccess}),bitstreamEnabled){const constraints={uuid:[]};bitstreamEnabled&&"selected"===payload.state.bitstream.changesLimit&&(constraints.uuid=payload.state.bitstream.selectedBitstreams.map(x=>x.id)),finalPayload.bitstream={constraints,mode:payload.state.bitstream.accessMode,accessConditions:payload.bitstreamAccess}}return finalPayload}},49579:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U:()=>GoogleRecaptchaComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(84739),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68014),src_app_core_services_window_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25955),_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(44994),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(82656),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(77028);let GoogleRecaptchaComponent=(()=>{class GoogleRecaptchaComponent2{constructor(_window,configService){this._window=_window,this.configService=configService,this.executeRecaptcha=new _angular_core__WEBPACK_IMPORTED_MODULE_3__.bkB,this.checkboxChecked=new _angular_core__WEBPACK_IMPORTED_MODULE_3__.bkB,this.showNotification=new _angular_core__WEBPACK_IMPORTED_MODULE_3__.bkB,this.dataCallbackFcn=$event=>{switch(this.captchaMode){case"invisible":this.executeRecaptcha.emit($event);break;case"checkbox":this.checkboxChecked.emit((0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.hj)($event));break;default:console.error(`Invalid reCaptcha mode '${this.captchaMode}`),this.showNotification.emit("error")}},this.expiredCallbackFcn=()=>{this.checkboxChecked.emit(!1),this.showNotification.emit("expired")},this.errorCallbackFcn=()=>{this.showNotification.emit("error")}}ngOnInit(){this.recaptchaKey$=this.configService.findByPropertyName("google.recaptcha.key.site").pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.ak)()),this._window.nativeWindow.dataCallback=this.dataCallbackFcn,this._window.nativeWindow.expiredCallback=this.expiredCallbackFcn,this._window.nativeWindow.errorCallback=this.errorCallbackFcn}static#_=this.\u0275fac=function(t){return new(t||GoogleRecaptchaComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_3__.rXU(src_app_core_services_window_service__WEBPACK_IMPORTED_MODULE_0__.lc),_angular_core__WEBPACK_IMPORTED_MODULE_3__.rXU(_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_1__.ConfigurationDataService))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_3__.VBU({type:GoogleRecaptchaComponent2,selectors:[["ds-google-recaptcha"]],inputs:{captchaMode:"captchaMode"},outputs:{executeRecaptcha:"executeRecaptcha",checkboxChecked:"checkboxChecked",showNotification:"showNotification"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_3__.aNF],decls:2,vars:7,consts:[[1,"g-recaptcha"]],template:function(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_3__.nrm(0,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_3__.nI1(1,"async")),2&rf){let tmp_3_0;_angular_core__WEBPACK_IMPORTED_MODULE_3__.BMQ("data-callback","dataCallback")("data-expired-callback","expiredCallback")("data-error-callback","errorCallback")("data-sitekey",null==(tmp_3_0=_angular_core__WEBPACK_IMPORTED_MODULE_3__.bMT(1,5,ctx.recaptchaKey$))?null:tmp_3_0.values[0])("data-size","invisible"===ctx.captchaMode?"invisible":null)}},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_5__.Jj]})}return GoogleRecaptchaComponent2})()},89705:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HasNoValuePipe});var _empty_util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(77028),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68014);let HasNoValuePipe=(()=>{class HasNoValuePipe2{transform(value){return(0,_empty_util__WEBPACK_IMPORTED_MODULE_0__.Tn)(value)}static#_=this.\u0275fac=function(t){return new(t||HasNoValuePipe2)};static#_2=this.\u0275pipe=_angular_core__WEBPACK_IMPORTED_MODULE_1__.EJ8({name:"dsHasNoValue",type:HasNoValuePipe2,pure:!0,standalone:!0})}return HasNoValuePipe2})()},25702:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>UiSwitchComponent,z:()=>UiSwitchModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68014),_angular_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(28955),_angular_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(84739);const _c0=["*"];function UiSwitchComponent_label_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"label",2)(1,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(3,"span",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("checkedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("uncheckedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.uncheckedLabel)}}const UI_SWITCH_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.nKC("UI_SWITCH_OPTIONS"),UI_SWITCH_CONTROL_VALUE_ACCESSOR={provide:_angular_forms__WEBPACK_IMPORTED_MODULE_1__.kq,useExisting:(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.Rfq)(()=>UiSwitchComponent),multi:!0};let UiSwitchComponent=(()=>{class UiSwitchComponent2{constructor(config={},cdr){this.cdr=cdr,this.change=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB,this.changeEvent=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB,this.valueChange=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB,this.onTouchedCallback=v=>{},this.onChangeCallback=v=>{},this.size=config&&config.size||"medium",this.color=config&&config.color,this.switchOffColor=config&&config.switchOffColor,this.switchColor=config&&config.switchColor,this.defaultBgColor=config&&config.defaultBgColor,this.defaultBoColor=config&&config.defaultBoColor,this.checkedLabel=config&&config.checkedLabel,this.uncheckedLabel=config&&config.uncheckedLabel,this.checkedTextColor=config&&config.checkedTextColor,this.uncheckedTextColor=config&&config.uncheckedTextColor}set checked(v){this._checked=!1!==v}get checked(){return this._checked}set disabled(v){this._disabled=!1!==v}get disabled(){return this._disabled}set reverse(v){this._reverse=!1!==v}get reverse(){return this._reverse}set loading(v){this._loading=!1!==v}get loading(){return this._loading}getColor(flag=""){return"borderColor"===flag?this.defaultBoColor:"switchColor"===flag?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===flag?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===flag?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(event){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(event),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(event){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(confirm=>{confirm&&this.onClick(event)}):this.onClick(event))}writeValue(obj){obj!==this.checked&&(this.checked=!!obj),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(fn){this.onChangeCallback=fn}registerOnTouched(fn){this.onTouchedCallback=fn}setDisabledState(isDisabled){this.disabled=isDisabled}ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}}return UiSwitchComponent2.\u0275fac=function(t){return new(t||UiSwitchComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(UI_SWITCH_OPTIONS,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_0__.gRc))},UiSwitchComponent2.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:UiSwitchComponent2,selectors:[["ui-switch"]],hostBindings:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__.bIt("click",function($event){return ctx.onToggle($event)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.Jv_([UI_SWITCH_CONTROL_VALUE_ACCESSOR])],ngContentSelectors:_c0,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.NAR(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"button",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.DNE(1,UiSwitchComponent_label_1_Template,5,8,"label",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(2,"small"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SdG(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background-color",ctx.getColor())("border-color",ctx.getColor("borderColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.AVh("checked",ctx.checked)("disabled",ctx.disabled)("loading",ctx.loading)("switch-large","large"===ctx.size)("switch-medium","medium"===ctx.size)("switch-small","small"===ctx.size),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-checked",ctx.checked)("aria-label",ctx.ariaLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngIf",ctx.checkedLabel||ctx.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background",ctx.getColor("switchColor")))},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.bT],encapsulation:2}),UiSwitchComponent2})(),UiSwitchModule=(()=>{class UiSwitchModule2{static forRoot(config){return{ngModule:UiSwitchModule2,providers:[{provide:UI_SWITCH_OPTIONS,useValue:config||{}}]}}}return UiSwitchModule2.\u0275fac=function(t){return new(t||UiSwitchModule2)},UiSwitchModule2.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.$C({type:UiSwitchModule2}),UiSwitchModule2.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.G2t({imports:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.MD,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN]}),UiSwitchModule2})()}};