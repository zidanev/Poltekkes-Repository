"use strict";exports.id=8972,exports.ids=[8972,8870,1555,148,7231,1870],exports.modules={34168:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>browseByGuard});var _angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(64247),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(43750),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(10743),_app_routing_paths__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(45930),_core_browse_browse_definition_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(85722),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(82656),_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(77028);const browseByGuard=(route,state,browseDefinitionService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_core_browse_browse_definition_data_service__WEBPACK_IMPORTED_MODULE_1__.BrowseDefinitionDataService),router=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_angular_router__WEBPACK_IMPORTED_MODULE_4__.Ix),translate=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_5__.c$))=>{const title=route.data.title,id=route.params.id||route.queryParams.id||route.data.id;let browseDefinition$;browseDefinition$=(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.Tn)(route.data.browseDefinition)&&(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(id)?browseDefinitionService.findById(id).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Tj)(browseDefinitionRD=>browseDefinitionRD.payload)):(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.of)(route.data.browseDefinition);const scope=route.queryParams.scope??route.parent?.params.id,value=route.queryParams.value,metadataTranslated=translate.instant(`browse.metadata.${id}`);return browseDefinition$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.nx)(browseDefinition=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(browseDefinition)?(route.data=function createData(title,id,browseDefinition,field,value,route,scope){return Object.assign({},route.data,{title,id,browseDefinition,field,value:(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(value)?`"${value}"`:"",scope})}(title,id,browseDefinition,metadataTranslated,value,route,scope),(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.of)(!0)):(router.navigate([_app_routing_paths__WEBPACK_IMPORTED_MODULE_0__.RD]),(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.of)(!1))))}},45647:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>browseByI18nBreadcrumbResolver});var _core_breadcrumbs_i18n_breadcrumb_resolver__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21870);const browseByI18nBreadcrumbResolver=(route,state)=>(route.data=Object.assign({},route.data,{breadcrumbKey:route.data.breadcrumbKey+"."+route.params.id}),(0,_core_breadcrumbs_i18n_breadcrumb_resolver__WEBPACK_IMPORTED_MODULE_0__.S)(route,state))},78972:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES});var dso_edit_menu_resolver=__webpack_require__(34615),core=__webpack_require__(68014),operators=__webpack_require__(10743),app_routing_paths=__webpack_require__(45930),dso_breadcrumbs_service=__webpack_require__(15446),dspace_object_data_service=__webpack_require__(78358),shared_operators=__webpack_require__(82656),empty_util=__webpack_require__(77028),browse_by_guard=__webpack_require__(34168),browse_by_i18n_breadcrumb_resolver=__webpack_require__(45647),common=__webpack_require__(84739),browse_by_switcher_component=__webpack_require__(4456),router=__webpack_require__(64247);const ROUTES=[{path:"",resolve:{breadcrumb:(route,state,breadcrumbService=(0,core.WQX)(dso_breadcrumbs_service.U),dataService=(0,core.WQX)(dspace_object_data_service.DSpaceObjectDataService))=>{const uuid=route.queryParams.scope;if((0,empty_util.a4)(uuid))return dataService.findById(uuid).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.Tj)(object=>({provider:breadcrumbService,key:object,url:(0,app_routing_paths.wN)(object)})))},menu:dso_edit_menu_resolver.c},children:[{path:":id",component:(()=>{class BrowseByPageComponent2{constructor(route){this.route=route}ngOnInit(){this.browseByType$=this.route.data.pipe((0,operators.Tj)(data=>data.browseDefinition.getRenderType()))}static#_=this.\u0275fac=function(t){return new(t||BrowseByPageComponent2)(core.rXU(router.nX))};static#_2=this.\u0275cmp=core.VBU({type:BrowseByPageComponent2,selectors:[["ds-browse-by-page"]],standalone:!0,features:[core.aNF],decls:3,vars:3,consts:[[1,"container"],[3,"browseByType"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0),core.nrm(1,"ds-browse-by-switcher",1),core.nI1(2,"async"),core.k0s()),2&rf&&(core.R7$(),core.Y8G("browseByType",core.bMT(2,1,ctx.browseByType$)))},dependencies:[browse_by_switcher_component.e,common.Jj]})}return BrowseByPageComponent2})(),canActivate:[browse_by_guard.h],resolve:{breadcrumb:browse_by_i18n_breadcrumb_resolver.p},data:{title:"browse.title.page",breadcrumbKey:"browse.metadata"}}]}]},4456:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{e:()=>BrowseBySwitcherComponent}),__webpack_require__(34069);var _shared_abstract_component_loader_abstract_component_loader_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4027),_shared_abstract_component_loader_dynamic_component_loader_directive__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(21962),_browse_by_decorator__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(89139),__webpack_require__(42513)),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68014);function BrowseBySwitcherComponent_ng_template_0_Template(rf,ctx){}let BrowseBySwitcherComponent=(()=>{class BrowseBySwitcherComponent2 extends _shared_abstract_component_loader_abstract_component_loader_component__WEBPACK_IMPORTED_MODULE_1__.e{constructor(){super(...arguments),this.inputNamesDependentForComponent=["context","browseByType"],this.inputNames=["context","browseByType","displayTitle","scope"]}getComponent(){return(0,_browse_by_decorator__WEBPACK_IMPORTED_MODULE_3__.cv)(this.browseByType,this.context,this.themeService.getThemeName())}static#_=this.\u0275fac=(()=>{let \u0275BrowseBySwitcherComponent_BaseFactory;return function(t){return(\u0275BrowseBySwitcherComponent_BaseFactory||(\u0275BrowseBySwitcherComponent_BaseFactory=_angular_core__WEBPACK_IMPORTED_MODULE_4__.xGo(BrowseBySwitcherComponent2)))(t||BrowseBySwitcherComponent2)}})();static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_4__.VBU({type:BrowseBySwitcherComponent2,selectors:[["ds-browse-by-switcher"]],inputs:{context:"context",browseByType:"browseByType",displayTitle:"displayTitle",scope:"scope"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_4__.Vt3,_angular_core__WEBPACK_IMPORTED_MODULE_4__.aNF],decls:2,vars:0,consts:[["DynamicComponentLoader",""],["dsDynamicComponentLoader",""]],template:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_4__.DNE(0,BrowseBySwitcherComponent_ng_template_0_Template,0,0,"ng-template",1,0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.C5r)},dependencies:[_shared_abstract_component_loader_dynamic_component_loader_directive__WEBPACK_IMPORTED_MODULE_5__.z],encapsulation:2})}return BrowseBySwitcherComponent2})()},15446:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U:()=>DSOBreadcrumbsService});var rxjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(10743),_app_routing_paths__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(45930),_breadcrumbs_breadcrumb_breadcrumb_model__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(96622),_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(77028),_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(32181),_cache_builders_link_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(48614),_dso_name_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91735),_angular_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(68014);let DSOBreadcrumbsService=(()=>{class DSOBreadcrumbsService2{constructor(linkService,dsoNameService){this.linkService=linkService,this.dsoNameService=dsoNameService}getBreadcrumbs(key,url){const label=this.dsoNameService.getName(key),crumb=new _breadcrumbs_breadcrumb_breadcrumb_model__WEBPACK_IMPORTED_MODULE_3__.Q(label,url),propertyName=key.getParentLinkKey();return this.linkService.resolveLink(key,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_4__.s)(propertyName))[propertyName].pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.I6)(parentRD=>parentRD.hasSucceeded||204===parentRD.statusCode),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.nx)(parentRD=>{if((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(parentRD)&&(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(parentRD.payload)){const parent=parentRD.payload;return this.getBreadcrumbs(parent,(0,_app_routing_paths__WEBPACK_IMPORTED_MODULE_0__.wN)(parent))}return(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)([])}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(breadcrumbs=>[...breadcrumbs,crumb]))}static#_=this.\u0275fac=function(t){return new(t||DSOBreadcrumbsService2)(_angular_core__WEBPACK_IMPORTED_MODULE_8__.KVO(_cache_builders_link_service__WEBPACK_IMPORTED_MODULE_1__._),_angular_core__WEBPACK_IMPORTED_MODULE_8__.KVO(_dso_name_service__WEBPACK_IMPORTED_MODULE_2__.f))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_8__.jDH({token:DSOBreadcrumbsService2,factory:DSOBreadcrumbsService2.\u0275fac,providedIn:"root"})}return DSOBreadcrumbsService2})()},80148:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{VersionDataService:()=>VersionDataService});var rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(10743),_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(77028),_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(32181),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(86786),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(40017),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91365),_shared_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(82656),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68134),_base_patch_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(75467),_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(84237),_request_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(72744),_angular_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(68014);let VersionDataService=(()=>{class VersionDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_4__.W{constructor(requestService,rdbService,objectCache,halService,comparator){super("versions",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.comparator=comparator,this.patchData=new _base_patch_data__WEBPACK_IMPORTED_MODULE_5__.n(this.linkPath,requestService,rdbService,objectCache,halService,comparator,this.responseMsToLive,this.constructIdEndpoint)}getHistoryFromVersion(version,useCachedVersionIfAvailable=!1,reRequestOnStale=!0){return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.hj)(version)?this.findById(version.id,useCachedVersionIfAvailable,reRequestOnStale,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_9__.s)("versionhistory")).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_3__.ak)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.nx)(res=>res.versionhistory),(0,_shared_operators__WEBPACK_IMPORTED_MODULE_3__.ak)()):rxjs__WEBPACK_IMPORTED_MODULE_11__.EMPTY}getHistoryIdFromVersion(version){return this.getHistoryFromVersion(version).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.Tj)(versionHistory=>versionHistory.id))}patch(object,operations){return this.patchData.patch(object,operations)}update(object){return this.patchData.update(object)}commitUpdates(method){this.patchData.commitUpdates(method)}createPatchFromCache(object){return this.patchData.createPatchFromCache(object)}static#_=this.\u0275fac=function(t){return new(t||VersionDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_7__.B),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__.o),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__.$),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_2__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_6__.Y))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_12__.jDH({token:VersionDataService2,factory:VersionDataService2.\u0275fac,providedIn:"root"})}return VersionDataService2})()},1555:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{VersionHistoryDataService:()=>VersionHistoryDataService});var _angular_common_http__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(38068),rxjs__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(10743),_shared_empty_util__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(77028),_shared_pagination_pagination_component_options_model__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(64694),_shared_search_models_paginated_search_options_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80780),_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(32181),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(91365),_shared_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(82656),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(68134),_request_models__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(87457),_request_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(72744),_version_data_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(80148),_angular_core__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(68014);let VersionHistoryDataService=(()=>{class VersionHistoryDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__.W{constructor(requestService,rdbService,objectCache,halService,versionDataService){super("versionhistories",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.versionDataService=versionDataService,this.versionsEndpoint="versions"}getBrowseEndpoint(options={},linkPath){return this.halService.getEndpoint(this.linkPath)}getVersionsEndpoint(versionHistoryId){return this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.nx)(href=>this.halService.getEndpoint(this.versionsEndpoint,`${href}/${versionHistoryId}`)))}getVersions(versionHistoryId,searchOptions,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const hrefObs=this.getVersionsEndpoint(versionHistoryId).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.Tj)(href=>searchOptions?searchOptions.toRestUrl(href):href));return this.versionDataService.findListByHref(hrefObs,void 0,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}createVersion(itemHref,summary){const requestId=this.requestService.generateRequestId(),requestOptions=Object.create({});let requestHeaders=new _angular_common_http__WEBPACK_IMPORTED_MODULE_10__.Lr;return requestHeaders=requestHeaders.append("Content-Type","text/uri-list"),requestOptions.headers=requestHeaders,this.halService.getEndpoint(this.versionsEndpoint).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.Tj)(endpointUrl=>summary?.length>0?`${endpointUrl}?summary=${summary}`:`${endpointUrl}`),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.I6)(href=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_11__.a4)(href))).subscribe(href=>{const request=new _request_models__WEBPACK_IMPORTED_MODULE_6__.Qf(requestId,href,itemHref,requestOptions);(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_11__.a4)(this.responseMsToLive)&&(request.responseMsToLive=this.responseMsToLive),this.requestService.send(request)}),this.rdbService.buildFromRequestUUIDAndAwait(requestId,versionRD=>(0,rxjs__WEBPACK_IMPORTED_MODULE_12__.combineLatest)([this.requestService.setStaleByHrefSubstring(versionRD.payload._links.self.href),this.requestService.setStaleByHrefSubstring(versionRD.payload._links.versionhistory.href)])).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)())}getLatestVersionFromHistory$(versionHistory){const latestVersionOptions=Object.assign(new _shared_pagination_pagination_component_options_model__WEBPACK_IMPORTED_MODULE_13__.W,{id:"item-newest-version-options",currentPage:1,pageSize:1}),latestVersionSearch=new _shared_search_models_paginated_search_options_model__WEBPACK_IMPORTED_MODULE_0__.C({pagination:latestVersionOptions});return this.getVersions(versionHistory.id,latestVersionSearch,!1,!0,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_14__.s)("item")).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.v7)(),(0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.Bo)(),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_11__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.pb)(versions=>versions.page.length>0),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.Tj)(versions=>versions.page[0]))}getLatestVersion$(version){return version.id?this.versionDataService.findById(version.id,!1,!0,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_14__.s)("versionhistory")).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.nx)(res=>res.versionhistory),(0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.nx)(versionHistoryRD=>this.getLatestVersionFromHistory$(versionHistoryRD))):(0,rxjs__WEBPACK_IMPORTED_MODULE_12__.of)(null)}isLatest$(version){return version?this.getLatestVersion$(version).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.nx)(latestVersion=>(0,rxjs__WEBPACK_IMPORTED_MODULE_12__.of)(version.version===latestVersion.version))):(0,rxjs__WEBPACK_IMPORTED_MODULE_12__.of)(null)}hasDraftVersion$(versionHref){return this.versionDataService.findByHref(versionHref,!1,!0,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_14__.s)("versionhistory")).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.nx)(versionRD=>versionRD.hasSucceeded&&!versionRD.hasNoContent?versionRD.payload.versionhistory.pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.Tj)(versionHistoryRD=>!(!versionHistoryRD.hasSucceeded||versionHistoryRD.hasNoContent)&&versionHistoryRD.payload.draftVersion)):(0,rxjs__WEBPACK_IMPORTED_MODULE_12__.of)(!1)))}getLatestVersionItemFromHistory$(versionHistory){return this.getLatestVersionFromHistory$(versionHistory).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.nx)(newLatestVersion=>newLatestVersion.item),(0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)())}getVersionHistoryFromVersion$(version){return this.versionDataService.getHistoryIdFromVersion(version).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.nx)(res=>this.findById(res)),(0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)())}invalidateVersionHistoryCache(versionHistoryID){this.requestService.setStaleByHrefSubstring("versioning/versionhistories/"+versionHistoryID)}static#_=this.\u0275fac=function(t){return new(t||VersionHistoryDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_15__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_7__.B),_angular_core__WEBPACK_IMPORTED_MODULE_15__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_15__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_15__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_15__.KVO(_version_data_service__WEBPACK_IMPORTED_MODULE_8__.VersionDataService))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_15__.jDH({token:VersionHistoryDataService2,factory:VersionHistoryDataService2.\u0275fac,providedIn:"root"})}return VersionHistoryDataService2})()},77231:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{QualityAssuranceEventDataService:()=>QualityAssuranceEventDataService});var _angular_common_http__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(38068),rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(10743),_shared_empty_util__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(77028),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10117),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(57699),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_data_base_create_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(85311),_data_base_delete_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(43626),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(68134),_data_base_patch_data__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(75467),_data_base_search_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(19399),_data_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(84237),_data_request_models__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(87457),_data_request_service__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(72744),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(91365),_angular_core__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(68014);let QualityAssuranceEventDataService=(()=>{class QualityAssuranceEventDataService2 extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService,comparator){super("qualityassuranceevents",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.comparator=comparator,this.createData=new _data_base_create_data__WEBPACK_IMPORTED_MODULE_3__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.deleteData=new _data_base_delete_data__WEBPACK_IMPORTED_MODULE_4__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint),this.patchData=new _data_base_patch_data__WEBPACK_IMPORTED_MODULE_6__.n(this.linkPath,requestService,rdbService,objectCache,halService,comparator,this.responseMsToLive,this.constructIdEndpoint),this.searchData=new _data_base_search_data__WEBPACK_IMPORTED_MODULE_7__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive)}getEventsByTopic(topic,options={},...linksToFollow){return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_12__.x("topic",topic)],this.searchData.searchBy("findByTopic",options,!0,!0,...linksToFollow)}searchEventsByTopic(options={},...linksToFollow){return this.searchData.searchBy("findByTopic",options,!0,!0,...linksToFollow)}clearFindByTopicRequests(){this.requestService.setStaleByHrefSubstring("findByTopic")}getEvent(id,...linksToFollow){return this.findById(id,!0,!0,...linksToFollow)}patchEvent(status,dso,reason){return this.patchData.patch(dso,[{path:"/status",op:"replace",value:status}])}boundProject(itemId,projectId){return this.postOnRelated(itemId,projectId)}removeProject(itemId){return this.deleteOnRelated(itemId)}deleteOnRelated(objectId){const requestId=this.requestService.generateRequestId();return this.getIDHrefObs(objectId).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.I6)(href=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_14__.a4)(href))).subscribe(href=>{const request=new _data_request_models__WEBPACK_IMPORTED_MODULE_9__.Dk(requestId,href+"/related",objectId);(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_14__.a4)(this.responseMsToLive)&&(request.responseMsToLive=this.responseMsToLive),this.requestService.send(request)}),this.rdbService.buildFromRequestUUID(requestId)}postOnRelated(objectId,relatedItemId,body){const requestId=this.requestService.generateRequestId();return this.getIDHrefObs(objectId).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.s)(1)).subscribe(href=>{const request=new _data_request_models__WEBPACK_IMPORTED_MODULE_9__.Qf(requestId,href+"/related?item="+relatedItemId,body);(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_14__.a4)(this.responseMsToLive)&&(request.responseMsToLive=this.responseMsToLive),this.requestService.send(request)}),this.rdbService.buildFromRequestUUID(requestId)}postData(target,correctionType,related,reason){const requestId=this.requestService.generateRequestId();return this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.nx)(href=>{const options=Object.create({});let headers=new _angular_common_http__WEBPACK_IMPORTED_MODULE_15__.Lr;headers=headers.append("Content-Type","application/json"),options.headers=headers;let params=new _angular_common_http__WEBPACK_IMPORTED_MODULE_15__.Nl;params=params.append("target",target).append("correctionType",correctionType),options.params=params;const request=new _data_request_models__WEBPACK_IMPORTED_MODULE_9__.Qf(requestId,href,{reason},options);return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_14__.a4)(this.responseMsToLive)&&(request.responseMsToLive=this.responseMsToLive),this.requestService.send(request),this.rdbService.buildFromRequestUUID(requestId)}))}deleteQAEvent(qaEvent){return this.deleteData.delete(qaEvent.id)}static#_=this.\u0275fac=function(t){return new(t||QualityAssuranceEventDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_16__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_10__.B),_angular_core__WEBPACK_IMPORTED_MODULE_16__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_16__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_16__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_11__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_16__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I),_angular_core__WEBPACK_IMPORTED_MODULE_16__.KVO(_data_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_8__.Y))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_16__.jDH({token:QualityAssuranceEventDataService2,factory:QualityAssuranceEventDataService2.\u0275fac,providedIn:"root"})}return QualityAssuranceEventDataService2})()},71870:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CorrectionTypeDataService:()=>CorrectionTypeDataService});var rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(74785),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10117),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(57699),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68134),_data_base_search_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(19399),_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(97570),_data_request_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(72744),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(91365),_shared_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(82656),_angular_core__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(68014);let CorrectionTypeDataService=(()=>{class CorrectionTypeDataService2 extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_3__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService){super("correctiontypes",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.linkPath="correctiontypes",this.searchByTopic="findByTopic",this.searchFindByItem="findByItem",this.searchData=new _data_base_search_data__WEBPACK_IMPORTED_MODULE_4__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive)}getCorrectionTypeById(id,useCachedVersionIfAvailable=!0,reRequestOnStale=!0){return this.findById(id,useCachedVersionIfAvailable,reRequestOnStale)}findByItem(itemUuid,useCachedVersionIfAvailable){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_8__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_9__.x("uuid",itemUuid)],this.searchData.searchBy(this.searchFindByItem,options,useCachedVersionIfAvailable)}findByTopic(topic,useCachedVersionIfAvailable=!0,reRequestOnStale=!0){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_8__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_9__.x("topic",topic)],this.searchData.searchBy(this.searchByTopic,options,useCachedVersionIfAvailable,reRequestOnStale).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_7__.Hz)(),(0,_shared_operators__WEBPACK_IMPORTED_MODULE_7__.W8)(),(0,rxjs__WEBPACK_IMPORTED_MODULE_10__.map)(list=>list[0]))}static#_=this.\u0275fac=function(t){return new(t||CorrectionTypeDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_5__.B),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_6__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_11__.jDH({token:CorrectionTypeDataService2,factory:CorrectionTypeDataService2.\u0275fac,providedIn:"root"})}return CorrectionTypeDataService2})()},65925:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>ItemVersionsSharedService});var _shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10117),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68014),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(43750);let ItemVersionsSharedService=(()=>{class ItemVersionsSharedService2{constructor(notificationsService,translateService){this.notificationsService=notificationsService,this.translateService=translateService}static msg(key){return"item.version.create.notification."+key}notifyCreateNewVersion(newVersionRD){const newVersionNumber=newVersionRD?.payload?.version;newVersionRD.hasSucceeded?this.notificationsService.success(null,this.translateService.get(ItemVersionsSharedService2.msg("success"),{version:newVersionNumber})):this.notificationsService.error(null,this.translateService.get(ItemVersionsSharedService2.msg(422===newVersionRD?.statusCode?"inProgress":"failure")))}static#_=this.\u0275fac=function(t){return new(t||ItemVersionsSharedService2)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I),_angular_core__WEBPACK_IMPORTED_MODULE_1__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_2__.c$))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.jDH({token:ItemVersionsSharedService2,factory:ItemVersionsSharedService2.\u0275fac,providedIn:"root"})}return ItemVersionsSharedService2})()},32137:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>ItemVersionsSummaryModalComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(84739),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68014),_angular_forms__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(28955),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(43750),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(74785),_shared_loading_themed_loading_component__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(32943),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(71781);const _c0=a0=>({version:a0});function ItemVersionsSummaryModalComponent_div_0_span_11_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(0,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_1__.i5U(2,1,"item.version.create.modal.text.startingFrom",_angular_core__WEBPACK_IMPORTED_MODULE_1__.eq3(4,_c0,ctx_r1.versionNumber))," ")}}function ItemVersionsSummaryModalComponent_div_0_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(0,"div")(1,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(4,"button",3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_1__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_1__.Njj(ctx_r1.onModalClose())}),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(5,"span",4),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(6,"\xd7"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s()()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(7,"div",5)(8,"p",6),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(9),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(10,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.DNE(11,ItemVersionsSummaryModalComponent_div_0_span_11_Template,3,6,"span",7),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(12,"div",8)(13,"label",9),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(14),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(15,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(16,"input",10),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(17,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.mxI("ngModelChange",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_1__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_1__.DH7(ctx_r1.newVersionSummary,$event)||(ctx_r1.newVersionSummary=$event),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Njj($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_1__.bIt("keyup.enter",function(){_angular_core__WEBPACK_IMPORTED_MODULE_1__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_1__.Njj(ctx_r1.onModalSubmit())}),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s()()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(18,"div",11)(19,"button",12),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(20,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_1__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_1__.Njj(ctx_r1.onModalClose())}),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nrm(21,"i",13),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(22),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(23,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(24,"button",14),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(25,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_1__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_1__.Njj(ctx_r1.onModalSubmit())}),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nrm(26,"i",15),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(27),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(28,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s()()()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_1__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.SpI("",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(3,10,"item.version.create.modal.header")," "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(7),_angular_core__WEBPACK_IMPORTED_MODULE_1__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(10,12,"item.version.create.modal.text")," "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Y8G("ngIf",!ctx_r1.firstVersion),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.SpI("",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(15,14,"item.version.create.modal.form.summary.label"),":"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.FS9("placeholder",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(17,16,"item.version.create.modal.form.summary.placeholder")),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R50("ngModel",ctx_r1.newVersionSummary),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.FS9("title",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(20,18,"item.version.create.modal.button.cancel.tooltip")),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(23,20,"item.version.create.modal.button.cancel")," "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.FS9("title",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(25,22,"item.version.create.modal.button.confirm.tooltip")),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(28,24,"item.version.create.modal.button.confirm")," ")}}function ItemVersionsSummaryModalComponent_ng_template_2_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(0,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(3,"div",5)(4,"p"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.EFF(5),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(6,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.j41(7,"div",16),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nrm(8,"ds-loading",17),_angular_core__WEBPACK_IMPORTED_MODULE_1__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(2,3,"item.version.create.modal.submitted.header")),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_1__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(6,5,"item.version.create.modal.submitted.text")),_angular_core__WEBPACK_IMPORTED_MODULE_1__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Y8G("showMessage",!1))}let ItemVersionsSummaryModalComponent=(()=>{class ItemVersionsSummaryModalComponent2{constructor(activeModal){this.activeModal=activeModal,this.firstVersion=!0,this.createVersionEvent=new _angular_core__WEBPACK_IMPORTED_MODULE_1__.bkB}ngOnInit(){this.submitted$=new rxjs__WEBPACK_IMPORTED_MODULE_2__.BehaviorSubject(!1)}onModalClose(){this.activeModal.dismiss()}beforeDismiss(){return!this.submitted$.getValue()}onModalSubmit(){this.createVersionEvent.emit(this.newVersionSummary),this.submitted$.next(!0)}static#_=this.\u0275fac=function(t){return new(t||ItemVersionsSummaryModalComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.rXU(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_3__.Lw))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_1__.VBU({type:ItemVersionsSummaryModalComponent2,selectors:[["ds-item-versions-summary-modal"]],outputs:{createVersionEvent:"createVersionEvent"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_1__.aNF],decls:4,vars:4,consts:[["waiting",""],[4,"ngIf","ngIfElse"],[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"pb-2"],[4,"ngIf"],[1,"form-group"],["for","summary"],["type","text","id","summary",1,"form-control",3,"ngModelChange","keyup.enter","ngModel","placeholder"],[1,"modal-footer","space-children-mr"],["type","button",1,"btn","btn-outline-secondary","btn-sm","ml-0",3,"click","title"],[1,"fas","fa-times","fa-fw"],["type","submit",1,"btn","btn-success","btn-sm","ml-0",3,"click","title"],[1,"fas","fa-check","fa-fw"],[1,"d-flex","justify-content-center"],[3,"showMessage"]],template:function(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.DNE(0,ItemVersionsSummaryModalComponent_div_0_Template,29,26,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.nI1(1,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.DNE(2,ItemVersionsSummaryModalComponent_ng_template_2_Template,9,7,"ng-template",null,0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.C5r)),2&rf){const waiting_r3=_angular_core__WEBPACK_IMPORTED_MODULE_1__.sdS(3);_angular_core__WEBPACK_IMPORTED_MODULE_1__.Y8G("ngIf",!0!==_angular_core__WEBPACK_IMPORTED_MODULE_1__.bMT(1,2,ctx.submitted$))("ngIfElse",waiting_r3)}},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_4__.bT,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.BC,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.vS,_shared_loading_themed_loading_component__WEBPACK_IMPORTED_MODULE_0__.v,_angular_common__WEBPACK_IMPORTED_MODULE_4__.Jj,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_6__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_6__.D9]})}return ItemVersionsSummaryModalComponent2})()},34615:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>dsoEditMenuResolver});var core=__webpack_require__(68014),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),app_routing_paths=__webpack_require__(45930),dspace_object_data_service=__webpack_require__(78358),authorization_data_service=__webpack_require__(30289),feature_id=__webpack_require__(29321),researcher_profile_data_service=__webpack_require__(64961),collection_model=__webpack_require__(28410),community_model=__webpack_require__(61935),item_model=__webpack_require__(6721),shared_operators=__webpack_require__(82656),correctiontype_data_service=__webpack_require__(71870),url_combiner=__webpack_require__(1828),empty_util=__webpack_require__(77028),menu_service=__webpack_require__(90547),menu_id_model=__webpack_require__(7417),menu_item_type_model=__webpack_require__(80122),notifications_service=__webpack_require__(10117),subscription_modal_component=__webpack_require__(5426),item_data_service=__webpack_require__(94743),version_data_service=__webpack_require__(80148),version_history_data_service=__webpack_require__(1555),workspaceitem_data_service=__webpack_require__(2402),item_versions_shared_service=__webpack_require__(65925),item_versions_summary_modal_component=__webpack_require__(32137),ng_bootstrap=__webpack_require__(71781),router=__webpack_require__(64247);let DsoVersioningModalService=(()=>{class DsoVersioningModalService2{constructor(modalService,versionService,versionHistoryService,itemVersionShared,router2,workspaceItemDataService,itemService){this.modalService=modalService,this.versionService=versionService,this.versionHistoryService=versionHistoryService,this.itemVersionShared=itemVersionShared,this.router=router2,this.workspaceItemDataService=workspaceItemDataService,this.itemService=itemService}openCreateVersionModal(dso){const item=dso,versionHref=item._links.version.href,activeModal=this.modalService.open(item_versions_summary_modal_component.L);this.versionService.findByHref(versionHref).pipe((0,shared_operators.qD)()).subscribe(res=>{activeModal.componentInstance.firstVersion=res.hasNoContent,activeModal.componentInstance.versionNumber=res.hasNoContent?void 0:res.payload.version}),activeModal.componentInstance.createVersionEvent.pipe((0,operators.nx)(summary=>this.versionHistoryService.createVersion(item._links.self.href,summary)),(0,shared_operators.qD)(),(0,operators.Mi)(()=>activeModal.close()),(0,operators.Mi)(res=>{this.itemVersionShared.notifyCreateNewVersion(res)}),(0,shared_operators.ak)(),(0,operators.nx)(newVersion=>this.itemService.findByHref(newVersion._links.item.href)),(0,shared_operators.ak)(),(0,operators.nx)(newVersionItem=>this.workspaceItemDataService.findByItem(newVersionItem.uuid,!0,!1)),(0,shared_operators.ak)()).subscribe(wsItem=>{this.router.navigateByUrl("workspaceitems/"+wsItem.id+"/edit")})}isNewVersionButtonDisabled(dso){return this.versionHistoryService.hasDraftVersion$(dso._links.version.href).pipe((0,operators.Tj)(res=>!!res))}getVersioningTooltipMessage(dso,tooltipMsgHasDraft,tooltipMsgCreate){return this.isNewVersionButtonDisabled(dso).pipe((0,operators.nx)(hasDraftVersion=>(0,cjs.of)(hasDraftVersion?tooltipMsgHasDraft:tooltipMsgCreate)))}static#_=this.\u0275fac=function(t){return new(t||DsoVersioningModalService2)(core.KVO(ng_bootstrap.Bq),core.KVO(version_data_service.VersionDataService),core.KVO(version_history_data_service.VersionHistoryDataService),core.KVO(item_versions_shared_service.h),core.KVO(router.Ix),core.KVO(workspaceitem_data_service.WorkspaceitemDataService),core.KVO(item_data_service.ItemDataService))};static#_2=this.\u0275prov=core.jDH({token:DsoVersioningModalService2,factory:DsoVersioningModalService2.\u0275fac,providedIn:"root"})}return DsoVersioningModalService2})();var dso_withdrawn_reinstate_modal_service=__webpack_require__(19941),ngx_translate_core=__webpack_require__(43750);let DSOEditMenuResolverService=(()=>{class DSOEditMenuResolverService2{constructor(dSpaceObjectDataService,menuService,authorizationService,modalService,dsoVersioningModalService,researcherProfileService,notificationsService,translate,dsoWithdrawnReinstateModalService,correctionTypeDataService){this.dSpaceObjectDataService=dSpaceObjectDataService,this.menuService=menuService,this.authorizationService=authorizationService,this.modalService=modalService,this.dsoVersioningModalService=dsoVersioningModalService,this.researcherProfileService=researcherProfileService,this.notificationsService=notificationsService,this.translate=translate,this.dsoWithdrawnReinstateModalService=dsoWithdrawnReinstateModalService,this.correctionTypeDataService=correctionTypeDataService}resolve(route,state){let id=route.params.id;return(0,empty_util.Tn)(id)&&(0,empty_util.a4)(route.queryParams.scope)&&(id=route.queryParams.scope),(0,empty_util.Tn)(id)?(0,cjs.of)({...route.data?.menu}):this.dSpaceObjectDataService.findById(id,!0,!1).pipe((0,shared_operators.qD)(),(0,operators.nx)(dsoRD=>{if(dsoRD.hasSucceeded){const dso=dsoRD.payload;return(0,cjs.combineLatest)(this.getDsoMenus(dso,route,state)).pipe((0,operators.Tj)(combinedMenus=>[].concat.apply([],combinedMenus)),(0,operators.Tj)(menus=>this.addDsoUuidToMenuIDs(menus,dso)),(0,operators.Tj)(menus=>({...route.data?.menu,[menu_id_model.D.DSO_EDIT]:menus})))}return(0,cjs.of)({...route.data?.menu})}))}getDsoMenus(dso,route,state){return[this.getItemMenu(dso),this.getComColMenu(dso),this.getCommonMenu(dso,state)]}getCommonMenu(dso,state){return(0,cjs.combineLatest)([this.authorizationService.isAuthorized(feature_id._.CanEditMetadata,dso.self)]).pipe((0,operators.Tj)(([canEditItem])=>[{id:"edit-dso",active:!1,visible:canEditItem,model:{type:menu_item_type_model.x.LINK,text:this.getDsoType(dso)+".page.edit",link:new url_combiner.t((0,app_routing_paths.wN)(dso),"edit","metadata").toString()},icon:"pencil-alt",index:2}]))}getItemMenu(dso){return dso instanceof item_model.q?(0,cjs.combineLatest)([this.authorizationService.isAuthorized(feature_id._.CanCreateVersion,dso.self),this.dsoVersioningModalService.isNewVersionButtonDisabled(dso),this.dsoVersioningModalService.getVersioningTooltipMessage(dso,"item.page.version.hasDraft","item.page.version.create"),this.authorizationService.isAuthorized(feature_id._.CanSynchronizeWithORCID,dso.self),this.authorizationService.isAuthorized(feature_id._.CanClaimItem,dso.self),this.correctionTypeDataService.findByItem(dso.uuid,!1).pipe((0,shared_operators.qD)(),(0,shared_operators.Bo)())]).pipe((0,operators.Tj)(([canCreateVersion,disableVersioning,versionTooltip,canSynchronizeWithOrcid,canClaimItem,correction])=>{const isPerson="person"===this.getDsoType(dso);return[{id:"orcid-dso",active:!1,visible:isPerson&&canSynchronizeWithOrcid,model:{type:menu_item_type_model.x.LINK,text:"item.page.orcid.tooltip",link:new url_combiner.t((0,app_routing_paths.wN)(dso),"orcid").toString()},icon:"orcid fab fa-lg",index:0},{id:"version-dso",active:!1,visible:canCreateVersion,model:{type:menu_item_type_model.x.ONCLICK,text:versionTooltip,disabled:disableVersioning,function:()=>{this.dsoVersioningModalService.openCreateVersionModal(dso)}},icon:"code-branch",index:1},{id:"claim-dso",active:!1,visible:isPerson&&canClaimItem,model:{type:menu_item_type_model.x.ONCLICK,text:"item.page.claim.button",function:()=>{this.claimResearcher(dso)}},icon:"hand-paper",index:3},{id:"withdrawn-item",active:!1,visible:dso.isArchived&&correction?.page.some(c=>c.topic===dso_withdrawn_reinstate_modal_service.pc),model:{type:menu_item_type_model.x.ONCLICK,text:"item.page.withdrawn",function:()=>{this.dsoWithdrawnReinstateModalService.openCreateWithdrawnReinstateModal(dso,"request-withdrawn",dso.isArchived)}},icon:"eye-slash",index:4},{id:"reinstate-item",active:!1,visible:dso.isWithdrawn&&correction?.page.some(c=>c.topic===dso_withdrawn_reinstate_modal_service.el),model:{type:menu_item_type_model.x.ONCLICK,text:"item.page.reinstate",function:()=>{this.dsoWithdrawnReinstateModalService.openCreateWithdrawnReinstateModal(dso,"request-reinstate",dso.isArchived)}},icon:"eye",index:5}]})):(0,cjs.of)([])}getComColMenu(dso){return dso instanceof community_model.E||dso instanceof collection_model.p?(0,cjs.combineLatest)([this.authorizationService.isAuthorized(feature_id._.CanSubscribe,dso.self)]).pipe((0,operators.Tj)(([canSubscribe])=>[{id:"subscribe",active:!1,visible:canSubscribe,model:{type:menu_item_type_model.x.ONCLICK,text:"subscriptions.tooltip",function:()=>{this.modalService.open(subscription_modal_component.w).componentInstance.dso=dso}},icon:"bell",index:4}])):(0,cjs.of)([])}claimResearcher(dso){this.researcherProfileService.createFromExternalSourceAndReturnRelatedItemId(dso.self).subscribe(id=>{(0,empty_util.hj)(id)?(this.notificationsService.success(this.translate.get("researcherprofile.success.claim.title"),this.translate.get("researcherprofile.success.claim.body")),this.authorizationService.invalidateAuthorizationsRequestCache(),this.menuService.hideMenuSection(menu_id_model.D.DSO_EDIT,"claim-dso-"+dso.uuid)):this.notificationsService.error(this.translate.get("researcherprofile.error.claim.title"),this.translate.get("researcherprofile.error.claim.body"))})}getDsoType(dso){const renderType=dso.getRenderTypes()[0];return"string"==typeof renderType||renderType instanceof String?renderType.toLowerCase():dso.type.toString().toLowerCase()}addDsoUuidToMenuIDs(menus,dso){return menus.map(menu=>(Object.assign(menu,{id:menu.id+"-"+dso.uuid}),(0,empty_util.a4)(menu.parentID)&&Object.assign(menu,{parentID:menu.parentID+"-"+dso.uuid}),menu))}static#_=this.\u0275fac=function(t){return new(t||DSOEditMenuResolverService2)(core.KVO(dspace_object_data_service.DSpaceObjectDataService),core.KVO(menu_service.$),core.KVO(authorization_data_service.AuthorizationDataService),core.KVO(ng_bootstrap.Bq),core.KVO(DsoVersioningModalService),core.KVO(researcher_profile_data_service.ResearcherProfileDataService),core.KVO(notifications_service.I),core.KVO(ngx_translate_core.c$),core.KVO(dso_withdrawn_reinstate_modal_service.Ee),core.KVO(correctiontype_data_service.CorrectionTypeDataService))};static#_2=this.\u0275prov=core.jDH({token:DSOEditMenuResolverService2,factory:DSOEditMenuResolverService2.\u0275fac,providedIn:"root"})}return DSOEditMenuResolverService2})();const dsoEditMenuResolver=(route,state,menuResolverService=(0,core.WQX)(DSOEditMenuResolverService))=>menuResolverService.resolve(route,state)},19941:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ee:()=>DsoWithdrawnReinstateModalService,el:()=>REQUEST_REINSTATE,pc:()=>REQUEST_WITHDRAWN});var operators=__webpack_require__(10743),authorization_data_service=__webpack_require__(30289),item_data_service=__webpack_require__(94743),quality_assurance_event_data_service=__webpack_require__(77231),shared_operators=__webpack_require__(82656),common=__webpack_require__(84739),core=__webpack_require__(68014),fesm2022_forms=__webpack_require__(28955),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),themed_loading_component=__webpack_require__(32943),ng_bootstrap=__webpack_require__(71781);function ItemWithdrawnReinstateModalComponent_div_0_div_1_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"div",13),core.EFF(1),core.nI1(2,"translate"),core.j41(3,"button",14),core.bIt("click",function(){core.eBV(_r2);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.onModalClose())}),core.j41(4,"span",15),core.EFF(5,"\xd7"),core.k0s()()()}2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"item.qa.withdrawn.modal.header")," "))}function ItemWithdrawnReinstateModalComponent_div_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div"),core.DNE(1,ItemWithdrawnReinstateModalComponent_div_0_div_1_Template,6,3,"div",3),core.j41(2,"div",4)(3,"div",5)(4,"label",6),core.EFF(5),core.nI1(6,"translate"),core.nI1(7,"translate"),core.k0s(),core.j41(8,"label",6),core.EFF(9),core.nI1(10,"translate"),core.nI1(11,"translate"),core.k0s(),core.j41(12,"textarea",7),core.nI1(13,"translate"),core.nI1(14,"translate"),core.mxI("ngModelChange",function($event){core.eBV(_r1);const ctx_r2=core.XpG();return core.DH7(ctx_r2.reason,$event)||(ctx_r2.reason=$event),core.Njj($event)}),core.k0s()()(),core.j41(15,"div",8)(16,"button",9),core.nI1(17,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r2=core.XpG();return core.Njj(ctx_r2.onModalClose())}),core.nrm(18,"i",10),core.EFF(19),core.nI1(20,"translate"),core.k0s(),core.j41(21,"button",11),core.nI1(22,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r2=core.XpG();return core.Njj(ctx_r2.onModalSubmit())}),core.nrm(23,"i",12),core.EFF(24),core.nI1(25,"translate"),core.nI1(26,"translate"),core.k0s()()()}if(2&rf){const ctx_r2=core.XpG(),reinstateHeader_r4=core.sdS(5);core.R7$(),core.Y8G("ngIf",ctx_r2.canWithdraw)("ngIfElse",reinstateHeader_r4),core.R7$(4),core.JRh(ctx_r2.canWithdraw?core.bMT(6,10,"qa-withdrawn.create.modal.form.summary.label"):core.bMT(7,12,"qa-reinstate.create.modal.form.summary.label")),core.R7$(4),core.JRh(ctx_r2.canWithdraw?core.bMT(10,14,"qa-withdrawn.create.modal.form.summary2.label"):core.bMT(11,16,"qa-reinstate.create.modal.form.summary2.label")),core.R7$(3),core.FS9("placeholder",ctx_r2.canWithdraw?core.bMT(13,18,"qa-withdrown.modal.form.summary.placeholder"):core.bMT(14,20,"qa-reinstate.modal.form.summary.placeholder")),core.R50("ngModel",ctx_r2.reason),core.R7$(4),core.FS9("title",core.bMT(17,22,"item.qa.withdrawn-reinstate.create.modal.button.cancel.tooltip")),core.R7$(3),core.SpI(" ",core.bMT(20,24,"item.qa.withdrawn-reinstate.create.modal.button.cancel")," "),core.R7$(2),core.FS9("title",core.bMT(22,26,"item.qa.withdrawn-reinstate.modal.button.confirm.tooltip")),core.R7$(3),core.SpI(" ",ctx_r2.canWithdraw?core.bMT(25,28,"qa-withdrown.create.modal.button.confirm"):core.bMT(26,30,"qa-reinstate.create.modal.button.confirm")," ")}}function ItemWithdrawnReinstateModalComponent_ng_template_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",13),core.EFF(1),core.nI1(2,"translate"),core.k0s(),core.j41(3,"div",4)(4,"div",16),core.nrm(5,"ds-loading",17),core.k0s()()),2&rf&&(core.R7$(),core.JRh(core.bMT(2,2,"item.qa.withdrawn.modal.submitted.header")),core.R7$(4),core.Y8G("showMessage",!1))}function ItemWithdrawnReinstateModalComponent_ng_template_4_div_0_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",13),core.EFF(1),core.nI1(2,"translate"),core.j41(3,"button",14),core.bIt("click",function(){core.eBV(_r5);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.onModalClose())}),core.j41(4,"span",15),core.EFF(5,"\xd7"),core.k0s()()()}2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"item.qa.reinstate.modal.header")," "))}function ItemWithdrawnReinstateModalComponent_ng_template_4_Template(rf,ctx){if(1&rf&&core.DNE(0,ItemWithdrawnReinstateModalComponent_ng_template_4_div_0_Template,6,3,"div",18),2&rf){const ctx_r2=core.XpG();core.Y8G("ngIf",!ctx_r2.canWithdraw)}}let ItemWithdrawnReinstateModalComponent=(()=>{class ItemWithdrawnReinstateModalComponent2{constructor(activeModal,authorizationService){this.activeModal=activeModal,this.authorizationService=authorizationService,this.submitted$=new cjs.BehaviorSubject(!1),this.createQAEvent=new core.bkB}onModalClose(){this.activeModal.close()}beforeDismiss(){return!this.submitted$.getValue()}onModalSubmit(){this.submitted$.next(!0),this.createQAEvent.emit(this.reason)}setWithdraw(state){this.canWithdraw=state}static#_=this.\u0275fac=function(t){return new(t||ItemWithdrawnReinstateModalComponent2)(core.rXU(ng_bootstrap.Lw),core.rXU(authorization_data_service.AuthorizationDataService))};static#_2=this.\u0275cmp=core.VBU({type:ItemWithdrawnReinstateModalComponent2,selectors:[["ds-item-withdrawn-reinstate-modal"]],outputs:{createQAEvent:"createQAEvent"},standalone:!0,features:[core.aNF],decls:6,vars:4,consts:[["waiting",""],["reinstateHeader",""],[4,"ngIf","ngIfElse"],["class","modal-header",4,"ngIf","ngIfElse"],[1,"modal-body"],[1,"form-group"],["for","reason"],["id","reason","rows","6","name","message",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"modal-footer","space-children-mr"],["type","button",1,"btn","btn-outline-secondary","btn-sm","ml-0",3,"click","title"],[1,"fas","fa-times","fa-fw"],["type","submit",1,"btn","btn-success","btn-sm","ml-0",3,"click","title"],[1,"fas","fa-check","fa-fw"],[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"d-flex","justify-content-center"],[3,"showMessage"],["class","modal-header",4,"ngIf"]],template:function(rf,ctx){if(1&rf&&(core.DNE(0,ItemWithdrawnReinstateModalComponent_div_0_Template,27,32,"div",2),core.nI1(1,"async"),core.DNE(2,ItemWithdrawnReinstateModalComponent_ng_template_2_Template,6,4,"ng-template",null,0,core.C5r)(4,ItemWithdrawnReinstateModalComponent_ng_template_4_Template,1,1,"ng-template",null,1,core.C5r)),2&rf){const waiting_r6=core.sdS(3);core.Y8G("ngIf",!0!==core.bMT(1,2,ctx.submitted$))("ngIfElse",waiting_r6)}},dependencies:[common.bT,ngx_translate_core.h,ngx_translate_core.D9,themed_loading_component.v,fesm2022_forms.YN,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.vS,common.Jj]})}return ItemWithdrawnReinstateModalComponent2})();var notifications_service=__webpack_require__(10117),router=__webpack_require__(64247);const REQUEST_WITHDRAWN="REQUEST/WITHDRAWN",REQUEST_REINSTATE="REQUEST/REINSTATE";let DsoWithdrawnReinstateModalService=(()=>{class DsoWithdrawnReinstateModalService2{constructor(router2,modalService,itemService,notificationsService,authorizationService,translateService,qaEventDataService){this.router=router2,this.modalService=modalService,this.itemService=itemService,this.notificationsService=notificationsService,this.authorizationService=authorizationService,this.translateService=translateService,this.qaEventDataService=qaEventDataService}openCreateWithdrawnReinstateModal(dso,correctionType,state){const target=dso.id,activeModal=this.modalService.open(ItemWithdrawnReinstateModalComponent);activeModal.componentInstance.setWithdraw(state),activeModal.componentInstance.createQAEvent.pipe((0,operators.s)(1)).subscribe(reasone=>{this.sendQARequest(target,correctionType,reasone),activeModal.close()})}sendQARequest(target,correctionType,reason){this.qaEventDataService.postData(target,correctionType,"",reason).pipe((0,shared_operators.qD)()).subscribe(res=>{res.hasSucceeded?(this.notificationsService.success(this.translateService.get("request-withdrawn"===correctionType?"correction-type.manage-relation.action.notification.withdrawn":"correction-type.manage-relation.action.notification.reinstate")),this.authorizationService.invalidateAuthorizationsRequestCache(),this.reloadPage(!0)):this.notificationsService.error(this.translateService.get("correction-type.manage-relation.action.notification.error"))})}reloadPage(self,urlToNavigateTo){const url=self?this.router.url:urlToNavigateTo;this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate([`/${url}`])})}static#_=this.\u0275fac=function(t){return new(t||DsoWithdrawnReinstateModalService2)(core.KVO(router.Ix),core.KVO(ng_bootstrap.Bq),core.KVO(item_data_service.ItemDataService),core.KVO(notifications_service.I),core.KVO(authorization_data_service.AuthorizationDataService),core.KVO(ngx_translate_core.c$),core.KVO(quality_assurance_event_data_service.QualityAssuranceEventDataService))};static#_2=this.\u0275prov=core.jDH({token:DsoWithdrawnReinstateModalService2,factory:DsoWithdrawnReinstateModalService2.\u0275fac,providedIn:"root"})}return DsoWithdrawnReinstateModalService2})()},5426:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>SubscriptionModalComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(84739),_angular_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(68014),_angular_forms__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(28955),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(43750),lodash_findIndex__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(84630),lodash_findIndex__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_findIndex__WEBPACK_IMPORTED_MODULE_0__),rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(10743),_core_auth_auth_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(41543),_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91735),_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(48168),__webpack_require__(82656)),_alert_alert_component__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(14467),_empty_util__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(77028),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10117),_object_collection_shared_badges_type_badge_themed_type_badge_component__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(83793),_subscriptions_data_service__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(49261),__webpack_require__(18870)),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(71781);function SubscriptionModalComponent_form_0_span_12_ds_type_badge_1_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(0,"ds-type-badge",17),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("object",ctx_r1.dso)}}function SubscriptionModalComponent_form_0_span_12_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"span",15),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(1,SubscriptionModalComponent_form_0_span_12_ds_type_badge_1_Template,1,1,"ds-type-badge",16),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!!ctx_r1.dso)}}function SubscriptionModalComponent_form_0_fieldset_14_div_6_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"div",24),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(1,"input",25),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(2,"label",26),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()()),2&rf){const frequency_r3=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("id","checkbox-"+frequency_r3)("formControlName",frequency_r3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("for","checkbox-"+frequency_r3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(4,4,"subscriptions.modal.new-subscription-form.frequency."+frequency_r3))}}function SubscriptionModalComponent_form_0_fieldset_14_ds_alert_7_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"ds-alert",27),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("type","alert-danger"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(2,2,"context-menu.actions.subscription.frequency.required")," "))}function SubscriptionModalComponent_form_0_fieldset_14_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"fieldset",18)(1,"legend",19),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(4,"div",20),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(5,"input",21),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(6,SubscriptionModalComponent_form_0_fieldset_14_div_6_Template,5,6,"div",22),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(7,SubscriptionModalComponent_form_0_fieldset_14_ds_alert_7_Template,3,4,"ds-alert",23),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf){const subscriptionType_r4=ctx.$implicit,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_10__.FS9("formGroupName",subscriptionType_r4.key),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(3,5,"subscriptions.modal.new-subscription-form.type."+subscriptionType_r4.key),": "),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("value",null==subscriptionType_r4||null==subscriptionType_r4.value?null:subscriptionType_r4.value.controls.subscriptionId.value),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngForOf",ctx_r1.frequencyDefaultValues),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!!ctx_r1.submitted&&(null==subscriptionType_r4||null==subscriptionType_r4.value||null==subscriptionType_r4.value.controls.frequencies.errors?null:subscriptionType_r4.value.controls.frequencies.errors.required))}}function SubscriptionModalComponent_form_0_p_16_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"p",28),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(2,1,"subscriptions.modal.delete-info")))}function SubscriptionModalComponent_form_0_span_24_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(1,"i",29),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(3,1,"subscriptions.modal.new-subscription-form.processing")," "))}function SubscriptionModalComponent_form_0_span_26_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(2,1,"subscriptions.modal.new-subscription-form.submit")," "))}function SubscriptionModalComponent_form_0_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"form",1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.bIt("ngSubmit",function(){_angular_core__WEBPACK_IMPORTED_MODULE_10__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_10__.Njj(ctx_r1.submit())}),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(1,"div",2)(2,"h4",3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(5,"button",4),_angular_core__WEBPACK_IMPORTED_MODULE_10__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_10__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_10__.Njj(ctx_r1.activeModal.close())}),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(6,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(7,"\xd7"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()()(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(8,"div",6)(9,"p",7)(10,"strong"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(11),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(12,SubscriptionModalComponent_form_0_span_12_Template,2,1,"span",8),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(13,"div"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(14,SubscriptionModalComponent_form_0_fieldset_14_Template,8,7,"fieldset",9),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(15,"keyvalue"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(16,SubscriptionModalComponent_form_0_p_16_Template,3,3,"p",10),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(17,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(18,"div",11)(19,"button",12),_angular_core__WEBPACK_IMPORTED_MODULE_10__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_10__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_10__.Njj(ctx_r1.activeModal.close())}),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(20),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(21,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(22,"button",13),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(23,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(24,SubscriptionModalComponent_form_0_span_24_Template,4,3,"span",14),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(25,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(26,SubscriptionModalComponent_form_0_span_26_Template,3,3,"span",14),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(27,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()()()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("formGroup",ctx_r1.subscriptionForm),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(4,10,"subscriptions.modal.title")),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(8),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(ctx_r1.dsoNameService.getName(ctx_r1.dso)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!!ctx_r1.dso),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngForOf",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(15,12,null==ctx_r1.subscriptionForm?null:ctx_r1.subscriptionForm.controls)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(17,14,ctx_r1.showDeleteInfo$)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(21,16,"subscriptions.modal.close")," "),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("disabled",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(23,18,ctx_r1.processing$)||!ctx_r1.isValid),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(25,20,ctx_r1.processing$)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!0!==_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(27,22,ctx_r1.processing$))}}let SubscriptionModalComponent=(()=>{class SubscriptionModalComponent2{constructor(formBuilder,modalService,notificationsService,subscriptionService,activeModal,authService,translate,dsoNameService){this.formBuilder=formBuilder,this.modalService=modalService,this.notificationsService=notificationsService,this.subscriptionService=subscriptionService,this.activeModal=activeModal,this.authService=authService,this.translate=translate,this.dsoNameService=dsoNameService,this.processing$=new rxjs__WEBPACK_IMPORTED_MODULE_11__.BehaviorSubject(!1),this.showDeleteInfo$=new rxjs__WEBPACK_IMPORTED_MODULE_11__.BehaviorSubject(!1),this.submitted=!1,this.subscriptionDefaultTypes=["content"],this.frequencyDefaultValues=["D","W","M"],this.isValid=!1,this.updateSubscription=new _angular_core__WEBPACK_IMPORTED_MODULE_10__.bkB}ngOnInit(){this.authService.getAuthenticatedUserFromStore().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.Tj)(ePerson=>ePerson.uuid),(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.shareReplay)({refCount:!1})).subscribe(ePersonId=>{this.ePersonId=ePersonId,(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(this.subscription)?this.initFormByGivenSubscription():this.initFormByAllSubscriptions()}),this.subscriptionForm.valueChanges.subscribe(newValue=>{let anyFrequencySelected=!1;for(const f of this.frequencyDefaultValues)anyFrequencySelected=anyFrequencySelected||newValue.content.frequencies[f];this.isValid=anyFrequencySelected})}initFormByAllSubscriptions(){this.subscriptionForm=new _angular_forms__WEBPACK_IMPORTED_MODULE_14__.J3({});for(const t of this.subscriptionDefaultTypes){const formGroup=new _angular_forms__WEBPACK_IMPORTED_MODULE_14__.J3({});formGroup.addControl("subscriptionId",this.formBuilder.control("")),formGroup.addControl("frequencies",this.formBuilder.group({}));for(const f of this.frequencyDefaultValues)formGroup.controls.frequencies.addControl(f,this.formBuilder.control(!1));this.subscriptionForm.addControl(t,formGroup)}this.initFormDataBySubscriptions()}initFormByGivenSubscription(){const formGroup=new _angular_forms__WEBPACK_IMPORTED_MODULE_14__.J3({});formGroup.addControl("subscriptionId",this.formBuilder.control(this.subscription.id)),formGroup.addControl("frequencies",this.formBuilder.group({})),formGroup.get("frequencies").addValidators(_angular_forms__WEBPACK_IMPORTED_MODULE_14__.k0.required);for(const f of this.frequencyDefaultValues){const value=-1!==lodash_findIndex__WEBPACK_IMPORTED_MODULE_0___default()(this.subscription.subscriptionParameterList,["value",f]);formGroup.controls.frequencies.addControl(f,this.formBuilder.control(value))}this.subscriptionForm=this.formBuilder.group({[this.subscription.subscriptionType]:formGroup})}initFormDataBySubscriptions(){this.processing$.next(!0),this.subscriptionService.getSubscriptionsByPersonDSO(this.ePersonId,this.dso?.uuid).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)()).subscribe({next:res=>{if(res.pageInfo.totalElements>0){this.showDeleteInfo$.next(!0);for(const subscription of res.page){const subscriptionGroup=this.subscriptionForm.get(subscription.subscriptionType);if((0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionGroup)){subscriptionGroup.controls.subscriptionId.setValue(subscription.id);for(const parameter of subscription.subscriptionParameterList.filter(p=>"frequency"===p.name))subscriptionGroup.controls.frequencies.controls[parameter.value]?.setValue(!0)}}}this.processing$.next(!1)},error:err=>{this.processing$.next(!1)}})}submit(){this.submitted=!0;const subscriptionTypes=Object.keys(this.subscriptionForm.controls),subscriptionsToBeCreated=[],subscriptionsToBeUpdated=[];subscriptionTypes.forEach(subscriptionType=>{const subscriptionGroup=this.subscriptionForm.controls[subscriptionType];if(subscriptionGroup.touched&&subscriptionGroup.dirty){const body=this.createBody(subscriptionGroup.controls.subscriptionId.value,subscriptionType,subscriptionGroup.controls.frequencies);(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(body.id)?subscriptionsToBeUpdated.push(body):(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(body.subscriptionParameterList)&&subscriptionsToBeCreated.push(body)}});const toBeProcessed=[];(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionsToBeCreated)&&toBeProcessed.push((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.from)(subscriptionsToBeCreated).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.ZZ)(subscriptionBody=>this.subscriptionService.createSubscription(subscriptionBody,this.ePersonId,this.dso.uuid).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)())),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.Mi)(res=>{if(res.hasSucceeded){const msg=this.translate.instant("subscriptions.modal.create.success",{type:res.payload.subscriptionType});this.notificationsService.success(null,msg)}else this.notificationsService.error(null,this.translate.instant("subscriptions.modal.create.error"))}))),(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionsToBeUpdated)&&toBeProcessed.push((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.from)(subscriptionsToBeUpdated).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.ZZ)(subscriptionBody=>this.subscriptionService.updateSubscription(subscriptionBody,this.ePersonId,this.dso.uuid).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)())),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.Mi)(res=>{if(res.hasSucceeded){const msg=this.translate.instant("subscriptions.modal.update.success",{type:res.payload.subscriptionType});this.notificationsService.success(null,msg),(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(this.subscription)&&this.updateSubscription.emit(res.payload)}else this.notificationsService.error(null,this.translate.instant("subscriptions.modal.update.error"))}))),(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.combineLatest)([...toBeProcessed]).subscribe(res=>{this.activeModal.close()})}createBody(subscriptionId,subscriptionType,frequencies){const body={id:(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionId)?subscriptionId:null,subscriptionType,subscriptionParameterList:[]};for(const frequency of this.frequencyDefaultValues)frequencies.value[frequency]&&body.subscriptionParameterList.push({name:"frequency",value:frequency});return body}static#_=this.\u0275fac=function(t){return new(t||SubscriptionModalComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_angular_forms__WEBPACK_IMPORTED_MODULE_14__.ze),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_15__.Bq),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_6__.I),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_subscriptions_data_service__WEBPACK_IMPORTED_MODULE_9__.SubscriptionsDataService),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_15__.Lw),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_core_auth_auth_service__WEBPACK_IMPORTED_MODULE_1__.uR),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_2__.f))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_10__.VBU({type:SubscriptionModalComponent2,selectors:[["ds-subscription-modal"]],inputs:{dso:"dso",subscription:"subscription"},outputs:{updateSubscription:"updateSubscription"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_10__.aNF],decls:1,vars:1,consts:[["data-test","subscription-form",3,"formGroup","ngSubmit",4,"ngIf"],["data-test","subscription-form",3,"ngSubmit","formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"mb-3"],["class","float-right",4,"ngIf"],["class","form-group form-row",3,"formGroupName",4,"ngFor","ngForOf"],["class","text-muted",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"disabled"],[4,"ngIf"],[1,"float-right"],[3,"object",4,"ngIf"],[3,"object"],[1,"form-group","form-row",3,"formGroupName"],[1,"col-md-4","col-form-label","float-md-left","pt-0"],[1,"col-md-8"],["type","hidden","formControlName","subscriptionId",3,"value"],["class","form-check","formGroupName","frequencies",4,"ngFor","ngForOf"],[3,"type",4,"ngIf"],["formGroupName","frequencies",1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","formControlName"],[1,"form-check-label",3,"for"],[3,"type"],[1,"text-muted"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(0,SubscriptionModalComponent_form_0_Template,28,24,"form",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",ctx.subscriptionForm)},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_17__.bT,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.qT,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.Zm,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.BC,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.cb,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.X1,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.j4,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.JD,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.$R,_object_collection_shared_badges_type_badge_themed_type_badge_component__WEBPACK_IMPORTED_MODULE_7__.C,_angular_common__WEBPACK_IMPORTED_MODULE_17__.pM,_alert_alert_component__WEBPACK_IMPORTED_MODULE_5__.C,_angular_common__WEBPACK_IMPORTED_MODULE_17__.Jj,_angular_common__WEBPACK_IMPORTED_MODULE_17__.lG,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__.D9]})}return SubscriptionModalComponent2})()},18870:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SubscriptionsDataService:()=>SubscriptionsDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(10743),src_app_core_shared_request_operators__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(59499),_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(91735),_core_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(57699),_core_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_core_data_base_delete_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(43626),_core_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68134),_core_data_base_search_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(19399),_core_data_dso_change_analyzer_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(60279),_core_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(97570),_core_data_request_models__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(87457),_core_data_request_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(72744),_core_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(91365),_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(82656),_empty_util__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(77028),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(10117),_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(32181),_angular_core__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(68014),_angular_common_http__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(38068),_ngrx_store__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(5136);let SubscriptionsDataService=(()=>{class SubscriptionsDataService2 extends _core_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_4__.W{constructor(comparator,http,notificationsService,requestService,rdbService,store,objectCache,halService,nameService){super("subscriptions",requestService,rdbService,objectCache,halService),this.comparator=comparator,this.http=http,this.notificationsService=notificationsService,this.requestService=requestService,this.rdbService=rdbService,this.store=store,this.objectCache=objectCache,this.halService=halService,this.nameService=nameService,this.findByEpersonLinkPath="findByEPerson",this.searchData=new _core_data_base_search_data__WEBPACK_IMPORTED_MODULE_5__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _core_data_base_delete_data__WEBPACK_IMPORTED_MODULE_3__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint)}getSubscriptionsByPersonDSO(eperson,uuid){const optionsWithObject=Object.assign(new _core_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_12__._,{searchParams:[new _core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__.x("resource",uuid),new _core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__.x("eperson_id",eperson)]});return this.searchData.searchBy("findByEPersonAndDso",optionsWithObject,!1,!0)}createSubscription(subscription,ePerson,uuid){return this.halService.getEndpoint(this.linkPath).pipe((0,_empty_util__WEBPACK_IMPORTED_MODULE_14__.VT)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointUrl=>`${endpointUrl}?resource=${uuid}&eperson_id=${ePerson}`),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointURL=>new _core_data_request_models__WEBPACK_IMPORTED_MODULE_7__.QU(this.requestService.generateRequestId(),endpointURL,JSON.stringify(subscription))),(0,src_app_core_shared_request_operators__WEBPACK_IMPORTED_MODULE_16__.w$)(this.requestService),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(restRequest=>this.rdbService.buildFromRequestUUID(restRequest.uuid)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.qD)())}updateSubscription(subscription,ePerson,uuid){return this.halService.getEndpoint(this.linkPath).pipe((0,_empty_util__WEBPACK_IMPORTED_MODULE_14__.VT)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointUrl=>`${endpointUrl}/${subscription.id}?resource=${uuid}&eperson_id=${ePerson}`),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointURL=>new _core_data_request_models__WEBPACK_IMPORTED_MODULE_7__.v_(this.requestService.generateRequestId(),endpointURL,JSON.stringify(subscription))),(0,src_app_core_shared_request_operators__WEBPACK_IMPORTED_MODULE_16__.w$)(this.requestService),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(restRequest=>this.rdbService.buildFromRequestUUID(restRequest.uuid)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.qD)())}deleteSubscription(id){return this.halService.getEndpoint(this.linkPath).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.pb)(href=>(0,_empty_util__WEBPACK_IMPORTED_MODULE_14__.hj)(href)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.F)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(endpointUrl=>this.deleteData.delete(id)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.qD)())}findAllSubscriptions(options){return this.findAllData.findAll(options,!0,!0,(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("resource"),(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("eperson"))}findByEPerson(ePersonId,options){const optionsWithObject=Object.assign(new _core_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_12__._,options,{searchParams:[new _core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__.x("uuid",ePersonId)]});return this.getEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(href=>`${href}/search/${this.findByEpersonLinkPath}`),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(href=>this.findListByHref(href,optionsWithObject,!1,!0,(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("resource"),(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("eperson"))))}static#_=this.\u0275fac=function(t){return new(t||SubscriptionsDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_data_dso_change_analyzer_service__WEBPACK_IMPORTED_MODULE_6__.j),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_angular_common_http__WEBPACK_IMPORTED_MODULE_19__.Qq),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_11__.I),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_data_request_service__WEBPACK_IMPORTED_MODULE_8__.B),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_20__.il),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_9__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__.f))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_18__.jDH({token:SubscriptionsDataService2,factory:SubscriptionsDataService2.\u0275fac,providedIn:"root"})}return SubscriptionsDataService2})()}};