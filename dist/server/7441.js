"use strict";exports.id=7441,exports.ids=[7441],exports.modules={37441:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ProcessDataService:()=>ProcessDataService,TIMER_FACTORY:()=>TIMER_FACTORY});var _angular_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(68014),rxjs_operators__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(10743),src_app_process_page_processes_process_status_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(19896),_shared_empty_util__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(77028),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10117),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(86786),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(40017),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(91365),_shared_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(82656),_base_delete_data__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(43626),_base_find_all_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(89480),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(68134),_base_search_data__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(19399),_bitstream_data_service__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(36505),_request_service__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(72744);const TIMER_FACTORY=new _angular_core__WEBPACK_IMPORTED_MODULE_12__.nKC("timer",{providedIn:"root",factory:()=>setTimeout});let ProcessDataService=(()=>{class ProcessDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_8__.W{constructor(requestService,rdbService,objectCache,halService,bitstreamDataService,notificationsService,zone,timer){super("processes",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.bitstreamDataService=bitstreamDataService,this.notificationsService=notificationsService,this.zone=zone,this.timer=timer,this.activelyBeingPolled=new Map,this.subs=new Map,this.findAllData=new _base_find_all_data__WEBPACK_IMPORTED_MODULE_7__.H(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _base_delete_data__WEBPACK_IMPORTED_MODULE_6__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint),this.searchData=new _base_search_data__WEBPACK_IMPORTED_MODULE_9__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive)}static statusIs(process,status){return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_13__.a4)(process)&&process.processStatus===status}static hasCompletedOrFailed(process){return ProcessDataService2.statusIs(process,src_app_process_page_processes_process_status_model__WEBPACK_IMPORTED_MODULE_0__.K.COMPLETED)||ProcessDataService2.statusIs(process,src_app_process_page_processes_process_status_model__WEBPACK_IMPORTED_MODULE_0__.K.FAILED)}getFilesEndpoint(processId){return this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.nx)(href=>this.halService.getEndpoint("files",`${href}/${processId}`)))}getFiles(processId){const href$=this.getFilesEndpoint(processId);return this.bitstreamDataService.findListByHref(href$)}findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.findAllData.findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.searchData.searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}autoRefreshingSearchBy(id,searchMethod,options,pollingIntervalInMs=5e3,...linksToFollow){const result$=this.searchBy(searchMethod,options,!0,!0,...linksToFollow).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_5__.bD)()),sub=result$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.pb)(()=>!this.activelyBeingPolled.has(id))).subscribe(processListRd=>{this.clearCurrentTimeout(id);const nextTimeout=this.timer(()=>{this.activelyBeingPolled.delete(id),this.requestService.setStaleByHrefSubstring(processListRd.payload._links.self.href)},pollingIntervalInMs);this.activelyBeingPolled.set(id,nextTimeout)});return this.subs.set(id,sub),result$}stopAutoRefreshing(id){this.clearCurrentTimeout(id),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_13__.a4)(this.subs.get(id))&&(this.subs.get(id).unsubscribe(),this.subs.delete(id))}delete(objectId,copyVirtualMetadata){return this.deleteData.delete(objectId,copyVirtualMetadata)}deleteByHref(href,copyVirtualMetadata){return this.deleteData.deleteByHref(href,copyVirtualMetadata)}clearCurrentTimeout(id){const timeout=this.activelyBeingPolled.get(id);(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_13__.a4)(timeout)&&clearTimeout(timeout),this.activelyBeingPolled.delete(id)}autoRefreshUntilCompletion(processId,pollingIntervalInMs=5e3,...linksToFollow){const process$=this.findById(processId,!0,!0,...linksToFollow).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_5__.bD)()),sub=process$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.pb)(processRD=>!ProcessDataService2.hasCompletedOrFailed(processRD.payload)&&!this.activelyBeingPolled.has(processId))).subscribe(processRD=>{if(this.clearCurrentTimeout(processId),processRD.hasSucceeded){const nextTimeout=this.timer(()=>{this.activelyBeingPolled.delete(processId),this.invalidateByHref(processRD.payload._links.self.href)},pollingIntervalInMs);this.activelyBeingPolled.set(processId,nextTimeout)}});return this.subs.set(processId,sub),process$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.I6)(processRD=>ProcessDataService2.hasCompletedOrFailed(processRD.payload))).subscribe(()=>{this.stopAutoRefreshing(processId)}),process$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.F)((previous,current)=>previous.payload?.processStatus===current.payload?.processStatus))}static#_=this.\u0275fac=function(t){return new(t||ProcessDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_11__.B),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_2__.o),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_3__.$),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_4__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_bitstream_data_service__WEBPACK_IMPORTED_MODULE_10__.BitstreamDataService),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__.I),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_angular_core__WEBPACK_IMPORTED_MODULE_12__.SKi),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(TIMER_FACTORY))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_12__.jDH({token:ProcessDataService2,factory:ProcessDataService2.\u0275fac,providedIn:"root"})}return ProcessDataService2})()}};