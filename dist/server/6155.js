exports.id=6155,exports.ids=[6155,7094,1813,5592,5858,9779],exports.modules={21870:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>i18nBreadcrumbResolver});var core=__webpack_require__(68014),empty_util=__webpack_require__(77028),route_utils=__webpack_require__(39609),cjs=__webpack_require__(74785),breadcrumb_model=__webpack_require__(96622);let I18nBreadcrumbsService=(()=>{class I18nBreadcrumbsService2{getBreadcrumbs(key,url){return(0,cjs.of)([new breadcrumb_model.Q(key+".breadcrumbs",url)])}static#_=this.\u0275fac=function(t){return new(t||I18nBreadcrumbsService2)};static#_2=this.\u0275prov=core.jDH({token:I18nBreadcrumbsService2,factory:I18nBreadcrumbsService2.\u0275fac,providedIn:"root"})}return I18nBreadcrumbsService2})();const i18nBreadcrumbResolver=(route,state,breadcrumbService=(0,core.WQX)(I18nBreadcrumbsService))=>{const key=route.data.breadcrumbKey;if((0,empty_util.Tn)(key))throw new Error('You provided an i18nBreadcrumbResolver for url "'+route.url+"\" but no breadcrumbKey in the route's data");return{provider:breadcrumbService,key,url:(0,route_utils.F)(route)}}},47094:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BulkAccessConfigDataService:()=>BulkAccessConfigDataService});var _cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(86786),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(40017),_data_request_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72744),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(91365),_config_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(55686),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(68014);let BulkAccessConfigDataService=(()=>{class BulkAccessConfigDataService2 extends _config_data_service__WEBPACK_IMPORTED_MODULE_4__.O{constructor(requestService,rdbService,objectCache,halService){super("bulkaccessconditionoptions",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService}static#_=this.\u0275fac=function(t){return new(t||BulkAccessConfigDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_2__.B),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__.o),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__.$),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_5__.jDH({token:BulkAccessConfigDataService2,factory:BulkAccessConfigDataService2.\u0275fac,providedIn:"root"})}return BulkAccessConfigDataService2})()},55686:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>ConfigDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10743),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68134),_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(82656);class ConfigDataService extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__.W{findByHref(href,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findByHref(href,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.Tj)(rd=>{if(rd.hasFailed)throw new Error("Couldn't retrieve the config");return rd}))}findByName(name,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findById(name,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}}},29779:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IdentifierDataService:()=>IdentifierDataService});var _angular_common_http__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(38068),rxjs_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(10743),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10117),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(91365),_shared_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(82656),_shared_request_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(59499),_base_base_data_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4705),_configuration_data_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(44994),_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(84237),_request_models__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(87457),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(72744),_angular_core__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(68014),_ngrx_store__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(5136);let IdentifierDataService=(()=>{class IdentifierDataService2 extends _base_base_data_service__WEBPACK_IMPORTED_MODULE_5__.L{constructor(comparator,halService,http,notificationsService,objectCache,rdbService,requestService,store,configurationService){super("identifiers",requestService,rdbService,objectCache,halService),this.comparator=comparator,this.halService=halService,this.http=http,this.notificationsService=notificationsService,this.objectCache=objectCache,this.rdbService=rdbService,this.requestService=requestService,this.store=store,this.configurationService=configurationService}getIdentifierDataFor(item){return this.findByHref(item._links.identifiers.href,!1,!0)}getIdentifierRegistrationConfiguration(){return this.configurationService.findByPropertyName("identifiers.item-status.register-doi").pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.Tj)(propertyRD=>propertyRD.hasSucceeded?propertyRD.payload.values:[]))}registerIdentifier(item,type){const requestId=this.requestService.generateRequestId();return this.getEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.Tj)(endpointURL=>{const options=Object.create({});let headers=new _angular_common_http__WEBPACK_IMPORTED_MODULE_11__.Lr;headers=headers.append("Content-Type","text/uri-list"),options.headers=headers;let params=new _angular_common_http__WEBPACK_IMPORTED_MODULE_11__.Nl;return params=params.append("type",type),options.params=params,new _request_models__WEBPACK_IMPORTED_MODULE_8__.Qf(requestId,endpointURL,item._links.self.href,options)}),(0,_shared_request_operators__WEBPACK_IMPORTED_MODULE_12__.w$)(this.requestService),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.nx)(request=>this.rdbService.buildFromRequestUUID(request.uuid)))}static#_=this.\u0275fac=function(t){return new(t||IdentifierDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_7__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_angular_common_http__WEBPACK_IMPORTED_MODULE_11__.Qq),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_14__.il),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_configuration_data_service__WEBPACK_IMPORTED_MODULE_6__.ConfigurationDataService))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_13__.jDH({token:IdentifierDataService2,factory:IdentifierDataService2.\u0275fac,providedIn:"root"})}return IdentifierDataService2})()},55858:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MetadataFieldDataService:()=>MetadataFieldDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(10743),_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(77028),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10117),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(57699),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(91365),_base_create_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(85311),_base_delete_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(43626),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(68134),_base_put_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(64034),_base_search_data__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(19399),_find_list_options_model__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(97570),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(72744),_angular_core__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(68014);let MetadataFieldDataService=(()=>{class MetadataFieldDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_6__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService){super("metadatafields",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.searchBySchemaLinkPath="bySchema",this.searchByFieldNameLinkPath="byFieldName",this.createData=new _base_create_data__WEBPACK_IMPORTED_MODULE_4__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.searchData=new _base_search_data__WEBPACK_IMPORTED_MODULE_8__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.putData=new _base_put_data__WEBPACK_IMPORTED_MODULE_7__.W(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _base_delete_data__WEBPACK_IMPORTED_MODULE_5__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint)}findBySchema(schema,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const optionsWithSchema=Object.assign(new _find_list_options_model__WEBPACK_IMPORTED_MODULE_10__._,options,{searchParams:[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("schema",schema.prefix)]});return this.searchBy(this.searchBySchemaLinkPath,optionsWithSchema,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchByFieldNameParams(schema,element,qualifier,query,exactName,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const optionParams=Object.assign(new _find_list_options_model__WEBPACK_IMPORTED_MODULE_10__._,options,{searchParams:[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("schema",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(schema)?schema:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("element",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(element)?element:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("qualifier",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(qualifier)?qualifier:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("query",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(query)?query:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("exactName",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(exactName)?exactName:"")]});return this.searchBy(this.searchByFieldNameLinkPath,optionParams,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}findByExactFieldName(exactFieldName){return this.searchByFieldNameParams(null,null,null,null,exactFieldName,null)}clearRequests(){this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.s)(1)).subscribe(href=>{this.requestService.setStaleByHrefSubstring(href)})}delete(objectId,copyVirtualMetadata){return this.deleteData.delete(objectId,copyVirtualMetadata)}deleteByHref(href,copyVirtualMetadata){return this.deleteData.deleteByHref(href,copyVirtualMetadata)}put(object){return this.putData.put(object)}create(object,...params){return this.createData.create(object,...params)}searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.searchData.searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}static#_=this.\u0275fac=function(t){return new(t||MetadataFieldDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_14__.jDH({token:MetadataFieldDataService2,factory:MetadataFieldDataService2.\u0275fac,providedIn:"root"})}return MetadataFieldDataService2})()},21813:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MetadataSchemaDataService:()=>MetadataSchemaDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(10743),_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(77028),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10117),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(91365),_base_create_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(85311),_base_delete_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(43626),_base_find_all_data__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(89480),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(68134),_base_put_data__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(64034),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(72744),_angular_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(68014);let MetadataSchemaDataService=(()=>{class MetadataSchemaDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_7__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService){super("metadataschemas",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.createData=new _base_create_data__WEBPACK_IMPORTED_MODULE_4__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.putData=new _base_put_data__WEBPACK_IMPORTED_MODULE_8__.W(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _base_delete_data__WEBPACK_IMPORTED_MODULE_5__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint),this.findAllData=new _base_find_all_data__WEBPACK_IMPORTED_MODULE_6__.H(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive)}createOrUpdateMetadataSchema(schema){return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__.a4)(schema.id)?this.putData.put(schema):this.createData.create(schema)}clearRequests(){return this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.Mi)(href=>this.requestService.removeByHrefSubstring(href)))}findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.findAllData.findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}delete(objectId,copyVirtualMetadata){return this.deleteData.delete(objectId,copyVirtualMetadata)}deleteByHref(href,copyVirtualMetadata){return this.deleteData.deleteByHref(href,copyVirtualMetadata)}static#_=this.\u0275fac=function(t){return new(t||MetadataSchemaDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_12__.jDH({token:MetadataSchemaDataService2,factory:MetadataSchemaDataService2.\u0275fac,providedIn:"root"})}return MetadataSchemaDataService2})()},6440:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>ObjectUpdatesService});var _ngrx_store__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5136),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(10743),_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(77028),_core_selectors__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(33768),_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39464),_object_updates_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10072),_object_updates_reducer__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(51087),_angular_core__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(68014);function filterByUrlObjectUpdatesStateSelector(url){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(function objectUpdatesStateSelector(){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(_core_selectors__WEBPACK_IMPORTED_MODULE_0__.N,state=>state["cache/object-updates"])}(),state=>state[url])}let ObjectUpdatesService=(()=>{class ObjectUpdatesService2{constructor(store,injector){this.store=store,this.injector=injector}initialize(url,fields,lastModified,patchOperationService){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.g$(url,fields,lastModified,patchOperationService))}saveFieldUpdate(url,field,changeType){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.XO(url,field,changeType))}getObjectEntry(url){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Lt)(filterByUrlObjectUpdatesStateSelector(url)))}getFieldState(url,uuid){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Lt)(function filterByUrlAndUUIDFieldStateSelector(url,uuid){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(filterByUrlObjectUpdatesStateSelector(url),state=>state.fieldStates[uuid])}(url,uuid)))}getFieldUpdates(url,initialFields,ignoreStates){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.nx)(objectEntry=>{const fieldUpdates={};return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(objectEntry)&&Object.keys(ignoreStates?objectEntry.fieldUpdates:objectEntry.fieldStates).forEach(uuid=>{fieldUpdates[uuid]=objectEntry.fieldUpdates[uuid]}),this.getFieldUpdatesExclusive(url,initialFields).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(fieldUpdatesExclusive=>(Object.keys(fieldUpdatesExclusive).forEach(uuid=>{fieldUpdates[uuid]=fieldUpdatesExclusive[uuid]}),fieldUpdates)))}))}getFieldUpdatesExclusive(url,initialFields){return this.getObjectEntry(url).pipe((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(objectEntry=>{const fieldUpdates={};for(const object of initialFields){let fieldUpdate=objectEntry.fieldUpdates[object.uuid];(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.Im)(fieldUpdate)&&(fieldUpdate={field:object,changeType:void 0}),fieldUpdates[object.uuid]=fieldUpdate}return fieldUpdates}))}isEditable(url,uuid){return this.getFieldState(url,uuid).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldState=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(fieldState)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(fieldState=>fieldState.editable),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.F)())}isValid(url,uuid){return this.getFieldState(url,uuid).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldState=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(fieldState)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(fieldState=>fieldState.isValid),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.F)())}isValidPage(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(entry=>Object.values(entry.fieldStates).findIndex(state=>!state.isValid)<0),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.F)())}saveAddFieldUpdate(url,field){const update$=this.getFieldUpdatesExclusive(url,[field]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldUpdates=>fieldUpdates[field.uuid].changeType===_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.ADD),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(()=>!0));return this.saveFieldUpdate(url,field,_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.ADD),update$}saveRemoveFieldUpdate(url,field){const update$=this.getFieldUpdatesExclusive(url,[field]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldUpdates=>fieldUpdates[field.uuid].changeType===_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.REMOVE),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(()=>!0));return this.saveFieldUpdate(url,field,_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.REMOVE),update$}saveChangeFieldUpdate(url,field){this.saveFieldUpdate(url,field,_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.UPDATE)}isSelectedVirtualMetadata(url,relationship,item){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Lt)(function virtualMetadataSourceSelector(url,source){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(filterByUrlObjectUpdatesStateSelector(url),state=>state.virtualMetadataSources[source])}(url,relationship)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(virtualMetadataSource=>virtualMetadataSource&&virtualMetadataSource[item]))}setSelectedVirtualMetadata(url,relationship,uuid,selected){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.nY(url,relationship,uuid,selected))}setEditableFieldUpdate(url,uuid,editable){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.KD(url,uuid,editable))}setValidFieldUpdate(url,uuid,valid){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.wS(url,uuid,valid))}discardFieldUpdates(url,undoNotification){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.Y8(url,undoNotification))}discardAllFieldUpdates(url,undoNotification){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.Y8(url,undoNotification,!0))}reinstateFieldUpdates(url){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.jX(url))}removeSingleFieldUpdate(url,uuid){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.mW(url,uuid))}getUpdatedFields(url,initialFields){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(objectEntry=>{const fields=[];return Object.keys(objectEntry.fieldStates).forEach(uuid=>{const fieldUpdate=objectEntry.fieldUpdates[uuid];if((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.Tn)(fieldUpdate)||fieldUpdate.changeType!==_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.REMOVE){let field;field=(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.hj)(fieldUpdate)?fieldUpdate.field:initialFields.find(object=>object.uuid===uuid),fields.push(field)}}),fields}))}hasUpdates(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(objectEntry=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(objectEntry)&&(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.hj)(objectEntry.fieldUpdates)))}isReinstatable(url){return this.hasUpdates(url+_object_updates_reducer__WEBPACK_IMPORTED_MODULE_3__.U)}getLastModified(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(entry=>entry.lastModified))}createPatch(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(entry=>{let patch=[];return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(entry.patchOperationService)&&(patch=this.injector.get(entry.patchOperationService).fieldUpdatesToPatchOperations(entry.fieldUpdates)),patch}))}static#_=this.\u0275fac=function(t){return new(t||ObjectUpdatesService2)(_angular_core__WEBPACK_IMPORTED_MODULE_7__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.il),_angular_core__WEBPACK_IMPORTED_MODULE_7__.KVO(_angular_core__WEBPACK_IMPORTED_MODULE_7__.zZn))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_7__.jDH({token:ObjectUpdatesService2,factory:ObjectUpdatesService2.\u0275fac,providedIn:"root"})}return ObjectUpdatesService2})()},10893:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{x:()=>RegistryService});var _ngrx_store__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(5136),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(10743),_admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34167),_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(77028),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10117),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(57699),_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(97570),_data_metadata_field_data_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(55858),_data_metadata_schema_data_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(21813),_shared_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(82656),_angular_core__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(68014),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(43750);const metadataRegistryStateSelector=state=>state.metadataRegistry,editMetadataSchemaSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.editSchema),selectedMetadataSchemasSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.selectedSchemas),editMetadataFieldSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.editField),selectedMetadataFieldsSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.selectedFields);let RegistryService=(()=>{class RegistryService2{constructor(store,notificationsService,translateService,metadataSchemaService,metadataFieldService){this.store=store,this.notificationsService=notificationsService,this.translateService=translateService,this.metadataSchemaService=metadataSchemaService,this.metadataFieldService=metadataFieldService}getMetadataSchemas(options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return this.metadataSchemaService.findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}getMetadataSchemaByPrefix(prefix,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=Object.assign(new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_6__._,{elementsPerPage:1e4});return this.getMetadataSchemas(options).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Tj)(schemas=>schemas.page),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.VT)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Tj)(schemas=>schemas.filter(schema=>schema.prefix===prefix)[0]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.ZZ)(schema=>this.metadataSchemaService.findById(`${schema.id}`,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)))}getMetadataFieldsBySchema(schema,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return this.metadataFieldService.findBySchema(schema,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}editMetadataSchema(schema){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.w2(schema))}cancelEditMetadataSchema(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Wi)}getActiveMetadataSchema(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(editMetadataSchemaSelector))}selectMetadataSchema(schema){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Q6(schema))}deselectMetadataSchema(schema){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.zn(schema))}deselectAllMetadataSchema(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Gr)}getSelectedMetadataSchemas(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(selectedMetadataSchemasSelector))}editMetadataField(field){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.dF(field))}cancelEditMetadataField(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Tf)}getActiveMetadataField(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(editMetadataFieldSelector))}selectMetadataField(field){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.jC(field))}deselectMetadataField(field){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.yb(field))}deselectAllMetadataField(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.TE)}getSelectedMetadataFields(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(selectedMetadataFieldsSelector))}createOrUpdateMetadataSchema(schema){const isUpdate=(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.a4)(schema.id);return this.metadataSchemaService.createOrUpdateMetadataSchema(schema).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Mi)(()=>{this.showNotifications(!0,isUpdate,!1,{prefix:schema.prefix})}))}deleteMetadataSchema(id){return this.metadataSchemaService.delete(`${id}`)}clearMetadataSchemaRequests(){return this.metadataSchemaService.clearRequests()}createMetadataField(field,schema){return field.qualifier||(field.qualifier=null),this.metadataFieldService.create(field,new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_9__.x("schemaId",schema.id)).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Mi)(()=>{this.showNotifications(!0,!1,!0,{field:field.toString()})}))}updateMetadataField(field){return field.qualifier||(field.qualifier=null),this.metadataFieldService.put(field).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Mi)(()=>{this.showNotifications(!0,!0,!0,{field:field.toString()})}))}deleteMetadataField(id){return this.metadataFieldService.delete(`${id}`)}clearMetadataFieldRequests(){this.metadataFieldService.clearRequests()}showNotifications(success,edited,isField,options){const prefix="admin.registries.schema.notification",editedString=edited?"edited":"created";(0,rxjs__WEBPACK_IMPORTED_MODULE_10__.combineLatest)(this.translateService.get(`${prefix}.${success?"success":"failure"}`),this.translateService.get(`${prefix}${isField?".field":""}.${editedString}`,options)).subscribe(([head,content])=>{success?this.notificationsService.success(head,content):this.notificationsService.error(head,content)})}queryMetadataFields(query,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return this.metadataFieldService.searchByFieldNameParams(null,null,null,query,null,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}static#_=this.\u0275fac=function(t){return new(t||RegistryService2)(_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.il),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__.I),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_12__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_data_metadata_schema_data_service__WEBPACK_IMPORTED_MODULE_3__.MetadataSchemaDataService),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_data_metadata_field_data_service__WEBPACK_IMPORTED_MODULE_2__.MetadataFieldDataService))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_11__.jDH({token:RegistryService2,factory:RegistryService2.\u0275fac,providedIn:"root"})}return RegistryService2})()},55592:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ResourcePolicyDataService:()=>ResourcePolicyDataService});var _angular_common_http__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(38068),rxjs_operators__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(10743),_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(77028),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10117),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(57699),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_data_base_create_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(85311),_data_base_delete_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(43626),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(68134),_data_base_patch_data__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(75467),_data_base_search_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(19399),_data_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(84237),_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(97570),_data_request_models__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(87457),_data_request_service__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(72744),_data_status_code_only_response_parsing_service__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(36191),_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(62120),_eperson_group_data_service__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(97195),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(91365),_shared_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(82656),_angular_core__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(68014);let ResourcePolicyDataService=(()=>{class ResourcePolicyDataService2 extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService,comparator,ePersonService,groupService){super("resourcepolicies",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.comparator=comparator,this.ePersonService=ePersonService,this.groupService=groupService,this.searchByEPersonMethod="eperson",this.searchByGroupMethod="group",this.searchByResourceMethod="resource",this.createData=new _data_base_create_data__WEBPACK_IMPORTED_MODULE_3__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.searchData=new _data_base_search_data__WEBPACK_IMPORTED_MODULE_7__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.patchData=new _data_base_patch_data__WEBPACK_IMPORTED_MODULE_6__.n(this.linkPath,requestService,rdbService,objectCache,halService,comparator,this.responseMsToLive,this.constructIdEndpoint),this.deleteData=new _data_base_delete_data__WEBPACK_IMPORTED_MODULE_4__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint)}create(resourcePolicy,resourceUUID,epersonUUID,groupUUID){const params=[];return params.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("resource",resourceUUID)),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(epersonUUID)?params.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("eperson",epersonUUID)):(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(groupUUID)&&params.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("group",groupUUID)),this.createData.create(resourcePolicy,...params)}delete(resourcePolicyID){return this.deleteData.delete(resourcePolicyID).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_15__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.Tj)(response=>response.hasSucceeded))}update(object){return this.patchData.update(object)}getDefaultAccessConditionsFor(collection,findListOptions){return this.findListByHref(collection._links.defaultAccessConditions.href,findListOptions)}searchByEPerson(UUID,resourceUUID,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("uuid",UUID)],(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(resourceUUID)&&options.searchParams.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("resource",resourceUUID)),this.searchData.searchBy(this.searchByEPersonMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchByGroup(UUID,resourceUUID,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("uuid",UUID)],(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(resourceUUID)&&options.searchParams.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("resource",resourceUUID)),this.searchData.searchBy(this.searchByGroupMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchByResource(UUID,action,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("uuid",UUID)],(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(action)&&options.searchParams.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("action",action)),this.searchData.searchBy(this.searchByResourceMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}updateTarget(resourcePolicyId,resourcePolicyHref,targetUUID,targetType){const targetEndpoint$=("eperson"===targetType?this.ePersonService:this.groupService).getIDHrefObs(targetUUID),options=Object.create({});let headers=new _angular_common_http__WEBPACK_IMPORTED_MODULE_20__.Lr;headers=headers.append("Content-Type","text/uri-list"),options.headers=headers;const requestId=this.requestService.generateRequestId();return targetEndpoint$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.$1)()).subscribe(targetEndpoint=>{const request=new _data_request_models__WEBPACK_IMPORTED_MODULE_9__.v_(requestId,resourcePolicyHref+"/"+targetType,targetEndpoint,options);Object.assign(request,{getResponseParser:()=>_data_status_code_only_response_parsing_service__WEBPACK_IMPORTED_MODULE_11__.M}),this.requestService.send(request)}),this.rdbService.buildFromRequestUUIDAndAwait(requestId,()=>this.invalidateByHref(resourcePolicyHref))}static#_=this.\u0275fac=function(t){return new(t||ResourcePolicyDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_10__.B),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_14__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_data_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_8__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_12__.EPersonDataService),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_eperson_group_data_service__WEBPACK_IMPORTED_MODULE_13__.GroupDataService))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_21__.jDH({token:ResourcePolicyDataService2,factory:ResourcePolicyDataService2.\u0275fac,providedIn:"root"})}return ResourcePolicyDataService2})()},50797:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{X:()=>CurationFormComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(84739),_angular_forms__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(28955),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(43750),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(10743),_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(44994),_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(54257),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(82656),_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(33549),_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(77028),_shared_handle_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(27382),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(10117),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(64247);function CurationFormComponent_option_8_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"option",9),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()),2&rf){const task_r1=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("value",task_r1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(2,2,"curation-task.task."+task_r1+".label")," ")}}function CurationFormComponent_div_9_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"div",3)(1,"label",10),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nrm(4,"input",11),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(5,"small",12),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(6),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(7,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(3,2,"curation.form.handle.label")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(7,4,"curation.form.handle.hint")))}let CurationFormComponent=(()=>{class CurationFormComponent2{constructor(scriptDataService,configurationDataService,notificationsService,translateService,handleService,router,cdr){this.scriptDataService=scriptDataService,this.configurationDataService=configurationDataService,this.notificationsService=notificationsService,this.translateService=translateService,this.handleService=handleService,this.router=router,this.cdr=cdr,this.subs=[]}ngOnDestroy(){this.subs.forEach(sub=>sub.unsubscribe())}ngOnInit(){this.form=new _angular_forms__WEBPACK_IMPORTED_MODULE_6__.J3({task:new _angular_forms__WEBPACK_IMPORTED_MODULE_6__.hs(""),handle:new _angular_forms__WEBPACK_IMPORTED_MODULE_6__.hs("")}),this.config=this.configurationDataService.findByPropertyName("plugin.named.org.dspace.curate.CurationTask"),this.subs.push(this.config.pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.ak)()).subscribe(configProperties=>{this.tasks=configProperties.values.filter(value=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.hj)(value)&&value.includes("=")).map(value=>value.split("=")[1].trim()),this.form.get("task").patchValue(this.tasks[0]),this.cdr.detectChanges()}))}hasHandleValue(){return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.a4)(this.dsoHandle)}submit(){const taskName=this.form.get("task").value;let handle$;handle$=this.hasHandleValue()?this.handleService.normalizeHandle(this.dsoHandle).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.Tj)(handle=>((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.Im)(handle)&&this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.invalid-handle")),handle))):this.handleService.normalizeHandle(this.form.get("handle").value).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.Tj)(handle=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.Im)(handle)?"all":handle)),this.subs.push(handle$.subscribe(handle=>{(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.a4)(handle)&&this.subs.push(this.scriptDataService.invoke("curate",[{name:"-t",value:taskName},{name:"-i",value:handle}],[]).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get("curation.form.submit.success.head"),this.translateService.get("curation.form.submit.success.content")),this.router.navigateByUrl((0,_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_9__.yJ)(rd.payload.processId))):this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.content"))}))}))}static#_=this.\u0275fac=function(t){return new(t||CurationFormComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_1__.ScriptDataService),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_0__.ConfigurationDataService),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_4__.I),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_shared_handle_service__WEBPACK_IMPORTED_MODULE_3__.e),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_11__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_5__.gRc))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_5__.VBU({type:CurationFormComponent2,selectors:[["ds-curation-form"]],inputs:{dsoHandle:"dsoHandle"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_5__.aNF],decls:13,vars:9,consts:[[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"row","mb-2"],[1,"col-12","col-sm-6"],["for","task",1,"font-weight-bold"],["id","task","formControlName","task",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","col-12 col-sm-6",4,"ngIf"],["type","submit",1,"btn","btn-default","btn-primary"],[3,"value"],["for","handle",1,"font-weight-bold"],["id","handle","formControlName","handle",1,"form-control"],[1,"text-muted"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"form",0),_angular_core__WEBPACK_IMPORTED_MODULE_5__.bIt("ngSubmit",function(){return ctx.submit()}),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(5),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(6,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(7,"select",5),_angular_core__WEBPACK_IMPORTED_MODULE_5__.DNE(8,CurationFormComponent_option_8_Template,3,4,"option",6),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.DNE(9,CurationFormComponent_div_9_Template,8,6,"div",7),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(10,"button",8),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(11),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(12,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("formGroup",ctx.form),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(5),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(6,5,"curation.form.task-select.label")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("ngForOf",ctx.tasks),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("ngIf",!ctx.hasHandleValue()),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(12,7,"curation.form.submit")))},dependencies:[_angular_forms__WEBPACK_IMPORTED_MODULE_6__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.qT,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.xH,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.y7,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.wz,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.BC,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.cb,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.X1,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.j4,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.JD,_angular_common__WEBPACK_IMPORTED_MODULE_12__.pM,_angular_common__WEBPACK_IMPORTED_MODULE_12__.bT,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.D9],encapsulation:2})}return CurationFormComponent2})()},91744:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{t:()=>DsoEditMetadataFieldValuesComponent});var _angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(23306),_angular_common__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(84739),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68014),_dso_edit_metadata_form__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__(48168),__webpack_require__(17533)),_dso_edit_metadata_value_dso_edit_metadata_value_component__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(36604),_dso_edit_metadata_value_headers_dso_edit_metadata_value_headers_component__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(91252);function DsoEditMetadataFieldValuesComponent_ds_dso_edit_metadata_value_4_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_3__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_3__.j41(0,"ds-dso-edit-metadata-value",3),_angular_core__WEBPACK_IMPORTED_MODULE_3__.bIt("edit",function(){const mdValue_r2=_angular_core__WEBPACK_IMPORTED_MODULE_3__.eBV(_r1).$implicit;return _angular_core__WEBPACK_IMPORTED_MODULE_3__.Njj(mdValue_r2.editing=!0)})("confirm",function($event){const mdValue_r2=_angular_core__WEBPACK_IMPORTED_MODULE_3__.eBV(_r1).$implicit,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_3__.XpG();return mdValue_r2.confirmChanges($event),ctx_r2.form.resetReinstatable(),_angular_core__WEBPACK_IMPORTED_MODULE_3__.Njj(ctx_r2.valueSaved.emit())})("remove",function(){const ctx_r3=_angular_core__WEBPACK_IMPORTED_MODULE_3__.eBV(_r1),mdValue_r2=ctx_r3.$implicit,idx_r5=ctx_r3.index,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_3__.XpG();return mdValue_r2.change===ctx_r2.DsoEditMetadataChangeTypeEnum.ADD?ctx_r2.form.remove(ctx_r2.mdField,idx_r5):mdValue_r2.change=ctx_r2.DsoEditMetadataChangeTypeEnum.REMOVE,ctx_r2.form.resetReinstatable(),_angular_core__WEBPACK_IMPORTED_MODULE_3__.Njj(ctx_r2.valueSaved.emit())})("undo",function(){const ctx_r5=_angular_core__WEBPACK_IMPORTED_MODULE_3__.eBV(_r1),mdValue_r2=ctx_r5.$implicit,idx_r5=ctx_r5.index,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_3__.XpG();return mdValue_r2.change===ctx_r2.DsoEditMetadataChangeTypeEnum.ADD?ctx_r2.form.remove(ctx_r2.mdField,idx_r5):mdValue_r2.discard(),_angular_core__WEBPACK_IMPORTED_MODULE_3__.Njj(ctx_r2.valueSaved.emit())})("dragging",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_3__.eBV(_r1);const ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_3__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_3__.Njj(ctx_r2.draggingMdField$.next($event?ctx_r2.mdField:null))}),_angular_core__WEBPACK_IMPORTED_MODULE_3__.k0s()}if(2&rf){const mdValue_r2=ctx.$implicit,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_3__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_3__.Y8G("dso",ctx_r2.dso)("mdValue",mdValue_r2)("mdField",ctx_r2.mdField)("dsoType",ctx_r2.dsoType)("saving$",ctx_r2.saving$)("isOnlyValue",1===ctx_r2.form.fields[ctx_r2.mdField].length)}}let DsoEditMetadataFieldValuesComponent=(()=>{class DsoEditMetadataFieldValuesComponent2{constructor(){this.valueSaved=new _angular_core__WEBPACK_IMPORTED_MODULE_3__.bkB,this.DsoEditMetadataChangeTypeEnum=_dso_edit_metadata_form__WEBPACK_IMPORTED_MODULE_1__.QR}drop(event){(0,_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_4__.HD)(this.form.fields[this.mdField],event.previousIndex,event.currentIndex),this.form.fields[this.mdField].forEach((value,index)=>{value.newValue.place=index,value.confirmChanges()}),this.form.resetReinstatable(),this.valueSaved.emit()}static#_=this.\u0275fac=function(t){return new(t||DsoEditMetadataFieldValuesComponent2)};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_3__.VBU({type:DsoEditMetadataFieldValuesComponent2,selectors:[["ds-dso-edit-metadata-field-values"]],inputs:{dso:"dso",form:"form",mdField:"mdField",dsoType:"dsoType",saving$:"saving$",draggingMdField$:"draggingMdField$"},outputs:{valueSaved:"valueSaved"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_3__.aNF],decls:5,vars:8,consts:[["cdkDropList","","role","table",1,"flex-grow-1","ds-drop-list","h-100",3,"cdkDropListDropped"],["role","presentation",3,"dsoType"],["role","presentation",3,"dso","mdValue","mdField","dsoType","saving$","isOnlyValue","edit","confirm","remove","undo","dragging",4,"ngFor","ngForOf"],["role","presentation",3,"edit","confirm","remove","undo","dragging","dso","mdValue","mdField","dsoType","saving$","isOnlyValue"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_3__.j41(0,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_3__.nI1(1,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_3__.nI1(2,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_3__.bIt("cdkDropListDropped",function($event){return ctx.drop($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_3__.nrm(3,"ds-dso-edit-metadata-value-headers",1),_angular_core__WEBPACK_IMPORTED_MODULE_3__.DNE(4,DsoEditMetadataFieldValuesComponent_ds_dso_edit_metadata_value_4_Template,1,6,"ds-dso-edit-metadata-value",2),_angular_core__WEBPACK_IMPORTED_MODULE_3__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_3__.AVh("disabled",_angular_core__WEBPACK_IMPORTED_MODULE_3__.bMT(1,4,ctx.draggingMdField$)&&_angular_core__WEBPACK_IMPORTED_MODULE_3__.bMT(2,6,ctx.draggingMdField$)!==ctx.mdField),_angular_core__WEBPACK_IMPORTED_MODULE_3__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_3__.Y8G("dsoType",ctx.dsoType),_angular_core__WEBPACK_IMPORTED_MODULE_3__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_3__.Y8G("ngForOf",ctx.form.fields[ctx.mdField]))},dependencies:[_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_4__.O7,_dso_edit_metadata_value_headers_dso_edit_metadata_value_headers_component__WEBPACK_IMPORTED_MODULE_5__.c,_angular_common__WEBPACK_IMPORTED_MODULE_6__.pM,_dso_edit_metadata_value_dso_edit_metadata_value_component__WEBPACK_IMPORTED_MODULE_2__.o,_angular_common__WEBPACK_IMPORTED_MODULE_6__.Jj],styles:[".ds-drop-list[_ngcontent-%COMP%]{background-color:var(--bs-gray-500)}.ds-drop-list.disabled[_ngcontent-%COMP%]{opacity:.3}"]})}return DsoEditMetadataFieldValuesComponent2})()},17533:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{QR:()=>DsoEditMetadataChangeType,qf:()=>DsoEditMetadataForm});class MetadataPatchOperation{constructor(op,field){this.op=op,this.field=field}}let MetadataPatchAddOperation=(()=>{class MetadataPatchAddOperation2 extends MetadataPatchOperation{static#_=this.operationType="add";constructor(field,value){super(MetadataPatchAddOperation2.operationType,field),this.value=value}toOperation(){return{op:this.op,path:`/metadata/${this.field}/-`,value:this.value}}}return MetadataPatchAddOperation2})(),MetadataPatchMoveOperation=(()=>{class MetadataPatchMoveOperation2 extends MetadataPatchOperation{static#_=this.operationType="move";constructor(field,from,to){super(MetadataPatchMoveOperation2.operationType,field),this.from=from,this.to=to}toOperation(){return{op:this.op,from:`/metadata/${this.field}/${this.from}`,path:`/metadata/${this.field}/${this.to}`}}}return MetadataPatchMoveOperation2})(),MetadataPatchRemoveOperation=(()=>{class MetadataPatchRemoveOperation2 extends MetadataPatchOperation{static#_=this.operationType="remove";constructor(field,place){super(MetadataPatchRemoveOperation2.operationType,field),this.place=place}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`}}}return MetadataPatchRemoveOperation2})(),MetadataPatchReplaceOperation=(()=>{class MetadataPatchReplaceOperation2 extends MetadataPatchOperation{static#_=this.operationType="replace";constructor(field,place,value){super(MetadataPatchReplaceOperation2.operationType,field),this.place=place,this.value=value}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`,value:this.value}}}return MetadataPatchReplaceOperation2})();var metadata_models=__webpack_require__(97414),empty_util=__webpack_require__(77028),DsoEditMetadataChangeType=function(DsoEditMetadataChangeType2){return DsoEditMetadataChangeType2[DsoEditMetadataChangeType2.UPDATE=1]="UPDATE",DsoEditMetadataChangeType2[DsoEditMetadataChangeType2.ADD=2]="ADD",DsoEditMetadataChangeType2[DsoEditMetadataChangeType2.REMOVE=3]="REMOVE",DsoEditMetadataChangeType2}(DsoEditMetadataChangeType||{});class DsoEditMetadataValue{constructor(value,added=!1){this.editing=!1,this.reordered=!1,this.originalValue=value,this.newValue=Object.assign(new metadata_models.vD,value),added&&(this.change=DsoEditMetadataChangeType.ADD,this.editing=!0)}confirmChanges(finishEditing=!1){this.reordered=this.originalValue.place!==this.newValue.place,((0,empty_util.Tn)(this.change)||this.change===DsoEditMetadataChangeType.UPDATE)&&(this.change=this.originalValue.value!==this.newValue.value||this.originalValue.language!==this.newValue.language||this.originalValue.authority!==this.newValue.authority||this.originalValue.confidence!==this.newValue.confidence?DsoEditMetadataChangeType.UPDATE:void 0),finishEditing&&(this.editing=!1)}hasChanges(){return(0,empty_util.a4)(this.change)||this.reordered}discardAndMarkReinstatable(){(this.change===DsoEditMetadataChangeType.UPDATE||this.reordered)&&(this.reinstatableValue=this.newValue),this.reinstatableChange=this.change,this.discard(!1)}discard(keepPlace=!0){this.change=void 0;const place=this.newValue.place;this.newValue=Object.assign(new metadata_models.vD,this.originalValue),keepPlace&&(this.newValue.place=place),this.confirmChanges(!0)}reinstate(){(0,empty_util.a4)(this.reinstatableValue)&&(this.newValue=this.reinstatableValue,this.reinstatableValue=void 0),(0,empty_util.a4)(this.reinstatableChange)&&(this.change=this.reinstatableChange,this.reinstatableChange=void 0),this.confirmChanges()}isReinstatable(){return(0,empty_util.a4)(this.reinstatableValue)||(0,empty_util.a4)(this.reinstatableChange)}resetReinstatable(){this.reinstatableValue=void 0,this.reinstatableChange=void 0}}class DsoEditMetadataForm{constructor(metadata){this.originalFieldKeys=[],this.fieldKeys=[],this.fields={},this.reinstatableNewValues={},Object.entries(metadata).forEach(([mdField,values])=>{this.originalFieldKeys.push(mdField),this.fieldKeys.push(mdField),this.setValuesForFieldSorted(mdField,values.map(value=>new DsoEditMetadataValue(value)))}),this.sortFieldKeys()}add(){(0,empty_util.Tn)(this.newValue)&&(this.newValue=new DsoEditMetadataValue(new metadata_models.vD,!0))}setMetadataField(mdField){this.newValue.editing=!1,this.addValueToField(this.newValue,mdField);const place=this.fields[mdField].length-1;this.fields[mdField][place].originalValue.place=place,this.fields[mdField][place].newValue.place=place,this.newValue=void 0}addValueToField(value,mdField){(0,empty_util.Im)(this.fields[mdField])&&(this.fieldKeys.push(mdField),this.sortFieldKeys(),this.fields[mdField]=[]),this.fields[mdField].push(value)}remove(mdField,index){(0,empty_util.hj)(this.fields[mdField])&&(this.fields[mdField].splice(index,1),0===this.fields[mdField].length&&(this.fieldKeys.splice(this.fieldKeys.indexOf(mdField),1),delete this.fields[mdField]))}hasChanges(){return Object.values(this.fields).some(values=>values.some(value=>value.hasChanges()))}hasOrderChanges(mdField){return this.fields[mdField].some(value=>value.originalValue.place!==value.newValue.place)}discard(){this.resetReinstatable(),Object.entries(this.fields).forEach(([field,values])=>{let removeFromIndex=-1;values.forEach((value,index)=>{value.change===DsoEditMetadataChangeType.ADD?((0,empty_util.Im)(this.reinstatableNewValues[field])&&(this.reinstatableNewValues[field]=[]),this.reinstatableNewValues[field].push(value),-1===removeFromIndex&&(removeFromIndex=index)):value.discardAndMarkReinstatable()}),removeFromIndex>-1&&this.fields[field].splice(removeFromIndex,this.fields[field].length-removeFromIndex)}),this.fieldKeys.forEach(field=>{this.originalFieldKeys.indexOf(field)<0&&delete this.fields[field]}),this.fieldKeys=[...this.originalFieldKeys],this.sortFieldKeys(),this.fieldKeys.forEach(field=>{this.setValuesForFieldSorted(field,this.fields[field])})}resetOrder(mdField){this.fields[mdField].forEach(value=>{value.newValue.place=value.originalValue.place,value.confirmChanges()}),this.setValuesForFieldSorted(mdField,this.fields[mdField])}sortFieldKeys(){this.fieldKeys.sort((a,b)=>a.localeCompare(b))}reinstate(){Object.values(this.fields).forEach(values=>{values.forEach(value=>{value.reinstate()})}),Object.entries(this.reinstatableNewValues).forEach(([field,values])=>{values.forEach(value=>{this.addValueToField(value,field)})}),this.fieldKeys.forEach(field=>{this.setValuesForFieldSorted(field,this.fields[field])}),this.reinstatableNewValues={}}isReinstatable(){return(0,empty_util.hj)(this.reinstatableNewValues)||Object.values(this.fields).some(values=>values.some(value=>value.isReinstatable()))}resetReinstatable(){this.reinstatableNewValues={},Object.values(this.fields).forEach(values=>{values.forEach(value=>{value.resetReinstatable()})})}setValuesForFieldSorted(mdField,values){this.fields[mdField]=values.sort((a,b)=>a.newValue.place-b.newValue.place)}getOperations(moveAnalyser){const operations=[];return Object.entries(this.fields).forEach(([field,values])=>{const replaceOperations=[],removeOperations=[],addOperations=[];[...values].sort((a,b)=>a.originalValue.place-b.originalValue.place).forEach(value=>{(0,empty_util.a4)(value.change)&&(value.change===DsoEditMetadataChangeType.UPDATE?(value.originalValue.value!==value.newValue.value||value.originalValue.language!==value.newValue.language||value.originalValue.authority!==value.newValue.authority||value.originalValue.confidence!==value.newValue.confidence)&&replaceOperations.push(new MetadataPatchReplaceOperation(field,value.originalValue.place,{value:value.newValue.value,language:value.newValue.language,authority:value.newValue.authority,confidence:value.newValue.confidence})):value.change===DsoEditMetadataChangeType.REMOVE?removeOperations.push(new MetadataPatchRemoveOperation(field,value.originalValue.place)):value.change===DsoEditMetadataChangeType.ADD?addOperations.push(new MetadataPatchAddOperation(field,{value:value.newValue.value,language:value.newValue.language,authority:value.newValue.authority,confidence:value.newValue.confidence})):console.warn("Illegal metadata change state detected for",value))}),operations.push(...replaceOperations.map(operation=>operation.toOperation())),operations.push(...removeOperations.sort((a,b)=>b.place-a.place).map(operation=>operation.toOperation())),operations.push(...addOperations.map(operation=>operation.toOperation()))}),Object.entries(this.fields).forEach(([field,values])=>{const valuesWithoutRemoved=values.filter(value=>value.change!==DsoEditMetadataChangeType.REMOVE),moveOperations=moveAnalyser.diff([...valuesWithoutRemoved].sort((a,b)=>a.originalValue.place-b.originalValue.place).map(value=>value.originalValue.place),[...valuesWithoutRemoved].sort((a,b)=>a.newValue.place-b.newValue.place).map(value=>value.originalValue.place)).map(operation=>new MetadataPatchMoveOperation(field,+operation.from.substr(1),+operation.path.substr(1)).toOperation());operations.push(...moveOperations)}),operations}}},69252:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{L:()=>DsoEditMetadataHeadersComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(43750),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68014);let DsoEditMetadataHeadersComponent=(()=>{class DsoEditMetadataHeadersComponent2{static#_=this.\u0275fac=function(t){return new(t||DsoEditMetadataHeadersComponent2)};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:DsoEditMetadataHeadersComponent2,selectors:[["ds-dso-edit-metadata-headers"]],inputs:{dsoType:"dsoType"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.aNF],decls:18,vars:12,consts:[[1,"d-flex","flex-row","ds-field-row","ds-header-row"],[1,"lbl-cell"],[1,"flex-grow-1"],[1,"d-flex","flex-row"],[1,"flex-grow-1","ds-flex-cell","ds-value-cell"],[1,"dont-break-out","preserve-line-breaks"],[1,"ds-flex-cell","ds-lang-cell"],[1,"text-center","ds-flex-cell","ds-edit-cell"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"div",0)(1,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(4,"div",2)(5,"div",3)(6,"div",4)(7,"b",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(9,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(10,"div",6)(11,"b"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(12),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(13,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(14,"div",7)(15,"b"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(16),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(17,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()()()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,4,ctx.dsoType+".edit.metadata.headers.field")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(6),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(9,6,ctx.dsoType+".edit.metadata.headers.value")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(13,8,ctx.dsoType+".edit.metadata.headers.language")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(17,10,ctx.dsoType+".edit.metadata.headers.edit")))},dependencies:[_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.D9],styles:[".lbl-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-field-width);max-width:var(--ds-dso-edit-field-width);background-color:var(--bs-gray-100);font-weight:700;padding:1rem;border:1px solid var(--bs-gray-200)}.ds-header-row[_ngcontent-%COMP%]{background-color:var(--bs-gray-100)}",".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success)}"]})}return DsoEditMetadataHeadersComponent2})()},91252:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>DsoEditMetadataValueHeadersComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(43750),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68014);let DsoEditMetadataValueHeadersComponent=(()=>{class DsoEditMetadataValueHeadersComponent2{static#_=this.\u0275fac=function(t){return new(t||DsoEditMetadataValueHeadersComponent2)};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:DsoEditMetadataValueHeadersComponent2,selectors:[["ds-dso-edit-metadata-value-headers"]],inputs:{dsoType:"dsoType"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.aNF],decls:10,vars:9,consts:[["role","row",1,"visually-hidden"],["role","columnheader"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"div",0)(1,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(4,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(6,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(7,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(9,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,3,ctx.dsoType+".edit.metadata.headers.value")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(6,5,ctx.dsoType+".edit.metadata.headers.language")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(9,7,ctx.dsoType+".edit.metadata.headers.edit")))},dependencies:[_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.D9],styles:[".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success)}"]})}return DsoEditMetadataValueHeadersComponent2})()},36604:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>DsoEditMetadataValueComponent});var _angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(23306),_angular_common__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(84739),_angular_core__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(68014),_angular_forms__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(28955),_angular_router__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(64247),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(71781),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(43750),rxjs__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(10743),src_app_core_registry_registry_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10893),src_app_core_submission_vocabularies_vocabulary_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(77275),src_app_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10117),_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(91735),_core_data_item_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(94743),_core_data_relationship_data_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8648),_core_metadata_metadata_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(94689),_core_shared_confidence_type__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(79070),_core_shared_metadata_representation_metadata_representation_model__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(48168),__webpack_require__(25281)),_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(82656),_item_page_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(63254),_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(77028),_shared_form_builder_ds_dynamic_form_ui_models_onebox_dynamic_onebox_component__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(74183),_shared_form_builder_ds_dynamic_form_ui_models_onebox_dynamic_onebox_model__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(80385),_shared_form_builder_ds_dynamic_form_ui_models_scrollable_dropdown_dynamic_scrollable_dropdown_component__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(72875),_shared_form_builder_ds_dynamic_form_ui_models_scrollable_dropdown_dynamic_scrollable_dropdown_model__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(10661),_shared_form_builder_models_form_field_metadata_value_model__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(5403),_shared_form_directives_authority_confidence_state_directive__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(78392),_shared_object_collection_shared_badges_type_badge_themed_type_badge_component__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(83793),_shared_utils_debounce_directive__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(51615),_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(32181),_shared_utils_var_directive__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(45961),_dso_edit_metadata_form__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(17533);const _c0=(a0,a1,a2,a3)=>({"ds-warning":a0,"ds-danger":a1,"ds-success":a2,"h-100":a3}),_c1=a0=>({disabled:a0});function DsoEditMetadataValueComponent_div_0_div_1_div_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"div",24),_angular_core__WEBPACK_IMPORTED_MODULE_19__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.JRh(ctx_r1.mdValue.newValue.value)}}function DsoEditMetadataValueComponent_div_0_div_1_textarea_2_Template(rf,ctx){if(1&rf){const _r3=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"textarea",25),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.mxI("ngModelChange",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r3);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.DH7(ctx_r1.mdValue.newValue.value,$event)||(ctx_r1.mdValue.newValue.value=$event),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("onDebounce",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r3);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.confirm.emit(!1))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_19__.R50("ngModel",ctx_r1.mdValue.newValue.value),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("dsDebounce",300),_angular_core__WEBPACK_IMPORTED_MODULE_19__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.value"))}}function DsoEditMetadataValueComponent_div_0_div_1_ds_dynamic_scrollable_dropdown_4_Template(rf,ctx){if(1&rf){const _r4=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"ds-dynamic-scrollable-dropdown",26),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("change",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r4);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.onChangeAuthorityField($event))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("bindId",ctx_r1.mdField)("group",ctx_r1.group)("model",ctx_r1.getModel())}}function DsoEditMetadataValueComponent_div_0_div_1_ds_dynamic_onebox_6_Template(rf,ctx){if(1&rf){const _r5=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"ds-dynamic-onebox",27),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("change",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r5);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.onChangeAuthorityField($event))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("group",ctx_r1.group)("model",ctx_r1.getModel())}}function DsoEditMetadataValueComponent_div_0_div_1_div_9_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"div")(1,"span",28),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(2,"i",29),_angular_core__WEBPACK_IMPORTED_MODULE_19__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("authorityValue",ctx_r1.mdValue.newValue)("iconMode",!0),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Lme(" ",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(4,4,ctx_r1.dsoType+".edit.metadata.authority.label")," ",ctx_r1.mdValue.newValue.authority," ")}}function DsoEditMetadataValueComponent_div_0_div_1_div_10_button_5_Template(rf,ctx){if(1&rf){const _r7=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"button",36),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r7);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(4);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.onChangeEditingAuthorityStatus(!0))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(3,"i",37),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(4);_angular_core__WEBPACK_IMPORTED_MODULE_19__.FS9("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(1,2,ctx_r1.dsoType+".edit.metadata.edit.buttons.open-authority-edition")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("title",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(2,4,ctx_r1.dsoType+".edit.metadata.edit.buttons.open-authority-edition"))}}function DsoEditMetadataValueComponent_div_0_div_1_div_10_button_6_Template(rf,ctx){if(1&rf){const _r8=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"button",38),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r8);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(4);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.onChangeEditingAuthorityStatus(!1))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(3,"i",39),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(4);_angular_core__WEBPACK_IMPORTED_MODULE_19__.FS9("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(1,2,ctx_r1.dsoType+".edit.metadata.edit.buttons.close-authority-edition")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("title",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(2,4,ctx_r1.dsoType+".edit.metadata.edit.buttons.close-authority-edition"))}}function DsoEditMetadataValueComponent_div_0_div_1_div_10_Template(rf,ctx){if(1&rf){const _r6=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"div",30)(1,"div",31),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(2,"i",32),_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(3,"input",33),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.mxI("ngModelChange",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r6);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.DH7(ctx_r1.mdValue.newValue.authority,$event)||(ctx_r1.mdValue.newValue.authority=$event),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("change",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r6);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.onChangeAuthorityKey())}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(5,DsoEditMetadataValueComponent_div_0_div_1_div_10_button_5_Template,4,6,"button",34)(6,DsoEditMetadataValueComponent_div_0_div_1_div_10_button_6_Template,4,6,"button",35),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("authorityValue",ctx_r1.mdValue.newValue.confidence)("iconMode",!0),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R50("ngModel",ctx_r1.mdValue.newValue.authority),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("disabled",!ctx_r1.editingAuthority),_angular_core__WEBPACK_IMPORTED_MODULE_19__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(4,7,ctx_r1.dsoType+".edit.metadata.edit.authority.key")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",!ctx_r1.editingAuthority),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",ctx_r1.editingAuthority)}}function DsoEditMetadataValueComponent_div_0_div_1_div_13_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"div",40)(1,"a",41),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(2,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(4,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(5,"ds-type-badge",42),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()),2&rf){const mdRepresentation_r9=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG().ngVar,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("routerLink",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(2,3,ctx_r1.mdRepresentationItemRoute$)),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(4,5,ctx_r1.mdRepresentationName$)),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("object",mdRepresentation_r9)}}function DsoEditMetadataValueComponent_div_0_div_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"div",17),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(1,DsoEditMetadataValueComponent_div_0_div_1_div_1_Template,2,1,"div",4)(2,DsoEditMetadataValueComponent_div_0_div_1_textarea_2_Template,2,5,"textarea",18),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(3,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(4,DsoEditMetadataValueComponent_div_0_div_1_ds_dynamic_scrollable_dropdown_4_Template,1,3,"ds-dynamic-scrollable-dropdown",19),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(5,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(6,DsoEditMetadataValueComponent_div_0_div_1_ds_dynamic_onebox_6_Template,1,2,"ds-dynamic-onebox",20),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(7,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(8,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(9,DsoEditMetadataValueComponent_div_0_div_1_div_9_Template,5,6,"div",21)(10,DsoEditMetadataValueComponent_div_0_div_1_div_10_Template,7,9,"div",22),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(11,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(12,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(13,DsoEditMetadataValueComponent_div_0_div_1_div_13_Template,6,7,"div",23),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()),2&rf){const mdRepresentation_r9=ctx.ngVar,isVirtual_r10=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG().ngVar,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",!ctx_r1.mdValue.editing&&!mdRepresentation_r9),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",ctx_r1.mdValue.editing&&!mdRepresentation_r9&&!0!==_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(3,7,ctx_r1.isAuthorityControlled())),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",ctx_r1.mdValue.editing&&_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(5,9,ctx_r1.isScrollableVocabulary())),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",ctx_r1.mdValue.editing&&(_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(7,11,ctx_r1.isHierarchicalVocabulary())||_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(8,13,ctx_r1.isSuggesterVocabulary()))),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",!isVirtual_r10&&!ctx_r1.mdValue.editing&&ctx_r1.mdValue.newValue.authority&&ctx_r1.mdValue.newValue.confidence!==ctx_r1.ConfidenceTypeEnum.CF_UNSET&&ctx_r1.mdValue.newValue.confidence!==ctx_r1.ConfidenceTypeEnum.CF_NOVALUE),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",ctx_r1.mdValue.editing&&_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(11,15,ctx_r1.isAuthorityControlled())&&_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(12,17,ctx_r1.isSuggesterVocabulary())),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",mdRepresentation_r9)}}function DsoEditMetadataValueComponent_div_0_div_4_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"div",24),_angular_core__WEBPACK_IMPORTED_MODULE_19__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.JRh(ctx_r1.mdValue.newValue.language)}}function DsoEditMetadataValueComponent_div_0_input_5_Template(rf,ctx){if(1&rf){const _r11=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"input",43),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.mxI("ngModelChange",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r11);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.DH7(ctx_r1.mdValue.newValue.language,$event)||(ctx_r1.mdValue.newValue.language=$event),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("onDebounce",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r11);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.confirm.emit(!1))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_19__.R50("ngModel",ctx_r1.mdValue.newValue.language),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("dsDebounce",300),_angular_core__WEBPACK_IMPORTED_MODULE_19__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.language"))}}function DsoEditMetadataValueComponent_div_0_button_11_Template(rf,ctx){if(1&rf){const _r12=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"button",44),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(3,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r12);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.edit.emit())}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(4,"i",45),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const isVirtual_r10=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG().ngVar,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_19__.FS9("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.buttons.edit")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("title",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(2,5,ctx_r1.dsoType+".edit.metadata.edit.buttons.edit"))("disabled",isVirtual_r10||ctx_r1.mdValue.change===ctx_r1.DsoEditMetadataChangeTypeEnum.REMOVE||_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(3,7,ctx_r1.saving$))}}function DsoEditMetadataValueComponent_div_0_button_12_Template(rf,ctx){if(1&rf){const _r13=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"button",46),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(3,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r13);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.confirm.emit(!0))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(4,"i",47),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()}if(2&rf){const isVirtual_r10=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG().ngVar,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_19__.FS9("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.buttons.confirm")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("title",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(2,5,ctx_r1.dsoType+".edit.metadata.edit.buttons.confirm"))("disabled",isVirtual_r10||_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(3,7,ctx_r1.saving$))}}function DsoEditMetadataValueComponent_div_0_button_23_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"button",48),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(3,"i",49),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()),2&rf){const disabled_r14=ctx.ngVar,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_19__.FS9("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(1,5,ctx_r1.dsoType+".edit.metadata.edit.buttons.drag")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("cdkDragHandleDisabled",disabled_r14)("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_19__.eq3(9,_c1,disabled_r14))("disabled",disabled_r14)("title",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(2,7,ctx_r1.dsoType+".edit.metadata.edit.buttons.drag"))}}function DsoEditMetadataValueComponent_div_0_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(0,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("cdkDragStarted",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.dragging.emit(!0))})("cdkDragEnded",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.dragging.emit(!1))}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(1,DsoEditMetadataValueComponent_div_0_div_1_Template,14,19,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(2,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(3,"div",3),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(4,DsoEditMetadataValueComponent_div_0_div_4_Template,2,1,"div",4)(5,DsoEditMetadataValueComponent_div_0_input_5_Template,2,5,"input",5),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(10,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(11,DsoEditMetadataValueComponent_div_0_button_11_Template,5,9,"button",10)(12,DsoEditMetadataValueComponent_div_0_button_12_Template,5,9,"button",11),_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(13,"button",12),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(14,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(15,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(16,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.remove.emit())}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(17,"i",13),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.j41(18,"button",14),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(19,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(20,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(21,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_19__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_19__.Njj(ctx_r1.undo.emit())}),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nrm(22,"i",15),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(23,DsoEditMetadataValueComponent_div_0_button_23_Template,4,11,"button",16),_angular_core__WEBPACK_IMPORTED_MODULE_19__.nI1(24,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_19__.k0s()()()()()}if(2&rf){const isVirtual_r10=ctx.ngVar,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_19__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_19__.ziG(32,_c0,ctx_r1.mdValue.reordered||ctx_r1.mdValue.change===ctx_r1.DsoEditMetadataChangeTypeEnum.UPDATE,ctx_r1.mdValue.change===ctx_r1.DsoEditMetadataChangeTypeEnum.REMOVE,ctx_r1.mdValue.change===ctx_r1.DsoEditMetadataChangeTypeEnum.ADD,ctx_r1.isOnlyValue)),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngVar",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(2,14,ctx_r1.mdRepresentation$)),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",!ctx_r1.mdValue.editing),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",ctx_r1.mdValue.editing),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngbTooltip",isVirtual_r10?_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(10,16,ctx_r1.dsoType+".edit.metadata.edit.buttons.virtual"):null),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",!ctx_r1.mdValue.editing),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngIf",ctx_r1.mdValue.editing),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_19__.FS9("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(14,18,ctx_r1.dsoType+".edit.metadata.edit.buttons.remove")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("title",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(15,20,ctx_r1.dsoType+".edit.metadata.edit.buttons.remove"))("disabled",isVirtual_r10||ctx_r1.mdValue.change&&ctx_r1.mdValue.change!==ctx_r1.DsoEditMetadataChangeTypeEnum.ADD||ctx_r1.mdValue.editing||_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(16,22,ctx_r1.saving$)),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(5),_angular_core__WEBPACK_IMPORTED_MODULE_19__.FS9("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(19,24,ctx_r1.dsoType+".edit.metadata.edit.buttons.undo")),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("title",_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(20,26,ctx_r1.dsoType+".edit.metadata.edit.buttons.undo"))("disabled",isVirtual_r10||!ctx_r1.mdValue.change&&ctx_r1.mdValue.reordered||!ctx_r1.mdValue.change&&!ctx_r1.mdValue.editing||_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(21,28,ctx_r1.saving$)),_angular_core__WEBPACK_IMPORTED_MODULE_19__.R7$(5),_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngVar",ctx_r1.isOnlyValue||_angular_core__WEBPACK_IMPORTED_MODULE_19__.bMT(24,30,ctx_r1.saving$))}}let DsoEditMetadataValueComponent=(()=>{class DsoEditMetadataValueComponent2{constructor(relationshipService,dsoNameService,vocabularyService,itemService,cdr,registryService,notificationsService,translate,metadataService){this.relationshipService=relationshipService,this.dsoNameService=dsoNameService,this.vocabularyService=vocabularyService,this.itemService=itemService,this.cdr=cdr,this.registryService=registryService,this.notificationsService=notificationsService,this.translate=translate,this.metadataService=metadataService,this.isOnlyValue=!1,this.edit=new _angular_core__WEBPACK_IMPORTED_MODULE_19__.bkB,this.confirm=new _angular_core__WEBPACK_IMPORTED_MODULE_19__.bkB,this.remove=new _angular_core__WEBPACK_IMPORTED_MODULE_19__.bkB,this.undo=new _angular_core__WEBPACK_IMPORTED_MODULE_19__.bkB,this.dragging=new _angular_core__WEBPACK_IMPORTED_MODULE_19__.bkB,this.DsoEditMetadataChangeTypeEnum=_dso_edit_metadata_form__WEBPACK_IMPORTED_MODULE_18__.QR,this.ConfidenceTypeEnum=_core_shared_confidence_type__WEBPACK_IMPORTED_MODULE_7__.l,this.editingAuthority=!1,this.group=new _angular_forms__WEBPACK_IMPORTED_MODULE_20__.J3({authorityField:new _angular_forms__WEBPACK_IMPORTED_MODULE_20__.hs}),this.model$=new rxjs__WEBPACK_IMPORTED_MODULE_21__.BehaviorSubject(null)}ngOnInit(){this.initVirtualProperties(),this.initAuthorityProperties()}initVirtualProperties(){this.mdRepresentation$=this.metadataService.isVirtual(this.mdValue.newValue)?this.relationshipService.resolveMetadataRepresentation(this.mdValue.newValue,this.dso,"Item").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(mdRepresentation=>mdRepresentation.representationType===_core_shared_metadata_representation_metadata_representation_model__WEBPACK_IMPORTED_MODULE_9__.d.Item?mdRepresentation:null)):rxjs__WEBPACK_IMPORTED_MODULE_21__.EMPTY,this.mdRepresentationItemRoute$=this.mdRepresentation$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(mdRepresentation=>mdRepresentation?(0,_item_page_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_23__._o)(mdRepresentation):null)),this.mdRepresentationName$=this.mdRepresentation$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(mdRepresentation=>mdRepresentation?this.dsoNameService.getName(mdRepresentation):null))}initAuthorityProperties(){if((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(this.mdField)){const owningCollection$=this.itemService.findByHref(this.dso._links.self.href,!0,!0,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_25__.s)("owningCollection")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.yd)(),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.Bo)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.nx)(item=>item.owningCollection),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.yd)(),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.Bo)());this.vocabulary$=owningCollection$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.nx)(c=>this.vocabularyService.getVocabularyByMetadataAndCollection(this.mdField,c.uuid).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.ak)())))}else this.vocabulary$=(0,rxjs__WEBPACK_IMPORTED_MODULE_21__.of)(void 0);this.isAuthorityControlled$=this.vocabulary$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Mi)(v=>this.model$.next(this.createModel(v))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(result=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(result))),this.isHierarchicalVocabulary$=this.vocabulary$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(result=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(result)&&result.hierarchical)),this.isScrollableVocabulary$=this.vocabulary$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(result=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(result)&&result.scrollable)),this.isSuggesterVocabulary$=this.vocabulary$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(result=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(result)&&!result.hierarchical&&!result.scrollable))}createModel(vocabulary){if((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(vocabulary)){let formFieldValue;(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(this.mdValue.newValue.value)?(formFieldValue=new _shared_form_builder_models_form_field_metadata_value_model__WEBPACK_IMPORTED_MODULE_15__.e,formFieldValue.value=this.mdValue.newValue.value,formFieldValue.display=this.mdValue.newValue.value,this.mdValue.newValue.authority&&(formFieldValue.authority=this.mdValue.newValue.authority,formFieldValue.confidence=this.mdValue.newValue.confidence)):formFieldValue=this.mdValue.newValue.value;const vocabularyOptions=vocabulary?{closed:!1,name:vocabulary.name}:null;return vocabulary.scrollable?new _shared_form_builder_ds_dynamic_form_ui_models_scrollable_dropdown_dynamic_scrollable_dropdown_model__WEBPACK_IMPORTED_MODULE_14__.j({id:"authorityField",label:`${this.dsoType}.edit.metadata.edit.value`,placeholder:`${this.dsoType}.edit.metadata.edit.value`,vocabularyOptions,metadataFields:[this.mdField],value:formFieldValue,repeatable:!1,submissionId:"edit-metadata",hasSelectableMetadata:!1,maxOptions:10}):new _shared_form_builder_ds_dynamic_form_ui_models_onebox_dynamic_onebox_model__WEBPACK_IMPORTED_MODULE_12__.K({id:"authorityField",label:`${this.dsoType}.edit.metadata.edit.value`,vocabularyOptions,metadataFields:[this.mdField],value:formFieldValue,repeatable:!1,submissionId:"edit-metadata",hasSelectableMetadata:!1})}return null}ngOnChanges(changes){(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(changes.mdField)&&!changes.mdField.firstChange&&(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(changes.mdField.currentValue)&&((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_24__.hj)(changes.mdField.previousValue)&&changes.mdField.previousValue!==changes.mdField.currentValue&&(this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=_core_shared_confidence_type__WEBPACK_IMPORTED_MODULE_7__.l.CF_UNSET),changes.mdField.currentValue.includes(".")&&this.validateMetadataField().subscribe(isValid=>{isValid&&(this.initAuthorityProperties(),this.cdr.detectChanges())}))}validateMetadataField(){return this.registryService.queryMetadataFields(this.mdField,null,!0,!1,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_25__.s)("schema")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.nx)(rd=>rd.hasSucceeded?(0,rxjs__WEBPACK_IMPORTED_MODULE_21__.of)(rd).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.LB)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.Tj)(fields=>fields.indexOf(this.mdField)>-1)):(this.notificationsService.error(this.translate.instant(`${this.dsoType}.edit.metadata.metadatafield.error`),rd.errorMessage),[!1])))}isAuthorityControlled(){return this.isAuthorityControlled$}isHierarchicalVocabulary(){return this.isHierarchicalVocabulary$}isScrollableVocabulary(){return this.isScrollableVocabulary$}isSuggesterVocabulary(){return this.isSuggesterVocabulary$}onChangeAuthorityField(event){this.mdValue.newValue.value=event.value,event.authority?(this.mdValue.newValue.authority=event.authority,this.mdValue.newValue.confidence=_core_shared_confidence_type__WEBPACK_IMPORTED_MODULE_7__.l.CF_ACCEPTED):(this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=_core_shared_confidence_type__WEBPACK_IMPORTED_MODULE_7__.l.CF_UNSET),this.confirm.emit(!1)}getModel(){return this.model$.value}onChangeEditingAuthorityStatus(status){this.editingAuthority=status}onChangeAuthorityKey(){""===this.mdValue.newValue.authority?(this.mdValue.newValue.confidence=_core_shared_confidence_type__WEBPACK_IMPORTED_MODULE_7__.l.CF_NOVALUE,this.confirm.emit(!1)):this.mdValue.newValue.authority!==this.mdValue.originalValue.authority&&(this.mdValue.newValue.confidence=_core_shared_confidence_type__WEBPACK_IMPORTED_MODULE_7__.l.CF_ACCEPTED,this.confirm.emit(!1))}static#_=this.\u0275fac=function(t){return new(t||DsoEditMetadataValueComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(_core_data_relationship_data_service__WEBPACK_IMPORTED_MODULE_5__.RelationshipDataService),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_3__.f),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(src_app_core_submission_vocabularies_vocabulary_service__WEBPACK_IMPORTED_MODULE_1__.g),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(_core_data_item_data_service__WEBPACK_IMPORTED_MODULE_4__.ItemDataService),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_19__.gRc),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(src_app_core_registry_registry_service__WEBPACK_IMPORTED_MODULE_0__.x),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(src_app_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__.I),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_26__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_19__.rXU(_core_metadata_metadata_service__WEBPACK_IMPORTED_MODULE_6__.T))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_19__.VBU({type:DsoEditMetadataValueComponent2,selectors:[["ds-dso-edit-metadata-value"]],inputs:{dso:"dso",mdValue:"mdValue",dsoType:"dsoType",saving$:"saving$",isOnlyValue:"isOnlyValue",mdField:"mdField"},outputs:{edit:"edit",confirm:"confirm",remove:"remove",undo:"undo",dragging:"dragging"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_19__.OA$,_angular_core__WEBPACK_IMPORTED_MODULE_19__.aNF],decls:1,vars:1,consts:[["class","d-flex flex-row ds-value-row","role","row","cdkDrag","",3,"ngClass","cdkDragStarted","cdkDragEnded",4,"ngVar"],["role","row","cdkDrag","",1,"d-flex","flex-row","ds-value-row",3,"cdkDragStarted","cdkDragEnded","ngClass"],["class","flex-grow-1 ds-flex-cell ds-value-cell d-flex flex-column","role","cell",4,"ngVar"],["role","cell",1,"ds-flex-cell","ds-lang-cell"],["class","dont-break-out preserve-line-breaks",4,"ngIf"],["class","form-control","type","text",3,"ngModel","dsDebounce","ngModelChange","onDebounce",4,"ngIf"],["role","cell",1,"text-center","ds-flex-cell","ds-edit-cell"],[1,"btn-group"],[1,"edit-field"],[1,"btn-group","edit-buttons",3,"ngbTooltip"],["class","btn btn-outline-primary btn-sm ng-star-inserted","data-test","metadata-edit-btn",3,"title","ngbTooltip","disabled","click",4,"ngIf"],["class","btn btn-outline-success btn-sm ng-star-inserted","data-test","metadata-confirm-btn",3,"title","ngbTooltip","disabled","click",4,"ngIf"],["data-test","metadata-remove-btn",1,"btn","btn-outline-danger","btn-sm",3,"click","title","ngbTooltip","disabled"],[1,"fas","fa-trash-alt","fa-fw"],["data-test","metadata-undo-btn",1,"btn","btn-outline-warning","btn-sm",3,"click","title","ngbTooltip","disabled"],[1,"fas","fa-undo-alt","fa-fw"],["class","btn btn-outline-secondary ds-drag-handle btn-sm","data-test","metadata-drag-btn","cdkDragHandle","",3,"cdkDragHandleDisabled","ngClass","disabled","title","ngbTooltip",4,"ngVar"],["role","cell",1,"flex-grow-1","ds-flex-cell","ds-value-cell","d-flex","flex-column"],["class","form-control","rows","5",3,"ngModel","dsDebounce","ngModelChange","onDebounce",4,"ngIf"],[3,"bindId","group","model","change",4,"ngIf"],[3,"group","model","change",4,"ngIf"],[4,"ngIf"],["class","mt-2",4,"ngIf"],["class","d-flex",4,"ngIf"],[1,"dont-break-out","preserve-line-breaks"],["rows","5",1,"form-control",3,"ngModelChange","onDebounce","ngModel","dsDebounce"],[3,"change","bindId","group","model"],[3,"change","group","model"],[1,"badge","badge-light","border"],["dsAuthorityConfidenceState","","aria-hidden","true",1,"fas","fa-fw","p-0",3,"authorityValue","iconMode"],[1,"mt-2"],[1,"btn-group","w-75"],["dsAuthorityConfidenceState","","aria-hidden","true",1,"fas","fa-fw","p-0","mr-1","mt-auto","mb-auto",3,"authorityValue","iconMode"],["data-test","authority-input",1,"form-control","form-outline",3,"ngModelChange","change","ngModel","disabled"],["class","btn btn-outline-secondary btn-sm ng-star-inserted","id","metadata-confirm-btn",3,"title","ngbTooltip","click",4,"ngIf"],["class","btn btn-outline-success btn-sm ng-star-inserted","id","metadata-confirm-btn",3,"title","ngbTooltip","click",4,"ngIf"],["id","metadata-confirm-btn",1,"btn","btn-outline-secondary","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip"],[1,"fas","fa-lock","fa-fw"],["id","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip"],[1,"fas","fa-lock-open","fa-fw"],[1,"d-flex"],["target","_blank",1,"mr-2",3,"routerLink"],[3,"object"],["type","text",1,"form-control",3,"ngModelChange","onDebounce","ngModel","dsDebounce"],["data-test","metadata-edit-btn",1,"btn","btn-outline-primary","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip","disabled"],[1,"fas","fa-edit","fa-fw"],["data-test","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip","disabled"],[1,"fas","fa-check","fa-fw"],["data-test","metadata-drag-btn","cdkDragHandle","",1,"btn","btn-outline-secondary","ds-drag-handle","btn-sm",3,"cdkDragHandleDisabled","ngClass","disabled","title","ngbTooltip"],[1,"fas","fa-grip-vertical","fa-fw"]],template:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_19__.DNE(0,DsoEditMetadataValueComponent_div_0_Template,25,37,"div",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_19__.Y8G("ngVar",ctx.metadataService.isVirtual(ctx.mdValue.newValue))},dependencies:[_shared_utils_var_directive__WEBPACK_IMPORTED_MODULE_27__.r,_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_28__.T1,_angular_common__WEBPACK_IMPORTED_MODULE_29__.YU,_angular_common__WEBPACK_IMPORTED_MODULE_29__.bT,_angular_forms__WEBPACK_IMPORTED_MODULE_20__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_20__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_20__.BC,_angular_forms__WEBPACK_IMPORTED_MODULE_20__.vS,_shared_utils_debounce_directive__WEBPACK_IMPORTED_MODULE_30__.R,_angular_router__WEBPACK_IMPORTED_MODULE_31__.Wk,_shared_object_collection_shared_badges_type_badge_themed_type_badge_component__WEBPACK_IMPORTED_MODULE_17__.C,_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_32__.n8,_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_32__.md,_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_28__.Fb,_angular_common__WEBPACK_IMPORTED_MODULE_29__.Jj,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_26__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_26__.D9,_shared_form_builder_ds_dynamic_form_ui_models_scrollable_dropdown_dynamic_scrollable_dropdown_component__WEBPACK_IMPORTED_MODULE_13__.s,_shared_form_builder_ds_dynamic_form_ui_models_onebox_dynamic_onebox_component__WEBPACK_IMPORTED_MODULE_11__.d,_shared_form_directives_authority_confidence_state_directive__WEBPACK_IMPORTED_MODULE_16__.K],styles:[".ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg);border:1px solid var(--bs-success)}.ds-drag-handle[_ngcontent-%COMP%]:not(.disabled){cursor:grab}  .edit-field>ngb-tooltip-window .tooltip-inner{min-width:var(--ds-dso-edit-virtual-tooltip-min-width)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}",".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success)}"]})}return DsoEditMetadataValueComponent2})()},12139:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DsoEditMetadataComponent:()=>DsoEditMetadataComponent});var common=__webpack_require__(84739),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),app_config_interface=__webpack_require__(59945),lazy_data_service=__webpack_require__(56964),shared_operators=(__webpack_require__(48168),__webpack_require__(82656)),resource_type=__webpack_require__(94554),alert_component=__webpack_require__(14467),alert_type=__webpack_require__(82555),empty_util=__webpack_require__(77028),themed_loading_component=__webpack_require__(32943),notifications_service=__webpack_require__(10117),dso_edit_metadata_field_values_component=__webpack_require__(91744),dso_edit_metadata_form=__webpack_require__(17533),dso_edit_metadata_headers_component=__webpack_require__(69252),dso_edit_metadata_value_component=__webpack_require__(36604),dso_edit_metadata_value_headers_component=__webpack_require__(91252),metadata_field_selector_component=__webpack_require__(19844),core=__webpack_require__(68014),router=__webpack_require__(64247),drag_drop=__webpack_require__(23306);let ArrayMoveChangeAnalyzer=(()=>{class ArrayMoveChangeAnalyzer2{diff(array1,array2){return this.getMoves(array1,array2).map(move=>Object.assign({op:"move",from:"/"+move[0],path:"/"+move[1]}))}getMoves(array1,array2){const moved=[...array2];return array1.reduce((moves,item,index)=>{if((0,empty_util.a4)(item)&&item!==moved[index]){const last=moved.lastIndexOf(item);(0,drag_drop.HD)(moved,last,index),moves.unshift([index,last])}return moves},[])}static#_=this.\u0275fac=function(t){return new(t||ArrayMoveChangeAnalyzer2)};static#_2=this.\u0275prov=core.jDH({token:ArrayMoveChangeAnalyzer2,factory:ArrayMoveChangeAnalyzer2.\u0275fac,providedIn:"root"})}return ArrayMoveChangeAnalyzer2})();function DsoEditMetadataComponent_div_0_button_9_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"button",20),core.nI1(1,"async"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r3);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.reinstate())}),core.nrm(3,"i",21),core.j41(4,"span",6),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("disabled",core.bMT(1,3,ctx_r1.saving$))("title",core.bMT(2,5,ctx_r1.dsoType+".edit.metadata.reinstate-button")),core.R7$(5),core.SpI("\xa0",core.bMT(6,7,ctx_r1.dsoType+".edit.metadata.reinstate-button"),"")}}function DsoEditMetadataComponent_div_0_button_17_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",22),core.nI1(1,"translate"),core.nI1(2,"async"),core.bIt("click",function(){core.eBV(_r4);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.discard())}),core.nrm(3,"i",23),core.j41(4,"span",6),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("title",core.bMT(1,3,ctx_r1.dsoType+".edit.metadata.discard-button"))("disabled",!ctx_r1.hasChanges||core.bMT(2,5,ctx_r1.saving$)),core.R7$(5),core.SpI("\xa0",core.bMT(6,7,ctx_r1.dsoType+".edit.metadata.discard-button"),"")}}function DsoEditMetadataComponent_div_0_div_21_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",24)(1,"div",25)(2,"ds-metadata-field-selector",26),core.mxI("mdFieldChange",function($event){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.DH7(ctx_r1.newMdField,$event)||(ctx_r1.newMdField=$event),core.Njj($event)}),core.k0s()(),core.j41(3,"div",27)(4,"div",11),core.nrm(5,"ds-dso-edit-metadata-value-headers",28),core.j41(6,"ds-dso-edit-metadata-value",29),core.bIt("confirm",function($event){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.confirmNewValue($event))})("remove",function(){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.form.newValue=void 0)})("undo",function(){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.form.newValue=void 0)}),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG(2);core.R7$(2),core.Y8G("dsoType",ctx_r1.dsoType),core.R50("mdField",ctx_r1.newMdField),core.Y8G("autofocus",!0),core.R7$(3),core.Y8G("dsoType",ctx_r1.dsoType),core.R7$(),core.Y8G("dso",ctx_r1.dso)("mdValue",ctx_r1.form.newValue)("dsoType",ctx_r1.dsoType)("saving$",ctx_r1.savingOrLoadingFieldValidation$)("isOnlyValue",!0)("mdField",ctx_r1.newMdField)}}function DsoEditMetadataComponent_div_0_div_22_div_4_Template(rf,ctx){if(1&rf){const _r7=core.RV6();core.j41(0,"div",34),core.bIt("click",function(){core.eBV(_r7);const mdField_r8=core.XpG().$implicit,ctx_r1=core.XpG(2);return ctx_r1.form.resetOrder(mdField_r8),core.Njj(ctx_r1.onValueSaved())}),core.EFF(1),core.nI1(2,"translate"),core.k0s()}if(2&rf){const ctx_r1=core.XpG(3);core.R7$(),core.SpI(" ",core.bMT(2,1,ctx_r1.dsoType+".edit.metadata.reset-order-button")," ")}}function DsoEditMetadataComponent_div_0_div_22_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",24)(1,"div",30)(2,"span",31),core.EFF(3),core.k0s(),core.DNE(4,DsoEditMetadataComponent_div_0_div_22_div_4_Template,3,3,"div",32),core.k0s(),core.j41(5,"ds-dso-edit-metadata-field-values",33),core.bIt("valueSaved",function(){core.eBV(_r6);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.onValueSaved())}),core.k0s()()}if(2&rf){const mdField_r8=ctx.$implicit,ctx_r1=core.XpG(2);core.R7$(3),core.JRh(mdField_r8),core.R7$(),core.Y8G("ngIf",ctx_r1.form.hasOrderChanges(mdField_r8)),core.R7$(),core.Y8G("dso",ctx_r1.dso)("form",ctx_r1.form)("dsoType",ctx_r1.dsoType)("saving$",ctx_r1.saving$)("draggingMdField$",ctx_r1.draggingMdField$)("mdField",mdField_r8)}}function DsoEditMetadataComponent_div_0_div_23_Template(rf,ctx){if(1&rf&&(core.j41(0,"div"),core.nrm(1,"ds-alert",35),core.k0s()),2&rf){const ctx_r1=core.XpG(2);core.R7$(),core.Y8G("content",ctx_r1.dsoType+".edit.metadata.empty")("type",ctx_r1.AlertTypeEnum.Info)}}function DsoEditMetadataComponent_div_0_button_26_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"button",36),core.nI1(1,"async"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r9);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.reinstate())}),core.nrm(3,"i",21),core.EFF(4),core.nI1(5,"translate"),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("disabled",core.bMT(1,3,ctx_r1.saving$))("title",core.bMT(2,5,ctx_r1.dsoType+".edit.metadata.reinstate-button")),core.R7$(4),core.SpI(" ",core.bMT(5,7,ctx_r1.dsoType+".edit.metadata.reinstate-button")," ")}}function DsoEditMetadataComponent_div_0_button_33_Template(rf,ctx){if(1&rf){const _r10=core.RV6();core.j41(0,"button",37),core.nI1(1,"translate"),core.nI1(2,"async"),core.bIt("click",function(){core.eBV(_r10);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.discard())}),core.nrm(3,"i",23),core.EFF(4),core.nI1(5,"translate"),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("title",core.bMT(1,3,ctx_r1.dsoType+".edit.metadata.discard-button"))("disabled",!ctx_r1.hasChanges||core.bMT(2,5,ctx_r1.saving$)),core.R7$(4),core.SpI(" ",core.bMT(5,7,ctx_r1.dsoType+".edit.metadata.discard-button")," ")}}function DsoEditMetadataComponent_div_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",2)(1,"div",3)(2,"button",4),core.nI1(3,"async"),core.nI1(4,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.add())}),core.nrm(5,"i",5),core.j41(6,"span",6),core.EFF(7),core.nI1(8,"translate"),core.k0s()(),core.DNE(9,DsoEditMetadataComponent_div_0_button_9_Template,7,9,"button",7),core.j41(10,"button",8),core.nI1(11,"async"),core.nI1(12,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.nrm(13,"i",9),core.j41(14,"span",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()(),core.DNE(17,DsoEditMetadataComponent_div_0_button_17_Template,7,9,"button",10),core.k0s(),core.j41(18,"div",11),core.nI1(19,"translate"),core.nrm(20,"ds-dso-edit-metadata-headers",12),core.DNE(21,DsoEditMetadataComponent_div_0_div_21_Template,7,10,"div",13)(22,DsoEditMetadataComponent_div_0_div_22_Template,6,8,"div",14),core.k0s(),core.DNE(23,DsoEditMetadataComponent_div_0_div_23_Template,2,2,"div",1),core.j41(24,"div",15)(25,"div",16),core.DNE(26,DsoEditMetadataComponent_div_0_button_26_Template,6,9,"button",17),core.j41(27,"button",18),core.nI1(28,"async"),core.nI1(29,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.nrm(30,"i",9),core.EFF(31),core.nI1(32,"translate"),core.k0s(),core.DNE(33,DsoEditMetadataComponent_div_0_button_33_Template,6,9,"button",19),core.k0s()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.Y8G("disabled",ctx_r1.form.newValue||core.bMT(3,18,ctx_r1.saving$))("title",core.bMT(4,20,ctx_r1.dsoType+".edit.metadata.add-button")),core.R7$(5),core.SpI("\xa0",core.bMT(8,22,ctx_r1.dsoType+".edit.metadata.add-button"),""),core.R7$(2),core.Y8G("ngIf",ctx_r1.isReinstatable),core.R7$(),core.Y8G("disabled",!ctx_r1.hasChanges||core.bMT(11,24,ctx_r1.saving$))("title",core.bMT(12,26,ctx_r1.dsoType+".edit.metadata.save-button")),core.R7$(5),core.SpI("\xa0",core.bMT(16,28,ctx_r1.dsoType+".edit.metadata.save-button"),""),core.R7$(2),core.Y8G("ngIf",!ctx_r1.isReinstatable),core.R7$(),core.BMQ("aria-label",core.bMT(19,30,"item.edit.head")),core.R7$(2),core.Y8G("dsoType",ctx_r1.dsoType),core.R7$(),core.Y8G("ngIf",ctx_r1.form.newValue),core.R7$(),core.Y8G("ngForOf",ctx_r1.form.fieldKeys),core.R7$(),core.Y8G("ngIf",ctx_r1.isEmpty&&!ctx_r1.form.newValue),core.R7$(3),core.Y8G("ngIf",ctx_r1.isReinstatable),core.R7$(),core.Y8G("disabled",!ctx_r1.hasChanges||core.bMT(28,32,ctx_r1.saving$))("title",core.bMT(29,34,ctx_r1.dsoType+".edit.metadata.save-button")),core.R7$(4),core.SpI(" ",core.bMT(32,36,ctx_r1.dsoType+".edit.metadata.save-button")," "),core.R7$(2),core.Y8G("ngIf",!ctx_r1.isReinstatable)}}function DsoEditMetadataComponent_ds_loading_1_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}let DsoEditMetadataComponent=(()=>{class DsoEditMetadataComponent2{constructor(route,notificationsService,translateService,parentInjector,arrayMoveChangeAnalyser,cdr,dataServiceMap){this.route=route,this.notificationsService=notificationsService,this.translateService=translateService,this.parentInjector=parentInjector,this.arrayMoveChangeAnalyser=arrayMoveChangeAnalyser,this.cdr=cdr,this.dataServiceMap=dataServiceMap,this.saving$=new cjs.BehaviorSubject(!1),this.draggingMdField$=new cjs.BehaviorSubject(null),this.loadingFieldValidation$=new cjs.BehaviorSubject(!1),this.AlertTypeEnum=alert_type.v}ngOnInit(){(0,empty_util.Tn)(this.dso)?this.dsoUpdateSubscription=(0,cjs.combineLatest)([this.route.data,this.route.parent.data]).pipe((0,operators.Tj)(([data,parentData])=>Object.assign({},data,parentData)),(0,operators.Mi)(data=>this.initDSO(data.dso.payload)),(0,operators.ZZ)(()=>this.retrieveDataService())).subscribe(dataService=>{this.initDataService(dataService),this.initForm()}):(this.initDSOType(this.dso),this.retrieveDataService().subscribe(dataService=>{this.initDataService(dataService),this.initForm()})),this.savingOrLoadingFieldValidation$=(0,cjs.combineLatest)([this.saving$,this.loadingFieldValidation$]).pipe((0,operators.Tj)(([saving,loading])=>saving||loading))}retrieveDataService(){return(0,empty_util.Tn)(this.updateDataService)?(0,lazy_data_service.M)(this.dataServiceMap,this.dsoType,this.parentInjector):(0,cjs.of)(this.updateDataService)}initDSO(object){this.dso=object,this.initDSOType(object)}initDSOType(object){let type;type="string"==typeof object.type?new resource_type.v(object.type):object.type,this.dsoType=type.value}initDataService(dataService){(0,empty_util.hj)(dataService)&&(this.updateDataService=dataService)}initForm(){this.form=new dso_edit_metadata_form.qf(this.dso.metadata),this.onValueSaved(),this.cdr.detectChanges()}onValueSaved(){this.hasChanges=this.form.hasChanges(),this.isReinstatable=this.form.isReinstatable(),this.isEmpty=0===Object.keys(this.form.fields).length}submit(){this.saving$.next(!0),this.updateDataService.patch(this.dso,this.form.getOperations(this.arrayMoveChangeAnalyser)).pipe((0,shared_operators.qD)()).subscribe(rd=>{this.saving$.next(!1),rd.hasFailed?this.notificationsService.error(this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.error.title`),rd.errorMessage):(this.notificationsService.success(this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.saved.title`),this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.saved.content`)),this.dso=rd.payload,this.initForm())})}confirmNewValue(saved){saved&&this.setMetadataField()}setMetadataField(){this.form.resetReinstatable(),this.loadingFieldValidation$.next(!0),this.metadataFieldSelectorComponent.validate().subscribe(valid=>{this.loadingFieldValidation$.next(!1),valid&&(this.form.setMetadataField(this.newMdField),this.onValueSaved())})}add(){this.newMdField=void 0,this.form.add()}discard(){this.form.discard(),this.onValueSaved()}reinstate(){this.form.reinstate(),this.onValueSaved()}ngOnDestroy(){(0,empty_util.a4)(this.dsoUpdateSubscription)&&this.dsoUpdateSubscription.unsubscribe()}static#_=this.\u0275fac=function(t){return new(t||DsoEditMetadataComponent2)(core.rXU(router.nX),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(core.zZn),core.rXU(ArrayMoveChangeAnalyzer),core.rXU(core.gRc),core.rXU(app_config_interface.l9))};static#_2=this.\u0275cmp=core.VBU({type:DsoEditMetadataComponent2,selectors:[["ds-base-dso-edit-metadata"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(metadata_field_selector_component.g,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.metadataFieldSelectorComponent=_t.first)}},inputs:{dso:"dso",updateDataService:"updateDataService"},standalone:!0,features:[core.aNF],decls:2,vars:2,consts:[["class","item-metadata",4,"ngIf"],[4,"ngIf"],[1,"item-metadata"],[1,"button-row","top","d-flex","my-2","space-children-mr","ml-gap"],["id","dso-add-btn",1,"mr-auto","btn","btn-success",3,"click","disabled","title"],["aria-hidden","true",1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["class","btn btn-warning ml-1","id","dso-reinstate-btn",3,"disabled","title","click",4,"ngIf"],["id","dso-save-btn",1,"btn","btn-primary","ml-1",3,"click","disabled","title"],["aria-hidden","true",1,"fas","fa-save"],["class","btn btn-danger ml-1","id","dso-discard-btn",3,"title","disabled","click",4,"ngIf"],["role","table"],[3,"dsoType"],["class","d-flex flex-row ds-field-row","role","row",4,"ngIf"],["class","d-flex flex-row ds-field-row","role","row",4,"ngFor","ngForOf"],[1,"button-row","bottom","d-inline-block","w-100"],[1,"mt-2","float-right","space-children-mr","ml-gap"],["class","btn btn-warning",3,"disabled","title","click",4,"ngIf"],[1,"btn","btn-primary",3,"click","disabled","title"],["class","btn btn-danger",3,"title","disabled","click",4,"ngIf"],["id","dso-reinstate-btn",1,"btn","btn-warning","ml-1",3,"click","disabled","title"],["aria-hidden","true",1,"fas","fa-undo-alt"],["id","dso-discard-btn",1,"btn","btn-danger","ml-1",3,"click","title","disabled"],["aria-hidden","true",1,"fas","fa-times"],["role","row",1,"d-flex","flex-row","ds-field-row"],["role","rowheader",1,"lbl-cell","ds-success"],[3,"mdFieldChange","dsoType","mdField","autofocus"],["role","cell",1,"flex-grow-1","ds-drop-list"],["role","presentation",3,"dsoType"],[3,"confirm","remove","undo","dso","mdValue","dsoType","saving$","isOnlyValue","mdField"],["role","rowheader",1,"lbl-cell"],[1,"dont-break-out","preserve-line-breaks"],["class","btn btn-warning reset-order-button mt-2 w-100",3,"click",4,"ngIf"],["role","cell",1,"flex-grow-1",3,"valueSaved","dso","form","dsoType","saving$","draggingMdField$","mdField"],[1,"btn","btn-warning","reset-order-button","mt-2","w-100",3,"click"],[3,"content","type"],[1,"btn","btn-warning",3,"click","disabled","title"],[1,"btn","btn-danger",3,"click","title","disabled"]],template:function(rf,ctx){1&rf&&core.DNE(0,DsoEditMetadataComponent_div_0_Template,34,38,"div",0)(1,DsoEditMetadataComponent_ds_loading_1_Template,1,0,"ds-loading",1),2&rf&&(core.Y8G("ngIf",ctx.form),core.R7$(),core.Y8G("ngIf",!ctx.form))},dependencies:[common.bT,dso_edit_metadata_headers_component.L,metadata_field_selector_component.g,dso_edit_metadata_value_headers_component.c,dso_edit_metadata_value_component.o,common.pM,dso_edit_metadata_field_values_component.t,alert_component.C,themed_loading_component.v,common.Jj,ngx_translate_core.h,ngx_translate_core.D9],styles:[".lbl-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-field-width);max-width:var(--ds-dso-edit-field-width);background-color:var(--bs-gray-100);font-weight:700;padding:1rem;border:1px solid var(--bs-gray-200)}.lbl-cell.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg);border:1px solid var(--bs-success)}.ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.reset-order-button[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}return DsoEditMetadataComponent2})()},19844:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{g:()=>MetadataFieldSelectorComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(84739),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68014),_angular_forms__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(28955),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(43750),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(10743),_core_cache_models_sort_options_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80685),_core_registry_registry_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10893),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(82656),_shared_empty_util__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(77028),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10117),_shared_utils_click_outside_directive__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(48442),_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(32181);const _c0=["mdFieldInput"],_c1=a0=>({"is-invalid":a0}),_c2=a0=>({show:a0});function MetadataFieldSelectorComponent_div_4_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.j41(0,"div",7),_angular_core__WEBPACK_IMPORTED_MODULE_4__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.k0s()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_4__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_4__.bMT(2,1,ctx_r1.dsoType+".edit.metadata.metadatafield.invalid"))}}function MetadataFieldSelectorComponent_div_8_Template(rf,ctx){if(1&rf){const _r3=_angular_core__WEBPACK_IMPORTED_MODULE_4__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_4__.j41(0,"div")(1,"button",8),_angular_core__WEBPACK_IMPORTED_MODULE_4__.bIt("click",function(){const mdFieldOption_r4=_angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r3).$implicit,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_4__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(ctx_r1.select(mdFieldOption_r4))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nrm(2,"span",9),_angular_core__WEBPACK_IMPORTED_MODULE_4__.k0s()()}if(2&rf){const mdFieldOption_r4=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y8G("innerHTML",mdFieldOption_r4,_angular_core__WEBPACK_IMPORTED_MODULE_4__.npT)}}let MetadataFieldSelectorComponent=(()=>{class MetadataFieldSelectorComponent2{constructor(registryService,notificationsService,translate){this.registryService=registryService,this.notificationsService=notificationsService,this.translate=translate,this.autofocus=!1,this.mdFieldChange=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.bkB,this.input=new _angular_forms__WEBPACK_IMPORTED_MODULE_5__.hs,this.query$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.BehaviorSubject(null),this.debounceTime=300,this.selectedValueLoading=!1,this.showInvalid=!1,this.subs=[]}ngOnInit(){this.subs.push(this.input.valueChanges.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.BL)(this.debounceTime)).subscribe(valueChange=>{this.selectedValueLoading||this.query$.next(valueChange),this.selectedValueLoading=!1,this.mdField=valueChange,this.mdFieldChange.emit(this.mdField)})),this.mdFieldOptions$=this.query$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.F)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.nx)(query=>(this.showInvalid=!1,null!==query?this.registryService.queryMetadataFields(query,{elementsPerPage:10,sort:new _core_cache_models_sort_options_model__WEBPACK_IMPORTED_MODULE_0__.z("fieldName",_core_cache_models_sort_options_model__WEBPACK_IMPORTED_MODULE_0__.U.ASC)},!0,!1,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_8__.s)("schema")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.v7)(),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.LB)()):[[]])))}ngAfterViewInit(){this.autofocus&&this.mdFieldInput.nativeElement.focus()}validate(){return this.registryService.queryMetadataFields(this.mdField,null,!0,!1,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_8__.s)("schema")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.nx)(rd=>rd.hasSucceeded?(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(rd).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.LB)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Tj)(fields=>fields.indexOf(this.mdField)>-1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Mi)(exists=>this.showInvalid=!exists)):(this.notificationsService.error(this.translate.instant(`${this.dsoType}.edit.metadata.metadatafield.error`),rd.errorMessage),[!1])))}select(mdFieldOption){this.selectedValueLoading=!0,this.input.setValue(mdFieldOption)}ngOnDestroy(){this.subs.filter(sub=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_9__.a4)(sub)).forEach(sub=>sub.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||MetadataFieldSelectorComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_4__.rXU(_core_registry_registry_service__WEBPACK_IMPORTED_MODULE_1__.x),_angular_core__WEBPACK_IMPORTED_MODULE_4__.rXU(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__.I),_angular_core__WEBPACK_IMPORTED_MODULE_4__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.c$))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_4__.VBU({type:MetadataFieldSelectorComponent2,selectors:[["ds-metadata-field-selector"]],viewQuery:function(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_4__.GBs(_c0,7),2&rf){let _t;_angular_core__WEBPACK_IMPORTED_MODULE_4__.mGM(_t=_angular_core__WEBPACK_IMPORTED_MODULE_4__.lsd())&&(ctx.mdFieldInput=_t.first)}},inputs:{dsoType:"dsoType",mdField:"mdField",autofocus:"autofocus"},outputs:{mdFieldChange:"mdFieldChange"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_4__.aNF],decls:10,vars:17,consts:[["mdFieldInput",""],[1,"w-100","position-relative"],["type","text",1,"form-control",3,"focusin","dsClickOutside","click","ngClass","value","formControl"],["class","invalid-feedback show-feedback",4,"ngIf"],[1,"autocomplete","dropdown-menu",3,"ngClass"],[1,"dropdown-list"],[4,"ngFor","ngForOf"],[1,"invalid-feedback","show-feedback"],[1,"d-block","dropdown-item",3,"click"],[3,"innerHTML"]],template:function(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_4__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_4__.j41(0,"div",1)(1,"input",2,0),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.bIt("focusin",function(){return _angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(ctx.query$.next(ctx.mdField))})("dsClickOutside",function(){return _angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(ctx.query$.next(null))})("click",function($event){return _angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj($event.stopPropagation())}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.DNE(4,MetadataFieldSelectorComponent_div_4_Template,3,3,"div",3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.j41(5,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nI1(6,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.j41(7,"div",5),_angular_core__WEBPACK_IMPORTED_MODULE_4__.DNE(8,MetadataFieldSelectorComponent_div_8_Template,3,1,"div",6),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nI1(9,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.k0s()()()}if(2&rf){let tmp_6_0;_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y8G("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_4__.eq3(13,_c1,ctx.showInvalid))("value",ctx.mdField)("formControl",ctx.input),_angular_core__WEBPACK_IMPORTED_MODULE_4__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_4__.bMT(3,7,ctx.dsoType+".edit.metadata.metadatafield")),_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y8G("ngIf",ctx.showInvalid),_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y8G("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_4__.eq3(15,_c2,(null==(tmp_6_0=_angular_core__WEBPACK_IMPORTED_MODULE_4__.bMT(6,9,ctx.mdFieldOptions$))?null:tmp_6_0.length)>0)),_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y8G("ngForOf",_angular_core__WEBPACK_IMPORTED_MODULE_4__.bMT(9,11,ctx.mdFieldOptions$))}},dependencies:[_angular_forms__WEBPACK_IMPORTED_MODULE_5__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.BC,_angular_common__WEBPACK_IMPORTED_MODULE_11__.YU,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.X1,_angular_forms__WEBPACK_IMPORTED_MODULE_5__.l_,_shared_utils_click_outside_directive__WEBPACK_IMPORTED_MODULE_12__.z,_angular_common__WEBPACK_IMPORTED_MODULE_11__.bT,_angular_common__WEBPACK_IMPORTED_MODULE_11__.pM,_angular_common__WEBPACK_IMPORTED_MODULE_11__.Jj,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.D9]})}return MetadataFieldSelectorComponent2})()},54990:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>ThemedDsoEditMetadataComponent}),__webpack_require__(48168);var _shared_theme_support_themed_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(31260),_angular_core__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(12139),__webpack_require__(68014));const _c0=["*"];function ThemedDsoEditMetadataComponent_ng_template_0_Template(rf,ctx){}let ThemedDsoEditMetadataComponent=(()=>{class ThemedDsoEditMetadataComponent2 extends _shared_theme_support_themed_component__WEBPACK_IMPORTED_MODULE_1__.J{constructor(){super(...arguments),this.inAndOutputNames=["dso","updateDataService"]}getComponentName(){return"DsoEditMetadataComponent"}importThemedComponent(themeName){return __webpack_require__(30207)(`./${themeName}/app/dso-shared/dso-edit-metadata/dso-edit-metadata.component`)}importUnthemedComponent(){return Promise.resolve().then(__webpack_require__.bind(__webpack_require__,12139))}static#_=this.\u0275fac=(()=>{let \u0275ThemedDsoEditMetadataComponent_BaseFactory;return function(t){return(\u0275ThemedDsoEditMetadataComponent_BaseFactory||(\u0275ThemedDsoEditMetadataComponent_BaseFactory=_angular_core__WEBPACK_IMPORTED_MODULE_3__.xGo(ThemedDsoEditMetadataComponent2)))(t||ThemedDsoEditMetadataComponent2)}})();static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_3__.VBU({type:ThemedDsoEditMetadataComponent2,selectors:[["ds-dso-edit-metadata"]],inputs:{dso:"dso",updateDataService:"updateDataService"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_3__.Vt3,_angular_core__WEBPACK_IMPORTED_MODULE_3__.aNF],ngContentSelectors:_c0,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_3__.NAR(),_angular_core__WEBPACK_IMPORTED_MODULE_3__.DNE(0,ThemedDsoEditMetadataComponent_ng_template_0_Template,0,0,"ng-template",null,0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.C5r),_angular_core__WEBPACK_IMPORTED_MODULE_3__.j41(2,"div",null,1),_angular_core__WEBPACK_IMPORTED_MODULE_3__.SdG(4),_angular_core__WEBPACK_IMPORTED_MODULE_3__.k0s())},encapsulation:2})}return ThemedDsoEditMetadataComponent2})()},36155:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES});var i18n_breadcrumb_resolver=__webpack_require__(21870),themed_dso_edit_metadata_component=__webpack_require__(54990),resource_policy_create_component=__webpack_require__(96315),resource_policy_edit_component=__webpack_require__(28319),resource_policy_resolver=__webpack_require__(48576),resource_policy_target_resolver=__webpack_require__(20312),common=__webpack_require__(84739),core=__webpack_require__(68014),router=__webpack_require__(64247),ng_bootstrap=__webpack_require__(71781),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),fade=__webpack_require__(28107),empty_util=__webpack_require__(77028),item_page_routing_paths=__webpack_require__(63254);const _c0=a0=>({active:a0}),_c1=a0=>[a0];function EditItemPageComponent_ul_7_li_1_a_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"a",18),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const page_r1=core.XpG().$implicit,ctx_r1=core.XpG(2);core.Y8G("ngClass",core.eq3(7,_c0,page_r1.page===ctx_r1.currentPage))("routerLink",core.eq3(9,_c1,"./"+page_r1.page)),core.BMQ("aria-selected",page_r1.page===ctx_r1.currentPage)("data-test",page_r1.page),core.R7$(),core.SpI(" ",core.bMT(2,5,"item.edit.tabs."+page_r1.page+".head")," ")}}function EditItemPageComponent_ul_7_li_1_button_5_Template(rf,ctx){if(1&rf&&(core.j41(0,"button",19),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const page_r1=core.XpG().$implicit;core.R7$(),core.SpI(" ",core.bMT(2,1,"item.edit.tabs."+page_r1.page+".head")," ")}}function EditItemPageComponent_ul_7_li_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"li",14),core.DNE(1,EditItemPageComponent_ul_7_li_1_a_1_Template,3,11,"a",15),core.nI1(2,"async"),core.j41(3,"span",16),core.nI1(4,"translate"),core.DNE(5,EditItemPageComponent_ul_7_li_1_button_5_Template,3,3,"button",17),core.nI1(6,"async"),core.k0s()()),2&rf){const page_r1=ctx.$implicit;core.R7$(),core.Y8G("ngIf",core.bMT(2,3,page_r1.enabled)),core.R7$(2),core.Y8G("ngbTooltip",core.bMT(4,5,"item.edit.tabs.disabled.tooltip")),core.R7$(2),core.Y8G("ngIf",!0!==core.bMT(6,7,page_r1.enabled))}}function EditItemPageComponent_ul_7_Template(rf,ctx){if(1&rf&&(core.j41(0,"ul",12),core.DNE(1,EditItemPageComponent_ul_7_li_1_Template,7,9,"li",13),core.k0s()),2&rf){const ctx_r1=core.XpG();core.R7$(),core.Y8G("ngForOf",ctx_r1.pages)}}let EditItemPageComponent=(()=>{class EditItemPageComponent2{constructor(route,router2,injector){this.route=route,this.router=router2,this.injector=injector,this.router.events.subscribe(()=>this.initPageParamsByRoute())}ngOnInit(){this.initPageParamsByRoute(),this.pages=this.route.routeConfig.children.filter(child=>(0,empty_util.hj)(child.path)).map(child=>{let enabled=(0,cjs.of)(!0);return(0,empty_util.hj)(child.canActivate)&&(enabled=(0,cjs.combineLatest)(child.canActivate.map(guardFn=>(0,core.N4e)(this.injector,()=>guardFn(this.route.snapshot,this.router.routerState.snapshot)))).pipe((0,operators.Tj)(canActivateOutcomes=>canActivateOutcomes.every(e=>!0===e)))),{page:child.path,enabled}}),this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso))}getItemPage(item){return(0,item_page_routing_paths._o)(item)}initPageParamsByRoute(){this.currentPage=this.route.snapshot.firstChild.routeConfig.path}static#_=this.\u0275fac=function(t){return new(t||EditItemPageComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(core.zZn))};static#_2=this.\u0275cmp=core.VBU({type:EditItemPageComponent2,selectors:[["ds-edit-item-page"]],standalone:!0,features:[core.aNF],decls:18,vars:10,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"border-bottom"],[1,"pt-2"],["class","nav nav-tabs justify-content-start","role","tablist",4,"ngIf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"button-row","bottom"],[1,"text-right"],["role","button",1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"],["role","tablist",1,"nav","nav-tabs","justify-content-start"],["class","nav-item","role","presentation",4,"ngFor","ngForOf"],["role","presentation",1,"nav-item"],["class","nav-link","role","tab",3,"ngClass","routerLink",4,"ngIf"],[3,"ngbTooltip"],["class","nav-link disabled",4,"ngIf"],["role","tab",1,"nav-link",3,"ngClass","routerLink"],[1,"nav-link","disabled"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"div",4),core.DNE(7,EditItemPageComponent_ul_7_Template,2,1,"ul",5),core.j41(8,"div",6)(9,"div",7),core.nrm(10,"router-outlet"),core.k0s(),core.j41(11,"div",8)(12,"div",9)(13,"a",10),core.nI1(14,"async"),core.nrm(15,"i",11),core.EFF(16),core.nI1(17,"translate"),core.k0s()()()()()()()()),2&rf){let tmp_2_0;core.R7$(4),core.JRh(core.bMT(5,4,"item.edit.head")),core.R7$(3),core.Y8G("ngIf",ctx.pages.length>0),core.R7$(6),core.Y8G("routerLink",ctx.getItemPage(null==(tmp_2_0=core.bMT(14,6,ctx.itemRD$))?null:tmp_2_0.payload)),core.R7$(3),core.SpI(" ",core.bMT(17,8,"item.edit.return"),"")}},dependencies:[ngx_translate_core.h,ngx_translate_core.D9,common.YU,common.bT,common.Sq,common.Jj,ng_bootstrap.n8,ng_bootstrap.md,router.Wk,router.n3],encapsulation:2,data:{animation:[fade.qG,fade.Ws]},changeDetection:0})}return EditItemPageComponent2})();var edit_item_page_routing_paths=__webpack_require__(62181),shared_operators=__webpack_require__(82656),access_control_form_container_component=__webpack_require__(61085);function ItemAccessControlComponent_ds_access_control_form_container_0_Template(rf,ctx){1&rf&&core.nrm(0,"ds-access-control-form-container",1),2&rf&&core.Y8G("itemRD",ctx.ngIf)("showLimitToSpecificBitstreams",!0)}let ItemAccessControlComponent=(()=>{class ItemAccessControlComponent2{constructor(route){this.route=route}ngOnInit(){this.itemRD$=this.route.parent.parent.data.pipe((0,operators.Tj)(data=>data.dso)).pipe((0,shared_operators.yd)())}static#_=this.\u0275fac=function(t){return new(t||ItemAccessControlComponent2)(core.rXU(router.nX))};static#_2=this.\u0275cmp=core.VBU({type:ItemAccessControlComponent2,selectors:[["ds-item-access-control"]],standalone:!0,features:[core.aNF],decls:2,vars:3,consts:[["titleMessage","item-access-control-title",3,"itemRD","showLimitToSpecificBitstreams",4,"ngIf"],["titleMessage","item-access-control-title",3,"itemRD","showLimitToSpecificBitstreams"]],template:function(rf,ctx){1&rf&&(core.DNE(0,ItemAccessControlComponent_ds_access_control_form_container_0_Template,1,2,"ds-access-control-form-container",0),core.nI1(1,"async")),2&rf&&core.Y8G("ngIf",core.bMT(1,1,ctx.itemRD$))},dependencies:[access_control_form_container_component.o,common.bT,common.Jj]})}return ItemAccessControlComponent2})();var isEqual=__webpack_require__(20027),isEqual_default=__webpack_require__.n(isEqual),dso_name_service=__webpack_require__(91735),link_service=__webpack_require__(48614),paginated_list_model=__webpack_require__(12383),alert_component=__webpack_require__(14467);let NgForTrackByIdDirective=(()=>{class NgForTrackByIdDirective2{constructor(ngFor){this.ngFor=ngFor,this.ngFor.ngForTrackBy=(index,dso)=>dso?dso.id:void 0}static#_=this.\u0275fac=function(t){return new(t||NgForTrackByIdDirective2)(core.rXU(common.Sq,1))};static#_2=this.\u0275dir=core.FsC({type:NgForTrackByIdDirective2,selectors:[["","ngForTrackById",""]],standalone:!0})}return NgForTrackByIdDirective2})();var resource_policies_component=__webpack_require__(67848),follow_link_config_model=__webpack_require__(32181);function ItemAuthorizationsComponent_ng_container_5_ng_container_2_ng_container_7_Template(rf,ctx){if(1&rf&&(core.qex(0),core.nrm(1,"ds-resource-policies",5),core.bVm()),2&rf){const bitstream_r4=ctx.$implicit;core.R7$(),core.Y8G("resourceType","bitstream")("resourceUUID",bitstream_r4.id)("resourceName",bitstream_r4.name)}}function ItemAuthorizationsComponent_ng_container_5_ng_container_2_div_9_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",11)(1,"button",12),core.bIt("click",function(){core.eBV(_r5);const bundle_r2=core.XpG(2).$implicit,ctx_r2=core.XpG();return core.Njj(ctx_r2.onBitstreamsLoad(bundle_r2))}),core.EFF(2),core.nI1(3,"translate"),core.k0s()()}2&rf&&(core.R7$(2),core.JRh(core.bMT(3,1,"collection.edit.item.authorizations.load-more-button")))}function ItemAuthorizationsComponent_ng_container_5_ng_container_2_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.qex(0),core.j41(1,"div",7)(2,"div",8)(3,"button",9),core.bIt("click",function(){core.eBV(_r1);const bundle_r2=core.XpG().$implicit,ctx_r2=core.XpG();return core.Njj(ctx_r2.collapseArea(bundle_r2.id))}),core.EFF(4),core.nI1(5,"translate"),core.k0s()(),core.j41(6,"div",10),core.DNE(7,ItemAuthorizationsComponent_ng_container_5_ng_container_2_ng_container_7_Template,2,3,"ng-container",3),core.nI1(8,"async"),core.DNE(9,ItemAuthorizationsComponent_ng_container_5_ng_container_2_div_9_Template,4,3,"div",4),core.k0s()(),core.bVm()}if(2&rf){const bundle_r2=core.XpG().$implicit,ctx_r2=core.XpG();core.R7$(3),core.BMQ("aria-expanded",!1)("aria-controls",bundle_r2.id),core.R7$(),core.Lme(" ",core.bMT(5,8,"collection.edit.item.authorizations.show-bitstreams-button")," ",ctx_r2.nameService.getName(bundle_r2)," "),core.R7$(2),core.Y8G("id",bundle_r2.id)("ngbCollapse",ctx_r2.bundleBitstreamsMap.get(bundle_r2.id).isCollapsed),core.R7$(),core.Y8G("ngForOf",core.bMT(8,10,ctx_r2.bundleBitstreamsMap.get(bundle_r2.id).bitstreams)),core.R7$(2),core.Y8G("ngIf",!ctx_r2.bundleBitstreamsMap.get(bundle_r2.id).allBitstreamsLoaded)}}function ItemAuthorizationsComponent_ng_container_5_Template(rf,ctx){if(1&rf&&(core.qex(0),core.nrm(1,"ds-resource-policies",5),core.DNE(2,ItemAuthorizationsComponent_ng_container_5_ng_container_2_Template,10,12,"ng-container",6),core.nI1(3,"async"),core.bVm()),2&rf){let tmp_5_0;const bundle_r2=ctx.$implicit,ctx_r2=core.XpG();core.R7$(),core.Y8G("resourceType","bundle")("resourceUUID",bundle_r2.id)("resourceName",bundle_r2.name),core.R7$(),core.Y8G("ngIf",(null==(tmp_5_0=core.bMT(3,4,null==(tmp_5_0=ctx_r2.bundleBitstreamsMap.get(bundle_r2.id))?null:tmp_5_0.bitstreams))?null:tmp_5_0.length)>0)}}function ItemAuthorizationsComponent_div_7_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",11)(1,"button",12),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG();return core.Njj(ctx_r2.onBundleLoad())}),core.EFF(2),core.nI1(3,"translate"),core.k0s()()}2&rf&&(core.R7$(2),core.JRh(core.bMT(3,1,"collection.edit.item.authorizations.load-bundle-button")))}let ItemAuthorizationsComponent=(()=>{class ItemAuthorizationsComponent2{constructor(linkService,route,nameService){this.linkService=linkService,this.route=route,this.nameService=nameService,this.bundleBitstreamsMap=new Map,this.bundles$=new cjs.BehaviorSubject([]),this.subs=[],this.bundlesPerPage=6,this.bundlesPageSize=1,this.allBundlesLoaded=!1,this.bitstreamSize=4,this.bitstreamPageSize=4}ngOnInit(){this.getBundlesPerItem()}getItemUUID(){return this.item$.pipe((0,operators.Tj)(item=>item.id),(0,operators.$1)(UUID=>(0,empty_util.hj)(UUID)))}getItemName(){return this.item$.pipe((0,operators.Tj)(item=>this.nameService.getName(item)))}getItemBundles(){return this.bundles$.asObservable()}getBundlesPerItem(page=1){this.item$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.QQ)(),(0,operators.Tj)(item=>this.linkService.resolveLink(item,(0,follow_link_config_model.s)("bundles",{findListOptions:{currentPage:page,elementsPerPage:this.bundlesPerPage}},(0,follow_link_config_model.s)("bitstreams")))));const bundles$=this.item$.pipe((0,operators.pb)(item=>(0,empty_util.hj)(item.bundles)),(0,operators.ZZ)(item=>item.bundles),(0,shared_operators.QQ)(),(0,operators.WL)(error=>(console.error(error),(0,cjs.of)((0,paginated_list_model.g)(null,[])))));this.subs.push(bundles$.pipe((0,operators.s)(1),(0,operators.Tj)(list=>list.page)).subscribe(bundles=>{(isEqual_default()(bundles.length,0)||bundles.length<this.bundlesPerPage)&&(this.allBundlesLoaded=!0),isEqual_default()(page,1)?this.bundles$.next(bundles):this.bundles$.next(this.bundles$.getValue().concat(bundles))}),bundles$.pipe((0,operators.s)(1),(0,operators.ZZ)(list=>list.page),(0,operators.Tj)(bundle=>({id:bundle.id,bitstreams:this.getBundleBitstreams(bundle)}))).subscribe(entry=>{const bitstreamMapValues={isCollapsed:!0,allBitstreamsLoaded:!1,bitstreams:null};bitstreamMapValues.bitstreams=entry.bitstreams.pipe((0,operators.Tj)(b=>(bitstreamMapValues.allBitstreamsLoaded=b?.page.length<this.bitstreamSize,[...b.page.slice(0,this.bitstreamSize)]))),this.bundleBitstreamsMap.set(entry.id,bitstreamMapValues)}))}getBundleBitstreams(bundle){return bundle.bitstreams.pipe((0,shared_operators.ak)(),(0,operators.WL)(error=>(console.error(error),(0,cjs.of)((0,paginated_list_model.g)(null,[])))))}collapseArea(bundleId){this.bundleBitstreamsMap.get(bundleId).isCollapsed=!this.bundleBitstreamsMap.get(bundleId).isCollapsed}onBundleLoad(){this.bundlesPageSize++,this.getBundlesPerItem(this.bundlesPageSize)}onBitstreamsLoad(bundle){return this.getBundleBitstreams(bundle).subscribe(res=>{const nextBitstreams=res?.page.slice(this.bitstreamPageSize,this.bitstreamPageSize+this.bitstreamSize),bitstreamsToShow=this.bundleBitstreamsMap.get(bundle.id).bitstreams.pipe((0,operators.Tj)(existingBits=>[...existingBits,...nextBitstreams]));this.bitstreamPageSize=this.bitstreamPageSize+this.bitstreamSize;const bitstreamMapValues={bitstreams:bitstreamsToShow,isCollapsed:this.bundleBitstreamsMap.get(bundle.id).isCollapsed,allBitstreamsLoaded:res?.page.length<=this.bitstreamPageSize};this.bundleBitstreamsMap.set(bundle.id,bitstreamMapValues)})}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||ItemAuthorizationsComponent2)(core.rXU(link_service._),core.rXU(router.nX),core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=core.VBU({type:ItemAuthorizationsComponent2,selectors:[["ds-item-authorizations"]],standalone:!0,features:[core.aNF],decls:8,vars:13,consts:[[1,"container"],[3,"type","content"],[3,"resourceType","resourceName","resourceUUID"],[4,"ngFor","ngForTrackById","ngForOf"],["class","row justify-content-center",4,"ngIf"],[3,"resourceType","resourceUUID","resourceName"],[4,"ngIf"],[1,"card","auth-bitstream-container"],[1,"card-header"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"card-body",3,"id","ngbCollapse"],[1,"row","justify-content-center"],["type","button",1,"btn","btn-link",3,"click"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0),core.nrm(1,"ds-alert",1)(2,"ds-resource-policies",2),core.nI1(3,"async"),core.nI1(4,"async"),core.DNE(5,ItemAuthorizationsComponent_ng_container_5_Template,4,6,"ng-container",3),core.nI1(6,"async"),core.DNE(7,ItemAuthorizationsComponent_div_7_Template,4,3,"div",4),core.k0s()),2&rf&&(core.R7$(),core.Y8G("type","alert-info")("content","item.edit.authorizations.heading"),core.R7$(),core.Y8G("resourceType","item")("resourceName",core.bMT(3,7,ctx.getItemName()))("resourceUUID",core.bMT(4,9,ctx.getItemUUID())),core.R7$(3),core.Y8G("ngForOf",core.bMT(6,11,ctx.bundles$)),core.R7$(2),core.Y8G("ngIf",!ctx.allBundlesLoaded))},dependencies:[resource_policies_component.e,ng_bootstrap.HC,ng_bootstrap.$G,ngx_translate_core.h,ngx_translate_core.D9,common.Sq,NgForTrackByIdDirective,common.Jj,common.bT,alert_component.C],styles:[".auth-bitstream-container[_ngcontent-%COMP%]{margin-top:-1em;margin-bottom:1.5em}"]})}return ItemAuthorizationsComponent2})();var object_cache_service=__webpack_require__(40017),bitstream_data_service=__webpack_require__(36505),bundle_data_service=__webpack_require__(78330),item_data_service=__webpack_require__(94743),field_change_type_model=__webpack_require__(39464),object_updates_service=__webpack_require__(6440),request_service=__webpack_require__(72744),themed_loading_component=__webpack_require__(32943),notifications_service=__webpack_require__(10117);class ResponsiveColumnSizes{constructor(xs,sm,md,lg,xl){this.xs=xs,this.sm=sm,this.md=md,this.lg=lg,this.xl=xl}buildClasses(){return`col-${this.xs} col-sm-${this.sm} col-md-${this.md} col-lg-${this.lg} col-xl-${this.xl}`}}class ResponsiveTableSizes{constructor(columns){this.columns=columns}combineColumns(start,end){if(start<end&&(0,empty_util.a4)(this.columns[start])&&(0,empty_util.a4)(this.columns[end])){let xs=this.columns[start].xs,sm=this.columns[start].sm,md=this.columns[start].md,lg=this.columns[start].lg,xl=this.columns[start].xl;for(let i=start+1;i<end+1;i++)xs+=this.columns[i].xs,sm+=this.columns[i].sm,md+=this.columns[i].md,lg+=this.columns[i].lg,xl+=this.columns[i].xl;return new ResponsiveColumnSizes(xs,sm,md,lg,xl)}}}var paginated_search_options_model=__webpack_require__(80780);let ObjectValuesPipe=(()=>{class ObjectValuesPipe2{transform(value){const values=[];return(0,empty_util.hj)(value)&&Object.values(value).forEach(v=>values.push(v)),values}static#_=this.\u0275fac=function(t){return new(t||ObjectValuesPipe2)};static#_2=this.\u0275pipe=core.EJ8({name:"dsObjectValues",type:ObjectValuesPipe2,pure:!0,standalone:!0})}return ObjectValuesPipe2})();var var_directive=__webpack_require__(45961),environment=__webpack_require__(72035),abstract_trackable_component=(__webpack_require__(6721),__webpack_require__(48440)),item_resolver=__webpack_require__(88336);let AbstractItemUpdateComponent=(()=>{class AbstractItemUpdateComponent2 extends abstract_trackable_component.F{constructor(itemService,objectUpdatesService,router2,notificationsService,translateService,route){super(objectUpdatesService,notificationsService,translateService,router2),this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.router=router2,this.notificationsService=notificationsService,this.translateService=translateService,this.route=route}ngOnInit(){(0,empty_util.a4)(this.item)?this.setItem(this.item):this.itemUpdateSubscription=(0,cjs.combineLatest)([this.route.data,this.route.parent.data]).pipe((0,operators.Tj)(([data,parentData])=>Object.assign({},data,parentData)),(0,operators.Tj)(data=>data.dso),(0,operators.Mi)(rd=>{this.item=rd.payload}),(0,operators.nx)(rd=>this.itemService.findByHref(rd.payload._links.self.href,!0,!0,...item_resolver.e)),(0,shared_operators.v7)()).subscribe(rd=>{this.setItem(rd.payload)}),super.ngOnInit(),this.discardTimeOut=environment.c.item.edit.undoTimeout,this.hasChanges().pipe((0,operators.$1)()).subscribe(hasChanges=>{hasChanges?this.checkLastModified():this.initializeOriginalFields()}),this.initializeNotificationsPrefix(),this.initializeUpdates()}setItem(item){this.item=item,this.itemPageRoute=(0,item_page_routing_paths._o)(this.item),this.postItemInit(),this.initializeUpdates()}ngOnDestroy(){(0,empty_util.a4)(this.itemUpdateSubscription)&&this.itemUpdateSubscription.unsubscribe()}postItemInit(){}initializeUpdates(){}initializeNotificationsPrefix(){}initializeOriginalFields(){}submit(){}trackUpdate(index,update){return update&&update.field?update.field.uuid:void 0}isValid(){return this.objectUpdatesService.isValidPage(this.url)}checkLastModified(){const currentVersion=this.item.lastModified;this.objectUpdatesService.getLastModified(this.url).pipe((0,operators.$1)()).subscribe(updateVersion=>{updateVersion.getDate()!==currentVersion.getDate()&&(this.notificationsService.warning(this.getNotificationTitle("outdated"),this.getNotificationContent("outdated")),this.initializeOriginalFields())})}static#_=this.\u0275fac=function(t){return new(t||AbstractItemUpdateComponent2)(core.rXU(item_data_service.ItemDataService),core.rXU(object_updates_service.F),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.nX))};static#_2=this.\u0275cmp=core.VBU({type:AbstractItemUpdateComponent2,selectors:[["ds-abstract-item-update"]],inputs:{item:"item"},standalone:!0,features:[core.Vt3,core.aNF],decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}return AbstractItemUpdateComponent2})();__webpack_require__(69910);const item_edit_bitstream_drag_handle_component_c0=["handleView"];function ItemEditBitstreamDragHandleComponent_ng_template_0_Template(rf,ctx){1&rf&&(core.j41(0,"div",1),core.nrm(1,"i",2),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.Y8G("title",core.bMT(2,1,"item.edit.bitstreams.edit.buttons.drag")))}let ItemEditBitstreamDragHandleComponent=(()=>{class ItemEditBitstreamDragHandleComponent2{constructor(viewContainerRef){this.viewContainerRef=viewContainerRef}ngOnInit(){this.viewContainerRef.createEmbeddedView(this.handleView)}ngOnDestroy(){this.viewContainerRef.clear()}static#_=this.\u0275fac=function(t){return new(t||ItemEditBitstreamDragHandleComponent2)(core.rXU(core.c1b))};static#_2=this.\u0275cmp=core.VBU({type:ItemEditBitstreamDragHandleComponent2,selectors:[["ds-item-edit-bitstream-drag-handle"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(item_edit_bitstream_drag_handle_component_c0,7),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.handleView=_t.first)}},standalone:!0,features:[core.aNF],decls:2,vars:0,consts:[["handleView",""],["tabindex","0",1,"drag-handle","text-muted","float-left","p-1","mr-2"],[1,"fas","fa-grip-vertical","fa-fw",3,"title"]],template:function(rf,ctx){1&rf&&core.DNE(0,ItemEditBitstreamDragHandleComponent_ng_template_0_Template,3,3,"ng-template",null,0,core.C5r)},dependencies:[ngx_translate_core.h,ngx_translate_core.D9],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover, .bitstream-row-drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle, [_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]     .larger-tooltip .tooltip-inner{max-width:500px}"]})}return ItemEditBitstreamDragHandleComponent2})();var drag_drop=__webpack_require__(23306),pagination_service=__webpack_require__(39304),pagination_component=__webpack_require__(91904),item_relationships_utils=__webpack_require__(19985),pagination_component_options_model=__webpack_require__(64694);let AbstractPaginatedDragAndDropListComponent=(()=>{class AbstractPaginatedDragAndDropListComponent2{constructor(objectUpdatesService,elRef,objectValuesPipe,paginationService){this.objectUpdatesService=objectUpdatesService,this.elRef=elRef,this.objectValuesPipe=objectValuesPipe,this.paginationService=paginationService,this.dropObject=new core.bkB,this.pageSize=10,this.options=Object.assign(new pagination_component_options_model.W,{id:"dad",currentPage:1,pageSize:this.pageSize}),this.currentPage$=new cjs.BehaviorSubject(this.options),this.loading$=new cjs.BehaviorSubject(!1),this.subs=[]}ngOnInit(){this.initializeObjectsRD(),this.initializeURL(),this.initializeUpdates(),this.initializePagination()}initializePagination(){this.paginationService.getCurrentPagination(this.options.id,this.options).subscribe(currentPagination=>{this.currentPage$.next(currentPagination)})}initializeUpdates(){this.objectsRD$.pipe((0,shared_operators.yd)(),(0,shared_operators.qn)()).subscribe(objects=>{this.objectUpdatesService.initialize(this.url,objects,new Date)}),this.updates$=this.objectsRD$.pipe((0,shared_operators.v7)(),(0,shared_operators.qn)(),(0,operators.nx)(objects=>this.objectUpdatesService.getFieldUpdatesExclusive(this.url,objects))),this.subs.push(this.updates$.pipe((0,operators.Tj)(fieldUpdates=>this.objectValuesPipe.transform(fieldUpdates)),(0,operators.F)((0,item_relationships_utils.g0)(fieldUpdate=>(0,empty_util.a4)(fieldUpdate)&&(0,empty_util.a4)(fieldUpdate.field)?fieldUpdate.field.uuid:void 0))).subscribe(updateValues=>{this.customOrder=updateValues.map(fieldUpdate=>fieldUpdate.field.uuid),this.loading$.next(!1)}),this.loading$.subscribe(loading=>this.options.disabled=loading))}drop(event){const dragIndex=event.previousIndex;let dropIndex=event.currentIndex;const dragPage=this.currentPage$.value.currentPage-1;let dropPage=this.currentPage$.value.currentPage-1;const droppedOnElement=this.elRef.nativeElement.querySelector(".page-item:hover");if((0,empty_util.a4)(droppedOnElement)&&(0,empty_util.a4)(droppedOnElement.textContent)){const droppedPage=Number(droppedOnElement.textContent);(0,empty_util.a4)(droppedPage)&&!Number.isNaN(droppedPage)&&(dropPage=droppedPage-1,dropIndex=0)}const isNewPage=dragPage!==dropPage;!isNewPage&&dragIndex!==dropIndex&&(0,drag_drop.HD)(this.customOrder,dragIndex,dropIndex);const redirectPage=dropPage+1,fromIndex=dragPage*this.pageSize+dragIndex,toIndex=dropPage*this.pageSize+dropIndex;fromIndex!==toIndex&&(isNewPage&&this.loading$.next(!0),this.dropObject.emit(Object.assign({fromIndex,toIndex,finish:()=>{isNewPage&&this.paginationComponent.doPageChange(redirectPage)}})))}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),this.paginationService.clearPagination(this.options.id)}static#_=this.\u0275fac=function(t){return new(t||AbstractPaginatedDragAndDropListComponent2)(core.rXU(object_updates_service.F),core.rXU(core.aKT),core.rXU(ObjectValuesPipe),core.rXU(pagination_service.m))};static#_2=this.\u0275cmp=core.VBU({type:AbstractPaginatedDragAndDropListComponent2,selectors:[["ds-paginated-drag-drop-abstract"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(pagination_component.e,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.paginationComponent=_t.first)}},outputs:{dropObject:"dropObject"},decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}return AbstractPaginatedDragAndDropListComponent2})();var cloneDeep=__webpack_require__(42768),cloneDeep_default=__webpack_require__.n(cloneDeep),app_routing_paths=__webpack_require__(45930),browser_only_pipe=__webpack_require__(87154);const item_edit_bitstream_component_c0=["bitstreamView"],item_edit_bitstream_component_c1=[[["","slot","drag-handle"]]],_c2=["[slot=drag-handle]"],_c3=a0=>["/bitstreams/",a0,"edit"];function ItemEditBitstreamComponent_ng_template_0_a_17_Template(rf,ctx){if(1&rf&&(core.j41(0,"a",8),core.nI1(1,"translate"),core.nI1(2,"translate"),core.nI1(3,"dsBrowserOnly"),core.nrm(4,"i",14),core.k0s()),2&rf){const ctx_r1=core.XpG(2);core.FS9("title",core.bMT(1,4,"item.edit.bitstreams.edit.buttons.download")),core.Y8G("routerLink",ctx_r1.bitstreamDownloadUrl),core.BMQ("aria-label",core.bMT(2,6,"item.edit.bitstreams.edit.buttons.download"))("data-test",core.bMT(3,8,"download-button"))}}function ItemEditBitstreamComponent_ng_template_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div"),core.SdG(1),core.j41(2,"div",1)(3,"span",2),core.EFF(4),core.k0s()()(),core.j41(5,"div")(6,"div",3)(7,"div",4),core.EFF(8),core.k0s()()(),core.j41(9,"div")(10,"div",5)(11,"span",2),core.EFF(12),core.nI1(13,"async"),core.k0s()()(),core.j41(14,"div")(15,"div",5)(16,"div",6),core.DNE(17,ItemEditBitstreamComponent_ng_template_0_a_17_Template,5,10,"a",7),core.j41(18,"button",8),core.nI1(19,"translate"),core.nI1(20,"translate"),core.nrm(21,"i",9),core.k0s(),core.j41(22,"button",10),core.nI1(23,"translate"),core.nI1(24,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.remove())}),core.nrm(25,"i",11),core.k0s(),core.j41(26,"button",12),core.nI1(27,"translate"),core.nI1(28,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.undo())}),core.nrm(29,"i",13),core.k0s()()()()}if(2&rf){let tmp_9_0;const ctx_r1=core.XpG();core.ZvI("",ctx_r1.columnSizes.columns[0].buildClasses()," row-element d-flex"),core.R7$(4),core.SpI(" ",ctx_r1.bitstreamName," "),core.R7$(),core.ZvI("",ctx_r1.columnSizes.columns[1].buildClasses()," row-element d-flex align-items-center"),core.R7$(2),core.Y8G("tooltipClass","larger-tooltip")("ngbTooltip",null==ctx_r1.bitstream?null:ctx_r1.bitstream.firstMetadataValue("dc.description")),core.R7$(),core.SpI(" ",null==ctx_r1.bitstream?null:ctx_r1.bitstream.firstMetadataValue("dc.description")," "),core.R7$(),core.ZvI("",ctx_r1.columnSizes.columns[2].buildClasses()," row-element d-flex align-items-center"),core.R7$(3),core.SpI(" ",null==(tmp_9_0=core.bMT(13,27,ctx_r1.format$))?null:tmp_9_0.shortDescription," "),core.R7$(2),core.ZvI("",ctx_r1.columnSizes.columns[3].buildClasses()," row-element d-flex align-items-center"),core.R7$(3),core.Y8G("ngIf",null!==ctx_r1.bitstreamDownloadUrl),core.R7$(),core.FS9("title",core.bMT(19,29,"item.edit.bitstreams.edit.buttons.edit")),core.Y8G("routerLink",core.eq3(41,_c3,ctx_r1.bitstream.id)),core.BMQ("aria-label",core.bMT(20,31,"item.edit.bitstreams.edit.buttons.edit")),core.R7$(4),core.FS9("title",core.bMT(23,33,"item.edit.bitstreams.edit.buttons.remove")),core.Y8G("disabled",!ctx_r1.canRemove()),core.BMQ("aria-label",core.bMT(24,35,"item.edit.bitstreams.edit.buttons.remove")),core.R7$(4),core.FS9("title",core.bMT(27,37,"item.edit.bitstreams.edit.buttons.undo")),core.Y8G("disabled",!ctx_r1.canUndo()),core.BMQ("aria-label",core.bMT(28,39,"item.edit.bitstreams.edit.buttons.undo"))}}let ItemEditBitstreamComponent=(()=>{class ItemEditBitstreamComponent2{constructor(objectUpdatesService,dsoNameService,viewContainerRef){this.objectUpdatesService=objectUpdatesService,this.dsoNameService=dsoNameService,this.viewContainerRef=viewContainerRef}ngOnInit(){this.viewContainerRef.createEmbeddedView(this.bitstreamView)}ngOnDestroy(){this.viewContainerRef.clear()}ngOnChanges(changes){this.bitstream=cloneDeep_default()(this.fieldUpdate.field),this.bitstreamName=this.dsoNameService.getName(this.bitstream),this.bitstreamDownloadUrl=(0,app_routing_paths.hV)(this.bitstream),this.format$=this.bitstream.format.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)())}remove(){this.objectUpdatesService.saveRemoveFieldUpdate(this.bundleUrl,this.bitstream)}undo(){this.objectUpdatesService.removeSingleFieldUpdate(this.bundleUrl,this.bitstream.uuid)}canRemove(){return this.fieldUpdate.changeType!==field_change_type_model.B.REMOVE}canUndo(){return this.fieldUpdate.changeType?.valueOf()>=0}static#_=this.\u0275fac=function(t){return new(t||ItemEditBitstreamComponent2)(core.rXU(object_updates_service.F),core.rXU(dso_name_service.f),core.rXU(core.c1b))};static#_2=this.\u0275cmp=core.VBU({type:ItemEditBitstreamComponent2,selectors:[["ds-item-edit-bitstream"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(item_edit_bitstream_component_c0,7),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.bitstreamView=_t.first)}},inputs:{fieldUpdate:"fieldUpdate",bundleUrl:"bundleUrl",columnSizes:"columnSizes"},standalone:!0,features:[core.OA$,core.aNF],ngContentSelectors:_c2,decls:2,vars:0,consts:[["bitstreamView",""],[1,"float-left","d-flex","align-items-center","overflow-hidden"],[1,"text-truncate"],[1,"w-100"],["placement","bottom",1,"text-truncate",3,"tooltipClass","ngbTooltip"],[1,"text-center","w-100"],[1,"btn-group","relationship-action-buttons"],["class","btn btn-outline-primary btn-sm",3,"routerLink","title",4,"ngIf"],[1,"btn","btn-outline-primary","btn-sm",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm",3,"click","disabled","title"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"click","disabled","title"],[1,"fas","fa-undo-alt","fa-fw"],[1,"fas","fa-download","fa-fw"]],template:function(rf,ctx){1&rf&&(core.NAR(item_edit_bitstream_component_c1),core.DNE(0,ItemEditBitstreamComponent_ng_template_0_Template,30,43,"ng-template",null,0,core.C5r))},dependencies:[router.Wk,ngx_translate_core.h,ngx_translate_core.D9,browser_only_pipe.L,ng_bootstrap.n8,ng_bootstrap.md,common.Jj,common.bT],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover, .bitstream-row-drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle, [_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]     .larger-tooltip .tooltip-inner{max-width:500px}"]})}return ItemEditBitstreamComponent2})();const paginated_drag_and_drop_bitstream_list_component_c0=a0=>({"mb-3":a0}),paginated_drag_and_drop_bitstream_list_component_c1=(a0,a1,a2,a3)=>({"table-warning":a0,"table-danger":a1,"table-success":a2,"bg-white":a3});function PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_div_1_ng_container_2_div_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",7)(1,"ds-item-edit-bitstream",8)(2,"div",9),core.nrm(3,"ds-item-edit-bitstream-drag-handle"),core.k0s()()()),2&rf){const uuid_r3=ctx.$implicit,updates_r4=core.XpG(2).ngVar,ctx_r1=core.XpG(3);core.Y8G("id",uuid_r3)("ngClass",core.ziG(5,paginated_drag_and_drop_bitstream_list_component_c1,0===updates_r4[uuid_r3].changeType,2===updates_r4[uuid_r3].changeType,1===updates_r4[uuid_r3].changeType,void 0===updates_r4[uuid_r3].changeType)),core.R7$(),core.Y8G("fieldUpdate",updates_r4[uuid_r3])("bundleUrl",ctx_r1.bundle.self)("columnSizes",ctx_r1.columnSizes)}}function PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_div_1_ng_container_2_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_div_1_ng_container_2_div_1_Template,4,10,"div",6),core.bVm()),2&rf){const ctx_r1=core.XpG(4);core.R7$(),core.Y8G("ngForOf",ctx_r1.customOrder)}}function PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_div_1_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",5),core.nI1(1,"async"),core.bIt("cdkDropListDropped",function($event){core.eBV(_r1);const ctx_r1=core.XpG(3);return core.Njj(ctx_r1.drop($event))}),core.DNE(2,PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_div_1_ng_container_2_Template,2,1,"ng-container",2),core.k0s()}if(2&rf){let tmp_5_0;const updates_r4=ctx.ngVar,ctx_r1=core.XpG(3);core.Y8G("id",ctx_r1.bundle.id)("ngClass",core.eq3(5,paginated_drag_and_drop_bitstream_list_component_c0,(null==(tmp_5_0=core.bMT(1,3,ctx_r1.objectsRD$))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements)>ctx_r1.pageSize)),core.R7$(2),core.Y8G("ngIf",updates_r4)}}function PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_div_1_Template,3,7,"div",4),core.nI1(2,"async"),core.bVm()),2&rf){const ctx_r1=core.XpG(2);core.R7$(),core.Y8G("ngVar",core.bMT(2,1,ctx_r1.updates$))}}function PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ds_loading_4_Template(rf,ctx){1&rf&&(core.nrm(0,"ds-loading",10),core.nI1(1,"translate")),2&rf&&core.Y8G("message",core.bMT(1,1,"loading.bitstreams"))}function PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-pagination",1),core.nI1(1,"async"),core.DNE(2,PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ng_container_2_Template,3,3,"ng-container",2),core.nI1(3,"async"),core.DNE(4,PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_ds_loading_4_Template,2,3,"ds-loading",3),core.nI1(5,"async"),core.k0s()),2&rf){let tmp_5_0;const ctx_r1=core.XpG();core.Y8G("hideGear",!0)("hidePagerWhenSinglePage",!0)("hidePaginationDetail",!0)("paginationOptions",ctx_r1.options)("collectionSize",null==(tmp_5_0=core.bMT(1,7,ctx_r1.objectsRD$))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements),core.R7$(2),core.Y8G("ngIf",!0!==core.bMT(3,9,ctx_r1.loading$)),core.R7$(2),core.Y8G("ngIf",core.bMT(5,11,ctx_r1.loading$))}}let PaginatedDragAndDropBitstreamListComponent=(()=>{class PaginatedDragAndDropBitstreamListComponent2 extends AbstractPaginatedDragAndDropListComponent{constructor(objectUpdatesService,elRef,objectValuesPipe,bundleService,paginationService,requestService){super(objectUpdatesService,elRef,objectValuesPipe,paginationService),this.objectUpdatesService=objectUpdatesService,this.elRef=elRef,this.objectValuesPipe=objectValuesPipe,this.bundleService=bundleService,this.paginationService=paginationService,this.requestService=requestService}ngOnInit(){super.ngOnInit()}initializeObjectsRD(){this.objectsRD$=this.currentPage$.pipe((0,operators.nx)(page=>{const paginatedOptions=new paginated_search_options_model.C({pagination:Object.assign({},page)});return this.bundleService.getBitstreamsEndpoint(this.bundle.id,paginatedOptions).pipe((0,operators.nx)(href=>this.requestService.hasByHref$(href)),(0,operators.nx)(()=>this.bundleService.getBitstreams(this.bundle.id,paginatedOptions,(0,follow_link_config_model.s)("format"))))}))}initializeURL(){this.url=this.bundle.self}static#_=this.\u0275fac=function(t){return new(t||PaginatedDragAndDropBitstreamListComponent2)(core.rXU(object_updates_service.F),core.rXU(core.aKT),core.rXU(ObjectValuesPipe),core.rXU(bundle_data_service.BundleDataService),core.rXU(pagination_service.m),core.rXU(request_service.B))};static#_2=this.\u0275cmp=core.VBU({type:PaginatedDragAndDropBitstreamListComponent2,selectors:[["ds-paginated-drag-and-drop-bitstream-list"]],inputs:{bundle:"bundle",columnSizes:"columnSizes"},standalone:!0,features:[core.Vt3,core.aNF],decls:2,vars:3,consts:[[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","collectionSize",4,"ngIf"],[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","collectionSize"],[4,"ngIf"],[3,"message",4,"ngIf"],["class","bundle-bitstreams-list","cdkDropList","",3,"id","ngClass","cdkDropListDropped",4,"ngVar"],["cdkDropList","",1,"bundle-bitstreams-list",3,"cdkDropListDropped","id","ngClass"],["class","row bitstream-row","cdkDrag","",3,"id","ngClass",4,"ngFor","ngForOf"],["cdkDrag","",1,"row","bitstream-row",3,"id","ngClass"],[3,"fieldUpdate","bundleUrl","columnSizes"],["slot","drag-handle","cdkDragHandle","","tabindex","0",1,"d-flex","align-items-center","bitstream-row-drag-handle"],[3,"message"]],template:function(rf,ctx){if(1&rf&&(core.DNE(0,PaginatedDragAndDropBitstreamListComponent_ds_pagination_0_Template,6,13,"ds-pagination",0),core.nI1(1,"async")),2&rf){let tmp_0_0;core.Y8G("ngIf",null==(tmp_0_0=core.bMT(1,1,ctx.objectsRD$))?null:tmp_0_0.payload)}},dependencies:[common.Jj,common.bT,pagination_component.e,common.YU,var_directive.r,drag_drop.O7,common.Sq,drag_drop.T1,ItemEditBitstreamComponent,ItemEditBitstreamDragHandleComponent,drag_drop.Fb,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover, .bitstream-row-drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle, [_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]     .larger-tooltip .tooltip-inner{max-width:500px}"]})}return PaginatedDragAndDropBitstreamListComponent2})();const item_edit_bitstream_bundle_component_c0=["bundleView"],item_edit_bitstream_bundle_component_c1=a0=>({name:a0}),item_edit_bitstream_bundle_component_c2=a0=>[a0,"bitstreams","new"],item_edit_bitstream_bundle_component_c3=a0=>({bundle:a0});function ItemEditBitstreamBundleComponent_ng_template_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div"),core.nrm(2,"ds-item-edit-bitstream-drag-handle"),core.j41(3,"div",2),core.EFF(4),core.nI1(5,"translate"),core.k0s()(),core.j41(6,"div")(7,"div",3)(8,"button",4),core.nI1(9,"translate"),core.nI1(10,"translate"),core.nrm(11,"i",5),core.k0s()()()(),core.j41(12,"ds-paginated-drag-and-drop-bitstream-list",6),core.bIt("dropObject",function($event){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.dropObject.emit($event))}),core.k0s()}if(2&rf){const ctx_r1=core.XpG();core.R7$(),core.ZvI("",ctx_r1.bundleNameColumn.buildClasses()," font-weight-bold row-element d-flex"),core.R7$(3),core.SpI(" ",core.i5U(5,13,"item.edit.bitstreams.bundle.name",core.eq3(20,item_edit_bitstream_bundle_component_c1,ctx_r1.dsoNameService.getName(ctx_r1.bundle)))," "),core.R7$(2),core.ZvI("",ctx_r1.columnSizes.columns[3].buildClasses()," text-center row-element"),core.R7$(2),core.FS9("title",core.bMT(9,16,"item.edit.bitstreams.bundle.edit.buttons.upload")),core.Y8G("routerLink",core.eq3(22,item_edit_bitstream_bundle_component_c2,ctx_r1.itemPageRoute))("queryParams",core.eq3(24,item_edit_bitstream_bundle_component_c3,ctx_r1.bundle.id)),core.BMQ("aria-label",core.bMT(10,18,"item.edit.bitstreams.bundle.edit.buttons.upload")),core.R7$(4),core.Y8G("bundle",ctx_r1.bundle)("columnSizes",ctx_r1.columnSizes)}}let ItemEditBitstreamBundleComponent=(()=>{class ItemEditBitstreamBundleComponent2{constructor(viewContainerRef,dsoNameService){this.viewContainerRef=viewContainerRef,this.dsoNameService=dsoNameService,this.dropObject=new core.bkB}ngOnInit(){this.bundleNameColumn=this.columnSizes.combineColumns(0,2),this.viewContainerRef.createEmbeddedView(this.bundleView),this.itemPageRoute=(0,item_page_routing_paths._o)(this.item)}ngOnDestroy(){this.viewContainerRef.clear()}static#_=this.\u0275fac=function(t){return new(t||ItemEditBitstreamBundleComponent2)(core.rXU(core.c1b),core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=core.VBU({type:ItemEditBitstreamBundleComponent2,selectors:[["ds-item-edit-bitstream-bundle"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(item_edit_bitstream_bundle_component_c0,7),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.bundleView=_t.first)}},inputs:{bundle:"bundle",item:"item",columnSizes:"columnSizes"},outputs:{dropObject:"dropObject"},standalone:!0,features:[core.aNF],decls:2,vars:0,consts:[["bundleView",""],[1,"row","bundle-row"],[1,"float-left","d-flex","align-items-center"],[1,"btn-group","bundle-action-buttons"],[1,"btn","btn-outline-success","btn-sm",3,"routerLink","queryParams","title"],[1,"fas","fa-upload","fa-fw"],[3,"dropObject","bundle","columnSizes"]],template:function(rf,ctx){1&rf&&core.DNE(0,ItemEditBitstreamBundleComponent_ng_template_0_Template,13,26,"ng-template",null,0,core.C5r)},dependencies:[PaginatedDragAndDropBitstreamListComponent,ngx_translate_core.h,ngx_translate_core.D9,router.Wk,ItemEditBitstreamDragHandleComponent],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover, .bitstream-row-drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle, [_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]     .larger-tooltip .tooltip-inner{max-width:500px}"]})}return ItemEditBitstreamBundleComponent2})();const item_bitstreams_component_c0=a0=>[a0,"bitstreams","new"];function ItemBitstreamsComponent_div_0_button_8_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"button",15),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r2);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.reinstate())}),core.nrm(2,"i",16),core.j41(3,"span",5),core.EFF(4),core.nI1(5,"translate"),core.k0s()()}2&rf&&(core.BMQ("aria-label",core.bMT(1,2,"item.edit.bitstreams.reinstate-button")),core.R7$(4),core.SpI("\xa0",core.bMT(5,4,"item.edit.bitstreams.reinstate-button"),""))}function ItemBitstreamsComponent_div_0_button_17_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",17),core.nI1(1,"async"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r4);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.discard())}),core.nrm(3,"i",18),core.j41(4,"span",5),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG(2);core.Y8G("disabled",!0!==core.bMT(1,3,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(2,5,"item.edit.bitstreams.discard-button")),core.R7$(5),core.SpI("\xa0",core.bMT(6,7,"item.edit.bitstreams.discard-button"),"")}}function ItemBitstreamsComponent_div_0_div_19_ds_item_edit_bitstream_bundle_15_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"ds-item-edit-bitstream-bundle",22),core.bIt("dropObject",function($event){const bundle_r6=core.eBV(_r5).$implicit,ctx_r2=core.XpG(3);return core.Njj(ctx_r2.dropBitstream(bundle_r6,$event))}),core.k0s()}if(2&rf){const bundle_r6=ctx.$implicit,ctx_r2=core.XpG(3);core.Y8G("bundle",bundle_r6)("item",ctx_r2.item)("columnSizes",ctx_r2.columnSizes)}}function ItemBitstreamsComponent_div_0_div_19_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",19)(1,"div",20)(2,"div"),core.nrm(3,"ds-item-edit-bitstream-drag-handle"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"div"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.j41(9,"div"),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"div"),core.EFF(13),core.nI1(14,"translate"),core.k0s()(),core.DNE(15,ItemBitstreamsComponent_div_0_div_19_ds_item_edit_bitstream_bundle_15_Template,1,3,"ds-item-edit-bitstream-bundle",21),core.k0s()),2&rf){const bundles_r7=core.XpG().ngVar,ctx_r2=core.XpG();core.R7$(2),core.ZvI("",ctx_r2.columnSizes.columns[0].buildClasses()," row-element"),core.R7$(2),core.SpI(" ",core.bMT(5,17,"item.edit.bitstreams.headers.name")," "),core.R7$(2),core.ZvI("",ctx_r2.columnSizes.columns[1].buildClasses()," row-element"),core.R7$(),core.JRh(core.bMT(8,19,"item.edit.bitstreams.headers.description")),core.R7$(2),core.ZvI("",ctx_r2.columnSizes.columns[2].buildClasses()," text-center row-element"),core.R7$(),core.JRh(core.bMT(11,21,"item.edit.bitstreams.headers.format")),core.R7$(2),core.ZvI("",ctx_r2.columnSizes.columns[3].buildClasses()," text-center row-element"),core.R7$(),core.JRh(core.bMT(14,23,"item.edit.bitstreams.headers.actions")),core.R7$(2),core.Y8G("ngForOf",bundles_r7)}}function ItemBitstreamsComponent_div_0_div_20_Template(rf,ctx){1&rf&&(core.j41(0,"div",23),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"item.edit.bitstreams.empty")," "))}function ItemBitstreamsComponent_div_0_ds_loading_21_Template(rf,ctx){1&rf&&(core.nrm(0,"ds-loading",24),core.nI1(1,"translate")),2&rf&&core.FS9("message",core.bMT(1,1,"loading.bitstreams"))}function ItemBitstreamsComponent_div_0_button_24_Template(rf,ctx){if(1&rf){const _r8=core.RV6();core.j41(0,"button",15),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r8);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.reinstate())}),core.nrm(2,"i",16),core.j41(3,"span",5),core.EFF(4),core.nI1(5,"translate"),core.k0s()()}2&rf&&(core.BMQ("aria-label",core.bMT(1,2,"item.edit.bitstreams.reinstate-button")),core.R7$(4),core.SpI("\xa0",core.bMT(5,4,"item.edit.bitstreams.reinstate-button"),""))}function ItemBitstreamsComponent_div_0_button_33_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"button",17),core.nI1(1,"async"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r9);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.discard())}),core.nrm(3,"i",18),core.j41(4,"span",5),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG(2);core.Y8G("disabled",!0!==core.bMT(1,3,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(2,5,"item.edit.bitstreams.discard-button")),core.R7$(5),core.SpI("\xa0",core.bMT(6,7,"item.edit.bitstreams.discard-button"),"")}}function ItemBitstreamsComponent_div_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div",2)(2,"button",3),core.nI1(3,"translate"),core.nrm(4,"i",4),core.j41(5,"span",5),core.EFF(6),core.nI1(7,"translate"),core.k0s()(),core.DNE(8,ItemBitstreamsComponent_div_0_button_8_Template,6,6,"button",6),core.nI1(9,"async"),core.j41(10,"button",7),core.nI1(11,"async"),core.nI1(12,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.nrm(13,"i",8),core.j41(14,"span",5),core.EFF(15),core.nI1(16,"translate"),core.k0s()(),core.DNE(17,ItemBitstreamsComponent_div_0_button_17_Template,7,9,"button",9),core.nI1(18,"async"),core.k0s(),core.DNE(19,ItemBitstreamsComponent_div_0_div_19_Template,16,25,"div",10)(20,ItemBitstreamsComponent_div_0_div_20_Template,3,3,"div",11)(21,ItemBitstreamsComponent_div_0_ds_loading_21_Template,2,3,"ds-loading",12),core.j41(22,"div",13)(23,"div",14),core.DNE(24,ItemBitstreamsComponent_div_0_button_24_Template,6,6,"button",6),core.nI1(25,"async"),core.j41(26,"button",7),core.nI1(27,"async"),core.nI1(28,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.nrm(29,"i",8),core.j41(30,"span",5),core.EFF(31),core.nI1(32,"translate"),core.k0s()(),core.DNE(33,ItemBitstreamsComponent_div_0_button_33_Template,7,9,"button",9),core.nI1(34,"async"),core.k0s()()()}if(2&rf){const bundles_r7=ctx.ngVar,ctx_r2=core.XpG();core.R7$(2),core.Y8G("routerLink",core.eq3(40,item_bitstreams_component_c0,ctx_r2.itemPageRoute)),core.BMQ("aria-label",core.bMT(3,16,"item.edit.bitstreams.upload-button")),core.R7$(4),core.SpI("\xa0",core.bMT(7,18,"item.edit.bitstreams.upload-button"),""),core.R7$(2),core.Y8G("ngIf",core.bMT(9,20,ctx_r2.isReinstatable$)),core.R7$(2),core.Y8G("disabled",!0!==core.bMT(11,22,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(12,24,"item.edit.bitstreams.save-button")),core.R7$(5),core.SpI("\xa0",core.bMT(16,26,"item.edit.bitstreams.save-button"),""),core.R7$(2),core.Y8G("ngIf",!0!==core.bMT(18,28,ctx_r2.isReinstatable$)),core.R7$(2),core.Y8G("ngIf",ctx_r2.item&&(null==bundles_r7?null:bundles_r7.length)>0),core.R7$(),core.Y8G("ngIf",0===(null==bundles_r7?null:bundles_r7.length)),core.R7$(),core.Y8G("ngIf",!bundles_r7),core.R7$(3),core.Y8G("ngIf",core.bMT(25,30,ctx_r2.isReinstatable$)),core.R7$(2),core.Y8G("disabled",!0!==core.bMT(27,32,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(28,34,"item.edit.bitstreams.save-button")),core.R7$(5),core.SpI("\xa0",core.bMT(32,36,"item.edit.bitstreams.save-button"),""),core.R7$(2),core.Y8G("ngIf",!0!==core.bMT(34,38,ctx_r2.isReinstatable$))}}let ItemBitstreamsComponent=(()=>{class ItemBitstreamsComponent2 extends AbstractItemUpdateComponent{constructor(itemService,objectUpdatesService,router2,notificationsService,translateService,route,bitstreamService,objectCache,requestService,cdRef,bundleService,zone){super(itemService,objectUpdatesService,router2,notificationsService,translateService,route),this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.router=router2,this.notificationsService=notificationsService,this.translateService=translateService,this.route=route,this.bitstreamService=bitstreamService,this.objectCache=objectCache,this.requestService=requestService,this.cdRef=cdRef,this.bundleService=bundleService,this.zone=zone,this.bundlesOptions={id:"bundles-pagination-options",currentPage:1,pageSize:9999},this.columnSizes=new ResponsiveTableSizes([new ResponsiveColumnSizes(2,2,3,4,4),new ResponsiveColumnSizes(2,3,3,3,3),new ResponsiveColumnSizes(2,2,2,2,2),new ResponsiveColumnSizes(6,5,4,3,3)]),this.submitting=!1}postItemInit(){this.bundles$=this.itemService.getBundles(this.item.id,new paginated_search_options_model.C({pagination:this.bundlesOptions})).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.Tj)(bundlePage=>bundlePage.page))}initializeNotificationsPrefix(){this.notificationsPrefix="item.edit.bitstreams.notifications."}submit(){this.submitting=!0,this.bundles$.pipe((0,operators.s)(1)).pipe((0,operators.nx)(bundles=>(0,cjs.zip)(...bundles.map(bundle=>this.objectUpdatesService.getFieldUpdates(bundle.self,[],!0)))),(0,operators.Tj)(fieldUpdates=>[].concat(...fieldUpdates.map(updates=>Object.values(updates).filter(fieldUpdate=>fieldUpdate.changeType===field_change_type_model.B.REMOVE)))),(0,operators.Tj)(fieldUpdates=>fieldUpdates.map(fieldUpdate=>fieldUpdate.field))).pipe((0,operators.s)(1),(0,operators.nx)(removedBitstreams=>this.bitstreamService.removeMultiple(removedBitstreams))).subscribe(responses=>{this.displayNotifications("item.edit.bitstreams.notifications.remove",[responses]),this.submitting=!1})}dropBitstream(bundle,event){this.zone.runOutsideAngular(()=>{(0,empty_util.a4)(event)&&(0,empty_util.a4)(event.fromIndex)&&(0,empty_util.a4)(event.toIndex)&&(0,empty_util.a4)(event.finish)&&this.bundleService.patch(bundle,[{op:"move",from:`/_links/bitstreams/${event.fromIndex}/href`,path:`/_links/bitstreams/${event.toIndex}/href`}]).pipe((0,operators.s)(1)).subscribe(response=>{this.zone.run(()=>{this.displayNotifications("item.edit.bitstreams.notifications.move",[response]),this.requestService.removeByHrefSubstring(bundle.self).pipe((0,operators.pb)(isCached=>isCached),(0,operators.s)(1)).subscribe(()=>event.finish())})})})}displayNotifications(key,responses){if((0,empty_util.hj)(responses)){const failedResponses=responses.filter(response=>(0,empty_util.a4)(response)&&response.hasFailed),successfulResponses=responses.filter(response=>(0,empty_util.a4)(response)&&response.hasSucceeded);failedResponses.forEach(response=>{this.notificationsService.error(this.translateService.instant(`${key}.failed.title`),response.errorMessage)}),successfulResponses.length>0&&this.notificationsService.success(this.translateService.instant(`${key}.saved.title`),this.translateService.instant(`${key}.saved.content`))}}discard(){const undoNotification=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardAllFieldUpdates(this.url,undoNotification)}reinstate(){this.bundles$.pipe((0,operators.s)(1)).subscribe(bundles=>{bundles.forEach(bundle=>{this.objectUpdatesService.reinstateFieldUpdates(bundle.self)})})}isReinstatable(){return this.bundles$.pipe((0,operators.nx)(bundles=>(0,cjs.combineLatest)(bundles.map(bundle=>this.objectUpdatesService.isReinstatable(bundle.self)))),(0,operators.Tj)(reinstatable=>reinstatable.includes(!0)))}hasChanges(){return this.bundles$.pipe((0,operators.nx)(bundles=>(0,cjs.combineLatest)(bundles.map(bundle=>this.objectUpdatesService.hasUpdates(bundle.self)))),(0,operators.Tj)(hasChanges=>hasChanges.includes(!0)))}ngOnDestroy(){this.itemUpdateSubscription&&this.itemUpdateSubscription.unsubscribe()}static#_=this.\u0275fac=function(t){return new(t||ItemBitstreamsComponent2)(core.rXU(item_data_service.ItemDataService),core.rXU(object_updates_service.F),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.nX),core.rXU(bitstream_data_service.BitstreamDataService),core.rXU(object_cache_service.$),core.rXU(request_service.B),core.rXU(core.gRc),core.rXU(bundle_data_service.BundleDataService),core.rXU(core.SKi))};static#_2=this.\u0275cmp=core.VBU({type:ItemBitstreamsComponent2,selectors:[["ds-item-bitstreams"]],standalone:!0,features:[core.Jv_([ObjectValuesPipe]),core.Vt3,core.aNF],decls:2,vars:3,consts:[["class","item-bitstreams",4,"ngVar"],[1,"item-bitstreams"],[1,"button-row","top","d-flex","mt-2","space-children-mr"],[1,"mr-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-upload"],[1,"d-none","d-sm-inline"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-save"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","container table-bordered mt-4",4,"ngIf"],["class","alert alert-info w-100 d-inline-block mt-4","role","alert",4,"ngIf"],[3,"message",4,"ngIf"],[1,"button-row","bottom"],[1,"mt-4","float-right","space-children-mr","ml-gap"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"click","disabled"],[1,"fas","fa-times"],[1,"container","table-bordered","mt-4"],[1,"row","header-row","font-weight-bold"],[3,"bundle","item","columnSizes","dropObject",4,"ngFor","ngForOf"],[3,"dropObject","bundle","item","columnSizes"],["role","alert",1,"alert","alert-info","w-100","d-inline-block","mt-4"],[3,"message"]],template:function(rf,ctx){1&rf&&(core.DNE(0,ItemBitstreamsComponent_div_0_Template,35,42,"div",0),core.nI1(1,"async")),2&rf&&core.Y8G("ngVar",core.bMT(1,1,ctx.bundles$))},dependencies:[common.Jj,ngx_translate_core.h,ngx_translate_core.D9,ItemEditBitstreamBundleComponent,router.Wk,common.bT,var_directive.r,ItemEditBitstreamDragHandleComponent,common.Sq,themed_loading_component.v],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover, .bitstream-row-drag-handle[_ngcontent-%COMP%]:hover{cursor:move}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle, [_nghost-%COMP%]     .bitstream-row-drag-handle:focus .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]     .larger-tooltip .tooltip-inner{max-width:500px}"]})}return ItemBitstreamsComponent2})();var collection_data_service=__webpack_require__(39138),dspace_object_type_model=__webpack_require__(83455),search_service=__webpack_require__(3435),search_configuration_service=__webpack_require__(90435),fesm2022_forms=__webpack_require__(28955),collection_page_routing_paths=__webpack_require__(72330),error_component=__webpack_require__(36159),object_select_model=__webpack_require__(58221),object_select_component=__webpack_require__(87240);const collection_select_component_c0=(a0,a1)=>({"btn-danger":a0,"btn-primary":a1});function CollectionSelectComponent_ng_container_0_ds_pagination_1_tr_13_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"tr")(1,"td")(2,"input",12,0),core.nI1(4,"async"),core.nI1(5,"async"),core.nI1(6,"translate"),core.bIt("change",function(){const selectCollection_r2=core.eBV(_r1).$implicit,ctx_r2=core.XpG(3);return core.Njj(ctx_r2.switch(selectCollection_r2.dso.id))}),core.k0s()(),core.j41(7,"td")(8,"a",13),core.EFF(9),core.k0s()()()}if(2&rf){const selectCollection_r2=ctx.$implicit,selectCollectionBtn_r4=core.sdS(3),ctx_r2=core.XpG(3);core.R7$(2),core.FS9("name",selectCollection_r2.dso.id),core.Y8G("disabled",!1===core.bMT(4,6,selectCollection_r2.canSelect$))("ngModel",core.bMT(5,8,selectCollection_r2.selected$)),core.BMQ("aria-label",core.bMT(6,10,selectCollectionBtn_r4.checked?"collection.select.table.deselect":"collection.select.table.select")),core.R7$(6),core.Y8G("routerLink",selectCollection_r2.route),core.R7$(),core.JRh(ctx_r2.dsoNameService.getName(selectCollection_r2.dso))}}function CollectionSelectComponent_ng_container_0_ds_pagination_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-pagination",6)(1,"div",7)(2,"table",8)(3,"thead")(4,"tr")(5,"th")(6,"span",9),core.EFF(7),core.nI1(8,"translate"),core.k0s()(),core.j41(9,"th",10),core.EFF(10),core.nI1(11,"translate"),core.k0s()()(),core.j41(12,"tbody"),core.DNE(13,CollectionSelectComponent_ng_container_0_ds_pagination_1_tr_13_Template,10,12,"tr",11),core.nI1(14,"async"),core.k0s()()()()),2&rf){const collectionsRD_r5=core.XpG().ngVar,ctx_r2=core.XpG();core.Y8G("paginationOptions",ctx_r2.paginationOptions)("sortOptions",ctx_r2.sortOptions)("collectionSize",null==collectionsRD_r5||null==collectionsRD_r5.payload?null:collectionsRD_r5.payload.totalElements)("hidePagerWhenSinglePage",!0)("hideGear",!0),core.R7$(7),core.JRh(core.bMT(8,8,"collection.select.table.selected")),core.R7$(3),core.JRh(core.bMT(11,10,"collection.select.table.title")),core.R7$(3),core.Y8G("ngForOf",core.bMT(14,12,ctx_r2.selectCollections$))}}function CollectionSelectComponent_ng_container_0_div_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",14),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"collection.select.empty")," "))}function CollectionSelectComponent_ng_container_0_ds_error_3_Template(rf,ctx){1&rf&&(core.nrm(0,"ds-error",15),core.nI1(1,"translate")),2&rf&&core.FS9("message",core.bMT(1,1,"error.collections"))}function CollectionSelectComponent_ng_container_0_ds_loading_4_Template(rf,ctx){1&rf&&(core.nrm(0,"ds-loading",15),core.nI1(1,"translate")),2&rf&&core.FS9("message",core.bMT(1,1,"loading.collections"))}function CollectionSelectComponent_ng_container_0_div_5_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",16)(1,"button",17),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.onCancel())}),core.nrm(2,"i",18),core.EFF(3),core.nI1(4,"translate"),core.k0s(),core.j41(5,"button",19),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.confirmSelected())}),core.nrm(6,"i",20),core.EFF(7),core.nI1(8,"translate"),core.k0s()()}if(2&rf){const selectedIds_r7=ctx.ngVar,ctx_r2=core.XpG(2);core.R7$(3),core.SpI(" ",core.bMT(4,4,ctx_r2.cancelButton)," "),core.R7$(2),core.Y8G("ngClass",core.l_i(8,collection_select_component_c0,ctx_r2.dangerConfirm,!ctx_r2.dangerConfirm))("disabled",0===(null==selectedIds_r7?null:selectedIds_r7.length)),core.R7$(2),core.SpI(" ",core.bMT(8,6,ctx_r2.confirmButton)," ")}}function CollectionSelectComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,CollectionSelectComponent_ng_container_0_ds_pagination_1_Template,15,14,"ds-pagination",2)(2,CollectionSelectComponent_ng_container_0_div_2_Template,3,3,"div",3)(3,CollectionSelectComponent_ng_container_0_ds_error_3_Template,2,3,"ds-error",4)(4,CollectionSelectComponent_ng_container_0_ds_loading_4_Template,2,3,"ds-loading",4)(5,CollectionSelectComponent_ng_container_0_div_5_Template,9,11,"div",5),core.nI1(6,"async"),core.bVm()),2&rf){const collectionsRD_r5=ctx.ngVar,ctx_r2=core.XpG();core.R7$(),core.Y8G("ngIf",(null==collectionsRD_r5||null==collectionsRD_r5.payload?null:collectionsRD_r5.payload.totalElements)>0||(null==collectionsRD_r5||null==collectionsRD_r5.payload||null==collectionsRD_r5.payload.page?null:collectionsRD_r5.payload.page.length)>0),core.R7$(),core.Y8G("ngIf",0===(null==collectionsRD_r5||null==collectionsRD_r5.payload?null:collectionsRD_r5.payload.totalElements)||0===(null==collectionsRD_r5||null==collectionsRD_r5.payload||null==collectionsRD_r5.payload.page?null:collectionsRD_r5.payload.page.length)),core.R7$(),core.Y8G("ngIf",null==collectionsRD_r5?null:collectionsRD_r5.hasFailed),core.R7$(),core.Y8G("ngIf",!collectionsRD_r5||(null==collectionsRD_r5?null:collectionsRD_r5.isLoading)),core.R7$(),core.Y8G("ngVar",core.bMT(6,5,ctx_r2.selectedIds$))}}let CollectionSelectComponent=(()=>{class CollectionSelectComponent2 extends object_select_component.h{ngOnInit(){super.ngOnInit(),(0,empty_util.hj)(this.confirmButton)||(this.confirmButton="collection.select.confirm"),this.selectCollections$=this.dsoRD$.pipe((0,empty_util.Az)(),(0,shared_operators.Hz)(),(0,cjs.map)(collections=>collections.page.map(collection=>Object.assign(new object_select_model.A,{dso:collection,canSelect$:this.canSelect(collection),selected$:this.getSelected(collection.id),route:(0,collection_page_routing_paths.JW)(collection.id)}))))}static#_=this.\u0275fac=(()=>{let \u0275CollectionSelectComponent_BaseFactory;return function(t){return(\u0275CollectionSelectComponent_BaseFactory||(\u0275CollectionSelectComponent_BaseFactory=core.xGo(CollectionSelectComponent2)))(t||CollectionSelectComponent2)}})();static#_2=this.\u0275cmp=core.VBU({type:CollectionSelectComponent2,selectors:[["ds-collection-select"]],standalone:!0,features:[core.Vt3,core.aNF],decls:2,vars:3,consts:[["selectCollectionBtn",""],[4,"ngVar"],[3,"paginationOptions","sortOptions","collectionSize","hidePagerWhenSinglePage","hideGear",4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[3,"message",4,"ngIf"],["class","space-children-mr float-right",4,"ngVar"],[3,"paginationOptions","sortOptions","collectionSize","hidePagerWhenSinglePage","hideGear"],[1,"table-responsive","mt-2"],["id","collection-select",1,"table","table-striped","table-hover"],[1,"sr-only"],["scope","col"],[4,"ngFor","ngForOf"],["type","checkbox",1,"collection-checkbox",3,"change","disabled","ngModel","name"],[3,"routerLink"],["role","alert",1,"alert","alert-info","w-100"],[3,"message"],[1,"space-children-mr","float-right"],[1,"btn","btn-outline-secondary","collection-cancel",3,"click"],[1,"fas","fa-times"],[1,"btn","collection-confirm",3,"click","ngClass","disabled"],[1,"fas","fa-trash"]],template:function(rf,ctx){1&rf&&(core.DNE(0,CollectionSelectComponent_ng_container_0_Template,7,7,"ng-container",1),core.nI1(1,"async")),2&rf&&core.Y8G("ngVar",core.bMT(1,1,ctx.dsoRD$))},dependencies:[var_directive.r,common.bT,pagination_component.e,common.pM,fesm2022_forms.YN,fesm2022_forms.Zm,fesm2022_forms.BC,fesm2022_forms.vS,router.Wk,error_component.A,themed_loading_component.v,common.YU,common.Jj,ngx_translate_core.h,ngx_translate_core.D9],styles:["table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type, table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type{width:1rem!important}"]})}return CollectionSelectComponent2})();var themed_search_form_component=__webpack_require__(77861);const item_collection_mapper_component_c0=["tabs"],item_collection_mapper_component_c1=a0=>({name:a0});function ItemCollectionMapperComponent_ng_template_18_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"div",11)(1,"ds-collection-select",12),core.nI1(2,"async"),core.bIt("confirm",function($event){core.eBV(_r2);const ctx_r2=core.XpG();return core.Njj(ctx_r2.removeMappings($event))})("cancel",function(){core.eBV(_r2);const ctx_r2=core.XpG();return core.Njj(ctx_r2.onCancel())}),core.k0s()()}if(2&rf){let tmp_4_0;const ctx_r2=core.XpG();core.R7$(),core.Y8G("key","browse")("dsoRD$",ctx_r2.itemCollectionsRD$)("paginationOptions",null==(tmp_4_0=core.bMT(2,6,ctx_r2.searchOptions$))?null:tmp_4_0.pagination)("confirmButton","item.edit.item-mapper.buttons.remove")("cancelButton","item.edit.item-mapper.cancel")("dangerConfirm",!0)}}function ItemCollectionMapperComponent_ng_template_23_div_5_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div")(1,"ds-collection-select",18),core.nI1(2,"async"),core.nI1(3,"async"),core.bIt("confirm",function($event){core.eBV(_r5);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.mapCollections($event))})("cancel",function(){core.eBV(_r5);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.onCancel())}),core.k0s()()}if(2&rf){let tmp_5_0,tmp_6_0;const ctx_r2=core.XpG(2);core.R7$(),core.Y8G("key","map")("dsoRD$",ctx_r2.mappedCollectionsRD$)("paginationOptions",null==(tmp_5_0=core.bMT(2,6,ctx_r2.searchOptions$))?null:tmp_5_0.pagination)("sortOptions",null==(tmp_6_0=core.bMT(3,8,ctx_r2.searchOptions$))?null:tmp_6_0.sort)("confirmButton","item.edit.item-mapper.buttons.add")("cancelButton","item.edit.item-mapper.cancel")}}function ItemCollectionMapperComponent_ng_template_23_div_6_Template(rf,ctx){1&rf&&(core.j41(0,"div",19),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"item.edit.item-mapper.no-search")," "))}function ItemCollectionMapperComponent_ng_template_23_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"div",13)(1,"div",14)(2,"ds-search-form",15),core.nI1(3,"async"),core.nI1(4,"translate"),core.bIt("submitSearch",function(){core.eBV(_r4);const ctx_r2=core.XpG();return core.Njj(ctx_r2.performedSearch=!0)}),core.k0s()()(),core.DNE(5,ItemCollectionMapperComponent_ng_template_23_div_5_Template,4,10,"div",16)(6,ItemCollectionMapperComponent_ng_template_23_div_6_Template,3,3,"div",17)}if(2&rf){let tmp_2_0;const ctx_r2=core.XpG();core.R7$(2),core.Y8G("query",null==(tmp_2_0=core.bMT(3,6,ctx_r2.searchOptions$))?null:tmp_2_0.query)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",core.bMT(4,8,"item.edit.item-mapper.search-form.placeholder")),core.R7$(3),core.Y8G("ngIf",ctx_r2.performedSearch),core.R7$(),core.Y8G("ngIf",!ctx_r2.performedSearch)}}let ItemCollectionMapperComponent=(()=>{class ItemCollectionMapperComponent2{constructor(route,router2,searchConfigService,searchService,notificationsService,itemDataService,collectionDataService,translateService,dsoNameService){this.route=route,this.router=router2,this.searchConfigService=searchConfigService,this.searchService=searchService,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.collectionDataService=collectionDataService,this.translateService=translateService,this.dsoNameService=dsoNameService,this.performedSearch=!1}ngOnInit(){this.itemRD$=this.route.parent.data.pipe((0,operators.s)(1),(0,operators.Tj)(data=>data.dso)),this.itemName$=this.itemRD$.pipe((0,operators.pb)(rd=>(0,empty_util.a4)(rd)),(0,operators.Tj)(rd=>this.dsoNameService.getName(rd.payload))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadCollectionLists()}loadCollectionLists(){this.shouldUpdate$=new cjs.BehaviorSubject(!0),this.itemCollectionsRD$=(0,cjs.combineLatest)(this.itemRD$.pipe((0,shared_operators.ak)()),this.shouldUpdate$).pipe((0,operators.nx)(([item,shouldUpdate])=>(!0===shouldUpdate&&this.shouldUpdate$.next(!1),this.collectionDataService.findListByHref(this.itemDataService.getMappedCollectionsEndpoint(item.id),void 0,!shouldUpdate,!1).pipe((0,shared_operators.v7)()))));const owningCollectionRD$=this.itemRD$.pipe((0,shared_operators.ak)(),(0,operators.nx)(item=>this.collectionDataService.findOwningCollectionFor(item)),(0,shared_operators.v7)()),itemCollectionsAndOptions$=(0,cjs.combineLatest)(this.itemCollectionsRD$,owningCollectionRD$,this.searchOptions$);this.mappedCollectionsRD$=itemCollectionsAndOptions$.pipe((0,operators.nx)(([itemCollectionsRD,owningCollectionRD,searchOptions])=>this.searchService.search(Object.assign(new paginated_search_options_model.C(searchOptions),{query:this.buildQuery([...itemCollectionsRD.payload.page,owningCollectionRD.payload],searchOptions.query),dsoTypes:[dspace_object_type_model.W.COLLECTION]}),1e4).pipe((0,shared_operators.jY)(),(0,operators.ql)(void 0))))}mapCollections(ids){const responses$=(0,cjs.combineLatest)([this.itemRD$.pipe((0,shared_operators.yd)(),(0,operators.Tj)(rd=>rd.payload),(0,operators.Tj)(item=>item.id)),this.itemCollectionsRD$.pipe((0,shared_operators.yd)(),(0,operators.Tj)(rd=>rd.payload.page),(0,operators.Tj)(collections=>collections.map(collection=>collection.id)))]).pipe((0,operators.nx)(([itemId,excludingIds])=>(0,cjs.combineLatest)(this.filterIds(ids,excludingIds).map(id=>this.itemDataService.mapToCollection(itemId,id).pipe((0,shared_operators.qD)())))));this.showNotifications(responses$,"item.edit.item-mapper.notifications.add")}removeMappings(ids){const responses$=this.itemRD$.pipe((0,shared_operators.yd)(),(0,operators.Tj)(itemRD=>itemRD.payload.id),(0,operators.nx)(itemId=>(0,cjs.combineLatest)(ids.map(id=>this.itemDataService.removeMappingFromCollection(itemId,id).pipe((0,shared_operators.qD)())))));this.showNotifications(responses$,"item.edit.item-mapper.notifications.remove")}filterIds(ids,excluding){return ids.filter(id=>excluding.indexOf(id)<0)}showNotifications(responses$,messagePrefix){responses$.subscribe(responses=>{const successful=responses.filter(response=>response.hasSucceeded),unsuccessful=responses.filter(response=>response.hasFailed);successful.length>0&&((0,cjs.combineLatest)([this.translateService.get(`${messagePrefix}.success.head`),this.translateService.get(`${messagePrefix}.success.content`,{amount:successful.length})]).subscribe(([head,content])=>{this.notificationsService.success(head,content)}),this.shouldUpdate$.next(!0)),unsuccessful.length>0&&(0,cjs.combineLatest)([this.translateService.get(`${messagePrefix}.error.head`),this.translateService.get(`${messagePrefix}.error.content`,{amount:unsuccessful.length})]).subscribe(([head,content])=>{this.notificationsService.error(head,content)}),this.switchToFirstTab()})}tabChange(event){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}getCurrentUrl(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}buildQuery(collections,query){let result=query;for(const collection of collections)result=this.addExcludeCollection(collection.id,result);return result}addExcludeCollection(collectionId,query){const excludeQuery=`-search.resourceid:${collectionId}`;return(0,empty_util.hj)(query)?`${query} AND ${excludeQuery}`:excludeQuery}switchToFirstTab(){this.tabs.select("browseTab")}onCancel(){this.itemRD$.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.s)(1)).subscribe(item=>{this.router.navigate([(0,item_page_routing_paths._o)(item)])})}static#_=this.\u0275fac=function(t){return new(t||ItemCollectionMapperComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(search_configuration_service.g),core.rXU(search_service.S),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(collection_data_service.CollectionDataService),core.rXU(ngx_translate_core.c$),core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=core.VBU({type:ItemCollectionMapperComponent2,selectors:[["ds-item-collection-mapper"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(item_collection_mapper_component_c0,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.tabs=_t.first)}},standalone:!0,features:[core.aNF],decls:25,vars:24,consts:[["tabs","ngbNav"],[1,"container","mt-2"],[1,"row"],[1,"col-12"],["id","item-name",3,"innerHTML"],["ngbNav","",1,"nav-tabs",3,"navChange","destroyOnHide"],["role","presentation","data-test","browseTab",3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],["role","presentation","data-test","mapTab",3,"ngbNavItem"],[3,"ngbNavOutlet"],[1,"mt-2"],[1,"mt-2",3,"confirm","cancel","key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"submitSearch","query","currentUrl","inPlaceSearch","searchPlaceholder"],[4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[1,"mt-2",3,"confirm","cancel","key","dsoRD$","paginationOptions","sortOptions","confirmButton","cancelButton"],["role","alert",1,"alert","alert-info","w-100"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.nrm(6,"p",4),core.nI1(7,"async"),core.nI1(8,"translate"),core.j41(9,"p"),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"ul",5,0),core.bIt("navChange",function($event){return core.eBV(_r1),core.Njj(ctx.tabChange($event))}),core.j41(14,"li",6)(15,"a",7),core.EFF(16),core.nI1(17,"translate"),core.k0s(),core.DNE(18,ItemCollectionMapperComponent_ng_template_18_Template,3,8,"ng-template",8),core.k0s(),core.j41(19,"li",9)(20,"a",7),core.EFF(21),core.nI1(22,"translate"),core.k0s(),core.DNE(23,ItemCollectionMapperComponent_ng_template_23_Template,7,10,"ng-template",8),core.k0s()(),core.nrm(24,"div",10),core.k0s()()()}if(2&rf){const tabs_r6=core.sdS(13);core.R7$(4),core.JRh(core.bMT(5,9,"item.edit.item-mapper.head")),core.R7$(2),core.Y8G("innerHTML",core.i5U(8,13,"item.edit.item-mapper.item",core.eq3(22,item_collection_mapper_component_c1,core.bMT(7,11,ctx.itemName$))),core.npT),core.R7$(4),core.JRh(core.bMT(11,16,"item.edit.item-mapper.description")),core.R7$(2),core.Y8G("destroyOnHide",!0),core.R7$(2),core.Y8G("ngbNavItem","browseTab"),core.R7$(2),core.JRh(core.bMT(17,18,"item.edit.item-mapper.tabs.browse")),core.R7$(3),core.Y8G("ngbNavItem","mapTab"),core.R7$(2),core.JRh(core.bMT(22,20,"item.edit.item-mapper.tabs.map")),core.R7$(3),core.Y8G("ngbNavOutlet",tabs_r6)}},dependencies:[ng_bootstrap.Pv,ng_bootstrap.Um,ng_bootstrap.X9,ng_bootstrap.sy,ng_bootstrap.Ri,ng_bootstrap.m_,CollectionSelectComponent,themed_search_form_component.d,common.Jj,ngx_translate_core.h,ngx_translate_core.D9,common.bT],data:{animation:[fade.qG,fade.Ws]},changeDetection:0})}return ItemCollectionMapperComponent2})();var curation_form_component=__webpack_require__(50797);const item_curate_component_c0=a0=>({item:a0});function ItemCurateComponent_ds_curation_form_5_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-curation-form",2),2&rf){const dsoRD_r1=ctx.ngIf;core.Y8G("dsoHandle",null==dsoRD_r1?null:dsoRD_r1.payload.handle)}}let ItemCurateComponent=(()=>{class ItemCurateComponent2{constructor(route,dsoNameService){this.route=route,this.dsoNameService=dsoNameService}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe((0,operators.s)(1),(0,operators.Tj)(data=>data.dso)),this.itemName$=this.dsoRD$.pipe((0,operators.pb)(rd=>(0,empty_util.a4)(rd)),(0,operators.Tj)(rd=>this.dsoNameService.getName(rd.payload)))}static#_=this.\u0275fac=function(t){return new(t||ItemCurateComponent2)(core.rXU(router.nX),core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=core.VBU({type:ItemCurateComponent2,selectors:[["ds-item-curate"]],standalone:!0,features:[core.aNF],decls:7,vars:11,consts:[[1,"container","mt-3"],[3,"dsoHandle",4,"ngIf"],[3,"dsoHandle"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"h2"),core.EFF(2),core.nI1(3,"async"),core.nI1(4,"translate"),core.k0s(),core.DNE(5,ItemCurateComponent_ds_curation_form_5_Template,1,1,"ds-curation-form",1),core.nI1(6,"async"),core.k0s()),2&rf&&(core.R7$(2),core.JRh(core.i5U(4,4,"item.edit.curate.title",core.eq3(9,item_curate_component_c0,core.bMT(3,2,ctx.itemName$)))),core.R7$(3),core.Y8G("ngIf",core.bMT(6,7,ctx.dsoRD$)))},dependencies:[curation_form_component.X,common.bT,ngx_translate_core.h,ngx_translate_core.D9,common.Jj],encapsulation:2})}return ItemCurateComponent2})();var entity_type_data_service=__webpack_require__(53722),relationship_data_service=__webpack_require__(8648),view_mode_model=__webpack_require__(97849),listable_object_component_loader_component=__webpack_require__(95776),modify_item_overview_component=__webpack_require__(63390);const abstract_simple_item_action_component_c0=a0=>({id:a0}),abstract_simple_item_action_component_c1=a0=>[a0,"edit"];let AbstractSimpleItemActionComponent=(()=>{class AbstractSimpleItemActionComponent2{constructor(route,router2,notificationsService,itemDataService,translateService){this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService}ngOnInit(){this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.yd)()),this.itemRD$.pipe((0,operators.$1)()).subscribe(rd=>{this.item=rd.payload,this.itemPageRoute=(0,item_page_routing_paths._o)(this.item)}),this.confirmMessage="item.edit."+this.messageKey+".confirm",this.cancelMessage="item.edit."+this.messageKey+".cancel",this.headerMessage="item.edit."+this.messageKey+".header",this.descriptionMessage="item.edit."+this.messageKey+".description"}performAction(){}processRestResponse(response){var predicate;response.hasSucceeded?this.itemDataService.findById(this.item.id).pipe((predicate=itemRd=>this.predicate(itemRd),source=>source.pipe((0,shared_operators.v7)(),(0,operators.$1)(predicate)))).subscribe(()=>{this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([(0,item_page_routing_paths.$r)(this.item)])}):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([(0,item_page_routing_paths.$r)(this.item)]))}static#_=this.\u0275fac=function(t){return new(t||AbstractSimpleItemActionComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))};static#_2=this.\u0275cmp=core.VBU({type:AbstractSimpleItemActionComponent2,selectors:[["ds-simple-action"]],standalone:!0,features:[core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,abstract_simple_item_action_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,abstract_simple_item_action_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,ngx_translate_core.h,ngx_translate_core.D9,router.Wk],encapsulation:2})}return AbstractSimpleItemActionComponent2})();const item_delete_component_c0=a0=>({id:a0}),item_delete_component_c1=a0=>[a0,"edit"];function ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ds_listable_object_component_loader_1_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-listable-object-component-loader",24),2&rf){const relatedItem_r6=core.XpG().ngVar,ctx_r3=core.XpG(6);core.Y8G("object",relatedItem_r6)("viewMode",ctx_r3.viewMode)}}function ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ng_template_6_ds_listable_object_component_loader_8_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-listable-object-component-loader",24),2&rf){const relatedItem_r6=core.XpG(2).ngVar,ctx_r3=core.XpG(6);core.Y8G("object",relatedItem_r6)("viewMode",ctx_r3.viewMode)}}function ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ng_template_6_div_9_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"div")(2,"div",31),core.EFF(3),core.k0s(),core.j41(4,"div"),core.EFF(5),core.k0s()()()),2&rf){const metadata_r9=ctx.$implicit;core.R7$(3),core.SpI(" ",metadata_r9.metadataField," "),core.R7$(2),core.SpI(" ",metadata_r9.metadataValue.value," ")}}function ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ng_template_6_Template(rf,ctx){if(1&rf){const _r8=core.RV6();core.j41(0,"div",25)(1,"div",26),core.EFF(2),core.nI1(3,"translate"),core.j41(4,"button",27),core.bIt("click",function(){core.eBV(_r8);const ctx_r3=core.XpG(7);return core.Njj(ctx_r3.closeVirtualMetadataModal())}),core.j41(5,"span",28),core.EFF(6,"\xd7"),core.k0s()()(),core.j41(7,"div",29),core.DNE(8,ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ng_template_6_ds_listable_object_component_loader_8_Template,1,2,"ds-listable-object-component-loader",19)(9,ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ng_template_6_div_9_Template,6,2,"div",30),core.nI1(10,"async"),core.k0s()()}if(2&rf){const relatedItem_r6=core.XpG().ngVar,relationshipDto_r10=core.XpG().$implicit;core.R7$(2),core.SpI(" ",core.bMT(3,3,"virtual-metadata.delete-item.modal-head")," "),core.R7$(6),core.Y8G("ngIf",relatedItem_r6),core.R7$(),core.Y8G("ngForOf",core.bMT(10,5,relationshipDto_r10.virtualMetadata$))}}function ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.qex(0),core.DNE(1,ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ds_listable_object_component_loader_1_Template,1,2,"ds-listable-object-component-loader",19),core.j41(2,"div",20)(3,"div",21)(4,"button",22),core.bIt("click",function(){core.eBV(_r5);const virtualMetadataModal_r7=core.sdS(7),ctx_r3=core.XpG(6);return core.Njj(ctx_r3.openVirtualMetadataModal(virtualMetadataModal_r7))}),core.nrm(5,"i",23),core.k0s()()(),core.DNE(6,ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_ng_template_6_Template,11,7,"ng-template",null,0,core.C5r),core.bVm()}if(2&rf){const relatedItem_r6=ctx.ngVar;core.R7$(),core.Y8G("ngIf",relatedItem_r6)}}function ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",13),core.DNE(1,ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_ng_container_1_Template,8,1,"ng-container",5),core.nI1(2,"async"),core.k0s()),2&rf){const relationshipDto_r10=ctx.$implicit;core.R7$(),core.Y8G("ngVar",core.bMT(2,1,relationshipDto_r10.relatedItem$))}}function ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",13)(1,"div",14),core.bIt("click",function(){const selected_r2=core.eBV(_r1).ngVar,typeDto_r3=core.XpG().$implicit,ctx_r3=core.XpG(3);return core.Njj(ctx_r3.setSelected(typeDto_r3.relationshipType,!selected_r2))}),core.j41(2,"label"),core.nrm(3,"input",15),core.nI1(4,"async"),core.k0s()(),core.j41(5,"div",16)(6,"h5",17),core.bIt("click",function(){const selected_r2=core.eBV(_r1).ngVar,typeDto_r3=core.XpG().$implicit,ctx_r3=core.XpG(3);return core.Njj(ctx_r3.setSelected(typeDto_r3.relationshipType,!selected_r2))}),core.EFF(7),core.nI1(8,"async"),core.nI1(9,"translate"),core.k0s(),core.DNE(10,ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_div_10_Template,3,3,"div",18),core.nI1(11,"async"),core.k0s()()}if(2&rf){const selected_r2=ctx.ngVar,typeDto_r3=core.XpG().$implicit,ctx_r3=core.XpG(3);core.R7$(3),core.Y8G("checked",selected_r2)("disabled",core.bMT(4,4,ctx_r3.isDeleting$)),core.R7$(4),core.SpI(" ",core.bMT(9,8,ctx_r3.getRelationshipMessageKey(core.bMT(8,6,typeDto_r3.label$)))," "),core.R7$(3),core.Y8G("ngForOf",core.bMT(11,10,typeDto_r3.relationshipDTOs$))}}function ItemDeleteComponent_ng_container_10_div_1_div_3_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",10),core.DNE(1,ItemDeleteComponent_ng_container_10_div_1_div_3_div_1_Template,12,12,"div",12),core.nI1(2,"async"),core.k0s()),2&rf){const typeDto_r3=ctx.$implicit;core.R7$(),core.Y8G("ngVar",core.bMT(2,1,typeDto_r3.isSelected$))}}function ItemDeleteComponent_ng_container_10_div_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",10),core.EFF(1),core.nI1(2,"translate"),core.DNE(3,ItemDeleteComponent_ng_container_10_div_1_div_3_Template,3,3,"div",11),core.k0s()),2&rf){const types_r11=core.XpG().ngVar;core.R7$(),core.SpI(" ",core.bMT(2,2,"virtual-metadata.delete-item.info")," "),core.R7$(2),core.Y8G("ngForOf",types_r11)}}function ItemDeleteComponent_ng_container_10_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,ItemDeleteComponent_ng_container_10_div_1_Template,4,4,"div",9),core.bVm()),2&rf){const types_r11=ctx.ngVar;core.R7$(),core.Y8G("ngIf",types_r11&&types_r11.length>0)}}class RelationshipTypeDTO{}class RelationshipDTO{}let ItemDeleteComponent=(()=>{class ItemDeleteComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService,modalService,objectUpdatesService,relationshipService,entityTypeService,linkService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.modalService=modalService,this.objectUpdatesService=objectUpdatesService,this.relationshipService=relationshipService,this.entityTypeService=entityTypeService,this.linkService=linkService,this.messageKey="delete",this.viewMode=view_mode_model.n.ListElement,this.typeDTOs$=new cjs.BehaviorSubject([]),this.relationships$=new Map,this.relatedItems$=new Map,this.virtualMetadata$=new Map,this.subs=[],this.isDeleting$=new cjs.BehaviorSubject(!1)}ngOnInit(){super.ngOnInit(),this.url=this.router.url;const label=this.item.firstMetadataValue("dspace.entity.type");(0,empty_util.hj)(label)&&this.subs.push(this.entityTypeService.getEntityTypeByLabel(label).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.nx)(entityType=>this.entityTypeService.getEntityTypeRelationships(entityType.id)),(0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.Tj)(relationshipTypes=>relationshipTypes.page),(0,operators.nx)(types=>0===types.length?(0,cjs.of)(types):(0,cjs.combineLatest)(types.map(type=>this.getRelationships(type))).pipe((0,operators.Tj)(relationships=>types.reduce((includedTypes,type,index)=>includedTypes.some(includedType=>includedType.id===type.id)||0===relationships[index].length?includedTypes:[...includedTypes,type],[]))))).subscribe(types=>this.typeDTOs$.next(types.map(relationshipType=>Object.assign(new RelationshipTypeDTO,{relationshipType,isSelected$:this.isSelected(relationshipType),label$:this.getLabel(relationshipType),relationshipDTOs$:this.getRelationships(relationshipType).pipe((0,operators.Tj)(relationships=>relationships.map(relationship=>Object.assign(new RelationshipDTO,{relationship,relatedItem$:this.getRelatedItem(relationship),virtualMetadata$:this.getVirtualMetadata(relationship)}))))}))))),this.subs.push(this.typeDTOs$.pipe((0,operators.s)(1)).subscribe(types=>this.objectUpdatesService.initialize(this.url,types.map(relationshipTypeDto=>relationshipTypeDto.relationshipType),this.item.lastModified)))}openVirtualMetadataModal(content){this.modalRef=this.modalService.open(content)}closeVirtualMetadataModal(){this.modalRef.close()}getRelationshipMessageKey(label){return(0,empty_util.a4)(label)&&label.indexOf("Of")>-1?`relationships.${label.substring(0,label.indexOf("Of")+2)}`:label}getLabel(relationshipType){return this.getRelationships(relationshipType).pipe((0,operators.nx)(relationships=>this.isLeftItem(relationships[0]).pipe((0,operators.Tj)(isLeftItem=>isLeftItem?relationshipType.leftwardType:relationshipType.rightwardType))))}getRelationships(relationshipType){return this.relationships$.has(relationshipType)||this.relationships$.set(relationshipType,this.relationshipService.getItemRelationshipsArray(this.item).pipe((0,operators.nx)(relationships=>(0,cjs.combineLatest)(relationships.map(relationship=>this.getRelationshipType(relationship))).pipe((0,operators.US)([]),(0,operators.Tj)(types=>relationships.filter((relationship,index)=>relationshipType.id===types[index].id)))))),this.relationships$.get(relationshipType)}getRelationshipType(relationship){return this.linkService.resolveLinks(relationship,(0,follow_link_config_model.s)("relationshipType"),(0,follow_link_config_model.s)("leftItem"),(0,follow_link_config_model.s)("rightItem")),relationship.relationshipType.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(relationshipType=>(0,empty_util.a4)(relationshipType)&&(0,empty_util.hj)(relationshipType.uuid)))}getRelatedItem(relationship){return this.relatedItems$.has(relationship)||this.relatedItems$.set(relationship,this.isLeftItem(relationship).pipe((0,operators.nx)(isLeftItem=>isLeftItem?relationship.rightItem:relationship.leftItem),(0,shared_operators.yd)(),(0,shared_operators.Bo)())),this.relatedItems$.get(relationship)}getVirtualMetadata(relationship){return this.virtualMetadata$.has(relationship)||this.virtualMetadata$.set(relationship,this.getRelatedItem(relationship).pipe((0,operators.Tj)(relatedItem=>Object.entries(relatedItem.metadata).map(([key,value])=>value.filter(metadata=>metadata.authority&&metadata.authority.endsWith(relationship.id)).map(metadata=>({metadataField:key,metadataValue:metadata}))).reduce((previous,current)=>previous.concat(current))))),this.virtualMetadata$.get(relationship)}isLeftItem(relationship){return relationship.leftItem.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(item=>(0,empty_util.a4)(item)&&(0,empty_util.hj)(item.uuid)),(0,operators.Tj)(leftItem=>leftItem.uuid===this.item.uuid))}isSelected(type){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.item.uuid,type.uuid)}setSelected(type,selected){!1===this.isDeleting$.value&&this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.item.uuid,type.uuid,selected)}performAction(){this.isDeleting$.next(!0),this.subs.push(this.typeDTOs$.pipe((0,operators.nx)(types=>(0,cjs.combineLatest)(types.map(type=>type.isSelected$)).pipe((0,operators.US)([]),(0,operators.Tj)(selection=>types.filter((type,index)=>selection[index])),(0,operators.Tj)(selectedDtoTypes=>selectedDtoTypes.map(typeDto=>typeDto.relationshipType.id)))),(0,operators.nx)(types=>this.itemDataService.delete(this.item.id,types)),(0,shared_operators.qD)()).subscribe(rd=>{this.notify(rd.hasSucceeded)}))}notify(succeeded){succeeded?(this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([""])):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([(0,item_page_routing_paths.$r)(this.item)]))}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||ItemDeleteComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$),core.rXU(ng_bootstrap.Bq),core.rXU(object_updates_service.F),core.rXU(relationship_data_service.RelationshipDataService),core.rXU(entity_type_data_service.f),core.rXU(link_service._))};static#_2=this.\u0275cmp=core.VBU({type:ItemDeleteComponent2,selectors:[["ds-item-delete"]],inputs:{url:"url"},standalone:!0,features:[core.Vt3,core.aNF],decls:21,vars:28,consts:[["virtualMetadataModal",""],[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[4,"ngVar"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click","disabled"],[1,"btn","btn-outline-secondary","cancel",3,"disabled","routerLink"],["class","mb-4",4,"ngIf"],[1,"mb-4"],["class","mb-4",4,"ngFor","ngForOf"],["class","d-flex flex-row",4,"ngVar"],[1,"d-flex","flex-row"],[1,"m-2",3,"click"],["type","checkbox",3,"checked","disabled"],[1,"flex-column","flex-grow-1"],[3,"click"],["class","d-flex flex-row",4,"ngFor","ngForOf"],[3,"object","viewMode",4,"ngIf"],[1,"ml-auto"],[1,"btn-group"],[1,"btn","btn-outline-info","btn-sm",3,"click"],[1,"fas","fa-info","fa-fw"],[3,"object","viewMode"],[1,"thumb-font-1"],[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",4),core.DNE(10,ItemDeleteComponent_ng_container_10_Template,2,1,"ng-container",5),core.nI1(11,"async"),core.j41(12,"div",6)(13,"button",7),core.nI1(14,"async"),core.bIt("click",function(){return ctx.performAction()}),core.EFF(15),core.nI1(16,"translate"),core.k0s(),core.j41(17,"button",8),core.nI1(18,"async"),core.EFF(19),core.nI1(20,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,9,ctx.headerMessage,core.eq3(24,item_delete_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,12,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(),core.Y8G("ngVar",core.bMT(11,14,ctx.typeDTOs$)),core.R7$(3),core.Y8G("disabled",core.bMT(14,16,ctx.isDeleting$)),core.R7$(2),core.SpI("",core.bMT(16,18,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("disabled",core.bMT(18,20,ctx.isDeleting$))("routerLink",core.eq3(26,item_delete_component_c1,ctx.itemPageRoute)),core.R7$(2),core.SpI(" ",core.bMT(20,22,ctx.cancelMessage)," "))},dependencies:[ngx_translate_core.h,ngx_translate_core.D9,listable_object_component_loader_component.v,common.bT,modify_item_overview_component.W,common.Jj,var_directive.r,common.Sq,router.Wk],encapsulation:2})}return ItemDeleteComponent2})();var authorized_collection_selector_component=__webpack_require__(73131);const item_move_component_c0=a0=>({id:a0}),item_move_component_c1=a0=>({type:a0}),item_move_component_c2=a0=>[a0,"edit"];function ItemMoveComponent_ng_template_24_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"item.edit.move.inheritpolicies.tooltip")," ")}function ItemMoveComponent_span_40_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",18),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"item.edit.move.save-button")," "))}function ItemMoveComponent_span_41_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",19),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"item.edit.move.processing")," "))}let ItemMoveComponent=(()=>{class ItemMoveComponent2{constructor(route,router2,notificationsService,itemDataService,searchService,translateService,requestService,dsoNameService){this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.searchService=searchService,this.translateService=translateService,this.requestService=requestService,this.dsoNameService=dsoNameService,this.selectorType=dspace_object_type_model.W.COLLECTION,this.inheritPolicies=!1,this.canSubmit=!1,this.processing=!1,this.COLLECTIONS=[dspace_object_type_model.W.COLLECTION]}ngOnInit(){this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.yd)()),this.itemPageRoute$=this.itemRD$.pipe((0,shared_operators.Hz)(),(0,operators.Tj)(item=>(0,item_page_routing_paths._o)(item))),this.itemRD$.subscribe(rd=>{this.item=rd.payload}),this.itemRD$.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.nx)(item=>item.owningCollection),(0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(collection=>{this.originalCollection=collection})}selectDso(data){this.selectedCollection=data,this.selectedCollectionName=this.dsoNameService.getName(data),this.canSubmit=!0}getCurrentUrl(){return this.router.url}moveToCollection(){this.processing=!0;const move$=this.itemDataService.moveToCollection(this.item.id,this.selectedCollection,this.inheritPolicies).pipe((0,shared_operators.qD)());move$.subscribe(response=>{response.hasSucceeded?this.notificationsService.success(this.translateService.get("item.edit.move.success")):this.notificationsService.error(this.translateService.get("item.edit.move.error"))}),move$.pipe((0,operators.nx)(()=>this.requestService.setStaleByHrefSubstring(this.item.id)),(0,operators.nx)(()=>this.itemDataService.findById(this.item.id,!1,!0,(0,follow_link_config_model.s)("owningCollection"))),(0,shared_operators.qD)()).subscribe(()=>{this.processing=!1,this.router.navigate([(0,item_page_routing_paths.$r)(this.item)])})}discard(){this.selectedCollection=null,this.canSubmit=!1}get canMove(){return this.canSubmit&&this.selectedCollection?.id!==this.originalCollection.id}static#_=this.\u0275fac=function(t){return new(t||ItemMoveComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(search_service.S),core.rXU(ngx_translate_core.c$),core.rXU(request_service.B),core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=core.VBU({type:ItemMoveComponent2,selectors:[["ds-item-move"]],standalone:!0,features:[core.aNF],decls:46,vars:44,consts:[["tooltipContent",""],[1,"container"],[1,"row"],[1,"col-12"],[1,"card","mb-3"],[1,"card-header"],[1,"card-body"],[3,"onSelect","types","currentDSOId"],["for","inheritPoliciesCheckbox"],["type","checkbox","name","tc","id","inheritPoliciesCheckbox",3,"ngModelChange","ngModel","ngbTooltip"],[1,"button-row","bottom"],[1,"float-right","space-children-mr"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"btn","btn-primary",3,"click","disabled"],[4,"ngIf"],[1,"btn","btn-danger",3,"click","disabled"],[1,"fas","fa-times"],[1,"fas","fa-save"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),core.EFF(4),core.nI1(5,"async"),core.nI1(6,"translate"),core.k0s(),core.j41(7,"p"),core.EFF(8),core.nI1(9,"translate"),core.k0s(),core.j41(10,"div",2)(11,"div",3)(12,"div",4)(13,"div",5),core.EFF(14),core.nI1(15,"translate"),core.nI1(16,"translate"),core.k0s(),core.j41(17,"div",6)(18,"ds-authorized-collection-selector",7),core.bIt("onSelect",function($event){return core.eBV(_r1),core.Njj(ctx.selectDso($event))}),core.k0s()(),core.nrm(19,"div"),core.k0s()()(),core.j41(20,"div",2)(21,"div",3)(22,"p")(23,"label",8),core.DNE(24,ItemMoveComponent_ng_template_24_Template,2,3,"ng-template",null,0,core.C5r),core.j41(26,"input",9),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.inheritPolicies,$event)||(ctx.inheritPolicies=$event),core.Njj($event)}),core.k0s(),core.EFF(27),core.nI1(28,"translate"),core.k0s()(),core.j41(29,"p"),core.EFF(30),core.nI1(31,"translate"),core.k0s()()(),core.j41(32,"div",10)(33,"div",11)(34,"button",12),core.nI1(35,"async"),core.nrm(36,"i",13),core.EFF(37),core.nI1(38,"translate"),core.k0s(),core.j41(39,"button",14),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.moveToCollection())}),core.DNE(40,ItemMoveComponent_span_40_Template,4,3,"span",15)(41,ItemMoveComponent_span_41_Template,4,3,"span",15),core.k0s(),core.j41(42,"button",16),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.discard())}),core.nrm(43,"i",17),core.EFF(44),core.nI1(45,"translate"),core.k0s()()()()()()}if(2&rf){let tmp_1_0;const tooltipContent_r2=core.sdS(25);core.R7$(4),core.JRh(core.i5U(6,18,"item.edit.move.head",core.eq3(38,item_move_component_c0,null==(tmp_1_0=core.bMT(5,16,ctx.itemRD$))||null==tmp_1_0.payload?null:tmp_1_0.payload.handle))),core.R7$(4),core.JRh(core.bMT(9,21,"item.edit.move.description")),core.R7$(6),core.JRh(core.i5U(16,25,"dso-selector.placeholder",core.eq3(40,item_move_component_c1,core.bMT(15,23,"dso-selector.placeholder.type.collection")))),core.R7$(4),core.Y8G("types",ctx.COLLECTIONS)("currentDSOId",ctx.selectedCollection?ctx.selectedCollection.id:ctx.originalCollection.id),core.R7$(8),core.R50("ngModel",ctx.inheritPolicies),core.Y8G("ngbTooltip",tooltipContent_r2),core.R7$(),core.SpI(" ",core.bMT(28,28,"item.edit.move.inheritpolicies.checkbox")," "),core.R7$(3),core.SpI(" ",core.bMT(31,30,"item.edit.move.inheritpolicies.description")," "),core.R7$(4),core.Y8G("routerLink",core.eq3(42,item_move_component_c2,core.bMT(35,32,ctx.itemPageRoute$))),core.R7$(3),core.SpI(" ",core.bMT(38,34,"item.edit.move.cancel")," "),core.R7$(2),core.Y8G("disabled",!ctx.canMove),core.R7$(),core.Y8G("ngIf",!ctx.processing),core.R7$(),core.Y8G("ngIf",ctx.processing),core.R7$(),core.Y8G("disabled",!ctx.canSubmit),core.R7$(2),core.SpI(" ",core.bMT(45,36,"item.edit.move.discard-button")," ")}},dependencies:[ngx_translate_core.h,ngx_translate_core.D9,ng_bootstrap.UN,ng_bootstrap.md,fesm2022_forms.YN,fesm2022_forms.Zm,fesm2022_forms.BC,fesm2022_forms.vS,router.Wk,common.Jj,authorized_collection_selector_component.e,common.bT],encapsulation:2})}return ItemMoveComponent2})();var dso_page_single_feature_guard=__webpack_require__(96293),feature_id=__webpack_require__(29321),item_page_resolver=__webpack_require__(60498);const itemPageAccessControlGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.AdministratorOf)),itemPageBitstreamsGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageBitstreamBundles)),itemPageCollectionMapperGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageMappings)),itemPageCurateGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.AdministratorOf)),itemPageDeleteGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanDelete)),itemPageEditAuthorizationsGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManagePolicies)),itemPageMetadataGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanEditMetadata)),itemPageMoveGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanMove)),itemPagePrivateGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanMakePrivate)),itemPageRegisterDoiGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanRegisterDOI)),itemPageReinstateGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.ReinstateItem)),itemPageRelationshipsGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageRelationships)),itemPageStatusGuard=(0,__webpack_require__(39833).FO)(()=>item_page_resolver.Z,()=>(0,cjs.of)([feature_id._.CanManageMappings,feature_id._.WithdrawItem,feature_id._.ReinstateItem,feature_id._.CanManagePolicies,feature_id._.CanMakePrivate,feature_id._.CanDelete,feature_id._.CanMove,feature_id._.CanRegisterDOI])),itemPageVersionHistoryGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageVersions)),itemPageWithdrawGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.WithdrawItem)),item_private_component_c0=a0=>({id:a0}),item_private_component_c1=a0=>[a0,"edit"];let ItemPrivateComponent=(()=>{class ItemPrivateComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="private",this.predicate=rd=>!rd.payload.isDiscoverable}performAction(){this.itemDataService.setDiscoverable(this.item,!1).pipe((0,shared_operators.qD)()).subscribe(rd=>{this.processRestResponse(rd)})}static#_=this.\u0275fac=function(t){return new(t||ItemPrivateComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))};static#_2=this.\u0275cmp=core.VBU({type:ItemPrivateComponent2,selectors:[["ds-item-private"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_private_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_private_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,ngx_translate_core.h,ngx_translate_core.D9,router.Wk],encapsulation:2})}return ItemPrivateComponent2})();const item_public_component_c0=a0=>({id:a0}),item_public_component_c1=a0=>[a0,"edit"];let ItemPublicComponent=(()=>{class ItemPublicComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="public",this.predicate=rd=>rd.payload.isDiscoverable}performAction(){this.itemDataService.setDiscoverable(this.item,!0).pipe((0,shared_operators.qD)()).subscribe(response=>{this.processRestResponse(response)})}static#_=this.\u0275fac=function(t){return new(t||ItemPublicComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))};static#_2=this.\u0275cmp=core.VBU({type:ItemPublicComponent2,selectors:[["ds-item-public"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_public_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_public_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,ngx_translate_core.h,ngx_translate_core.D9,router.Wk],encapsulation:2})}return ItemPublicComponent2})();var identifier_data_service=__webpack_require__(29779);const item_register_doi_component_c0=a0=>({id:a0}),item_register_doi_component_c1=a0=>[a0,"edit"];function ItemRegisterDoiComponent_div_9_div_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"p",10),core.EFF(2),core.nI1(3,"translate"),core.nI1(4,"translate"),core.k0s()()),2&rf){const identifier_r1=core.XpG().$implicit,ctx_r1=core.XpG();core.R7$(2),core.E5c("",core.bMT(3,3,ctx_r1.doiToUpdateMessage),": ",identifier_r1.value," (",core.bMT(4,5,"item.edit.identifiers.doi.status."+identifier_r1.identifierStatus),") ")}}function ItemRegisterDoiComponent_div_9_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",8),core.DNE(1,ItemRegisterDoiComponent_div_9_div_1_Template,5,7,"div",9),core.k0s()),2&rf){const identifier_r1=ctx.$implicit;core.R7$(),core.Y8G("ngIf","doi"===identifier_r1.identifierType)}}let ItemRegisterDoiComponent=(()=>{class ItemRegisterDoiComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService,identifierDataService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.identifierDataService=identifierDataService,this.messageKey="register-doi",this.doiToUpdateMessage="item.edit."+this.messageKey+".to-update",this.processing=!1}ngOnInit(){this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.yd)()),this.itemRD$.pipe((0,operators.$1)()).subscribe(rd=>{this.item=rd.payload,this.itemPageRoute=(0,item_page_routing_paths._o)(this.item),this.identifiers$=this.identifierDataService.getIdentifierDataFor(this.item).pipe((0,operators.Tj)(identifierRD=>401!==identifierRD.statusCode&&(0,empty_util.a4)(identifierRD.payload)?identifierRD.payload.identifiers:null))}),this.confirmMessage="item.edit."+this.messageKey+".confirm",this.cancelMessage="item.edit."+this.messageKey+".cancel",this.headerMessage="item.edit."+this.messageKey+".header",this.descriptionMessage="item.edit."+this.messageKey+".description"}performAction(){this.registerDoi()}registerDoi(){this.processing=!0,this.identifierDataService.registerIdentifier(this.item,"doi").subscribe(response=>{response.hasCompleted&&(this.processing=!1,this.processRestResponse(response))})}static#_=this.\u0275fac=function(t){return new(t||ItemRegisterDoiComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$),core.rXU(identifier_data_service.IdentifierDataService))};static#_2=this.\u0275cmp=core.VBU({type:ItemRegisterDoiComponent2,selectors:[["ds-item-register-doi"]],standalone:!0,features:[core.Vt3,core.aNF],decls:19,vars:22,consts:[[1,"container"],[1,"row"],[1,"col-12"],["class","w-100 p",4,"ngFor","ngForOf"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"],[1,"w-100","p"],[4,"ngIf"],[1,"float-left"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.DNE(9,ItemRegisterDoiComponent_div_9_Template,2,1,"div",3),core.nI1(10,"async"),core.nrm(11,"ds-modify-item-overview",4),core.j41(12,"div",5)(13,"button",6),core.bIt("click",function(){return ctx.performAction()}),core.EFF(14),core.nI1(15,"translate"),core.k0s(),core.j41(16,"button",7),core.EFF(17),core.nI1(18,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,7,ctx.headerMessage,core.eq3(18,item_register_doi_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,10,ctx.descriptionMessage)),core.R7$(2),core.Y8G("ngForOf",core.bMT(10,12,ctx.identifiers$)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(15,14,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(20,item_register_doi_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(18,16,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9,common.Jj,common.bT,common.Sq],encapsulation:2})}return ItemRegisterDoiComponent2})();const item_reinstate_component_c0=a0=>({id:a0}),item_reinstate_component_c1=a0=>[a0,"edit"];let ItemReinstateComponent=(()=>{class ItemReinstateComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="reinstate",this.predicate=rd=>!rd.payload.isWithdrawn}performAction(){this.itemDataService.setWithDrawn(this.item,!1).pipe((0,shared_operators.qD)()).subscribe(response=>{this.processRestResponse(response)})}static#_=this.\u0275fac=function(t){return new(t||ItemReinstateComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))};static#_2=this.\u0275cmp=core.VBU({type:ItemReinstateComponent2,selectors:[["ds-item-reinstate"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_reinstate_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_reinstate_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,ngx_translate_core.h,ngx_translate_core.D9,router.Wk],encapsulation:2})}return ItemReinstateComponent2})();var relationship_type_data_service=__webpack_require__(41548),alert_type=__webpack_require__(82555);let EditItemRelationshipsService=(()=>{class EditItemRelationshipsService2{constructor(itemService,objectUpdatesService,notificationsService,modalService,relationshipService,entityTypeService,translateService){this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.notificationsService=notificationsService,this.modalService=modalService,this.relationshipService=relationshipService,this.entityTypeService=entityTypeService,this.translateService=translateService,this.notificationsPrefix="item.edit.relationships.notifications.",this.isSaving$=new cjs.BehaviorSubject(!1)}submit(item,url){this.isSaving$.next(!0),this.objectUpdatesService.getFieldUpdates(url,[],!0).pipe((0,operators.Tj)(fieldUpdates=>Object.values(fieldUpdates).filter(fieldUpdate=>(0,empty_util.a4)(fieldUpdate)).filter(fieldUpdate=>fieldUpdate.changeType===field_change_type_model.B.ADD||fieldUpdate.changeType===field_change_type_model.B.REMOVE)),(0,operators.s)(1),(0,operators.nx)(updates=>updates),(0,operators.Hh)(update=>update.changeType===field_change_type_model.B.REMOVE?this.deleteRelationship(update.field).pipe((0,operators.s)(1),(0,operators.nx)(deleteRD=>deleteRD.hasSucceeded?this.itemService.invalidateByHref(update.field.relatedItem._links.self.href).pipe((0,operators.Tj)(()=>deleteRD)):[deleteRD])):update.changeType===field_change_type_model.B.ADD?this.addRelationship(update.field).pipe((0,operators.s)(1),(0,operators.nx)(relationshipRD=>{if(relationshipRD.hasSucceeded){const{leftItem,rightItem}=relationshipRD.payload._links;return leftItem.href===item.self?this.itemService.invalidateByHref(rightItem.href).pipe((0,operators.Tj)(()=>relationshipRD)):this.itemService.invalidateByHref(leftItem.href).pipe((0,operators.Tj)(()=>relationshipRD))}return[relationshipRD]})):cjs.EMPTY),(0,operators.$r)(),(0,operators.nx)(responses=>this.itemService.invalidateByHref(item.self).pipe((0,operators.Tj)(()=>responses)))).subscribe(responses=>{responses.length>0&&(this.initializeOriginalFields(item,url),this.displayNotifications(responses),this.modalService.dismissAll(),this.isSaving$.next(!1))})}initializeOriginalFields(item,url){return this.relationshipService.getRelatedItems(item).pipe((0,operators.s)(1)).subscribe(items=>{this.objectUpdatesService.initialize(url,items,item.lastModified)})}deleteRelationship(deleteRelationship){let copyVirtualMetadata;return copyVirtualMetadata=deleteRelationship.keepLeftVirtualMetadata&&deleteRelationship.keepRightVirtualMetadata?"all":deleteRelationship.keepLeftVirtualMetadata?"left":deleteRelationship.keepRightVirtualMetadata?"right":"none",this.relationshipService.deleteRelationship(deleteRelationship.uuid,copyVirtualMetadata,!1)}addRelationship(addRelationship){let leftItem,rightItem,leftwardValue,rightwardValue;return addRelationship.originalIsLeft?(leftItem=addRelationship.originalItem,rightItem=addRelationship.relatedItem,leftwardValue=null,rightwardValue=addRelationship.nameVariant):(leftItem=addRelationship.relatedItem,rightItem=addRelationship.originalItem,leftwardValue=addRelationship.nameVariant,rightwardValue=null),this.relationshipService.addRelationship(addRelationship.type.id,leftItem,rightItem,leftwardValue,rightwardValue,!1)}displayNotifications(responses){const failedResponses=responses.filter(response=>response.hasFailed),successfulResponses=responses.filter(response=>response.hasSucceeded);failedResponses.forEach(response=>{this.notificationsService.error(this.getNotificationTitle("failed"),response.errorMessage)}),successfulResponses.length>0&&this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved"))}isProvidedItemTypeLeftType(relationshipType,itemType,item){return this.getRelationshipLeftAndRightType(relationshipType).pipe((0,operators.Tj)(([leftType,rightType])=>leftType.id===itemType.id||rightType.id!==itemType.id&&void console.warn(`The item ${item.uuid} is not on the right or the left side of relationship type ${relationshipType.uuid}`)))}shouldDisplayBothRelationshipSides(relationshipType,itemType){return this.getRelationshipLeftAndRightType(relationshipType).pipe((0,operators.Tj)(([leftType,rightType])=>leftType.id===itemType.id&&rightType.id===itemType.id&&relationshipType.leftwardType!==relationshipType.rightwardType))}getRelationshipLeftAndRightType(relationshipType){const leftType$=relationshipType.leftType.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()),rightType$=relationshipType.rightType.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)());return(0,cjs.combineLatest)([leftType$,rightType$])}getNotificationTitle(key){return this.translateService.instant(this.notificationsPrefix+key+".title")}getNotificationContent(key){return this.translateService.instant(this.notificationsPrefix+key+".content")}static#_=this.\u0275fac=function(t){return new(t||EditItemRelationshipsService2)(core.KVO(item_data_service.ItemDataService),core.KVO(object_updates_service.F),core.KVO(notifications_service.I),core.KVO(ng_bootstrap.Bq),core.KVO(relationship_data_service.RelationshipDataService),core.KVO(entity_type_data_service.f),core.KVO(ngx_translate_core.c$))};static#_2=this.\u0275prov=core.jDH({token:EditItemRelationshipsService2,factory:EditItemRelationshipsService2.\u0275fac,providedIn:"root"})}return EditItemRelationshipsService2})();__webpack_require__(63158),__webpack_require__(34589);var app_config_interface=__webpack_require__(59945),request_param_model=__webpack_require__(57699),dynamic_lookup_relation_modal_component=__webpack_require__(44452),relationship_options_model=__webpack_require__(42733),selectable_list_service=__webpack_require__(1050),relation_query_utils=__webpack_require__(77457);function VirtualMetadataComponent_ng_container_8_div_1_div_6_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"div",16),core.EFF(2),core.k0s(),core.j41(3,"div"),core.EFF(4),core.k0s()()),2&rf){const metadata_r5=ctx.$implicit;core.R7$(2),core.SpI(" ",metadata_r5.metadataField," "),core.R7$(2),core.SpI(" ",metadata_r5.metadataValue.value," ")}}function VirtualMetadataComponent_ng_container_8_div_1_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",10),core.bIt("click",function(){const selected_r2=core.eBV(_r1).ngVar,itemDTO_r3=core.XpG().$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.setSelectedVirtualMetadataItem(itemDTO_r3.item,!selected_r2))}),core.j41(1,"div",11)(2,"label"),core.nrm(3,"input",12),core.k0s()(),core.j41(4,"div",13),core.nrm(5,"ds-listable-object-component-loader",14),core.DNE(6,VirtualMetadataComponent_ng_container_8_div_1_div_6_Template,5,2,"div",15),core.k0s()()}if(2&rf){const selected_r2=ctx.ngVar,itemDTO_r3=core.XpG().$implicit,ctx_r3=core.XpG();core.R7$(3),core.Y8G("checked",selected_r2),core.R7$(2),core.Y8G("object",itemDTO_r3.item),core.R7$(),core.Y8G("ngForOf",ctx_r3.virtualMetadata.get(itemDTO_r3.item.uuid))}}function VirtualMetadataComponent_ng_container_8_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,VirtualMetadataComponent_ng_container_8_div_1_Template,7,3,"div",9),core.nI1(2,"async"),core.bVm()),2&rf){const itemDTO_r3=ctx.$implicit;core.R7$(),core.Y8G("ngVar",core.bMT(2,1,itemDTO_r3.isSelectedVirtualMetadataItem$))}}let VirtualMetadataComponent=(()=>{class VirtualMetadataComponent2{constructor(objectUpdatesService,appConfig){this.objectUpdatesService=objectUpdatesService,this.appConfig=appConfig,this.close=new core.bkB,this.save=new core.bkB,this.itemDTOs$=new cjs.BehaviorSubject([]),this.subs=[],this.virtualMetadata=new Map,this.showThumbnails=this.appConfig.browseBy.showThumbnails}getVirtualMetadata(item){return Object.entries(item.metadata).map(([key,value])=>value.filter(metadata=>!key.startsWith("relation")&&metadata.authority&&metadata.authority.endsWith(this.relationshipId)).map(metadata=>({metadataField:key,metadataValue:metadata}))).reduce((previous,current)=>previous.concat(current),[])}setSelectedVirtualMetadataItem(item,selected){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.relationshipId,item.uuid,selected)}isSelectedVirtualMetadataItem(item){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationshipId,item.uuid)}trackItemDTO(index,itemDTO){return itemDTO?.item?.uuid}ngOnInit(){this.subs.push(this.itemDTOs$.subscribe(itemDTOs=>{itemDTOs.forEach(itemDTO=>this.virtualMetadata.set(itemDTO.item.uuid,this.getVirtualMetadata(itemDTO.item)))}))}ngOnChanges(){(0,empty_util.a4)(this.leftItem)&&(0,empty_util.a4)(this.rightItem)&&this.itemDTOs$.next([{item:this.leftItem,isSelectedVirtualMetadataItem$:this.isSelectedVirtualMetadataItem(this.leftItem)},{item:this.rightItem,isSelectedVirtualMetadataItem$:this.isSelectedVirtualMetadataItem(this.rightItem)}])}ngOnDestroy(){this.subs.forEach(sub=>sub.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||VirtualMetadataComponent2)(core.rXU(object_updates_service.F),core.rXU(app_config_interface.vQ))};static#_2=this.\u0275cmp=core.VBU({type:VirtualMetadataComponent2,selectors:[["ds-virtual-metadata"]],inputs:{url:"url",relationshipId:"relationshipId",leftItem:"leftItem",rightItem:"rightItem"},outputs:{close:"close",save:"save"},standalone:!0,features:[core.OA$,core.aNF],decls:15,vars:11,consts:[[3,"ngClass"],[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","flex-row-reverse","m-2"],[1,"btn","btn-primary","save",3,"click"],["aria-hidden","true",1,"fas","fa-save"],["class","item d-flex flex-row",3,"click",4,"ngVar"],[1,"item","d-flex","flex-row",3,"click"],[1,"m-2"],["type","checkbox",1,"select",3,"checked"],[1,"flex-column"],[3,"object"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1),core.EFF(2),core.nI1(3,"translate"),core.j41(4,"button",2),core.bIt("click",function(){return ctx.close.emit()}),core.j41(5,"span",3),core.EFF(6,"\xd7"),core.k0s()()(),core.j41(7,"div",4),core.DNE(8,VirtualMetadataComponent_ng_container_8_Template,3,3,"ng-container",5),core.nI1(9,"async"),core.j41(10,"div",6)(11,"button",7),core.bIt("click",function(){return ctx.save.emit()}),core.nrm(12,"i",8),core.EFF(13),core.nI1(14,"translate"),core.k0s()()()()),2&rf&&(core.Y8G("ngClass",ctx.showThumbnails?"hide-modal-thumbnail-column":""),core.R7$(2),core.SpI("",core.bMT(3,5,"virtual-metadata.delete-relationship.modal-head")," "),core.R7$(6),core.Y8G("ngForOf",core.bMT(9,7,ctx.itemDTOs$))("ngForTrackBy",ctx.trackItemDTO),core.R7$(5),core.SpI(" ",core.bMT(14,9,"item.edit.metadata.save-button")," "))},dependencies:[common.YU,ngx_translate_core.h,ngx_translate_core.D9,common.Sq,var_directive.r,common.Jj,listable_object_component_loader_component.v],encapsulation:2})}return VirtualMetadataComponent2})();function EditRelationshipComponent_div_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",2)(1,"div",3),core.nrm(2,"ds-listable-object-component-loader",4),core.nI1(3,"async"),core.k0s(),core.j41(4,"div",5)(5,"div",6)(6,"button",7),core.nI1(7,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG(),virtualMetadataModal_r3=core.sdS(3);return core.Njj(ctx_r1.openVirtualMetadataModal(virtualMetadataModal_r3))}),core.nrm(8,"i",8),core.k0s(),core.j41(9,"button",9),core.nI1(10,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.undo())}),core.nrm(11,"i",10),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.Y8G("object",core.bMT(3,7,ctx_r1.relatedItem$))("viewMode",ctx_r1.viewMode)("value",ctx_r1.nameVariant),core.R7$(4),core.FS9("title",core.bMT(7,9,"item.edit.metadata.edit.buttons.remove")),core.Y8G("disabled",!ctx_r1.canRemove()),core.R7$(3),core.FS9("title",core.bMT(10,11,"item.edit.metadata.edit.buttons.undo")),core.Y8G("disabled",!ctx_r1.canUndo())}}function EditRelationshipComponent_ng_template_2_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"ds-virtual-metadata",11),core.nI1(1,"async"),core.nI1(2,"async"),core.bIt("close",function(){core.eBV(_r4);const ctx_r1=core.XpG();return core.Njj(ctx_r1.closeVirtualMetadataModal())})("save",function(){core.eBV(_r4);const ctx_r1=core.XpG();return core.Njj(ctx_r1.remove())}),core.k0s()}if(2&rf){const ctx_r1=core.XpG();core.Y8G("relationshipId",ctx_r1.relationship.id)("leftItem",core.bMT(1,4,ctx_r1.leftItem$))("rightItem",core.bMT(2,6,ctx_r1.rightItem$))("url",ctx_r1.url)}}let EditRelationshipComponent=(()=>{class EditRelationshipComponent2{get relationship(){return this.update.relationship}get update(){return this.fieldUpdate.field}get nameVariant(){return this.update.nameVariant}constructor(objectUpdatesService,modalService){this.objectUpdatesService=objectUpdatesService,this.modalService=modalService,this.relatedItem$=new cjs.BehaviorSubject(null),this.viewMode=view_mode_model.n.ListElement}ngOnChanges(){this.relationship&&(this.relationship.leftItem||this.relationship.rightItem)?(this.leftItem$=this.relationship.leftItem.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(item=>(0,empty_util.a4)(item)&&(0,empty_util.hj)(item.uuid))),this.rightItem$=this.relationship.rightItem.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(item=>(0,empty_util.a4)(item)&&(0,empty_util.hj)(item.uuid))),(0,cjs.combineLatest)([this.leftItem$,this.rightItem$]).pipe((0,operators.Tj)(([leftItem,rightItem])=>leftItem.uuid===this.editItem.uuid?rightItem:leftItem),(0,operators.s)(1)).subscribe(relatedItem=>{this.relatedItem$.next(relatedItem)})):this.relatedItem$.next(this.update.relatedItem)}remove(){this.closeVirtualMetadataModal(),(0,cjs.combineLatest)([this.leftItem$,this.rightItem$]).pipe((0,operators.Tj)(items=>items.map(item=>this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationship.id,item.uuid))),(0,operators.nx)(selection$=>(0,cjs.combineLatest)(selection$)),(0,operators.Tj)(selection=>Object.assign({},this.fieldUpdate.field,{keepLeftVirtualMetadata:!0===selection[0],keepRightVirtualMetadata:!0===selection[1]})),(0,operators.s)(1)).subscribe(deleteRelationship=>{this.objectUpdatesService.saveRemoveFieldUpdate(this.url,deleteRelationship)})}openVirtualMetadataModal(content){this.modalRef=this.modalService.open(content)}closeVirtualMetadataModal(){this.modalRef.close()}undo(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.fieldUpdate.field.uuid)}canRemove(){return this.fieldUpdate.changeType!==field_change_type_model.B.REMOVE&&this.fieldUpdate.changeType!==field_change_type_model.B.ADD}canUndo(){return this.fieldUpdate.changeType?.valueOf()>=0}static#_=this.\u0275fac=function(t){return new(t||EditRelationshipComponent2)(core.rXU(object_updates_service.F),core.rXU(ng_bootstrap.Bq))};static#_2=this.\u0275cmp=core.VBU({type:EditRelationshipComponent2,selectors:[["ds-edit-relationship"]],inputs:{fieldUpdate:"fieldUpdate",url:"url",editItem:"editItem"},standalone:!0,features:[core.OA$,core.aNF],decls:4,vars:3,consts:[["virtualMetadataModal",""],["class","row",4,"ngIf"],[1,"row"],[1,"col-10","relationship"],[3,"object","viewMode","value"],[1,"col-2"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-danger","btn-sm",3,"click","disabled","title"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"click","disabled","title"],[1,"fas","fa-undo-alt","fa-fw"],[3,"close","save","relationshipId","leftItem","rightItem","url"]],template:function(rf,ctx){1&rf&&(core.DNE(0,EditRelationshipComponent_div_0_Template,12,13,"div",1),core.nI1(1,"async"),core.DNE(2,EditRelationshipComponent_ng_template_2_Template,3,8,"ng-template",null,0,core.C5r)),2&rf&&core.Y8G("ngIf",core.bMT(1,1,ctx.relatedItem$))},dependencies:[listable_object_component_loader_component.v,common.Jj,common.bT,ngx_translate_core.h,ngx_translate_core.D9,VirtualMetadataComponent],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.relationship-action-buttons[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]})}return EditRelationshipComponent2})();const edit_relationship_list_component_c0=()=>({}),edit_relationship_list_component_c1=(a0,a1,a2)=>({"alert-success":a0,"alert-warning":a1,"alert-danger":a2});function EditRelationshipListComponent_ng_container_10_ng_container_1_ng_container_1_ds_edit_relationship_5_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-edit-relationship",9),2&rf){const updateValue_r1=ctx.$implicit,ctx_r1=core.XpG(4);core.Y8G("fieldUpdate",updateValue_r1||core.lJ4(4,edit_relationship_list_component_c0))("url",ctx_r1.url)("editItem",ctx_r1.item)("ngClass",core.sMw(5,edit_relationship_list_component_c1,1===updateValue_r1.changeType,0===updateValue_r1.changeType,2===updateValue_r1.changeType))}}function EditRelationshipListComponent_ng_container_10_ng_container_1_ng_container_1_div_6_Template(rf,ctx){1&rf&&(core.j41(0,"div"),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.JRh(core.bMT(2,1,"item.edit.relationships.no-relationships")))}function EditRelationshipListComponent_ng_container_10_ng_container_1_ng_container_1_Template(rf,ctx){if(1&rf&&(core.qex(0),core.j41(1,"ds-pagination",6),core.nI1(2,"async"),core.nI1(3,"async"),core.j41(4,"div",7),core.DNE(5,EditRelationshipListComponent_ng_container_10_ng_container_1_ng_container_1_ds_edit_relationship_5_Template,1,9,"ds-edit-relationship",8),core.k0s()(),core.DNE(6,EditRelationshipListComponent_ng_container_10_ng_container_1_ng_container_1_div_6_Template,3,3,"div",5),core.bVm()),2&rf){let tmp_6_0;const updateValues_r3=ctx.ngVar,ctx_r1=core.XpG(3);core.R7$(),core.Y8G("paginationOptions",ctx_r1.paginationConfig)("collectionSize",(null==(tmp_6_0=core.bMT(2,7,ctx_r1.relationshipsRd$))||null==tmp_6_0.payload?null:tmp_6_0.payload.totalElements)+core.bMT(3,9,ctx_r1.nbAddedFields$))("hideGear",!0)("hidePagerWhenSinglePage",!0),core.R7$(4),core.Y8G("ngForOf",updateValues_r3)("ngForTrackBy",ctx_r1.trackUpdate),core.R7$(),core.Y8G("ngIf",0===updateValues_r3.length)}}function EditRelationshipListComponent_ng_container_10_ng_container_1_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,EditRelationshipListComponent_ng_container_10_ng_container_1_ng_container_1_Template,7,11,"ng-container",4),core.nI1(2,"dsObjectValues"),core.bVm()),2&rf){const updates_r4=core.XpG().ngVar;core.R7$(),core.Y8G("ngVar",core.bMT(2,1,updates_r4))}}function EditRelationshipListComponent_ng_container_10_ds_loading_3_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}function EditRelationshipListComponent_ng_container_10_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,EditRelationshipListComponent_ng_container_10_ng_container_1_Template,3,3,"ng-container",5),core.nI1(2,"async"),core.DNE(3,EditRelationshipListComponent_ng_container_10_ds_loading_3_Template,1,0,"ds-loading",5),core.nI1(4,"async"),core.bVm()),2&rf){const updates_r4=ctx.ngVar,ctx_r1=core.XpG();core.R7$(),core.Y8G("ngIf",updates_r4&&!0!==core.bMT(2,2,ctx_r1.loading$)),core.R7$(2),core.Y8G("ngIf",core.bMT(4,4,ctx_r1.loading$))}}let EditRelationshipListComponent=(()=>{class EditRelationshipListComponent2{constructor(objectUpdatesService,linkService,relationshipService,modalService,paginationService,selectableListService,editItemRelationshipsService,appConfig){this.objectUpdatesService=objectUpdatesService,this.linkService=linkService,this.relationshipService=relationshipService,this.modalService=modalService,this.paginationService=paginationService,this.selectableListService=selectableListService,this.editItemRelationshipsService=editItemRelationshipsService,this.appConfig=appConfig,this.submitModal=new core.bkB,this.currentItemIsLeftItem$=new cjs.BehaviorSubject(void 0),this.updates$=new cjs.BehaviorSubject(void 0),this.relationshipsRd$=new cjs.BehaviorSubject(void 0),this.isLastPage$=new cjs.BehaviorSubject(!0),this.loading$=new cjs.BehaviorSubject(!0),this.nbAddedFields$=new cjs.BehaviorSubject(0),this.subs=[],this.fetchThumbnail=this.appConfig.browseBy.showThumbnails}getRelationshipMessageKey(){return(0,cjs.combineLatest)([this.getLabel(),this.relatedEntityType$]).pipe((0,operators.Tj)(([label,relatedEntityType])=>{if((0,empty_util.a4)(label)&&label.indexOf("is")>-1&&label.indexOf("Of")>-1){const relationshipLabel=`${label.substring(2,label.indexOf("Of"))}`;return relationshipLabel!==relatedEntityType.label?`relationships.is${relationshipLabel}Of.${relatedEntityType.label}`:`relationships.is${relationshipLabel}Of`}return label}))}getLabel(){return this.currentItemIsLeftItem$.pipe((0,operators.Tj)(currentItemIsLeftItem=>currentItemIsLeftItem?this.relationshipType.leftwardType:this.relationshipType.rightwardType))}trackUpdate(index,update){return update&&update.field?update.field.uuid:void 0}openLookup(){this.modalRef=this.modalService.open(dynamic_lookup_relation_modal_component.d,{size:"lg"});const modalComp=this.modalRef.componentInstance;modalComp.repeatable=!0,modalComp.isEditRelationship=!0,modalComp.listId=this.listId,modalComp.item=this.item,modalComp.relationshipType=this.relationshipType,modalComp.currentItemIsLeftItem$=this.currentItemIsLeftItem$,modalComp.toAdd=[],modalComp.toRemove=[],modalComp.isPending=!1,modalComp.hiddenQuery="-search.resourceid:"+this.item.uuid,this.item.owningCollection.pipe((0,shared_operators.ak)()).subscribe(collection=>{modalComp.collection=collection}),modalComp.select=(...selectableObjects)=>{selectableObjects.forEach(searchResult=>{const relatedItem=searchResult.indexableObject,foundIndex=modalComp.toRemove.findIndex(itemSearchResult=>itemSearchResult.indexableObject.uuid===relatedItem.uuid);-1!==foundIndex?modalComp.toRemove.splice(foundIndex,1):this.getRelationFromId(relatedItem).subscribe(relationship=>{if(relationship){const foundIndexRemove=modalComp.toRemove.findIndex(el=>el.indexableObject.uuid===relatedItem.uuid);-1!==foundIndexRemove&&modalComp.toRemove.splice(foundIndexRemove,1)}else modalComp.toAdd.push(searchResult);this.loading$.next((0,empty_util.hj)(modalComp.toAdd)||(0,empty_util.hj)(modalComp.toRemove)),this.relationshipsRd$.next(this.relationshipsRd$.getValue())})})},modalComp.deselect=(...selectableObjects)=>{selectableObjects.forEach(searchResult=>{const relatedItem=searchResult.indexableObject,foundIndex=modalComp.toAdd.findIndex(el=>el.indexableObject.uuid===relatedItem.uuid);-1!==foundIndex?modalComp.toAdd.splice(foundIndex,1):modalComp.toRemove.push(searchResult),this.loading$.next((0,empty_util.hj)(modalComp.toAdd)||(0,empty_util.hj)(modalComp.toRemove))})},modalComp.submitEv=()=>{modalComp.isPending=!0;const isLeft=this.currentItemIsLeftItem$.getValue(),addOperations=modalComp.toAdd.map(searchResult=>({type:"add",searchResult})),removeOperations=modalComp.toRemove.map(searchResult=>({type:"remove",searchResult}));(0,cjs.from)([...addOperations,...removeOperations]).pipe((0,operators.Hh)(({type,searchResult})=>{const relatedItem=searchResult.indexableObject;return"add"===type?this.relationshipService.getNameVariant(this.listId,relatedItem.uuid).pipe((0,operators.nx)(nameVariant=>this.objectUpdatesService.saveAddFieldUpdate(this.url,{uuid:`${this.relationshipType.id}-${relatedItem.uuid}`,nameVariant,type:this.relationshipType,originalIsLeft:isLeft,originalItem:this.item,relatedItem})),(0,operators.s)(1)):"remove"===type?this.relationshipService.getNameVariant(this.listId,relatedItem.uuid).pipe((0,operators.nx)(nameVariant=>this.getRelationFromId(searchResult.indexableObject).pipe((0,operators.Tj)(relationship=>this.objectUpdatesService.saveRemoveFieldUpdate(this.url,{uuid:relationship.id,nameVariant,type:this.relationshipType,originalIsLeft:isLeft,originalItem:this.item,relatedItem,relationship})))),(0,operators.s)(1)):cjs.EMPTY}),(0,operators.$r)()).subscribe({complete:()=>{this.editItemRelationshipsService.submit(this.item,this.url),this.submitModal.emit()}})},modalComp.discardEv=()=>{modalComp.toAdd.forEach(searchResult=>{this.selectableListService.deselectSingle(this.listId,searchResult)}),modalComp.toRemove.forEach(searchResult=>{this.selectableListService.selectSingle(this.listId,searchResult)}),modalComp.toAdd=[],modalComp.toRemove=[],this.loading$.next(!1)},modalComp.closeEv=()=>{this.loading$.next(!1)},this.relatedEntityType$.pipe((0,operators.s)(1)).subscribe(relatedEntityType=>{modalComp.relationshipOptions=Object.assign(new relationship_options_model.j,{relationshipType:relatedEntityType.label,searchConfiguration:relatedEntityType.label.toLowerCase(),nameVariants:"true"})}),this.selectableListService.deselectAll(this.listId)}getRelationFromId(relatedItem){const relationshipLabel=this.currentItemIsLeftItem$.getValue()?this.relationshipType.leftwardType:this.relationshipType.rightwardType;return this.relationshipService.searchByItemsAndType(this.relationshipType.id,this.item.uuid,relationshipLabel,[relatedItem.id]).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.Tj)(res=>res.page[0]))}ngOnInit(){this.relationshipLeftAndRightType$=(0,cjs.combineLatest)([this.relationshipType.leftType,this.relationshipType.rightType].map(type=>type.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()))),this.relatedEntityType$=this.relationshipLeftAndRightType$.pipe((0,operators.Tj)(([leftType,rightType])=>leftType.uuid!==this.itemType.uuid?leftType:rightType),(0,empty_util.Az)()),this.relatedEntityType$.pipe((0,operators.s)(1)).subscribe(relatedEntityType=>this.listId=`edit-relationship-${this.itemType.id}-${relatedEntityType.id}`),this.relationshipMessageKey$=this.getRelationshipMessageKey(),this.paginationConfig=new pagination_component_options_model.W,this.paginationConfig.id=`er${this.relationshipType.id}`,this.paginationConfig.pageSize=5,this.paginationConfig.currentPage=1;const currentPagination$=this.paginationService.getCurrentPagination(this.paginationConfig.id,this.paginationConfig).pipe((0,operators.Mi)(()=>this.loading$.next(!0))),linksToFollow=(0,relation_query_utils.nW)(this.fetchThumbnail);this.subs.push((0,cjs.combineLatest)([currentPagination$,this.currentItemIsLeftItem$,this.relatedEntityType$]).pipe((0,operators.nx)(([currentPagination,currentItemIsLeftItem,relatedEntityType])=>this.relationshipService.getItemRelationshipsByLabel(this.item,currentItemIsLeftItem?this.relationshipType.leftwardType:this.relationshipType.rightwardType,{elementsPerPage:currentPagination.pageSize,currentPage:currentPagination.currentPage,searchParams:[new request_param_model.x("relatedEntityType",relatedEntityType.label)]},!0,!0,...linksToFollow)),(0,operators.Mi)(rd=>{this.relationshipsRd$.next(rd)}),(0,shared_operators.v7)(),(0,shared_operators.Bo)()).subscribe(relationshipPaginatedList=>{this.objectUpdatesService.initialize(this.url,relationshipPaginatedList.page,new Date)})),this.subs.push(this.relationshipsRd$.pipe((0,empty_util.Az)(),(0,shared_operators.v7)()).subscribe(rd=>{this.isLastPage$.next((0,empty_util.Tn)(rd.payload._links.next))})),this.subs.push(this.relationshipsRd$.pipe((0,empty_util.Az)(),(0,shared_operators.v7)(),(0,operators.nx)(rd=>(0,cjs.from)(rd.payload.page).pipe((0,operators.ZZ)(relationship=>this.relationshipService.isLeftItem(relationship,this.item).pipe((0,operators.nx)(isLeftItem=>isLeftItem?relationship.rightItem.pipe((0,shared_operators.qD)(),(0,shared_operators.Bo)(),(0,operators.Tj)(relatedItem=>[relationship,isLeftItem,relatedItem])):relationship.leftItem.pipe((0,shared_operators.qD)(),(0,shared_operators.Bo)(),(0,operators.Tj)(relatedItem=>[relationship,isLeftItem,relatedItem]))))),(0,operators.Tj)(([relationship,isLeftItem,relatedItem])=>({uuid:relationship.id,type:this.relationshipType,relationship,originalIsLeft:isLeftItem,originalItem:this.item,relatedItem,nameVariant:isLeftItem?relationship.rightwardValue:relationship.leftwardValue})),(0,operators.$r)(),(0,operators.US)([]))),(0,operators.nx)(nextFields=>this.objectUpdatesService.getFieldUpdates(this.url,nextFields).pipe((0,operators.Tj)(fieldUpdates=>{const fieldUpdatesFiltered={};return this.nbAddedFields$.next(0),Object.keys(fieldUpdates).forEach(uuid=>{(0,empty_util.a4)(fieldUpdates[uuid])&&fieldUpdates[uuid].field.type.id===this.relationshipType.id&&(fieldUpdates[uuid].changeType===field_change_type_model.B.ADD?(this.nbAddedFields$.next(this.nbAddedFields$.getValue()+1),!0===this.isLastPage$.getValue()&&(fieldUpdatesFiltered[uuid]=fieldUpdates[uuid])):fieldUpdatesFiltered[uuid]=fieldUpdates[uuid])}),fieldUpdatesFiltered}))),(0,operators.ql)({})).subscribe(updates=>{this.loading$.next(!1),this.updates$.next(updates)}))}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||EditRelationshipListComponent2)(core.rXU(object_updates_service.F),core.rXU(link_service._),core.rXU(relationship_data_service.RelationshipDataService),core.rXU(ng_bootstrap.Bq),core.rXU(pagination_service.m),core.rXU(selectable_list_service.K),core.rXU(EditItemRelationshipsService),core.rXU(app_config_interface.vQ))};static#_2=this.\u0275cmp=core.VBU({type:EditRelationshipListComponent2,selectors:[["ds-edit-relationship-list"]],inputs:{item:"item",itemType:"itemType",url:"url",relationshipType:"relationshipType",hasChanges:"hasChanges",currentItemIsLeftItem$:"currentItemIsLeftItem$"},outputs:{submitModal:"submitModal"},standalone:!0,features:[core.aNF],decls:12,vars:14,consts:[[1,"h4"],[1,"ml-2","btn","btn-success",3,"click","disabled"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[4,"ngVar"],[4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"my-2"],["class","relationship-row d-block alert",3,"fieldUpdate","url","editItem","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"relationship-row","d-block","alert",3,"fieldUpdate","url","editItem","ngClass"]],template:function(rf,ctx){1&rf&&(core.j41(0,"h2",0),core.EFF(1),core.nI1(2,"async"),core.nI1(3,"translate"),core.j41(4,"button",1),core.nI1(5,"async"),core.bIt("click",function(){return ctx.openLookup()}),core.nrm(6,"i",2),core.j41(7,"span",3),core.EFF(8),core.nI1(9,"translate"),core.k0s()()(),core.DNE(10,EditRelationshipListComponent_ng_container_10_Template,5,6,"ng-container",4),core.nI1(11,"async")),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(3,6,core.bMT(2,4,ctx.relationshipMessageKey$))," "),core.R7$(3),core.Y8G("disabled",core.bMT(5,8,ctx.hasChanges)),core.R7$(4),core.SpI("\xa0",core.bMT(9,10,"item.edit.relationships.edit.buttons.add"),""),core.R7$(2),core.Y8G("ngVar",core.bMT(11,12,ctx.updates$)))},dependencies:[EditRelationshipComponent,pagination_component.e,common.Jj,ObjectValuesPipe,var_directive.r,common.bT,common.pM,ngx_translate_core.h,ngx_translate_core.D9,common.YU,themed_loading_component.v],styles:[".relationship-row[_ngcontent-%COMP%]:not(.alert){padding:var(--bs-alert-padding-y) 0}.relationship-row.alert[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-alert-padding-x));margin-right:calc(-1 * var(--bs-alert-padding-x));margin-top:-1px;margin-bottom:-1px}"]})}return EditRelationshipListComponent2})();function EditRelationshipListWrapperComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(core.qex(0),core.nrm(1,"ds-edit-relationship-list",1)(2,"ds-edit-relationship-list",2),core.bVm()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("url",ctx_r0.url)("item",ctx_r0.item)("itemType",ctx_r0.itemType)("relationshipType",ctx_r0.relationshipType)("hasChanges",ctx_r0.hasChanges)("currentItemIsLeftItem$",ctx_r0.isLeftItem$),core.R7$(),core.Y8G("url",ctx_r0.url)("item",ctx_r0.item)("itemType",ctx_r0.itemType)("relationshipType",ctx_r0.relationshipType)("hasChanges",ctx_r0.hasChanges)("currentItemIsLeftItem$",ctx_r0.isRightItem$)}}function EditRelationshipListWrapperComponent_ng_container_2_Template(rf,ctx){if(1&rf&&(core.qex(0),core.nrm(1,"ds-edit-relationship-list",2),core.bVm()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("url",ctx_r0.url)("item",ctx_r0.item)("itemType",ctx_r0.itemType)("relationshipType",ctx_r0.relationshipType)("hasChanges",ctx_r0.hasChanges)("currentItemIsLeftItem$",ctx_r0.currentItemIsLeftItem$)}}let EditRelationshipListWrapperComponent=(()=>{class EditRelationshipListWrapperComponent2{constructor(editItemRelationshipsService){this.editItemRelationshipsService=editItemRelationshipsService,this.submitModal=new core.bkB,this.currentItemIsLeftItem$=new cjs.BehaviorSubject(void 0),this.isLeftItem$=new cjs.BehaviorSubject(!0),this.isRightItem$=new cjs.BehaviorSubject(!1),this.subs=[]}ngOnInit(){this.subs.push(this.editItemRelationshipsService.isProvidedItemTypeLeftType(this.relationshipType,this.itemType,this.item).subscribe(nextValue=>{this.currentItemIsLeftItem$.next(nextValue)})),this.shouldDisplayBothRelationshipSides$=this.editItemRelationshipsService.shouldDisplayBothRelationshipSides(this.relationshipType,this.itemType)}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||EditRelationshipListWrapperComponent2)(core.rXU(EditItemRelationshipsService))};static#_2=this.\u0275cmp=core.VBU({type:EditRelationshipListWrapperComponent2,selectors:[["ds-edit-relationship-list-wrapper"]],inputs:{item:"item",itemType:"itemType",url:"url",relationshipType:"relationshipType",hasChanges:"hasChanges"},outputs:{submitModal:"submitModal"},standalone:!0,features:[core.aNF],decls:4,vars:6,consts:[[4,"ngIf"],[1,"d-block","mb-4",3,"url","item","itemType","relationshipType","hasChanges","currentItemIsLeftItem$"],[3,"url","item","itemType","relationshipType","hasChanges","currentItemIsLeftItem$"]],template:function(rf,ctx){1&rf&&(core.DNE(0,EditRelationshipListWrapperComponent_ng_container_0_Template,3,12,"ng-container",0),core.nI1(1,"async"),core.DNE(2,EditRelationshipListWrapperComponent_ng_container_2_Template,2,6,"ng-container",0),core.nI1(3,"async")),2&rf&&(core.Y8G("ngIf",core.bMT(1,2,ctx.shouldDisplayBothRelationshipSides$)),core.R7$(2),core.Y8G("ngIf",!1===core.bMT(3,4,ctx.shouldDisplayBothRelationshipSides$)))},dependencies:[common.Jj,EditRelationshipListComponent,common.bT]})}return EditRelationshipListWrapperComponent2})();function ItemRelationshipsComponent_ng_container_1_ng_container_2_Template(rf,ctx){1&rf&&core.eu8(0)}function ItemRelationshipsComponent_ng_container_1_div_3_div_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",10),core.nrm(1,"ds-edit-relationship-list-wrapper",12),core.k0s()),2&rf){const relationshipType_r1=ctx.$implicit,entityType_r2=core.XpG(2).ngIf,ctx_r2=core.XpG();core.R7$(),core.Y8G("url",ctx_r2.url)("item",ctx_r2.item)("itemType",entityType_r2)("relationshipType",relationshipType_r1)("hasChanges",ctx_r2.hasChanges$)}}function ItemRelationshipsComponent_ng_container_1_div_3_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",10),core.DNE(1,ItemRelationshipsComponent_ng_container_1_div_3_div_1_Template,2,5,"div",11),core.k0s()),2&rf){const relationshipTypes_r4=ctx.ngIf,ctx_r2=core.XpG(2);core.R7$(),core.Y8G("ngForOf",relationshipTypes_r4)("ngForTrackBy",ctx_r2.trackById)}}function ItemRelationshipsComponent_ng_container_1_ng_container_7_Template(rf,ctx){1&rf&&core.eu8(0)}function ItemRelationshipsComponent_ng_container_1_Template(rf,ctx){if(1&rf&&(core.qex(0),core.j41(1,"div",5),core.DNE(2,ItemRelationshipsComponent_ng_container_1_ng_container_2_Template,1,0,"ng-container",6),core.k0s(),core.DNE(3,ItemRelationshipsComponent_ng_container_1_div_3_Template,2,2,"div",7),core.nI1(4,"async"),core.j41(5,"div",8)(6,"div",9),core.DNE(7,ItemRelationshipsComponent_ng_container_1_ng_container_7_Template,1,0,"ng-container",6),core.k0s()(),core.bVm()),2&rf){const ctx_r2=core.XpG(),loading_r5=core.sdS(6),buttons_r6=core.sdS(8);core.R7$(2),core.Y8G("ngTemplateOutlet",buttons_r6),core.R7$(),core.Y8G("ngIf",core.bMT(4,4,ctx_r2.relationshipTypes$))("ngIfElse",loading_r5),core.R7$(4),core.Y8G("ngTemplateOutlet",buttons_r6)}}function ItemRelationshipsComponent_ng_template_3_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-alert",13),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const ctx_r2=core.XpG();core.Y8G("type",ctx_r2.AlertType.Info),core.R7$(),core.SpI(" ",core.bMT(2,2,"item.edit.relationships.no-entity-type")," ")}}function ItemRelationshipsComponent_ng_template_5_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}function ItemRelationshipsComponent_ng_template_7_button_1_Template(rf,ctx){if(1&rf){const _r8=core.RV6();core.j41(0,"button",21),core.nI1(1,"async"),core.bIt("click",function(){core.eBV(_r8);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.discard())}),core.nrm(2,"i",22),core.j41(3,"span",20),core.EFF(4),core.nI1(5,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG(2);core.Y8G("disabled",!0!==core.bMT(1,2,ctx_r2.hasChanges$)),core.R7$(4),core.SpI("\xa0",core.bMT(5,4,"item.edit.metadata.discard-button"),"")}}function ItemRelationshipsComponent_ng_template_7_button_3_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"button",23),core.bIt("click",function(){core.eBV(_r9);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.reinstate())}),core.nrm(1,"i",24),core.j41(2,"span",20),core.EFF(3),core.nI1(4,"translate"),core.k0s()()}2&rf&&(core.R7$(3),core.SpI("\xa0",core.bMT(4,1,"item.edit.metadata.reinstate-button"),""))}function ItemRelationshipsComponent_ng_template_7_span_8_Template(rf,ctx){1&rf&&core.nrm(0,"span",25)}function ItemRelationshipsComponent_ng_template_7_i_10_Template(rf,ctx){1&rf&&core.nrm(0,"i",26)}function ItemRelationshipsComponent_ng_template_7_Template(rf,ctx){if(1&rf){const _r7=core.RV6();core.j41(0,"div",14),core.DNE(1,ItemRelationshipsComponent_ng_template_7_button_1_Template,6,6,"button",15),core.nI1(2,"async"),core.DNE(3,ItemRelationshipsComponent_ng_template_7_button_3_Template,5,3,"button",16),core.nI1(4,"async"),core.j41(5,"button",17),core.nI1(6,"async"),core.nI1(7,"async"),core.bIt("click",function(){core.eBV(_r7);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.DNE(8,ItemRelationshipsComponent_ng_template_7_span_8_Template,1,0,"span",18),core.nI1(9,"async"),core.DNE(10,ItemRelationshipsComponent_ng_template_7_i_10_Template,1,0,"i",19),core.nI1(11,"async"),core.j41(12,"span",20),core.EFF(13),core.nI1(14,"translate"),core.k0s()()()}if(2&rf){const ctx_r2=core.XpG();core.R7$(),core.Y8G("ngIf",!0!==core.bMT(2,6,ctx_r2.isReinstatable$)),core.R7$(2),core.Y8G("ngIf",core.bMT(4,8,ctx_r2.isReinstatable$)),core.R7$(2),core.Y8G("disabled",!0!==core.bMT(6,10,ctx_r2.hasChanges$)||!0===core.bMT(7,12,ctx_r2.isSaving$)),core.R7$(3),core.Y8G("ngIf",core.bMT(9,14,ctx_r2.isSaving$)),core.R7$(2),core.Y8G("ngIf",!0!==core.bMT(11,16,ctx_r2.isSaving$)),core.R7$(3),core.SpI("\xa0",core.bMT(14,18,"item.edit.metadata.save-button"),"")}}let ItemRelationshipsComponent=(()=>{class ItemRelationshipsComponent2 extends AbstractItemUpdateComponent{get isSaving$(){return this.editItemRelationshipsService.isSaving$}constructor(itemService,objectUpdatesService,router2,notificationsService,translateService,route,relationshipService,objectCache,requestService,entityTypeService,relationshipTypeService,cdr,modalService,editItemRelationshipsService){super(itemService,objectUpdatesService,router2,notificationsService,translateService,route),this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.router=router2,this.notificationsService=notificationsService,this.translateService=translateService,this.route=route,this.relationshipService=relationshipService,this.objectCache=objectCache,this.requestService=requestService,this.entityTypeService=entityTypeService,this.relationshipTypeService=relationshipTypeService,this.cdr=cdr,this.modalService=modalService,this.editItemRelationshipsService=editItemRelationshipsService,this.entityType$=new cjs.BehaviorSubject(void 0),this.AlertType=alert_type.v}initializeUpdates(){const label=this.item.firstMetadataValue("dspace.entity.type");void 0!==label?(this.relationshipTypes$=this.relationshipTypeService.searchByEntityType(label,!0,!0,...this.getRelationshipTypeFollowLinks()).pipe((0,operators.Tj)(relationshipTypes=>relationshipTypes.page),(0,operators.F)((0,item_relationships_utils.W2)())),this.entityTypeService.getEntityTypeByLabel(label).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(type=>this.entityType$.next(type))):this.entityType$.next(void 0)}initializeNotificationsPrefix(){this.notificationsPrefix="item.edit.relationships.notifications."}submit(){this.editItemRelationshipsService.submit(this.item,this.url)}initializeOriginalFields(){return this.editItemRelationshipsService.initializeOriginalFields(this.item,this.url)}trackById(index,relationshipType){return relationshipType.id}getRelationshipTypeFollowLinks(){return[(0,follow_link_config_model.s)("leftType"),(0,follow_link_config_model.s)("rightType")]}static#_=this.\u0275fac=function(t){return new(t||ItemRelationshipsComponent2)(core.rXU(item_data_service.ItemDataService),core.rXU(object_updates_service.F),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.nX),core.rXU(relationship_data_service.RelationshipDataService),core.rXU(object_cache_service.$),core.rXU(request_service.B),core.rXU(entity_type_data_service.f),core.rXU(relationship_type_data_service.RelationshipTypeDataService),core.rXU(core.gRc),core.rXU(ng_bootstrap.Bq),core.rXU(EditItemRelationshipsService))};static#_2=this.\u0275cmp=core.VBU({type:ItemRelationshipsComponent2,selectors:[["ds-item-relationships"]],standalone:!0,features:[core.Vt3,core.aNF],decls:9,vars:4,consts:[["noEntityType",""],["loading",""],["buttons",""],[1,"item-relationships"],[4,"ngIf","ngIfElse"],[1,"button-row","top","d-flex","justify-content-end"],[4,"ngTemplateOutlet"],["class","mb-4",4,"ngIf","ngIfElse"],[1,"button-row","bottom"],[1,"float-right","ml-gap"],[1,"mb-4"],["class","mb-4",4,"ngFor","ngForOf","ngForTrackBy"],[3,"url","item","itemType","relationshipType","hasChanges"],[1,"d-block","mt-2",3,"type"],[1,"d-flex","space-children-mr","justify-content-end"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"click","disabled"],["aria-hidden","true","class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["aria-hidden","true","class","fas fa-save",4,"ngIf"],[1,"d-none","d-sm-inline"],[1,"btn","btn-danger",3,"click","disabled"],["aria-hidden","true",1,"fas","fa-times"],[1,"btn","btn-warning",3,"click"],["aria-hidden","true",1,"fas","fa-undo-alt"],["aria-hidden","true","role","status",1,"spinner-border","spinner-border-sm"],["aria-hidden","true",1,"fas","fa-save"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",3),core.DNE(1,ItemRelationshipsComponent_ng_container_1_Template,8,6,"ng-container",4),core.nI1(2,"async"),core.k0s(),core.DNE(3,ItemRelationshipsComponent_ng_template_3_Template,3,4,"ng-template",null,0,core.C5r)(5,ItemRelationshipsComponent_ng_template_5_Template,1,0,"ng-template",null,1,core.C5r)(7,ItemRelationshipsComponent_ng_template_7_Template,15,20,"ng-template",null,2,core.C5r)),2&rf){const noEntityType_r10=core.sdS(4);core.R7$(),core.Y8G("ngIf",core.bMT(2,2,ctx.entityType$))("ngIfElse",noEntityType_r10)}},dependencies:[alert_component.C,common.Jj,common.Sq,common.bT,common.T3,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9,EditRelationshipListWrapperComponent],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:var(--ds-gap)}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width: 576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]})}return ItemRelationshipsComponent2})();var themed_component=__webpack_require__(31260);__webpack_require__(46532);const themed_item_status_component_c0=["*"];function ThemedItemStatusComponent_ng_template_0_Template(rf,ctx){}let ThemedItemStatusComponent=(()=>{class ThemedItemStatusComponent2 extends themed_component.J{getComponentName(){return"ItemStatusComponent"}importThemedComponent(themeName){return __webpack_require__(52529)(`./${themeName}/app/item-page/edit-item-page/item-status/item-status.component`)}importUnthemedComponent(){return Promise.resolve().then(__webpack_require__.bind(__webpack_require__,46532))}static#_=this.\u0275fac=(()=>{let \u0275ThemedItemStatusComponent_BaseFactory;return function(t){return(\u0275ThemedItemStatusComponent_BaseFactory||(\u0275ThemedItemStatusComponent_BaseFactory=core.xGo(ThemedItemStatusComponent2)))(t||ThemedItemStatusComponent2)}})();static#_2=this.\u0275cmp=core.VBU({type:ThemedItemStatusComponent2,selectors:[["ds-item-status"]],standalone:!0,features:[core.Vt3,core.aNF],ngContentSelectors:themed_item_status_component_c0,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(rf,ctx){1&rf&&(core.NAR(),core.DNE(0,ThemedItemStatusComponent_ng_template_0_Template,0,0,"ng-template",null,0,core.C5r),core.j41(2,"div",null,1),core.SdG(4),core.k0s())},encapsulation:2})}return ThemedItemStatusComponent2})();var item_versions_component=__webpack_require__(25006);function ItemVersionHistoryComponent_div_0_ds_item_versions_1_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-item-versions",3),2&rf){const item_r1=core.XpG().ngVar;core.Y8G("item",item_r1)("displayWhenEmpty",!0)("displayTitle",!1)("displayActions",!0)}}function ItemVersionHistoryComponent_div_0_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",1),core.DNE(1,ItemVersionHistoryComponent_div_0_ds_item_versions_1_Template,1,4,"ds-item-versions",2),core.k0s()),2&rf){const item_r1=ctx.ngVar;core.R7$(),core.Y8G("ngIf",item_r1)}}const item_withdraw_component_c0=a0=>({id:a0}),item_withdraw_component_c1=a0=>[a0,"edit"],ROUTES=[{path:"",resolve:{breadcrumb:i18n_breadcrumb_resolver.S},data:{breadcrumbKey:"item.edit"},children:[{path:"",component:EditItemPageComponent,children:[{path:"",redirectTo:"status",pathMatch:"full"},{path:"status",component:ThemedItemStatusComponent,data:{title:"item.edit.tabs.status.title",showBreadcrumbs:!0},canActivate:[itemPageStatusGuard]},{path:"bitstreams",component:ItemBitstreamsComponent,data:{title:"item.edit.tabs.bitstreams.title",showBreadcrumbs:!0},canActivate:[itemPageBitstreamsGuard]},{path:"metadata",component:themed_dso_edit_metadata_component.Q,data:{title:"item.edit.tabs.metadata.title",showBreadcrumbs:!0},canActivate:[itemPageMetadataGuard]},{path:"curate",component:ItemCurateComponent,data:{title:"item.edit.tabs.curate.title",showBreadcrumbs:!0},canActivate:[itemPageCurateGuard]},{path:"relationships",component:ItemRelationshipsComponent,data:{title:"item.edit.tabs.relationships.title",showBreadcrumbs:!0},canActivate:[itemPageRelationshipsGuard]},{path:"versionhistory",component:(()=>{class ItemVersionHistoryComponent2{constructor(route){this.route=route,this.AlertTypeEnum=alert_type.v}ngOnInit(){this.itemRD$=this.route.parent.parent.data.pipe((0,operators.Tj)(data=>data.dso)).pipe((0,shared_operators.yd)())}static#_=this.\u0275fac=function(t){return new(t||ItemVersionHistoryComponent2)(core.rXU(router.nX))};static#_2=this.\u0275cmp=core.VBU({type:ItemVersionHistoryComponent2,selectors:[["ds-item-version-history"]],standalone:!0,features:[core.aNF],decls:2,vars:3,consts:[["class","mt-2",4,"ngVar"],[1,"mt-2"],[3,"item","displayWhenEmpty","displayTitle","displayActions",4,"ngIf"],[3,"item","displayWhenEmpty","displayTitle","displayActions"]],template:function(rf,ctx){if(1&rf&&(core.DNE(0,ItemVersionHistoryComponent_div_0_Template,2,1,"div",0),core.nI1(1,"async")),2&rf){let tmp_0_0;core.Y8G("ngVar",null==(tmp_0_0=core.bMT(1,1,ctx.itemRD$))?null:tmp_0_0.payload)}},dependencies:[item_versions_component.I,var_directive.r,common.bT,common.Jj],encapsulation:2})}return ItemVersionHistoryComponent2})(),data:{title:"item.edit.tabs.versionhistory.title",showBreadcrumbs:!0},canActivate:[itemPageVersionHistoryGuard]},{path:"access-control",component:ItemAccessControlComponent,data:{title:"item.edit.tabs.access-control.title",showBreadcrumbs:!0},canActivate:[itemPageAccessControlGuard]},{path:"mapper",component:ItemCollectionMapperComponent,data:{title:"item.edit.tabs.item-mapper.title",showBreadcrumbs:!0},canActivate:[itemPageCollectionMapperGuard]}]},{path:"mapper",component:ItemCollectionMapperComponent},{path:edit_item_page_routing_paths.kH,component:(()=>{class ItemWithdrawComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="withdraw",this.predicate=rd=>rd.payload.isWithdrawn}performAction(){this.itemDataService.setWithDrawn(this.item,!0).pipe((0,shared_operators.qD)()).subscribe(response=>{this.processRestResponse(response)})}static#_=this.\u0275fac=function(t){return new(t||ItemWithdrawComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))};static#_2=this.\u0275cmp=core.VBU({type:ItemWithdrawComponent2,selectors:[["ds-item-withdraw"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_withdraw_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_withdraw_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,ngx_translate_core.h,ngx_translate_core.D9,router.Wk],encapsulation:2})}return ItemWithdrawComponent2})(),canActivate:[itemPageWithdrawGuard]},{path:edit_item_page_routing_paths.Pg,component:ItemReinstateComponent,canActivate:[itemPageReinstateGuard]},{path:edit_item_page_routing_paths.$2,component:ItemPrivateComponent,canActivate:[itemPagePrivateGuard]},{path:edit_item_page_routing_paths.RS,component:ItemPublicComponent},{path:edit_item_page_routing_paths.Jr,component:ItemDeleteComponent,canActivate:[itemPageDeleteGuard]},{path:edit_item_page_routing_paths.Bw,component:ItemMoveComponent,data:{title:"item.edit.move.title"},canActivate:[itemPageMoveGuard]},{path:edit_item_page_routing_paths.KY,component:ItemRegisterDoiComponent,canActivate:[itemPageRegisterDoiGuard],data:{title:"item.edit.register-doi.title"}},{path:edit_item_page_routing_paths.K4,children:[{path:"create",resolve:{resourcePolicyTarget:resource_policy_target_resolver.Q},component:resource_policy_create_component.m,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:resource_policy_resolver.n},component:resource_policy_edit_component._,data:{title:"resource-policies.edit.page.title"}},{path:"",component:ItemAuthorizationsComponent,data:{title:"item.edit.authorizations.title"}}],canActivate:[itemPageEditAuthorizationsGuard]}]}]},9280:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{k:()=>ItemOperationComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(84739),_angular_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64247),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(71781),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(43750),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68014);function ItemOperationComponent_span_5_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"span")(1,"button",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("disabled",ctx_r0.operation.disabled)("routerLink",ctx_r0.operation.operationUrl),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(2,4,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(4,6,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")," ")}}function ItemOperationComponent_span_6_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"span",6),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(2,"button",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(5,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(1,4,"item.edit.tabs.status.buttons.unauthorized")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("disabled",!0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,6,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(5,8,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")," ")}}let ItemOperationComponent=(()=>{class ItemOperationComponent2{static#_=this.\u0275fac=function(t){return new(t||ItemOperationComponent2)};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:ItemOperationComponent2,selectors:[["ds-item-operation"]],inputs:{operation:"operation"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.aNF],decls:7,vars:5,consts:[[1,"col-3","float-left","d-flex","h-100","action-label"],[1,"justify-content-center","align-self-center"],[1,"col-9","float-left","action-button"],[4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],[1,"btn","btn-outline-primary",3,"disabled","routerLink"],[3,"ngbTooltip"],[1,"btn","btn-outline-primary",3,"disabled"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"div",0)(1,"span",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(4,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.DNE(5,ItemOperationComponent_span_5_Template,5,8,"span",3)(6,ItemOperationComponent_span_6_Template,6,10,"span",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,3,"item.edit.tabs.status.buttons."+ctx.operation.operationKey+".label")," "),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngIf",ctx.operation.authorized),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngIf",!ctx.operation.authorized))},dependencies:[_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.D9,_angular_router__WEBPACK_IMPORTED_MODULE_2__.Wk,_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_3__.n8,_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_3__.md,_angular_common__WEBPACK_IMPORTED_MODULE_4__.bT],encapsulation:2})}return ItemOperationComponent2})()},46532:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ItemStatusComponent:()=>ItemStatusComponent});var common=__webpack_require__(84739),router=__webpack_require__(64247),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),configuration_data_service=__webpack_require__(44994),authorization_data_service=__webpack_require__(30289),feature_id=__webpack_require__(29321),identifier_data_service=__webpack_require__(29779),orcid_auth_service=__webpack_require__(62958),shared_operators=__webpack_require__(82656),fade=__webpack_require__(28107),empty_util=__webpack_require__(77028),item_page_routing_paths=__webpack_require__(63254),item_operation_component=__webpack_require__(9280);class ItemOperation{constructor(operationKey,operationUrl,featureID,disabled=!1,authorized=!0){this.operationKey=operationKey,this.operationUrl=operationUrl,this.featureID=featureID,this.authorized=authorized,this.setDisabled(disabled)}setDisabled(disabled){this.disabled=disabled}setAuthorized(authorized){this.authorized=authorized}}var core=__webpack_require__(68014);const _c0=a0=>({"pt-3":a0});function ItemStatusComponent_div_4_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",7)(1,"div",3),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",8),core.EFF(5),core.k0s()()),2&rf){const statusKey_r1=ctx.$implicit,ctx_r1=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,4,"item.edit.tabs.status.labels."+statusKey_r1),": "),core.R7$(2),core.Mz_("id","status-",statusKey_r1,""),core.R7$(),core.SpI(" ",ctx_r1.statusData[statusKey_r1]," ")}}function ItemStatusComponent_div_5_div_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"div",3),core.EFF(2),core.k0s(),core.j41(3,"div",10),core.EFF(4),core.nI1(5,"translate"),core.k0s()()),2&rf){const identifier_r3=core.XpG().$implicit;core.R7$(2),core.SpI(" ",identifier_r3.identifierType.toLocaleUpperCase()," "),core.R7$(2),core.Lme("",identifier_r3.value," (",core.bMT(5,3,"item.edit.identifiers.doi.status."+identifier_r3.identifierStatus),")")}}function ItemStatusComponent_div_5_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",7),core.DNE(1,ItemStatusComponent_div_5_div_1_Template,6,5,"div",9),core.k0s()),2&rf){const identifier_r3=ctx.$implicit;core.R7$(),core.Y8G("ngIf","doi"===identifier_r3.identifierType)}}function ItemStatusComponent_div_15_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",11),core.nrm(1,"ds-item-operation",12),core.k0s()),2&rf){const operation_r4=ctx.$implicit;core.Y8G("ngClass",core.eq3(2,_c0,operation_r4)),core.R7$(),core.Y8G("operation",operation_r4)}}let ItemStatusComponent=(()=>{class ItemStatusComponent2{constructor(route,authorizationService,identifierDataService,configurationService,orcidAuthService){this.route=route,this.authorizationService=authorizationService,this.identifierDataService=identifierDataService,this.configurationService=configurationService,this.orcidAuthService=orcidAuthService,this.operations$=new cjs.BehaviorSubject([]),this.subs=[]}ngOnInit(){this.itemRD$=this.route.parent.data.pipe((0,operators.Tj)(data=>data.dso)),this.itemRD$.pipe((0,operators.$1)(),(0,operators.Tj)(data=>data.payload)).pipe((0,operators.nx)(item=>{this.statusData=Object.assign({id:item.id,handle:item.handle,lastModified:item.lastModified}),this.statusDataKeys=Object.keys(this.statusData),this.identifiers$=this.identifierDataService.getIdentifierDataFor(item).pipe((0,operators.Tj)(identifierRD=>401!==identifierRD.statusCode&&(0,empty_util.a4)(identifierRD.payload)?identifierRD.payload.identifiers:null));const registerConfigEnabled$=this.configurationService.findByPropertyName("identifiers.item-status.register-doi").pipe((0,shared_operators.qD)(),(0,operators.Tj)(response=>{if(response.hasSucceeded){const payload=response.payload;return!!(payload.values.length>0&&(0,empty_util.a4)(payload.values[0]))&&"true"===payload.values[0]}return!1})),currentUrl=this.getCurrentUrl(item),initialOperations=[new ItemOperation("authorizations",`${currentUrl}/authorizations`,feature_id._.CanManagePolicies,!0),new ItemOperation("mappedCollections",`${currentUrl}/mapper`,feature_id._.CanManageMappings,!0),item.isWithdrawn?new ItemOperation("reinstate",`${currentUrl}/reinstate`,feature_id._.ReinstateItem,!0):new ItemOperation("withdraw",`${currentUrl}/withdraw`,feature_id._.WithdrawItem,!0),item.isDiscoverable?new ItemOperation("private",`${currentUrl}/private`,feature_id._.CanMakePrivate,!0):new ItemOperation("public",`${currentUrl}/public`,feature_id._.CanMakePrivate,!0),new ItemOperation("move",`${currentUrl}/move`,feature_id._.CanMove,!0),new ItemOperation("delete",`${currentUrl}/delete`,feature_id._.CanDelete,!0)];this.operations$.next(initialOperations);const ops$=this.identifierDataService.getIdentifierDataFor(item).pipe((0,shared_operators.qD)(),(0,operators.ZZ)(dataRD=>{if(dataRD.hasSucceeded){const identifiers=dataRD.payload.identifiers;let no_doi=!0,pending=!1;return identifiers?.forEach(identifier=>{(0,empty_util.a4)(identifier)&&"doi"===identifier.identifierType&&(no_doi=!1,["PENDING","MINTED",null].includes(identifier.identifierStatus)&&(pending=!0))}),registerConfigEnabled$.pipe((0,operators.Tj)(enabled=>enabled&&(pending||no_doi)))}return(0,cjs.of)(!1)}),(0,operators.nx)(showDoi=>{const ops=[...initialOperations];if(showDoi){const op=new ItemOperation("register-doi",`${currentUrl}/register-doi`,feature_id._.CanRegisterDOI,!0);ops.splice(ops.length-1,0,op)}return ops}),(0,operators.Hh)(op=>(0,empty_util.a4)(op.featureID)?this.authorizationService.isAuthorized(op.featureID,item.self).pipe((0,operators.F)(),(0,operators.Tj)(authorized=>(op.setDisabled(!authorized),op.setAuthorized(authorized),op))):[op]),(0,operators.$r)());let orcidOps$=(0,cjs.of)([]);return this.orcidAuthService.isLinkedToOrcid(item)&&(orcidOps$=this.orcidAuthService.onlyAdminCanDisconnectProfileFromOrcid().pipe((0,operators.Tj)(canDisconnect=>canDisconnect?[new ItemOperation("unlinkOrcid",`${currentUrl}/unlink-orcid`)]:[]))),(0,cjs.combineLatest)([ops$,orcidOps$])}),(0,operators.Tj)(([ops,orcidOps])=>[...ops,...orcidOps])).subscribe(ops=>this.operations$.next(ops)),this.itemPageRoute$=this.itemRD$.pipe((0,shared_operators.Hz)(),(0,operators.Tj)(item=>(0,item_page_routing_paths._o)(item)))}getCurrentUrl(item){return(0,item_page_routing_paths.$r)(item)}trackOperation(index,operation){return(0,empty_util.a4)(operation)?operation.operationKey:void 0}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||ItemStatusComponent2)(core.rXU(router.nX),core.rXU(authorization_data_service.AuthorizationDataService),core.rXU(identifier_data_service.IdentifierDataService),core.rXU(configuration_data_service.ConfigurationDataService),core.rXU(orcid_auth_service.r))};static#_2=this.\u0275cmp=core.VBU({type:ItemStatusComponent2,selectors:[["ds-base-item-status"]],standalone:!0,features:[core.aNF],decls:17,vars:19,consts:[[1,"mt-2"],[1,"row"],["class","w-100",4,"ngFor","ngForOf"],[1,"col-3","float-left","status-label"],["id","status-itemPage",1,"col-9","float-left","status-data"],[3,"routerLink"],["class","w-100",3,"ngClass",4,"ngFor","ngForOf"],[1,"w-100"],[1,"col-9","float-left","status-data",3,"id"],[4,"ngIf"],[1,"col-9","float-left","status-label"],[1,"w-100",3,"ngClass"],[3,"operation"]],template:function(rf,ctx){1&rf&&(core.j41(0,"p",0),core.EFF(1),core.nI1(2,"translate"),core.k0s(),core.j41(3,"div",1),core.DNE(4,ItemStatusComponent_div_4_Template,6,6,"div",2)(5,ItemStatusComponent_div_5_Template,2,1,"div",2),core.nI1(6,"async"),core.j41(7,"div",3),core.EFF(8),core.nI1(9,"translate"),core.k0s(),core.j41(10,"div",4)(11,"a",5),core.nI1(12,"async"),core.EFF(13),core.nI1(14,"async"),core.k0s()(),core.DNE(15,ItemStatusComponent_div_15_Template,2,4,"div",6),core.nI1(16,"async"),core.k0s()),2&rf&&(core.R7$(),core.JRh(core.bMT(2,7,"item.edit.tabs.status.description")),core.R7$(3),core.Y8G("ngForOf",ctx.statusDataKeys),core.R7$(),core.Y8G("ngForOf",core.bMT(6,9,ctx.identifiers$)),core.R7$(3),core.SpI(" ",core.bMT(9,11,"item.edit.tabs.status.labels.itemPage"),": "),core.R7$(3),core.Y8G("routerLink",core.bMT(12,13,ctx.itemPageRoute$)),core.R7$(2),core.JRh(core.bMT(14,15,ctx.itemPageRoute$)),core.R7$(2),core.Y8G("ngForOf",core.bMT(16,17,ctx.operations$)))},dependencies:[ngx_translate_core.h,ngx_translate_core.D9,common.Sq,common.Jj,common.bT,router.Wk,item_operation_component.k,common.YU],encapsulation:2,data:{animation:[fade.qG,fade.Ws]}})}return ItemStatusComponent2})()},61085:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>AccessControlFormContainerComponent});var common=__webpack_require__(84739),fesm2022_forms=__webpack_require__(28955),ngx_translate_core=__webpack_require__(43750),ngx_ui_switch=__webpack_require__(25702),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),bulk_access_config_data_service=__webpack_require__(47094),shared_operators=(__webpack_require__(4617),__webpack_require__(82656)),alert_component=__webpack_require__(14467),alert_type=__webpack_require__(82555),selectable_list_service=__webpack_require__(1050),ng_bootstrap=__webpack_require__(71781),date_util=__webpack_require__(7840),core=__webpack_require__(68014);let ToDatePipe=(()=>{class ToDatePipe2{transform(dateValue){if(!dateValue)return null;const date=new Date(dateValue);return{year:date.getFullYear(),month:date.getMonth()+1,day:date.getDate()}}static#_=this.\u0275fac=function(t){return new(t||ToDatePipe2)};static#_2=this.\u0275pipe=core.EJ8({name:"toDate",type:ToDatePipe2,pure:!1,standalone:!0})}return ToDatePipe2})();const _c0=["ngForm"];function AccessControlArrayFormComponent_div_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",7),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-no-access-conditions-warning-message")," "))}function AccessControlArrayFormComponent_ng_container_3_option_9_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",20),core.EFF(1),core.k0s()),2&rf){const option_r5=ctx.$implicit;core.Y8G("value",option_r5.name),core.R7$(),core.SpI(" ",option_r5.name," ")}}function AccessControlArrayFormComponent_ng_container_3_div_13_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",21)(1,"label",10),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",17)(5,"input",22,1),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r6);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.startDate,$event)||(control_r3.startDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",23)(9,"button",24),core.bIt("click",function(){core.eBV(_r6);const d_r7=core.sdS(6);return core.Njj(d_r7.toggle())}),core.k0s()()(),core.j41(10,"small",14),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolstartdate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-start-date")," "),core.R7$(3),core.Mz_("id","accesscontrolstartdate-",control_r3.id,""),core.Mz_("name","startDate-",control_r3.id,""),core.R50("ngModel",control_r3.startDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxStartDate)),core.R7$(4),core.Y8G("disabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-start-date-note")," ")}}function AccessControlArrayFormComponent_ng_container_3_div_14_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"div",21)(1,"label",10),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",17)(5,"input",22,2),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r9);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.endDate,$event)||(control_r3.endDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",23)(9,"button",24),core.bIt("click",function(){core.eBV(_r9);const d1_r10=core.sdS(6);return core.Njj(d1_r10.toggle())}),core.k0s()()(),core.j41(10,"small",14),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolenddate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-end-date")," "),core.R7$(3),core.Mz_("id","accesscontrolenddate-",control_r3.id,""),core.Mz_("name","endDate-",control_r3.id,""),core.R50("ngModel",control_r3.endDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxEndDate)),core.R7$(4),core.Y8G("disabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-end-date-note")," ")}}function AccessControlArrayFormComponent_ng_container_3_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.qex(0),core.j41(1,"div",8)(2,"div",9)(3,"div")(4,"label",10),core.EFF(5),core.nI1(6,"translate"),core.k0s(),core.j41(7,"select",11),core.mxI("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit;return core.DH7(control_r3.itemName,$event)||(control_r3.itemName=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.accessControlChanged(control_r3,$event))}),core.nrm(8,"option",12),core.DNE(9,AccessControlArrayFormComponent_ng_container_3_option_9_Template,2,2,"option",13),core.k0s(),core.j41(10,"small",14),core.EFF(11),core.nI1(12,"translate"),core.k0s()(),core.DNE(13,AccessControlArrayFormComponent_ng_container_3_div_13_Template,13,17,"div",15)(14,AccessControlArrayFormComponent_ng_container_3_div_14_Template,13,17,"div",15),core.k0s(),core.j41(15,"div")(16,"span",16),core.EFF(17,"\xa0"),core.k0s(),core.j41(18,"div",17)(19,"button",18),core.nI1(20,"translate"),core.bIt("click",function(){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.removeAccessControlItem(control_r3.id))}),core.nrm(21,"i",19),core.k0s()()()(),core.bVm()}if(2&rf){const control_r3=ctx.$implicit,ctx_r3=core.XpG(),ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("ngModelGroup","access-control-item-",control_r3.id,""),core.R7$(3),core.Mz_("for","accesscontroloption-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(6,17,"access-control-option-label")," "),core.R7$(2),core.Mz_("id","accesscontroloption-",control_r3.id,""),core.Mz_("name","itemName-",control_r3.id,""),core.Y8G("disabled",ngForm_r8.disabled),core.R50("ngModel",control_r3.itemName),core.R7$(2),core.Y8G("ngForOf",ctx_r3.dropdownOptions),core.R7$(2),core.SpI(" ",core.bMT(12,19,"access-control-option-note")," "),core.R7$(2),core.Y8G("ngIf",control_r3.hasStartDate),core.R7$(),core.Y8G("ngIf",control_r3.hasEndDate),core.R7$(5),core.Y8G("disabled",ngForm_r8.disabled||1===ctx_r3.form.accessControls.length),core.BMQ("aria-label",core.bMT(20,21,"access-control-remove"))}}let AccessControlArrayFormComponent=(()=>{class AccessControlArrayFormComponent2{constructor(){this.dropdownOptions=[],this.form={accessControls:[emptyAccessControlItem()]},this.formDisabled=!0,this.disable=()=>{this.ngForm.form.disable(),this.formDisabled=!0},this.enable=()=>{this.ngForm.form.enable(),this.formDisabled=!1}}ngOnInit(){this.disable()}get allControlsAreEmpty(){return this.form.accessControls.every(x=>null===x.itemName||""===x.itemName)}get showWarning(){return"replace"===this.mode&&this.allControlsAreEmpty&&!this.formDisabled}addAccessControlItem(itemName=null){this.form.accessControls=[...this.form.accessControls,{...emptyAccessControlItem(),itemName}]}removeAccessControlItem(id){this.form.accessControls=this.form.accessControls.filter(item=>item.id!==id)}getValue(){return this.form.accessControls.filter(x=>null!==x.itemName&&""!==x.itemName).map(x=>({name:x.itemName,startDate:x.startDate?(0,date_util.Sd)(x.startDate):null,endDate:x.endDate?(0,date_util.Sd)(x.endDate):null}))}reset(){this.form.accessControls=[],this.addAccessControlItem(),this.disable()}accessControlChanged(control,selectedItem){const item=this.dropdownOptions.find(x=>x.name===selectedItem);control.startDate=null,control.endDate=null,control.hasStartDate=item?.hasStartDate||!1,control.hasEndDate=item?.hasEndDate||!1,control.maxStartDate=item?.maxStartDate||null,control.maxEndDate=item?.maxEndDate||null}trackById(index,item){return item.id}static#_=this.\u0275fac=function(t){return new(t||AccessControlArrayFormComponent2)};static#_2=this.\u0275cmp=core.VBU({type:AccessControlArrayFormComponent2,selectors:[["ds-access-control-array-form"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(_c0,7),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.ngForm=_t.first)}},inputs:{dropdownOptions:"dropdownOptions",mode:"mode",type:"type"},exportAs:["accessControlArrayForm"],standalone:!0,features:[core.aNF],decls:8,vars:9,consts:[["ngForm","ngForm"],["d","ngbDatepicker"],["d1","ngbDatepicker"],["class","alert alert-warning",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-outline-primary","mt-3",3,"click","id","disabled"],[1,"fas","fa-plus"],[1,"alert","alert-warning"],[1,"access-control-item","mt-3",3,"ngModelGroup"],[1,"d-flex","flex-column"],[3,"for"],[1,"form-control",3,"ngModelChange","id","disabled","ngModel","name"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-text","text-muted"],["class","mt-3",4,"ngIf"],["aria-hidden","true",1,"mb-2","d-inline-block"],[1,"input-group"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-trash"],[3,"value"],[1,"mt-3"],["placeholder","yyyy-mm-dd","ngbDatepicker","","placement","top-start top-end bottom-start bottom-end",1,"form-control",3,"ngModelChange","id","ngModel","name","maxDate"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","fas","fa-calendar",3,"click","disabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"form",null,0),core.DNE(2,AccessControlArrayFormComponent_div_2_Template,3,3,"div",3)(3,AccessControlArrayFormComponent_ng_container_3_Template,22,23,"ng-container",4),core.j41(4,"button",5),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.addAccessControlItem())}),core.nrm(5,"i",6),core.EFF(6),core.nI1(7,"translate"),core.k0s()()}if(2&rf){const ngForm_r8=core.sdS(1);core.R7$(2),core.Y8G("ngIf",ctx.showWarning),core.R7$(),core.Y8G("ngForOf",ctx.form.accessControls)("ngForTrackBy",ctx.trackById),core.R7$(),core.Mz_("id","add-btn-",ctx.type,""),core.Y8G("disabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(7,7,"access-control-add-more")," ")}},dependencies:[fesm2022_forms.YN,fesm2022_forms.qT,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.me,fesm2022_forms.wz,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.vS,fesm2022_forms.Y4,fesm2022_forms.cV,common.bT,common.pM,ng_bootstrap.IQ,ng_bootstrap.cw,ngx_translate_core.h,ngx_translate_core.D9,ToDatePipe],styles:[".access-control-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 50px;grid-gap:10px;padding-bottom:15px;border-bottom:2px dotted gray}"]})}return AccessControlArrayFormComponent2})();const emptyAccessControlItem=()=>({id:randomID(),itemName:null,startDate:null,hasStartDate:!1,maxStartDate:null,endDate:null,hasEndDate:!1,maxEndDate:null}),randomID=()=>Math.floor(1e6*Math.random());var bulk_access_control_service=__webpack_require__(76415),context_model=__webpack_require__(34069),bitstream_data_service=__webpack_require__(36505),pagination_service=__webpack_require__(39304),empty_util=(__webpack_require__(6721),__webpack_require__(77028)),object_collection_component=__webpack_require__(60047),pagination_component_options_model=__webpack_require__(64694);const item_access_control_select_bitstreams_modal_component_c0=a0=>({repeatable:!0,listId:a0});function ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_ds_viewable_collection_1_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"ds-viewable-collection",10),core.bIt("pageChange",function($event){core.eBV(_r1);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.loadForPage($event))}),core.k0s()}if(2&rf){const data_r3=core.XpG().ngIf,ctx_r1=core.XpG();core.Y8G("config",ctx_r1.paginationConfig)("context",ctx_r1.context)("objects",data_r3)("selectable",!0)("selectionConfig",core.eq3(6,item_access_control_select_bitstreams_modal_component_c0,ctx_r1.LIST_ID))("showPaginator",!0)}}function ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_div_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",11),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-select-bitstreams-modal.no-items")," "))}function ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_ds_viewable_collection_1_Template,1,8,"ds-viewable-collection",8)(2,ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_div_2_Template,3,3,"div",9),core.bVm()),2&rf){const data_r3=ctx.ngIf;core.R7$(),core.Y8G("ngIf",data_r3.payload.page.length>0),core.R7$(),core.Y8G("ngIf",data_r3&&0===data_r3.payload.page.length)}}let ItemAccessControlSelectBitstreamsModalComponent=(()=>{class ItemAccessControlSelectBitstreamsModalComponent2{constructor(bitstreamService,paginationService,translateService,activeModal){this.bitstreamService=bitstreamService,this.paginationService=paginationService,this.translateService=translateService,this.activeModal=activeModal,this.LIST_ID="item-access-control-select-bitstreams",this.selectedBitstreams=[],this.data$=new cjs.BehaviorSubject(null),this.pageSize=5,this.context=context_model.o.Bitstream}ngOnInit(){this.loadForPage(1),this.paginationConfig=new pagination_component_options_model.W,this.paginationConfig.id="iacsbm",this.paginationConfig.currentPage=1,(0,empty_util.a4)(this.pageSize)&&(this.paginationConfig.pageSize=this.pageSize)}loadForPage(page){this.bitstreamService.findAllByItemAndBundleName(this.item,"ORIGINAL",{currentPage:page},!1).pipe((0,shared_operators.qD)()).subscribe(this.data$)}static#_=this.\u0275fac=function(t){return new(t||ItemAccessControlSelectBitstreamsModalComponent2)(core.rXU(bitstream_data_service.BitstreamDataService),core.rXU(pagination_service.m),core.rXU(ngx_translate_core.c$),core.rXU(ng_bootstrap.Lw))};static#_2=this.\u0275cmp=core.VBU({type:ItemAccessControlSelectBitstreamsModalComponent2,selectors:[["ds-item-access-control-select-bitstreams-modal"]],inputs:{item:"item",selectedBitstreams:"selectedBitstreams"},standalone:!0,features:[core.aNF],decls:14,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"config","context","objects","selectable","selectionConfig","showPaginator","pageChange",4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[3,"pageChange","config","context","objects","selectable","selectionConfig","showPaginator"],["role","alert",1,"alert","alert-info","w-100"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"h4",1),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",2),core.bIt("click",function(){return ctx.activeModal.dismiss("Cross click")}),core.j41(5,"span",3),core.EFF(6,"\xd7"),core.k0s()()(),core.j41(7,"div",4),core.DNE(8,ItemAccessControlSelectBitstreamsModalComponent_ng_container_8_Template,3,2,"ng-container",5),core.nI1(9,"async"),core.k0s(),core.j41(10,"div",6)(11,"button",7),core.bIt("click",function(){return ctx.activeModal.close("Close click")}),core.EFF(12),core.nI1(13,"translate"),core.k0s()()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-select-bitstreams-modal.title")," "),core.R7$(6),core.Y8G("ngIf",core.bMT(9,5,ctx.data$)),core.R7$(4),core.SpI(" ",core.bMT(13,7,"access-control-select-bitstreams-modal.close")," "))},dependencies:[common.bT,object_collection_component.h,common.Jj,ngx_translate_core.h,ngx_translate_core.D9]})}return ItemAccessControlSelectBitstreamsModalComponent2})();const access_control_form_container_component_c0=["bitstreamAccessCmp"],_c1=["itemAccessCmp"],_c2=()=>[];function AccessControlFormContainerComponent_ds_alert_3_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-alert",29),2&rf){const ctx_r1=core.XpG();core.Y8G("type",ctx_r1.AlertType.Info)("content",ctx_r1.titleMessage)}}function AccessControlFormContainerComponent_div_43_button_15_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",37),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r4);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.openSelectBitstreamsModal(ctx_r1.itemRD.payload))}),core.nrm(2,"i",38),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus||"selected"!==ctx_r1.state.bitstream.changesLimit),core.BMQ("aria-label",core.bMT(1,2,"access-control-bitstreams-select"))}}function AccessControlFormContainerComponent_div_43_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"div",11)(1,"fieldset",30)(2,"legend",31),core.EFF(3),core.nI1(4,"translate"),core.k0s(),core.j41(5,"div",14)(6,"input",32),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(7,"label",33),core.EFF(8),core.nI1(9,"translate"),core.k0s()(),core.j41(10,"div",14)(11,"input",34),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(12,"label",35),core.EFF(13),core.nI1(14,"translate"),core.DNE(15,AccessControlFormContainerComponent_div_43_button_15_Template,3,4,"button",36),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(3),core.SpI(" ",core.bMT(4,9,"access-control-limit-to-specific")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.SpI(" ",core.bMT(9,11,"access-control-process-all-bitstreams")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.Lme(" ",ctx_r1.state.bitstream.selectedBitstreams.length," ",core.bMT(14,13,"access-control-bitstreams-selected")," "),core.R7$(2),core.Y8G("ngIf",ctx_r1.itemRD)}}function AccessControlFormContainerComponent_hr_66_Template(rf,ctx){1&rf&&core.nrm(0,"hr")}function AccessControlFormContainerComponent_div_67_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",39)(1,"button",40),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.reset())}),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",41),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-cancel")," "),core.R7$(2),core.Y8G("disabled",!ctx_r1.state.item.toggleStatus&&!ctx_r1.state.bitstream.toggleStatus),core.R7$(),core.SpI(" ",core.bMT(6,5,"access-control-execute")," ")}}let AccessControlFormContainerComponent=(()=>{class AccessControlFormContainerComponent2{constructor(bulkAccessConfigService,bulkAccessControlService,selectableListService,modalService,cdr){this.bulkAccessConfigService=bulkAccessConfigService,this.bulkAccessControlService=bulkAccessControlService,this.selectableListService=selectableListService,this.modalService=modalService,this.cdr=cdr,this.showLimitToSpecificBitstreams=!1,this.titleMessage="",this.showSubmit=!0,this.AlertType=alert_type.v,this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}},this.dropdownData$=this.bulkAccessConfigService.findByName("default").pipe((0,shared_operators.qD)(),(0,operators.Tj)(configRD=>configRD.hasSucceeded?configRD.payload:null),(0,cjs.shareReplay)({refCount:!1,bufferSize:1}))}getFormValue(){return console.log({bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}),{bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}}reset(){this.bitstreamAccessCmp.reset(),this.itemAccessCmp.reset(),this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}}}submit(){const bitstreamAccess=this.bitstreamAccessCmp.getValue(),itemAccess=this.itemAccessCmp.getValue(),{file}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess,itemAccess,state:this.state});this.bulkAccessControlService.executeScript([this.itemRD.payload.uuid],file).pipe((0,operators.s)(1)).subscribe(res=>{console.log("success",res)})}handleStatusChange(type,active){"bitstream"===type?active?this.bitstreamAccessCmp.enable():this.bitstreamAccessCmp.disable():"item"===type&&(active?this.itemAccessCmp.enable():this.itemAccessCmp.disable())}openSelectBitstreamsModal(item){const ref=this.modalService.open(ItemAccessControlSelectBitstreamsModalComponent);ref.componentInstance.selectedBitstreams=this.state.bitstream.selectedBitstreams,ref.componentInstance.item=item,ref.closed.pipe((0,cjs.concatMap)(()=>this.selectableListService.getSelectableList("item-access-control-select-bitstreams")),(0,operators.s)(1)).subscribe(list=>{this.state.bitstream.selectedBitstreams=list?.selection||[],this.cdr.detectChanges()})}ngOnDestroy(){this.selectableListService.deselectAll("item-access-control-select-bitstreams")}static#_=this.\u0275fac=function(t){return new(t||AccessControlFormContainerComponent2)(core.rXU(bulk_access_config_data_service.BulkAccessConfigDataService),core.rXU(bulk_access_control_service.r),core.rXU(selectable_list_service.K),core.rXU(ng_bootstrap.Bq),core.rXU(core.gRc))};static#_2=this.\u0275cmp=core.VBU({type:AccessControlFormContainerComponent2,selectors:[["ds-access-control-form-container"]],viewQuery:function(rf,ctx){if(1&rf&&(core.GBs(access_control_form_container_component_c0,7),core.GBs(_c1,7)),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.bitstreamAccessCmp=_t.first),core.mGM(_t=core.lsd())&&(ctx.itemAccessCmp=_t.first)}},inputs:{showLimitToSpecificBitstreams:"showLimitToSpecificBitstreams",titleMessage:"titleMessage",itemRD:"itemRD",showSubmit:"showSubmit"},exportAs:["dsAccessControlForm"],standalone:!0,features:[core.aNF],decls:68,vars:62,consts:[["itemAccessCmp",""],["bitstreamAccessCmp",""],[1,"container"],[1,"card","border-0"],[1,"card-body"],["class","d-block pb-3",3,"type","content",4,"ngIf"],[1,"row"],[1,"col-12","col-md-6","border-right","d-flex","flex-column","justify-content-between"],[1,"d-flex","align-items-center"],[1,"h3","mb-0","mr-4"],[3,"ngModelChange","ariaLabel","ngModel"],[1,"row","mt-3"],[1,"h4","col-12","col-md-3"],[1,"col-12","col-md-8"],[1,"form-check"],["type","radio","name","itemMode","id","itemReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemReplace",1,"form-check-label"],["type","radio","name","itemMode","id","itemAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemAdd",1,"form-check-label"],[1,"h4","mt-3"],[3,"type","mode","dropdownOptions"],[1,"col-12","col-md-6","d-flex","flex-column","justify-content-between"],["class","row mt-3",4,"ngIf"],["type","radio","name","bitstreamMode","id","bitstreamReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamReplace",1,"form-check-label"],["type","radio","name","bitstreamMode","id","bitstreamAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamAdd",1,"form-check-label"],[4,"ngIf"],["class","d-flex justify-content-end",4,"ngIf"],[1,"d-block","pb-3",3,"type","content"],[1,"col-12"],[1,"h4"],["type","radio","name","changesLimit","id","processAll","value","all",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","processAll",1,"form-check-label"],["type","radio","name","changesLimit","id","processSelected","value","selected",1,"form-check-input","mt-2",3,"ngModelChange","disabled","ngModel"],["for","processSelected",1,"form-check-label"],["class","btn btn-outline-dark border-0","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"btn","btn-outline-dark","border-0",3,"click","disabled"],[1,"fa","fa-search"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-primary","mr-3",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",2)(1,"div",3)(2,"div",4),core.DNE(3,AccessControlFormContainerComponent_ds_alert_3_Template,1,2,"ds-alert",5),core.j41(4,"div",6)(5,"div",7)(6,"div")(7,"div",8)(8,"h2",9),core.EFF(9),core.nI1(10,"translate"),core.k0s(),core.j41(11,"ui-switch",10),core.nI1(12,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.toggleStatus,$event)||(ctx.state.item.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("item",$event))}),core.k0s()(),core.j41(13,"fieldset",11)(14,"legend",12),core.EFF(15),core.nI1(16,"translate"),core.k0s(),core.j41(17,"div",13)(18,"div",14)(19,"input",15),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(20,"label",16),core.EFF(21),core.nI1(22,"translate"),core.k0s()(),core.j41(23,"div",14)(24,"input",17),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(25,"label",18),core.EFF(26),core.nI1(27,"translate"),core.k0s()()()()(),core.j41(28,"div")(29,"h3",19),core.EFF(30),core.nI1(31,"translate"),core.k0s(),core.nrm(32,"ds-access-control-array-form",20,0),core.nI1(34,"async"),core.k0s()(),core.j41(35,"div",21)(36,"div")(37,"div",8)(38,"h2",9),core.EFF(39),core.nI1(40,"translate"),core.k0s(),core.j41(41,"ui-switch",10),core.nI1(42,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.toggleStatus,$event)||(ctx.state.bitstream.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("bitstream",$event))}),core.k0s()(),core.DNE(43,AccessControlFormContainerComponent_div_43_Template,16,15,"div",22),core.k0s(),core.j41(44,"fieldset",11)(45,"legend",12),core.EFF(46),core.nI1(47,"translate"),core.k0s(),core.j41(48,"div",13)(49,"div",14)(50,"input",23),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(51,"label",24),core.EFF(52),core.nI1(53,"translate"),core.k0s()(),core.j41(54,"div",14)(55,"input",25),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(56,"label",26),core.EFF(57),core.nI1(58,"translate"),core.k0s()()()(),core.j41(59,"div")(60,"h3",19),core.EFF(61),core.nI1(62,"translate"),core.k0s(),core.nrm(63,"ds-access-control-array-form",20,1),core.nI1(65,"async"),core.k0s()()(),core.DNE(66,AccessControlFormContainerComponent_hr_66_Template,1,0,"hr",27)(67,AccessControlFormContainerComponent_div_67_Template,7,7,"div",28),core.k0s()()()}if(2&rf){let tmp_16_0,tmp_31_0;core.R7$(3),core.Y8G("ngIf",ctx.titleMessage),core.R7$(6),core.SpI(" ",core.bMT(10,32,"access-control-item-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(12,34,ctx.state.bitstream.toggleStatus?"access-control-item-toggle.disable":"access-control-item-toggle.enable")),core.R50("ngModel",ctx.state.item.toggleStatus),core.R7$(4),core.SpI(" ",core.bMT(16,36,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(22,38,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(27,40,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(31,42,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","item")("mode",ctx.state.item.accessMode)("dropdownOptions",(null==(tmp_16_0=core.bMT(34,44,ctx.dropdownData$))?null:tmp_16_0.itemAccessConditionOptions)||core.lJ4(60,_c2)),core.R7$(7),core.SpI(" ",core.bMT(40,46,"access-control-bitstream-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(42,48,ctx.state.bitstream.toggleStatus?"access-control-bitstream-toggle.disable":"access-control-bitstream-toggle.enable")),core.R50("ngModel",ctx.state.bitstream.toggleStatus),core.R7$(2),core.Y8G("ngIf",ctx.showLimitToSpecificBitstreams),core.R7$(3),core.SpI(" ",core.bMT(47,50,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(53,52,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(58,54,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(62,56,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","bitstream")("mode",ctx.state.bitstream.accessMode)("dropdownOptions",(null==(tmp_31_0=core.bMT(65,58,ctx.dropdownData$))?null:tmp_31_0.bitstreamAccessConditionOptions)||core.lJ4(61,_c2)),core.R7$(3),core.Y8G("ngIf",ctx.showSubmit),core.R7$(),core.Y8G("ngIf",ctx.showSubmit)}},dependencies:[common.bT,alert_component.C,ngx_ui_switch.z,fesm2022_forms.me,fesm2022_forms.Fm,fesm2022_forms.BC,fesm2022_forms.vS,ngx_ui_switch.S,fesm2022_forms.YN,AccessControlArrayFormComponent,common.Jj,ngx_translate_core.h,ngx_translate_core.D9]})}return AccessControlFormContainerComponent2})()},76415:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{r:()=>BulkAccessControlService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10743),_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54257),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(82656),_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(33549),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(77028),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10117),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(64247),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(43750);let BulkAccessControlService=(()=>{class BulkAccessControlService2{constructor(notificationsService,router,scriptService,translationService){this.notificationsService=notificationsService,this.router=router,this.scriptService=scriptService,this.translationService=translationService}createPayloadFile(payload){const content=convertToBulkAccessControlFileModel(payload),blob=new Blob([JSON.stringify(content,null,2)],{type:"application/json"}),file=new File([blob],"data.json",{type:"application/json"});return{url:URL.createObjectURL(file),file}}executeScript(uuids,file){console.log("execute",{uuids,file});const params=[{name:"-f",value:file.name}];return uuids.forEach(uuid=>{params.push({name:"-u",value:uuid})}),this.scriptService.invoke("bulk-access-control",params,[file]).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Tj)(rd=>{if(rd.hasSucceeded){const title=this.translationService.get("process.new.notification.success.title"),content=this.translationService.get("process.new.notification.success.content");return this.notificationsService.success(title,content),(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.hj)(rd.payload)&&this.router.navigateByUrl((0,_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__.yJ)(rd.payload.processId)),!0}{const title=this.translationService.get("process.new.notification.error.title"),content=this.translationService.get("process.new.notification.error.content");return this.notificationsService.error(title,content),!1}}))}static#_=this.\u0275fac=function(t){return new(t||BulkAccessControlService2)(_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__.I),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_angular_router__WEBPACK_IMPORTED_MODULE_7__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__.ScriptDataService),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__.c$))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_6__.jDH({token:BulkAccessControlService2,factory:BulkAccessControlService2.\u0275fac,providedIn:"root"})}return BulkAccessControlService2})();const convertToBulkAccessControlFileModel=payload=>{const finalPayload={},bitstreamEnabled=payload.state.bitstream.toggleStatus;if(payload.state.item.toggleStatus&&(finalPayload.item={mode:payload.state.item.accessMode,accessConditions:payload.itemAccess}),bitstreamEnabled){const constraints={uuid:[]};bitstreamEnabled&&"selected"===payload.state.bitstream.changesLimit&&(constraints.uuid=payload.state.bitstream.selectedBitstreams.map(x=>x.id)),finalPayload.bitstream={constraints,mode:payload.state.bitstream.accessMode,accessConditions:payload.bitstreamAccess}}return finalPayload}},58221:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>DSpaceObjectSelect});class DSpaceObjectSelect{}},87240:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{h:()=>ObjectSelectComponent});var core=__webpack_require__(68014),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),dso_name_service=__webpack_require__(91735),authorization_data_service=(__webpack_require__(80685),__webpack_require__(30289)),ngrx_store=(__webpack_require__(29321),__webpack_require__(5136)),empty_util=__webpack_require__(77028),object_select_actions=__webpack_require__(56011);const objectSelectionsStateSelector=state=>state.objectSelection,objectSelectionListStateSelector=state=>state.objectSelection;let ObjectSelectService=(()=>{class ObjectSelectService2{constructor(store,appStore){this.store=store,this.appStore=appStore}getSelected(key,id){return this.store.select(function selectionByKeyAndIdSelector(key,id){return function keyAndIdSelector(key,id){return(0,ngrx_store.Mz)(objectSelectionsStateSelector,state=>{if((0,empty_util.a4)(state)&&(0,empty_util.a4)(state[key]))return state[key][id]})}(key,id)}(key,id)).pipe((0,operators.Tj)(object=>!!object&&object.checked))}getAllSelected(key){return this.appStore.select(objectSelectionListStateSelector).pipe((0,operators.Tj)(state=>(0,empty_util.a4)(state[key])?Object.keys(state[key]).filter(id=>state[key][id].checked):[]))}initialSelect(key,id){this.store.dispatch(new object_select_actions.u7(key,id))}initialDeselect(key,id){this.store.dispatch(new object_select_actions.NE(key,id))}select(key,id){this.store.dispatch(new object_select_actions.AS(key,id))}deselect(key,id){this.store.dispatch(new object_select_actions.Vu(key,id))}switch(key,id){this.store.dispatch(new object_select_actions.YE(key,id))}reset(key){this.store.dispatch(new object_select_actions.bx(key,null))}static#_=this.\u0275fac=function(t){return new(t||ObjectSelectService2)(core.KVO(ngrx_store.il),core.KVO(ngrx_store.il))};static#_2=this.\u0275prov=core.jDH({token:ObjectSelectService2,factory:ObjectSelectService2.\u0275fac,providedIn:"root"})}return ObjectSelectService2})(),ObjectSelectComponent=(()=>{class ObjectSelectComponent2{constructor(objectSelectService,authorizationService,dsoNameService){this.objectSelectService=objectSelectService,this.authorizationService=authorizationService,this.dsoNameService=dsoNameService,this.cancel=new core.bkB,this.confirm=new core.bkB,this.dangerConfirm=!1}ngOnInit(){this.selectedIds$=this.objectSelectService.getAllSelected(this.key)}ngOnDestroy(){this.objectSelectService.reset(this.key)}switch(id){this.objectSelectService.switch(this.key,id)}getSelected(id){return this.objectSelectService.getSelected(this.key,id)}canSelect(item){return this.featureId?this.authorizationService.isAuthorized(this.featureId,item.self).pipe((0,operators.ql)(!1)):(0,cjs.of)(!0)}confirmSelected(){this.selectedIds$.pipe((0,operators.s)(1)).subscribe(ids=>{this.confirm.emit(ids),this.objectSelectService.reset(this.key)})}onCancel(){this.cancel.emit()}static#_=this.\u0275fac=function(t){return new(t||ObjectSelectComponent2)(core.rXU(ObjectSelectService),core.rXU(authorization_data_service.AuthorizationDataService),core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=core.VBU({type:ObjectSelectComponent2,selectors:[["ds-object-select-abstract"]],inputs:{key:"key",dsoRD$:"dsoRD$",paginationOptions:"paginationOptions",sortOptions:"sortOptions",confirmButton:"confirmButton",featureId:"featureId",cancelButton:"cancelButton",dangerConfirm:"dangerConfirm"},outputs:{cancel:"cancel",confirm:"confirm"},decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}return ObjectSelectComponent2})()},96315:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{m:()=>ResourcePolicyCreateComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(43750),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10743),_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(91735),_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(55592),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(82656),_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(62181),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10117),_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7951),_angular_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64247);let ResourcePolicyCreateComponent=(()=>{class ResourcePolicyCreateComponent2{constructor(dsoNameService,notificationsService,resourcePolicyService,route,router,translate){this.dsoNameService=dsoNameService,this.notificationsService=notificationsService,this.resourcePolicyService=resourcePolicyService,this.route=route,this.router=router,this.translate=translate,this.processing$=new rxjs__WEBPACK_IMPORTED_MODULE_5__.BehaviorSubject(!1)}ngOnInit(){this.route.data.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(data=>data),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.s)(1)).subscribe(data=>{this.targetResourceUUID=data.resourcePolicyTarget.payload.id,this.targetResourceName=this.dsoNameService.getName(data.resourcePolicyTarget.payload)})}isProcessing(){return this.processing$.asObservable()}redirectToAuthorizationsPage(){this.router.navigate([`../../${_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__.K4}`],{relativeTo:this.route})}createResourcePolicy(event){let response$;this.processing$.next(!0),response$="eperson"===event.target.type?this.resourcePolicyService.create(event.object,this.targetResourceUUID,event.target.uuid):this.resourcePolicyService.create(event.object,this.targetResourceUUID,null,event.target.uuid),response$.pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)()).subscribe(responseRD=>{this.processing$.next(!1),responseRD.hasSucceeded?(this.notificationsService.success(null,this.translate.get("resource-policies.create.page.success.content")),this.redirectToAuthorizationsPage()):this.notificationsService.error(null,this.translate.get("resource-policies.create.page.failure.content"))})}static#_=this.\u0275fac=function(t){return new(t||ResourcePolicyCreateComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__.f),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__.I),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__.ResourcePolicyDataService),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.nX),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.c$))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_8__.VBU({type:ResourcePolicyCreateComponent2,selectors:[["ds-resource-policy-create"]],standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_8__.aNF],decls:5,vars:5,consts:[[1,"container"],[1,"mb-3"],[3,"reset","submit","isProcessing"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"div",0)(1,"h4",1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(4,"ds-resource-policy-form",2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("reset",function(){return ctx.redirectToAuthorizationsPage()})("submit",function($event){return ctx.createResourcePolicy($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Lme("",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(3,3,"resource-policies.create.page.heading")," ",ctx.targetResourceName,""),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("isProcessing",ctx.isProcessing()))},dependencies:[_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__.y,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.D9],encapsulation:2})}return ResourcePolicyCreateComponent2})()},28319:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_:()=>ResourcePolicyEditComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(43750),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10743),_core_resource_policy_models_resource_policy_resource_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(46328),_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(55592),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(82656),_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(62181),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10117),_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7951),_angular_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64247);let ResourcePolicyEditComponent=(()=>{class ResourcePolicyEditComponent2{constructor(notificationsService,resourcePolicyService,route,router,translate){this.notificationsService=notificationsService,this.resourcePolicyService=resourcePolicyService,this.route=route,this.router=router,this.translate=translate,this.processing$=new rxjs__WEBPACK_IMPORTED_MODULE_5__.BehaviorSubject(!1)}ngOnInit(){this.route.data.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(data=>data),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.s)(1)).subscribe(data=>{this.resourcePolicy=data.resourcePolicy.payload})}isProcessing(){return this.processing$.asObservable()}redirectToAuthorizationsPage(){this.router.navigate([`../../${_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__.K4}`],{relativeTo:this.route})}updateResourcePolicy(event){this.processing$.next(!0);const updatedObject=Object.assign({},event.object,{id:this.resourcePolicy.id,type:_core_resource_policy_models_resource_policy_resource_type__WEBPACK_IMPORTED_MODULE_0__.O.value,_links:this.resourcePolicy._links}),updateTargetSucceeded$=event.updateTarget?this.resourcePolicyService.updateTarget(this.resourcePolicy.id,this.resourcePolicy._links.self.href,event.target.uuid,event.target.type).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(responseRD=>responseRD&&responseRD.hasSucceeded)):(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.of)(!0),updateResourcePolicySucceeded$=this.resourcePolicyService.update(updatedObject).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(responseRD=>responseRD&&responseRD.hasSucceeded));(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.combineLatest)([updateTargetSucceeded$,updateResourcePolicySucceeded$]).subscribe(([updateTargetSucceeded,updateResourcePolicySucceeded])=>{this.processing$.next(!1),updateTargetSucceeded&&updateResourcePolicySucceeded?(this.notificationsService.success(null,this.translate.get("resource-policies.edit.page.success.content")),this.redirectToAuthorizationsPage()):this.notificationsService.error(null,this.translate.get(updateResourcePolicySucceeded?"resource-policies.edit.page.target-failure.content":updateTargetSucceeded?"resource-policies.edit.page.other-failure.content":"resource-policies.edit.page.failure.content"))})}static#_=this.\u0275fac=function(t){return new(t||ResourcePolicyEditComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__.I),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__.ResourcePolicyDataService),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.nX),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.c$))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_8__.VBU({type:ResourcePolicyEditComponent2,selectors:[["ds-resource-policy-edit"]],standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_8__.aNF],decls:5,vars:6,consts:[[1,"container"],[1,"mb-3"],[3,"reset","submit","resourcePolicy","isProcessing"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"div",0)(1,"h1",1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(4,"ds-resource-policy-form",2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("reset",function(){return ctx.redirectToAuthorizationsPage()})("submit",function($event){return ctx.updateResourcePolicy($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Lme("",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(3,4,"resource-policies.edit.page.heading")," ",ctx.resourcePolicy.id,""),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("resourcePolicy",ctx.resourcePolicy)("isProcessing",ctx.isProcessing()))},dependencies:[_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__.y,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.D9],encapsulation:2})}return ResourcePolicyEditComponent2})()},7951:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{y:()=>ResourcePolicyFormComponent});var common=__webpack_require__(84739),core=__webpack_require__(68014),ng_bootstrap=__webpack_require__(71781),fesm2020_core=__webpack_require__(71508),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),dso_name_service=__webpack_require__(91735),request_service=__webpack_require__(72744),eperson_data_service=__webpack_require__(62120),group_data_service=__webpack_require__(97195),resource_policy_model=__webpack_require__(12266),resource_policy_resource_type=__webpack_require__(46328),shared_operators=__webpack_require__(82656),date_util=__webpack_require__(7840),empty_util=__webpack_require__(77028),eperson_group_list_component=__webpack_require__(46846),ds_dynamic_input_model=__webpack_require__(13942),ds_dynamic_textarea_model=__webpack_require__(67044),form_component=__webpack_require__(49148),form_service=__webpack_require__(79181),action_type_model=__webpack_require__(22598),policy_type_model=__webpack_require__(38226);const policyTypeList=[{label:policy_type_model.t.TYPE_SUBMISSION,value:policy_type_model.t.TYPE_SUBMISSION},{label:policy_type_model.t.TYPE_WORKFLOW,value:policy_type_model.t.TYPE_WORKFLOW},{label:policy_type_model.t.TYPE_INHERITED,value:policy_type_model.t.TYPE_INHERITED},{label:policy_type_model.t.TYPE_CUSTOM,value:policy_type_model.t.TYPE_CUSTOM}],policyActionList=[{label:action_type_model.X.READ.toString(),value:action_type_model.X.READ},{label:action_type_model.X.WRITE.toString(),value:action_type_model.X.WRITE},{label:action_type_model.X.REMOVE.toString(),value:action_type_model.X.REMOVE},{label:action_type_model.X.ADMIN.toString(),value:action_type_model.X.ADMIN},{label:action_type_model.X.DELETE.toString(),value:action_type_model.X.DELETE},{label:action_type_model.X.WITHDRAWN_READ.toString(),value:action_type_model.X.WITHDRAWN_READ},{label:action_type_model.X.DEFAULT_BITSTREAM_READ.toString(),value:action_type_model.X.DEFAULT_BITSTREAM_READ},{label:action_type_model.X.DEFAULT_ITEM_READ.toString(),value:action_type_model.X.DEFAULT_ITEM_READ}],RESOURCE_POLICY_FORM_NAME_CONFIG={id:"name",label:"resource-policies.form.name.label",maxLength:30,hint:"resource-policies.form.name.hint",metadataFields:[],repeatable:!1,submissionId:"",hasSelectableMetadata:!1},RESOURCE_POLICY_FORM_DESCRIPTION_CONFIG={id:"description",label:"resource-policies.form.description.label",metadataFields:[],repeatable:!1,rows:10,submissionId:"",hasSelectableMetadata:!1},RESOURCE_POLICY_FORM_POLICY_TYPE_CONFIG={id:"policyType",label:"resource-policies.form.policy-type.label",options:policyTypeList,required:!0,validators:{required:null},errorMessages:{required:"resource-policies.form.policy-type.required"}},RESOURCE_POLICY_FORM_ACTION_TYPE_CONFIG={id:"action",label:"resource-policies.form.action-type.label",options:policyActionList,required:!0,validators:{required:null},errorMessages:{required:"resource-policies.form.action-type.required"}},RESOURCE_POLICY_FORM_DATE_GROUP_CONFIG={id:"date",group:[]},RESOURCE_POLICY_FORM_DATE_GROUP_LAYOUT={element:{control:"form-row"}},RESOURCE_POLICY_FORM_START_DATE_CONFIG={id:"start",label:"resource-policies.form.date.start.label",placeholder:"resource-policies.form.date.start.label",inline:!1,toggleIcon:"far fa-calendar-alt"},RESOURCE_POLICY_FORM_START_DATE_LAYOUT={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-6"}},RESOURCE_POLICY_FORM_END_DATE_CONFIG={id:"end",label:"resource-policies.form.date.end.label",placeholder:"resource-policies.form.date.end.label",inline:!1,toggleIcon:"far fa-calendar-alt"},RESOURCE_POLICY_FORM_END_DATE_LAYOUT={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-6"}},_c0=["content"];function ResourcePolicyFormComponent_ds_form_1_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-form",17,2),2&rf){const ctx_r1=core.XpG();core.Y8G("formId",ctx_r1.formId)("formModel",ctx_r1.formModel)("displaySubmit",!1)("displayCancel",!1)}}function ResourcePolicyFormComponent_ng_template_14_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"ds-eperson-group-list",18),core.bIt("select",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.Njj(ctx_r1.updateObjectSelected($event,!0))}),core.k0s()}}function ResourcePolicyFormComponent_ng_template_19_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"ds-eperson-group-list",19),core.bIt("select",function($event){core.eBV(_r4);const ctx_r1=core.XpG();return core.Njj(ctx_r1.updateObjectSelected($event,!1))}),core.k0s()}2&rf&&core.Y8G("isListOfEPerson",!1)}function ResourcePolicyFormComponent_span_32_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",20),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"submission.workflow.tasks.generic.processing")," "))}function ResourcePolicyFormComponent_span_34_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"form.submit")," "))}function ResourcePolicyFormComponent_ng_template_36_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",21)(1,"h4",22),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",23),core.bIt("click",function(){const modal_r6=core.eBV(_r5).$implicit;return core.Njj(modal_r6.close())}),core.j41(5,"span",24),core.EFF(6,"\xd7"),core.k0s()()(),core.j41(7,"div",25)(8,"div",26)(9,"div",27),core.nrm(10,"i",28),core.k0s(),core.j41(11,"div"),core.nrm(12,"p",29),core.nI1(13,"translate"),core.nrm(14,"p",30),core.nI1(15,"translate"),core.k0s()()(),core.j41(16,"div",31)(17,"button",32),core.bIt("click",function(){const modal_r6=core.eBV(_r5).$implicit;return core.Njj(modal_r6.close())}),core.EFF(18),core.nI1(19,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.JRh(core.bMT(3,4,"resource-policies.form.eperson-group-list.modal.header")),core.R7$(10),core.Y8G("innerHTML",core.bMT(13,6,"eperson"===ctx_r1.navActiveId?"resource-policies.form.eperson-group-list.modal.text1.toGroup":"resource-policies.form.eperson-group-list.modal.text1.toEPerson"),core.npT),core.R7$(2),core.Y8G("innerHTML",core.bMT(15,8,"resource-policies.form.eperson-group-list.modal.text2"),core.npT),core.R7$(4),core.JRh(core.bMT(19,10,"resource-policies.form.eperson-group-list.modal.close"))}}let ResourcePolicyFormComponent=(()=>{class ResourcePolicyFormComponent2{constructor(dsoNameService,ePersonService,formService,groupService,requestService,modalService){this.dsoNameService=dsoNameService,this.ePersonService=ePersonService,this.formService=formService,this.groupService=groupService,this.requestService=requestService,this.modalService=modalService,this.isProcessing=(0,cjs.of)(!1),this.reset=new core.bkB,this.submit=new core.bkB,this.resourcePolicyTargetName$=new cjs.BehaviorSubject(""),this.subs=[],this.resourcePolicyTargetUpdated=!1}ngOnInit(){if(this.isActive=!0,this.formId=this.formService.getUniqueId("resource-policy-form"),this.formModel=this.buildResourcePolicyForm(),this.isBeingEdited()){const epersonRD$=this.ePersonService.findByHref(this.resourcePolicy._links.eperson.href,!1).pipe((0,shared_operators.yd)()),groupRD$=this.groupService.findByHref(this.resourcePolicy._links.group.href,!1).pipe((0,shared_operators.yd)()),dsoRD$=(0,cjs.combineLatest)([epersonRD$,groupRD$]).pipe((0,operators.Tj)(rdArr=>rdArr.find(rd=>(0,empty_util.hj)(rd.payload))),(0,empty_util.Az)());this.subs.push(dsoRD$.pipe((0,operators.pb)(()=>this.isActive)).subscribe(dsoRD=>{this.resourcePolicyGrant=dsoRD.payload,this.navActiveId=String(dsoRD.payload.type),this.resourcePolicyTargetName$.next(this.getResourcePolicyTargetName())}))}}isFormValid(){return this.formService.isValid(this.formId).pipe((0,operators.Tj)(isValid=>isValid&&(0,empty_util.hj)(this.resourcePolicyGrant)))}buildResourcePolicyForm(){const formModel=[];formModel.push(new ds_dynamic_input_model.C(RESOURCE_POLICY_FORM_NAME_CONFIG),new ds_dynamic_textarea_model.E(RESOURCE_POLICY_FORM_DESCRIPTION_CONFIG),new fesm2020_core.z4z(RESOURCE_POLICY_FORM_POLICY_TYPE_CONFIG),new fesm2020_core.z4z(RESOURCE_POLICY_FORM_ACTION_TYPE_CONFIG));const startDateModel=new fesm2020_core.dku(RESOURCE_POLICY_FORM_START_DATE_CONFIG,RESOURCE_POLICY_FORM_START_DATE_LAYOUT),endDateModel=new fesm2020_core.dku(RESOURCE_POLICY_FORM_END_DATE_CONFIG,RESOURCE_POLICY_FORM_END_DATE_LAYOUT),dateGroupConfig=Object.assign({},RESOURCE_POLICY_FORM_DATE_GROUP_CONFIG,{group:[]});return dateGroupConfig.group.push(startDateModel,endDateModel),formModel.push(new fesm2020_core.iO5(dateGroupConfig,RESOURCE_POLICY_FORM_DATE_GROUP_LAYOUT)),this.initModelsValue(formModel),formModel}initModelsValue(formModel){return this.resourcePolicy&&formModel.forEach(model=>{"date"===model.id?((0,empty_util.a4)(this.resourcePolicy.startDate)&&(model.get(0).value=(0,date_util.PR)(this.resourcePolicy.startDate)),(0,empty_util.a4)(this.resourcePolicy.endDate)&&(model.get(1).value=(0,date_util.PR)(this.resourcePolicy.endDate))):this.resourcePolicy.hasOwnProperty(model.id)&&this.resourcePolicy[model.id]&&(model.value=this.resourcePolicy[model.id])}),formModel}isBeingEdited(){return!(0,empty_util.Im)(this.resourcePolicy)}getResourcePolicyTargetName(){return(0,empty_util.hj)(this.resourcePolicyGrant)?this.dsoNameService.getName(this.resourcePolicyGrant):""}updateObjectSelected(object,isEPerson){this.resourcePolicyTargetUpdated=!0,this.resourcePolicyGrant=object,this.resourcePolicyGrantType=isEPerson?"eperson":"group",this.resourcePolicyTargetName$.next(this.getResourcePolicyTargetName())}onReset(){this.reset.emit()}onSubmit(){this.formService.getFormData(this.formId).pipe((0,operators.s)(1)).subscribe(data=>{const eventPayload=Object.create({});eventPayload.object=this.createResourcePolicyByFormData(data),eventPayload.target={type:this.resourcePolicyGrantType,uuid:this.resourcePolicyGrant.id},eventPayload.updateTarget=this.resourcePolicyTargetUpdated,this.submit.emit(eventPayload)})}createResourcePolicyByFormData(data){const resourcePolicy=new resource_policy_model.h;return resourcePolicy.name=data.name?data.name[0].value:null,resourcePolicy.description=data.description?data.description[0].value:null,resourcePolicy.policyType=data.policyType?data.policyType[0].value:null,resourcePolicy.action=data.action?data.action[0].value:null,resourcePolicy.startDate=data.date&&data.date.start?(0,date_util.Sd)(data.date.start[0].value):null,resourcePolicy.endDate=data.date&&data.date.end?(0,date_util.Sd)(data.date.end[0].value):null,resourcePolicy.type=resource_policy_resource_type.O,resourcePolicy}ngOnDestroy(){this.isActive=!1,this.formModel=null,this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}onNavChange(changeEvent){this.isBeingEdited()&&(changeEvent.preventDefault(),this.modalService.open(this.content))}static#_=this.\u0275fac=function(t){return new(t||ResourcePolicyFormComponent2)(core.rXU(dso_name_service.f),core.rXU(eperson_data_service.EPersonDataService),core.rXU(form_service.u),core.rXU(group_data_service.GroupDataService),core.rXU(request_service.B),core.rXU(ng_bootstrap.Bq))};static#_2=this.\u0275cmp=core.VBU({type:ResourcePolicyFormComponent2,selectors:[["ds-resource-policy-form"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(_c0,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.content=_t.first)}},inputs:{resourcePolicy:"resourcePolicy",isProcessing:"isProcessing"},outputs:{reset:"reset",submit:"submit"},standalone:!0,features:[core.aNF],decls:38,vars:34,consts:[["nav","ngbNav"],["content",""],["formRef","formComponent"],[3,"formId","formModel","displaySubmit","displayCancel",4,"ngIf"],[1,"container-fluid"],["for","ResourcePolicyObject"],["id","ResourcePolicyObject","type","text",1,"form-control","mb-3",3,"value"],["ngbNav","",1,"nav-pills",3,"activeIdChange","navChange","activeId"],["role","presentation",3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"form-group","row"],[1,"col","text-right"],["type","reset",1,"btn","btn-default",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[4,"ngIf"],[3,"formId","formModel","displaySubmit","displayCancel"],[3,"select"],[3,"select","isListOfEPerson"],[1,"fas","fa-circle-notch","fa-spin"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"d-flex","flex-row"],[1,"mr-3"],[1,"fas","fa-info-circle","fa-2x","text-info"],[1,"font-weight-bold",3,"innerHTML"],[3,"innerHTML"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div"),core.DNE(1,ResourcePolicyFormComponent_ds_form_1_Template,2,4,"ds-form",3),core.j41(2,"div",4)(3,"label",5),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.nrm(6,"input",6),core.nI1(7,"async"),core.j41(8,"ul",7,0),core.mxI("activeIdChange",function($event){return core.eBV(_r1),core.DH7(ctx.navActiveId,$event)||(ctx.navActiveId=$event),core.Njj($event)}),core.bIt("navChange",function($event){return core.eBV(_r1),core.Njj(ctx.onNavChange($event))}),core.j41(10,"li",8)(11,"a",9),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.DNE(14,ResourcePolicyFormComponent_ng_template_14_Template,1,0,"ng-template",10),core.k0s(),core.j41(15,"li",8)(16,"a",9),core.EFF(17),core.nI1(18,"translate"),core.k0s(),core.DNE(19,ResourcePolicyFormComponent_ng_template_19_Template,1,1,"ng-template",10),core.k0s()(),core.nrm(20,"div",11),core.j41(21,"div"),core.nrm(22,"hr"),core.j41(23,"div",12)(24,"div",13)(25,"button",14),core.nI1(26,"async"),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.onReset())}),core.EFF(27),core.nI1(28,"translate"),core.k0s(),core.j41(29,"button",15),core.nI1(30,"async"),core.nI1(31,"async"),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.onSubmit())}),core.DNE(32,ResourcePolicyFormComponent_span_32_Template,4,3,"span",16),core.nI1(33,"async"),core.DNE(34,ResourcePolicyFormComponent_span_34_Template,3,3,"span",16),core.nI1(35,"async"),core.k0s()()()()()(),core.DNE(36,ResourcePolicyFormComponent_ng_template_36_Template,20,12,"ng-template",null,1,core.C5r)}if(2&rf){const nav_r7=core.sdS(9);core.R7$(),core.Y8G("ngIf",ctx.formModel),core.R7$(3),core.JRh(core.bMT(5,14,"resource-policies.form.eperson-group-list.label")),core.R7$(2),core.Y8G("value",core.bMT(7,16,ctx.resourcePolicyTargetName$)),core.R7$(2),core.R50("activeId",ctx.navActiveId),core.R7$(2),core.Y8G("ngbNavItem","eperson"),core.R7$(2),core.JRh(core.bMT(13,18,"resource-policies.form.eperson-group-list.tab.eperson")),core.R7$(3),core.Y8G("ngbNavItem","group"),core.R7$(2),core.JRh(core.bMT(18,20,"resource-policies.form.eperson-group-list.tab.group")),core.R7$(3),core.Y8G("ngbNavOutlet",nav_r7),core.R7$(5),core.Y8G("disabled",core.bMT(26,22,ctx.isProcessing)),core.R7$(2),core.JRh(core.bMT(28,24,"form.cancel")),core.R7$(2),core.Y8G("disabled",!0!==core.bMT(30,26,ctx.isFormValid())||core.bMT(31,28,ctx.isProcessing)),core.R7$(3),core.Y8G("ngIf",core.bMT(33,30,ctx.isProcessing)),core.R7$(2),core.Y8G("ngIf",!0!==core.bMT(35,32,ctx.isProcessing))}},dependencies:[form_component.s,ng_bootstrap.Pv,ng_bootstrap.Um,ng_bootstrap.X9,ng_bootstrap.sy,ng_bootstrap.Ri,ng_bootstrap.m_,eperson_group_list_component.T,ngx_translate_core.h,ngx_translate_core.D9,common.Jj,common.bT],encapsulation:2})}return ResourcePolicyFormComponent2})()},20312:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>resourcePolicyTargetResolver});var _angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(64247),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(10743),_config_app_config_interface__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(59945),_core_lazy_data_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(56964),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(82656),_core_shared_resource_type__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(94554),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(77028);const resourcePolicyTargetResolver=(route,state,dataServiceMap=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_config_app_config_interface__WEBPACK_IMPORTED_MODULE_0__.l9),parentInjector=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_2__.zZn),router=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_router__WEBPACK_IMPORTED_MODULE_3__.Ix))=>{const targetType=route.queryParamMap.get("targetType"),policyTargetId=route.queryParamMap.get("policyTargetId");((0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.Im)(targetType)||(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.Im)(policyTargetId))&&router.navigateByUrl("/404",{skipLocationChange:!0});const resourceType=new _core_shared_resource_type__WEBPACK_IMPORTED_MODULE_5__.v(targetType);return(0,_core_lazy_data_service__WEBPACK_IMPORTED_MODULE_6__.M)(dataServiceMap,resourceType.value,parentInjector).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.nx)(dataService=>dataService.findById(policyTargetId)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)())}},48576:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>resourcePolicyResolver});var _angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(68014),_angular_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(64247),_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(55592),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(82656),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(77028),_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(32181);const resourcePolicyResolver=(route,state,router=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_router__WEBPACK_IMPORTED_MODULE_3__.Ix),resourcePolicyService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_0__.ResourcePolicyDataService))=>{const policyId=route.queryParamMap.get("policyId");return(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.Im)(policyId)&&router.navigateByUrl("/404",{skipLocationChange:!0}),resourcePolicyService.findById(policyId,!0,!1,(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_5__.s)("eperson"),(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_5__.s)("group")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)())}},67848:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{e:()=>ResourcePoliciesComponent});var common=__webpack_require__(84739),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),dso_name_service=__webpack_require__(91735),request_service=__webpack_require__(72744),eperson_data_service=__webpack_require__(62120),group_data_service=__webpack_require__(97195),resource_policy_data_service=__webpack_require__(55592),shared_operators=__webpack_require__(82656),empty_util=__webpack_require__(77028),notifications_service=__webpack_require__(10117),follow_link_config_model=__webpack_require__(32181),core=__webpack_require__(68014),fesm2022_forms=__webpack_require__(28955),access_control_routing_paths=__webpack_require__(60856),date_util=__webpack_require__(7840),has_value_pipe=__webpack_require__(10585),router=__webpack_require__(64247);const _c0=["ds-resource-policy-entry",""];function ResourcePolicyEntryComponent_button_30_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"button",7),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.redirectToGroupEditPage())}),core.nrm(2,"i",10),core.k0s()}2&rf&&core.Y8G("title",core.bMT(1,1,"resource-policies.table.headers.edit.group"))}let ResourcePolicyEntryComponent=(()=>{class ResourcePolicyEntryComponent2{constructor(dsoNameService,groupService,route,router2){this.dsoNameService=dsoNameService,this.groupService=groupService,this.route=route,this.router=router2,this.toggleCheckbox=new core.bkB}ngOnInit(){this.epersonName$=this.getName$(this.entry.policy.eperson),this.groupName$=this.getName$(this.entry.policy.group)}getName$(dso$){return dso$.pipe((0,shared_operators.v7)(),(0,operators.Tj)(rd=>{if((0,empty_util.a4)(rd?.payload))return this.dsoNameService.getName(rd.payload)}))}formatDate(date){return(0,empty_util.hj)(date)?(0,date_util.$T)((0,date_util.PR)(date)):""}redirectToResourcePolicyEditPage(){this.router.navigate(["./edit"],{relativeTo:this.route,queryParams:{policyId:this.entry.policy.id}})}redirectToGroupEditPage(){this.groupService.findByHref(this.entry.policy._links.group.href,!1).pipe((0,shared_operators.ak)(),(0,operators.Tj)(group=>group.id)).subscribe(groupUUID=>{this.router.navigate([(0,access_control_routing_paths.xl)(groupUUID)])})}static#_=this.\u0275fac=function(t){return new(t||ResourcePolicyEntryComponent2)(core.rXU(dso_name_service.f),core.rXU(group_data_service.GroupDataService),core.rXU(router.nX),core.rXU(router.Ix))};static#_2=this.\u0275cmp=core.VBU({type:ResourcePolicyEntryComponent2,selectors:[["tr","ds-resource-policy-entry",""]],inputs:{entry:"entry"},outputs:{toggleCheckbox:"toggleCheckbox"},standalone:!0,features:[core.aNF],attrs:_c0,decls:33,vars:26,consts:[[1,"text-center"],[1,"custom-control","custom-checkbox"],["type","checkbox",1,"custom-control-input",3,"ngModelChange","id","ngModel"],[1,"custom-control-label",3,"for"],[1,"sr-only"],["scope","row"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm",3,"click","title"],["aria-hidden","true",1,"fas","fa-edit","fa-fw"],["class","btn btn-outline-primary btn-sm",3,"title","click",4,"ngIf"],["aria-hidden","true",1,"fas","fa-users","fa-fw"]],template:function(rf,ctx){1&rf&&(core.j41(0,"td",0)(1,"div",1)(2,"input",2),core.bIt("ngModelChange",function($event){return ctx.toggleCheckbox.emit($event)}),core.k0s(),core.j41(3,"label",3)(4,"span",4),core.EFF(5),core.nI1(6,"translate"),core.k0s()()()(),core.j41(7,"th",5),core.EFF(8),core.k0s(),core.j41(9,"td"),core.EFF(10),core.k0s(),core.j41(11,"td"),core.EFF(12),core.k0s(),core.j41(13,"td"),core.EFF(14),core.k0s(),core.j41(15,"td"),core.EFF(16),core.nI1(17,"async"),core.k0s(),core.j41(18,"td"),core.EFF(19),core.nI1(20,"async"),core.k0s(),core.j41(21,"td"),core.EFF(22),core.k0s(),core.j41(23,"td"),core.EFF(24),core.k0s(),core.j41(25,"td",0)(26,"div",6)(27,"button",7),core.nI1(28,"translate"),core.bIt("click",function(){return ctx.redirectToResourcePolicyEditPage()}),core.nrm(29,"i",8),core.k0s(),core.DNE(30,ResourcePolicyEntryComponent_button_30_Template,3,3,"button",9),core.nI1(31,"async"),core.nI1(32,"dsHasValue"),core.k0s()()),2&rf&&(core.R7$(2),core.Y8G("id",ctx.entry.id)("ngModel",ctx.entry.checked),core.R7$(),core.Y8G("for",ctx.entry.id),core.R7$(2),core.JRh(core.bMT(6,14,ctx.entry.checked?"resource-policies.table.headers.deselect":"resource-policies.table.headers.select")),core.R7$(3),core.SpI(" ",ctx.entry.id,"\n"),core.R7$(2),core.JRh(ctx.entry.policy.name),core.R7$(2),core.JRh(ctx.entry.policy.policyType),core.R7$(2),core.JRh(ctx.entry.policy.action),core.R7$(2),core.SpI(" ",core.bMT(17,16,ctx.epersonName$),"\n"),core.R7$(3),core.SpI(" ",core.bMT(20,18,ctx.groupName$),"\n"),core.R7$(3),core.JRh(ctx.formatDate(ctx.entry.policy.startDate)),core.R7$(2),core.JRh(ctx.formatDate(ctx.entry.policy.endDate)),core.R7$(3),core.Y8G("title",core.bMT(28,20,"resource-policies.table.headers.edit.policy")),core.R7$(3),core.Y8G("ngIf",core.bMT(32,24,core.bMT(31,22,ctx.groupName$))))},dependencies:[common.Jj,ngx_translate_core.h,ngx_translate_core.D9,fesm2022_forms.YN,fesm2022_forms.Zm,fesm2022_forms.BC,fesm2022_forms.vS,common.bT,has_value_pipe.a],encapsulation:2})}return ResourcePolicyEntryComponent2})();function ResourcePoliciesComponent_ng_container_11_Template(rf,ctx){if(1&rf&&(core.qex(0),core.EFF(1),core.bVm()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.SpI(" (",ctx_r0.resourceUUID,") ")}}function ResourcePoliciesComponent_span_17_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",12),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"submission.workflow.tasks.generic.processing")," "))}function ResourcePoliciesComponent_span_19_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",13),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"resource-policies.delete.btn")," "))}function ResourcePoliciesComponent_tr_27_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"tr",14)(1,"th")(2,"div",15)(3,"input",16,0),core.bIt("change",function($event){core.eBV(_r2);const ctx_r0=core.XpG();return core.Njj(ctx_r0.selectAllCheckbox($event))}),core.k0s(),core.j41(5,"label",17)(6,"span",18),core.EFF(7),core.nI1(8,"translate"),core.k0s()()()(),core.j41(9,"th"),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"th"),core.EFF(13),core.nI1(14,"translate"),core.k0s(),core.j41(15,"th"),core.EFF(16),core.nI1(17,"translate"),core.k0s(),core.j41(18,"th"),core.EFF(19),core.nI1(20,"translate"),core.k0s(),core.j41(21,"th"),core.EFF(22),core.nI1(23,"translate"),core.k0s(),core.j41(24,"th"),core.EFF(25),core.nI1(26,"translate"),core.k0s(),core.j41(27,"th"),core.EFF(28),core.nI1(29,"translate"),core.k0s(),core.j41(30,"th"),core.EFF(31),core.nI1(32,"translate"),core.k0s(),core.j41(33,"th"),core.EFF(34),core.nI1(35,"translate"),core.k0s()()}if(2&rf){const selectAllBtn_r3=core.sdS(4),ctx_r0=core.XpG();core.R7$(3),core.Y8G("id","selectAll_"+ctx_r0.resourceUUID),core.R7$(2),core.Y8G("for","selectAll_"+ctx_r0.resourceUUID),core.R7$(2),core.JRh(core.bMT(8,12,selectAllBtn_r3.checked?"resource-policies.table.headers.deselect-all":"resource-policies.table.headers.select-all")),core.R7$(3),core.JRh(core.bMT(11,14,"resource-policies.table.headers.id")),core.R7$(3),core.JRh(core.bMT(14,16,"resource-policies.table.headers.name")),core.R7$(3),core.JRh(core.bMT(17,18,"resource-policies.table.headers.policyType")),core.R7$(3),core.JRh(core.bMT(20,20,"resource-policies.table.headers.action")),core.R7$(3),core.JRh(core.bMT(23,22,"resource-policies.table.headers.eperson")),core.R7$(3),core.JRh(core.bMT(26,24,"resource-policies.table.headers.group")),core.R7$(3),core.JRh(core.bMT(29,26,"resource-policies.table.headers.date.start")),core.R7$(3),core.JRh(core.bMT(32,28,"resource-policies.table.headers.date.end")),core.R7$(3),core.JRh(core.bMT(35,30,"resource-policies.table.headers.edit"))}}function ResourcePoliciesComponent_tbody_29_tr_1_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"tr",20),core.bIt("toggleCheckbox",function($event){const entry_r5=core.eBV(_r4).$implicit,ctx_r0=core.XpG(2);return core.Njj(ctx_r0.selectCheckbox(entry_r5,$event))}),core.k0s()}2&rf&&core.Y8G("entry",ctx.$implicit)}function ResourcePoliciesComponent_tbody_29_Template(rf,ctx){if(1&rf&&(core.j41(0,"tbody"),core.DNE(1,ResourcePoliciesComponent_tbody_29_tr_1_Template,1,1,"tr",19),core.nI1(2,"async"),core.k0s()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("ngForOf",core.bMT(2,1,ctx_r0.getResourcePolicies()))}}let ResourcePoliciesComponent=(()=>{class ResourcePoliciesComponent2{constructor(cdr,dsoNameService,ePersonService,groupService,notificationsService,requestService,resourcePolicyService,route,router2,translate){this.cdr=cdr,this.dsoNameService=dsoNameService,this.ePersonService=ePersonService,this.groupService=groupService,this.notificationsService=notificationsService,this.requestService=requestService,this.resourcePolicyService=resourcePolicyService,this.route=route,this.router=router2,this.translate=translate,this.processingDelete$=new cjs.BehaviorSubject(!1),this.resourcePoliciesEntries$=new cjs.BehaviorSubject([]),this.subs=[]}ngOnInit(){this.isActive=!0,this.initResourcePolicyList()}canDelete(){return(0,cjs.from)(this.resourcePoliciesEntries$.value).pipe((0,operators.pb)(entry=>entry.checked),(0,operators.TS)((acc,value)=>[...acc,value],[]),(0,operators.Tj)(entries=>(0,empty_util.hj)(entries)),(0,operators.F)())}deleteSelectedResourcePolicies(){this.processingDelete$.next(!0);const policiesToDelete=this.resourcePoliciesEntries$.value.filter(entry=>entry.checked);this.subs.push((0,cjs.from)(policiesToDelete).pipe((0,operators.Hh)(entry=>this.resourcePolicyService.delete(entry.policy.id)),(0,operators.SQ)((acc,value)=>[...acc,value],[]),(0,operators.pb)(results=>results.length===policiesToDelete.length),(0,operators.s)(1)).subscribe(results=>{const failureResults=results.filter(result=>!result);(0,empty_util.Im)(failureResults)?this.notificationsService.success(null,this.translate.get("resource-policies.delete.success.content")):this.notificationsService.error(null,this.translate.get("resource-policies.delete.failure.content")),this.processingDelete$.next(!1)}))}getResourcePolicies(){return this.resourcePoliciesEntries$.asObservable()}initResourcePolicyList(){this.subs.push(this.resourcePolicyService.searchByResource(this.resourceUUID,null,!1,!0,(0,follow_link_config_model.s)("eperson"),(0,follow_link_config_model.s)("group")).pipe((0,operators.pb)(()=>this.isActive),(0,shared_operators.v7)()).subscribe(result=>{const entries=result.payload.page.map(policy=>({id:policy.id,policy,checked:!1}));this.resourcePoliciesEntries$.next(entries),this.cdr.detectChanges()}))}isProcessingDelete(){return this.processingDelete$.asObservable()}redirectToResourcePolicyCreatePage(){this.router.navigate(["./create"],{relativeTo:this.route,queryParams:{policyTargetId:this.resourceUUID,targetType:this.resourceType}})}selectAllCheckbox(event){const checked=event.target.checked;this.resourcePoliciesEntries$.value.forEach(entry=>entry.checked=checked)}selectCheckbox(policyEntry,checked){policyEntry.checked=checked}ngOnDestroy(){this.isActive=!1,this.resourcePoliciesEntries$=null,this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static#_=this.\u0275fac=function(t){return new(t||ResourcePoliciesComponent2)(core.rXU(core.gRc),core.rXU(dso_name_service.f),core.rXU(eperson_data_service.EPersonDataService),core.rXU(group_data_service.GroupDataService),core.rXU(notifications_service.I),core.rXU(request_service.B),core.rXU(resource_policy_data_service.ResourcePolicyDataService),core.rXU(router.nX),core.rXU(router.Ix),core.rXU(ngx_translate_core.c$))};static#_2=this.\u0275cmp=core.VBU({type:ResourcePoliciesComponent2,selectors:[["ds-resource-policies"]],inputs:{resourceUUID:"resourceUUID",resourceType:"resourceType",resourceName:"resourceName"},standalone:!0,features:[core.aNF],decls:31,vars:34,consts:[["selectAllBtn",""],[1,"table-responsive"],[1,"table","table-striped","table-bordered","table-hover"],["colspan","10"],[1,"d-flex","justify-content-between","align-items-center","m-0"],[1,"text-info"],[4,"ngIf"],[1,"space-children-mr","flex-shrink-0"],[1,"btn","btn-danger","p-1",3,"click","disabled","title"],[1,"btn","btn-success","p-1",3,"click","disabled","title"],["aria-hidden","true",1,"fas","fa-plus"],["class","text-center",4,"ngIf"],["aria-hidden","true",1,"fas","fa-circle-notch","fa-spin"],["aria-hidden","true",1,"fas","fa-trash-alt","fa-fw"],[1,"text-center"],[1,"custom-control","custom-checkbox"],["type","checkbox",1,"custom-control-input",3,"change","id"],[1,"custom-control-label",3,"for"],[1,"sr-only"],["ds-resource-policy-entry","",3,"entry","toggleCheckbox",4,"ngFor","ngForOf"],["ds-resource-policy-entry","",3,"toggleCheckbox","entry"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",1)(1,"table",2)(2,"thead")(3,"tr")(4,"th",3)(5,"div",4)(6,"span"),core.EFF(7),core.nI1(8,"translate"),core.j41(9,"span",5),core.EFF(10),core.k0s(),core.DNE(11,ResourcePoliciesComponent_ng_container_11_Template,2,1,"ng-container",6),core.k0s(),core.j41(12,"div",7)(13,"button",8),core.nI1(14,"async"),core.nI1(15,"async"),core.nI1(16,"translate"),core.bIt("click",function(){return ctx.deleteSelectedResourcePolicies()}),core.DNE(17,ResourcePoliciesComponent_span_17_Template,4,3,"span",6),core.nI1(18,"async"),core.DNE(19,ResourcePoliciesComponent_span_19_Template,4,3,"span",6),core.nI1(20,"async"),core.k0s(),core.j41(21,"button",9),core.nI1(22,"async"),core.nI1(23,"translate"),core.bIt("click",function(){return ctx.redirectToResourcePolicyCreatePage()}),core.nrm(24,"i",10),core.EFF(25),core.nI1(26,"translate"),core.k0s()()()()(),core.DNE(27,ResourcePoliciesComponent_tr_27_Template,36,32,"tr",11),core.nI1(28,"async"),core.k0s(),core.DNE(29,ResourcePoliciesComponent_tbody_29_Template,3,3,"tbody",6),core.nI1(30,"async"),core.k0s()()),2&rf){let tmp_10_0,tmp_11_0;core.R7$(7),core.SpI(" ",core.bMT(8,12,"resource-policies.table.headers.title.for."+ctx.resourceType)," "),core.R7$(3),core.SpI(" ",ctx.resourceName," "),core.R7$(),core.Y8G("ngIf","item"!==ctx.resourceType),core.R7$(2),core.Y8G("disabled",!0!==core.bMT(14,14,ctx.canDelete())||core.bMT(15,16,ctx.isProcessingDelete()))("title",core.bMT(16,18,"resource-policies.delete.btn.title")),core.R7$(4),core.Y8G("ngIf",core.bMT(18,20,ctx.isProcessingDelete())),core.R7$(2),core.Y8G("ngIf",!0!==core.bMT(20,22,ctx.isProcessingDelete())),core.R7$(2),core.Y8G("disabled",core.bMT(22,24,ctx.isProcessingDelete()))("title",core.bMT(23,26,"resource-policies.add.for."+ctx.resourceType)),core.R7$(4),core.SpI(" ",core.bMT(26,28,"resource-policies.add.button")," "),core.R7$(2),core.Y8G("ngIf",(null==(tmp_10_0=core.bMT(28,30,ctx.getResourcePolicies()))?null:tmp_10_0.length)>0),core.R7$(2),core.Y8G("ngIf",(null==(tmp_11_0=core.bMT(30,32,ctx.getResourcePolicies()))?null:tmp_11_0.length)>0)}},dependencies:[ResourcePolicyEntryComponent,ngx_translate_core.h,ngx_translate_core.D9,common.bT,common.Jj,common.Sq],styles:["td[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]:focus{box-shadow:none!important}"]})}return ResourcePoliciesComponent2})()},48440:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>AbstractTrackableComponent});var _core_data_object_updates_object_updates_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6440),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10117),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(68014),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(43750),_angular_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(64247);let AbstractTrackableComponent=(()=>{class AbstractTrackableComponent2{constructor(objectUpdatesService,notificationsService,translateService,router){this.objectUpdatesService=objectUpdatesService,this.notificationsService=notificationsService,this.translateService=translateService,this.router=router,this.notificationsPrefix="static-pages.form.notification"}ngOnInit(){this.url=this.router.url.split("?")[0],this.hasChanges$=this.hasChanges(),this.isReinstatable$=this.isReinstatable()}discard(){const undoNotification=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardFieldUpdates(this.url,undoNotification)}reinstate(){this.objectUpdatesService.reinstateFieldUpdates(this.url)}isReinstatable(){return this.objectUpdatesService.isReinstatable(this.url)}hasChanges(){return this.objectUpdatesService.hasUpdates(this.url)}getNotificationTitle(key){return this.translateService.instant(this.notificationsPrefix+key+".title")}getNotificationContent(key){return this.translateService.instant(this.notificationsPrefix+key+".content")}static#_=this.\u0275fac=function(t){return new(t||AbstractTrackableComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_core_data_object_updates_object_updates_service__WEBPACK_IMPORTED_MODULE_0__.F),_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__.I),_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_4__.Ix))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_2__.VBU({type:AbstractTrackableComponent2,selectors:[["ds-abstract-trackable"]],standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_2__.aNF],decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}return AbstractTrackableComponent2})()},10585:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>HasValuePipe});var _empty_util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(77028),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68014);let HasValuePipe=(()=>{class HasValuePipe2{transform(value){return(0,_empty_util__WEBPACK_IMPORTED_MODULE_0__.a4)(value)}static#_=this.\u0275fac=function(t){return new(t||HasValuePipe2)};static#_2=this.\u0275pipe=_angular_core__WEBPACK_IMPORTED_MODULE_1__.EJ8({name:"dsHasValue",type:HasValuePipe2,pure:!0,standalone:!0})}return HasValuePipe2})()},30207:(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./custom/app/dso-shared/dso-edit-metadata/dso-edit-metadata.component":[38831,8831]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return __webpack_require__.e(ids[1]).then(()=>__webpack_require__(id))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id=30207,module.exports=webpackAsyncContext},52529:(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./custom/app/item-page/edit-item-page/item-status/item-status.component":[47953,7953]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return __webpack_require__.e(ids[1]).then(()=>__webpack_require__(id))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id=52529,module.exports=webpackAsyncContext},25702:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>UiSwitchComponent,z:()=>UiSwitchModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68014),_angular_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(28955),_angular_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(84739);const _c0=["*"];function UiSwitchComponent_label_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"label",2)(1,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(3,"span",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("checkedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("uncheckedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.uncheckedLabel)}}const UI_SWITCH_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.nKC("UI_SWITCH_OPTIONS"),UI_SWITCH_CONTROL_VALUE_ACCESSOR={provide:_angular_forms__WEBPACK_IMPORTED_MODULE_1__.kq,useExisting:(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.Rfq)(()=>UiSwitchComponent),multi:!0};let UiSwitchComponent=(()=>{class UiSwitchComponent2{constructor(config={},cdr){this.cdr=cdr,this.change=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB,this.changeEvent=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB,this.valueChange=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB,this.onTouchedCallback=v=>{},this.onChangeCallback=v=>{},this.size=config&&config.size||"medium",this.color=config&&config.color,this.switchOffColor=config&&config.switchOffColor,this.switchColor=config&&config.switchColor,this.defaultBgColor=config&&config.defaultBgColor,this.defaultBoColor=config&&config.defaultBoColor,this.checkedLabel=config&&config.checkedLabel,this.uncheckedLabel=config&&config.uncheckedLabel,this.checkedTextColor=config&&config.checkedTextColor,this.uncheckedTextColor=config&&config.uncheckedTextColor}set checked(v){this._checked=!1!==v}get checked(){return this._checked}set disabled(v){this._disabled=!1!==v}get disabled(){return this._disabled}set reverse(v){this._reverse=!1!==v}get reverse(){return this._reverse}set loading(v){this._loading=!1!==v}get loading(){return this._loading}getColor(flag=""){return"borderColor"===flag?this.defaultBoColor:"switchColor"===flag?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===flag?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===flag?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(event){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(event),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(event){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(confirm=>{confirm&&this.onClick(event)}):this.onClick(event))}writeValue(obj){obj!==this.checked&&(this.checked=!!obj),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(fn){this.onChangeCallback=fn}registerOnTouched(fn){this.onTouchedCallback=fn}setDisabledState(isDisabled){this.disabled=isDisabled}ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}}return UiSwitchComponent2.\u0275fac=function(t){return new(t||UiSwitchComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(UI_SWITCH_OPTIONS,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_0__.gRc))},UiSwitchComponent2.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:UiSwitchComponent2,selectors:[["ui-switch"]],hostBindings:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__.bIt("click",function($event){return ctx.onToggle($event)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.Jv_([UI_SWITCH_CONTROL_VALUE_ACCESSOR])],ngContentSelectors:_c0,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.NAR(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"button",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.DNE(1,UiSwitchComponent_label_1_Template,5,8,"label",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(2,"small"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SdG(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background-color",ctx.getColor())("border-color",ctx.getColor("borderColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.AVh("checked",ctx.checked)("disabled",ctx.disabled)("loading",ctx.loading)("switch-large","large"===ctx.size)("switch-medium","medium"===ctx.size)("switch-small","small"===ctx.size),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-checked",ctx.checked)("aria-label",ctx.ariaLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngIf",ctx.checkedLabel||ctx.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background",ctx.getColor("switchColor")))},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.bT],encapsulation:2}),UiSwitchComponent2})(),UiSwitchModule=(()=>{class UiSwitchModule2{static forRoot(config){return{ngModule:UiSwitchModule2,providers:[{provide:UI_SWITCH_OPTIONS,useValue:config||{}}]}}}return UiSwitchModule2.\u0275fac=function(t){return new(t||UiSwitchModule2)},UiSwitchModule2.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.$C({type:UiSwitchModule2}),UiSwitchModule2.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.G2t({imports:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.MD,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN]}),UiSwitchModule2})()}};