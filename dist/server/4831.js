"use strict";exports.id=4831,exports.ids=[4831,8870],exports.modules={5426:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>SubscriptionModalComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(84739),_angular_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(68014),_angular_forms__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(28955),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(43750),lodash_findIndex__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(84630),lodash_findIndex__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_findIndex__WEBPACK_IMPORTED_MODULE_0__),rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(74785),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(10743),_core_auth_auth_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(41543),_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91735),_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(48168),__webpack_require__(82656)),_alert_alert_component__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(14467),_empty_util__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(77028),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10117),_object_collection_shared_badges_type_badge_themed_type_badge_component__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(83793),_subscriptions_data_service__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(49261),__webpack_require__(18870)),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(71781);function SubscriptionModalComponent_form_0_span_12_ds_type_badge_1_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(0,"ds-type-badge",17),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("object",ctx_r1.dso)}}function SubscriptionModalComponent_form_0_span_12_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"span",15),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(1,SubscriptionModalComponent_form_0_span_12_ds_type_badge_1_Template,1,1,"ds-type-badge",16),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!!ctx_r1.dso)}}function SubscriptionModalComponent_form_0_fieldset_14_div_6_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"div",24),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(1,"input",25),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(2,"label",26),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()()),2&rf){const frequency_r3=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("id","checkbox-"+frequency_r3)("formControlName",frequency_r3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("for","checkbox-"+frequency_r3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(4,4,"subscriptions.modal.new-subscription-form.frequency."+frequency_r3))}}function SubscriptionModalComponent_form_0_fieldset_14_ds_alert_7_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"ds-alert",27),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("type","alert-danger"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(2,2,"context-menu.actions.subscription.frequency.required")," "))}function SubscriptionModalComponent_form_0_fieldset_14_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"fieldset",18)(1,"legend",19),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(4,"div",20),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(5,"input",21),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(6,SubscriptionModalComponent_form_0_fieldset_14_div_6_Template,5,6,"div",22),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(7,SubscriptionModalComponent_form_0_fieldset_14_ds_alert_7_Template,3,4,"ds-alert",23),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf){const subscriptionType_r4=ctx.$implicit,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_10__.FS9("formGroupName",subscriptionType_r4.key),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(3,5,"subscriptions.modal.new-subscription-form.type."+subscriptionType_r4.key),": "),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("value",null==subscriptionType_r4||null==subscriptionType_r4.value?null:subscriptionType_r4.value.controls.subscriptionId.value),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngForOf",ctx_r1.frequencyDefaultValues),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!!ctx_r1.submitted&&(null==subscriptionType_r4||null==subscriptionType_r4.value||null==subscriptionType_r4.value.controls.frequencies.errors?null:subscriptionType_r4.value.controls.frequencies.errors.required))}}function SubscriptionModalComponent_form_0_p_16_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"p",28),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(2,1,"subscriptions.modal.delete-info")))}function SubscriptionModalComponent_form_0_span_24_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nrm(1,"i",29),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(3,1,"subscriptions.modal.new-subscription-form.processing")," "))}function SubscriptionModalComponent_form_0_span_26_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(2,1,"subscriptions.modal.new-subscription-form.submit")," "))}function SubscriptionModalComponent_form_0_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(0,"form",1),_angular_core__WEBPACK_IMPORTED_MODULE_10__.bIt("ngSubmit",function(){_angular_core__WEBPACK_IMPORTED_MODULE_10__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_10__.Njj(ctx_r1.submit())}),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(1,"div",2)(2,"h4",3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(5,"button",4),_angular_core__WEBPACK_IMPORTED_MODULE_10__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_10__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_10__.Njj(ctx_r1.activeModal.close())}),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(6,"span",5),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(7,"\xd7"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()()(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(8,"div",6)(9,"p",7)(10,"strong"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(11),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(12,SubscriptionModalComponent_form_0_span_12_Template,2,1,"span",8),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(13,"div"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(14,SubscriptionModalComponent_form_0_fieldset_14_Template,8,7,"fieldset",9),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(15,"keyvalue"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(16,SubscriptionModalComponent_form_0_p_16_Template,3,3,"p",10),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(17,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(18,"div",11)(19,"button",12),_angular_core__WEBPACK_IMPORTED_MODULE_10__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_10__.eBV(_r1);const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_10__.Njj(ctx_r1.activeModal.close())}),_angular_core__WEBPACK_IMPORTED_MODULE_10__.EFF(20),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(21,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.j41(22,"button",13),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(23,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(24,SubscriptionModalComponent_form_0_span_24_Template,4,3,"span",14),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(25,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(26,SubscriptionModalComponent_form_0_span_26_Template,3,3,"span",14),_angular_core__WEBPACK_IMPORTED_MODULE_10__.nI1(27,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_10__.k0s()()()}if(2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_10__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("formGroup",ctx_r1.subscriptionForm),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(4,10,"subscriptions.modal.title")),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(8),_angular_core__WEBPACK_IMPORTED_MODULE_10__.JRh(ctx_r1.dsoNameService.getName(ctx_r1.dso)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!!ctx_r1.dso),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngForOf",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(15,12,null==ctx_r1.subscriptionForm?null:ctx_r1.subscriptionForm.controls)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(17,14,ctx_r1.showDeleteInfo$)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_10__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(21,16,"subscriptions.modal.close")," "),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("disabled",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(23,18,ctx_r1.processing$)||!ctx_r1.isValid),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(25,20,ctx_r1.processing$)),_angular_core__WEBPACK_IMPORTED_MODULE_10__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",!0!==_angular_core__WEBPACK_IMPORTED_MODULE_10__.bMT(27,22,ctx_r1.processing$))}}let SubscriptionModalComponent=(()=>{class SubscriptionModalComponent2{constructor(formBuilder,modalService,notificationsService,subscriptionService,activeModal,authService,translate,dsoNameService){this.formBuilder=formBuilder,this.modalService=modalService,this.notificationsService=notificationsService,this.subscriptionService=subscriptionService,this.activeModal=activeModal,this.authService=authService,this.translate=translate,this.dsoNameService=dsoNameService,this.processing$=new rxjs__WEBPACK_IMPORTED_MODULE_11__.BehaviorSubject(!1),this.showDeleteInfo$=new rxjs__WEBPACK_IMPORTED_MODULE_11__.BehaviorSubject(!1),this.submitted=!1,this.subscriptionDefaultTypes=["content"],this.frequencyDefaultValues=["D","W","M"],this.isValid=!1,this.updateSubscription=new _angular_core__WEBPACK_IMPORTED_MODULE_10__.bkB}ngOnInit(){this.authService.getAuthenticatedUserFromStore().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.Tj)(ePerson=>ePerson.uuid),(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.shareReplay)({refCount:!1})).subscribe(ePersonId=>{this.ePersonId=ePersonId,(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(this.subscription)?this.initFormByGivenSubscription():this.initFormByAllSubscriptions()}),this.subscriptionForm.valueChanges.subscribe(newValue=>{let anyFrequencySelected=!1;for(const f of this.frequencyDefaultValues)anyFrequencySelected=anyFrequencySelected||newValue.content.frequencies[f];this.isValid=anyFrequencySelected})}initFormByAllSubscriptions(){this.subscriptionForm=new _angular_forms__WEBPACK_IMPORTED_MODULE_14__.J3({});for(const t of this.subscriptionDefaultTypes){const formGroup=new _angular_forms__WEBPACK_IMPORTED_MODULE_14__.J3({});formGroup.addControl("subscriptionId",this.formBuilder.control("")),formGroup.addControl("frequencies",this.formBuilder.group({}));for(const f of this.frequencyDefaultValues)formGroup.controls.frequencies.addControl(f,this.formBuilder.control(!1));this.subscriptionForm.addControl(t,formGroup)}this.initFormDataBySubscriptions()}initFormByGivenSubscription(){const formGroup=new _angular_forms__WEBPACK_IMPORTED_MODULE_14__.J3({});formGroup.addControl("subscriptionId",this.formBuilder.control(this.subscription.id)),formGroup.addControl("frequencies",this.formBuilder.group({})),formGroup.get("frequencies").addValidators(_angular_forms__WEBPACK_IMPORTED_MODULE_14__.k0.required);for(const f of this.frequencyDefaultValues){const value=-1!==lodash_findIndex__WEBPACK_IMPORTED_MODULE_0___default()(this.subscription.subscriptionParameterList,["value",f]);formGroup.controls.frequencies.addControl(f,this.formBuilder.control(value))}this.subscriptionForm=this.formBuilder.group({[this.subscription.subscriptionType]:formGroup})}initFormDataBySubscriptions(){this.processing$.next(!0),this.subscriptionService.getSubscriptionsByPersonDSO(this.ePersonId,this.dso?.uuid).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)()).subscribe({next:res=>{if(res.pageInfo.totalElements>0){this.showDeleteInfo$.next(!0);for(const subscription of res.page){const subscriptionGroup=this.subscriptionForm.get(subscription.subscriptionType);if((0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionGroup)){subscriptionGroup.controls.subscriptionId.setValue(subscription.id);for(const parameter of subscription.subscriptionParameterList.filter(p=>"frequency"===p.name))subscriptionGroup.controls.frequencies.controls[parameter.value]?.setValue(!0)}}}this.processing$.next(!1)},error:err=>{this.processing$.next(!1)}})}submit(){this.submitted=!0;const subscriptionTypes=Object.keys(this.subscriptionForm.controls),subscriptionsToBeCreated=[],subscriptionsToBeUpdated=[];subscriptionTypes.forEach(subscriptionType=>{const subscriptionGroup=this.subscriptionForm.controls[subscriptionType];if(subscriptionGroup.touched&&subscriptionGroup.dirty){const body=this.createBody(subscriptionGroup.controls.subscriptionId.value,subscriptionType,subscriptionGroup.controls.frequencies);(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(body.id)?subscriptionsToBeUpdated.push(body):(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(body.subscriptionParameterList)&&subscriptionsToBeCreated.push(body)}});const toBeProcessed=[];(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionsToBeCreated)&&toBeProcessed.push((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.from)(subscriptionsToBeCreated).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.ZZ)(subscriptionBody=>this.subscriptionService.createSubscription(subscriptionBody,this.ePersonId,this.dso.uuid).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)())),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.Mi)(res=>{if(res.hasSucceeded){const msg=this.translate.instant("subscriptions.modal.create.success",{type:res.payload.subscriptionType});this.notificationsService.success(null,msg)}else this.notificationsService.error(null,this.translate.instant("subscriptions.modal.create.error"))}))),(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionsToBeUpdated)&&toBeProcessed.push((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.from)(subscriptionsToBeUpdated).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.ZZ)(subscriptionBody=>this.subscriptionService.updateSubscription(subscriptionBody,this.ePersonId,this.dso.uuid).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)())),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.Mi)(res=>{if(res.hasSucceeded){const msg=this.translate.instant("subscriptions.modal.update.success",{type:res.payload.subscriptionType});this.notificationsService.success(null,msg),(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(this.subscription)&&this.updateSubscription.emit(res.payload)}else this.notificationsService.error(null,this.translate.instant("subscriptions.modal.update.error"))}))),(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.combineLatest)([...toBeProcessed]).subscribe(res=>{this.activeModal.close()})}createBody(subscriptionId,subscriptionType,frequencies){const body={id:(0,_empty_util__WEBPACK_IMPORTED_MODULE_13__.hj)(subscriptionId)?subscriptionId:null,subscriptionType,subscriptionParameterList:[]};for(const frequency of this.frequencyDefaultValues)frequencies.value[frequency]&&body.subscriptionParameterList.push({name:"frequency",value:frequency});return body}static#_=this.\u0275fac=function(t){return new(t||SubscriptionModalComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_angular_forms__WEBPACK_IMPORTED_MODULE_14__.ze),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_15__.Bq),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_6__.I),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_subscriptions_data_service__WEBPACK_IMPORTED_MODULE_9__.SubscriptionsDataService),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_15__.Lw),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_core_auth_auth_service__WEBPACK_IMPORTED_MODULE_1__.uR),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_10__.rXU(_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_2__.f))};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_10__.VBU({type:SubscriptionModalComponent2,selectors:[["ds-subscription-modal"]],inputs:{dso:"dso",subscription:"subscription"},outputs:{updateSubscription:"updateSubscription"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_10__.aNF],decls:1,vars:1,consts:[["data-test","subscription-form",3,"formGroup","ngSubmit",4,"ngIf"],["data-test","subscription-form",3,"ngSubmit","formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"mb-3"],["class","float-right",4,"ngIf"],["class","form-group form-row",3,"formGroupName",4,"ngFor","ngForOf"],["class","text-muted",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-success",3,"disabled"],[4,"ngIf"],[1,"float-right"],[3,"object",4,"ngIf"],[3,"object"],[1,"form-group","form-row",3,"formGroupName"],[1,"col-md-4","col-form-label","float-md-left","pt-0"],[1,"col-md-8"],["type","hidden","formControlName","subscriptionId",3,"value"],["class","form-check","formGroupName","frequencies",4,"ngFor","ngForOf"],[3,"type",4,"ngIf"],["formGroupName","frequencies",1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","formControlName"],[1,"form-check-label",3,"for"],[3,"type"],[1,"text-muted"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_10__.DNE(0,SubscriptionModalComponent_form_0_Template,28,24,"form",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_10__.Y8G("ngIf",ctx.subscriptionForm)},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_17__.bT,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.qT,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.Zm,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.BC,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.cb,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.X1,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.j4,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.JD,_angular_forms__WEBPACK_IMPORTED_MODULE_14__.$R,_object_collection_shared_badges_type_badge_themed_type_badge_component__WEBPACK_IMPORTED_MODULE_7__.C,_angular_common__WEBPACK_IMPORTED_MODULE_17__.pM,_alert_alert_component__WEBPACK_IMPORTED_MODULE_5__.C,_angular_common__WEBPACK_IMPORTED_MODULE_17__.Jj,_angular_common__WEBPACK_IMPORTED_MODULE_17__.lG,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__.D9]})}return SubscriptionModalComponent2})()},18870:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SubscriptionsDataService:()=>SubscriptionsDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(10743),src_app_core_shared_request_operators__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(59499),_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(91735),_core_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86786),_core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(57699),_core_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40017),_core_data_base_delete_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(43626),_core_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68134),_core_data_base_search_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(19399),_core_data_dso_change_analyzer_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(60279),_core_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(97570),_core_data_request_models__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(87457),_core_data_request_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(72744),_core_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(91365),_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(82656),_empty_util__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(77028),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(10117),_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(32181),_angular_core__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(68014),_angular_common_http__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(38068),_ngrx_store__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(5136);let SubscriptionsDataService=(()=>{class SubscriptionsDataService2 extends _core_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_4__.W{constructor(comparator,http,notificationsService,requestService,rdbService,store,objectCache,halService,nameService){super("subscriptions",requestService,rdbService,objectCache,halService),this.comparator=comparator,this.http=http,this.notificationsService=notificationsService,this.requestService=requestService,this.rdbService=rdbService,this.store=store,this.objectCache=objectCache,this.halService=halService,this.nameService=nameService,this.findByEpersonLinkPath="findByEPerson",this.searchData=new _core_data_base_search_data__WEBPACK_IMPORTED_MODULE_5__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _core_data_base_delete_data__WEBPACK_IMPORTED_MODULE_3__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint)}getSubscriptionsByPersonDSO(eperson,uuid){const optionsWithObject=Object.assign(new _core_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_12__._,{searchParams:[new _core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__.x("resource",uuid),new _core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__.x("eperson_id",eperson)]});return this.searchData.searchBy("findByEPersonAndDso",optionsWithObject,!1,!0)}createSubscription(subscription,ePerson,uuid){return this.halService.getEndpoint(this.linkPath).pipe((0,_empty_util__WEBPACK_IMPORTED_MODULE_14__.VT)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointUrl=>`${endpointUrl}?resource=${uuid}&eperson_id=${ePerson}`),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointURL=>new _core_data_request_models__WEBPACK_IMPORTED_MODULE_7__.QU(this.requestService.generateRequestId(),endpointURL,JSON.stringify(subscription))),(0,src_app_core_shared_request_operators__WEBPACK_IMPORTED_MODULE_16__.w$)(this.requestService),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(restRequest=>this.rdbService.buildFromRequestUUID(restRequest.uuid)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.qD)())}updateSubscription(subscription,ePerson,uuid){return this.halService.getEndpoint(this.linkPath).pipe((0,_empty_util__WEBPACK_IMPORTED_MODULE_14__.VT)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointUrl=>`${endpointUrl}/${subscription.id}?resource=${uuid}&eperson_id=${ePerson}`),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(endpointURL=>new _core_data_request_models__WEBPACK_IMPORTED_MODULE_7__.v_(this.requestService.generateRequestId(),endpointURL,JSON.stringify(subscription))),(0,src_app_core_shared_request_operators__WEBPACK_IMPORTED_MODULE_16__.w$)(this.requestService),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(restRequest=>this.rdbService.buildFromRequestUUID(restRequest.uuid)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.qD)())}deleteSubscription(id){return this.halService.getEndpoint(this.linkPath).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.pb)(href=>(0,_empty_util__WEBPACK_IMPORTED_MODULE_14__.hj)(href)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.F)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(endpointUrl=>this.deleteData.delete(id)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_10__.qD)())}findAllSubscriptions(options){return this.findAllData.findAll(options,!0,!0,(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("resource"),(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("eperson"))}findByEPerson(ePersonId,options){const optionsWithObject=Object.assign(new _core_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_12__._,options,{searchParams:[new _core_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_13__.x("uuid",ePersonId)]});return this.getEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.Tj)(href=>`${href}/search/${this.findByEpersonLinkPath}`),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.nx)(href=>this.findListByHref(href,optionsWithObject,!1,!0,(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("resource"),(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_17__.s)("eperson"))))}static#_=this.\u0275fac=function(t){return new(t||SubscriptionsDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_data_dso_change_analyzer_service__WEBPACK_IMPORTED_MODULE_6__.j),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_angular_common_http__WEBPACK_IMPORTED_MODULE_19__.Qq),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_11__.I),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_data_request_service__WEBPACK_IMPORTED_MODULE_8__.B),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_20__.il),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_9__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_18__.KVO(_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__.f))};static#_2=this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_18__.jDH({token:SubscriptionsDataService2,factory:SubscriptionsDataService2.\u0275fac,providedIn:"root"})}return SubscriptionsDataService2})()},34831:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES});var common=__webpack_require__(84739),ngx_translate_core=__webpack_require__(43750),cjs=__webpack_require__(74785),operators=__webpack_require__(10743),auth_service=__webpack_require__(41543),paginated_list_model=__webpack_require__(12383),pagination_service=__webpack_require__(39304),shared_operators=__webpack_require__(82656),page_info_model=__webpack_require__(59136),alert_component=__webpack_require__(14467),alert_type=__webpack_require__(82555),empty_util=__webpack_require__(77028),themed_loading_component=__webpack_require__(32943),pagination_component=__webpack_require__(91904),pagination_component_options_model=__webpack_require__(64694),core=__webpack_require__(68014),router=__webpack_require__(64247),app_routing_paths=__webpack_require__(45930),dso_name_service=__webpack_require__(91735),confirmation_modal_component=(__webpack_require__(48168),__webpack_require__(32007)),themed_type_badge_component=__webpack_require__(83793),subscription_modal_component=(__webpack_require__(49261),__webpack_require__(5426)),subscriptions_data_service=__webpack_require__(18870),ng_bootstrap=__webpack_require__(71781);const _c0=["ds-subscription-view",""];function SubscriptionViewComponent_ng_container_1_Template(rf,ctx){if(1&rf&&(core.qex(0),core.nrm(1,"ds-type-badge",10),core.j41(2,"p")(3,"a",11),core.EFF(4),core.k0s()(),core.bVm()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("object",ctx_r0.dso),core.R7$(2),core.Y8G("routerLink",ctx_r0.getPageRoute(ctx_r0.dso)),core.R7$(),core.JRh(ctx_r0.dsoNameService.getName(ctx_r0.dso))}}function SubscriptionViewComponent_ng_container_2_Template(rf,ctx){1&rf&&(core.qex(0),core.j41(1,"p",12),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"p",13),core.EFF(5),core.nI1(6,"translate"),core.k0s(),core.bVm()),2&rf&&(core.R7$(2),core.JRh(core.bMT(3,2,"subscriptions.table.not-available")),core.R7$(3),core.JRh(core.bMT(6,4,"subscriptions.table.not-available-message")))}function SubscriptionViewComponent_span_4_Template(rf,ctx){if(1&rf&&(core.j41(0,"span",14),core.EFF(1),core.k0s()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.JRh(ctx_r0.subscription.subscriptionType)}}function SubscriptionViewComponent_ng_container_6_span_1_span_3_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.EFF(1,","),core.k0s())}function SubscriptionViewComponent_ng_container_6_span_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"span"),core.EFF(1),core.nI1(2,"translate"),core.DNE(3,SubscriptionViewComponent_ng_container_6_span_1_span_3_Template,2,0,"span",1),core.k0s()),2&rf){const parameterList_r2=ctx.$implicit,i_r3=ctx.index,ctx_r0=core.XpG(2);core.R7$(),core.SpI(" ",core.bMT(2,2,"subscriptions.frequency."+parameterList_r2.value),""),core.R7$(2),core.Y8G("ngIf",i_r3<ctx_r0.subscription.subscriptionParameterList.length-1)}}function SubscriptionViewComponent_ng_container_6_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,SubscriptionViewComponent_ng_container_6_span_1_Template,4,4,"span",15),core.bVm()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Y8G("ngForOf",ctx_r0.subscription.subscriptionParameterList)}}let SubscriptionViewComponent=(()=>{class SubscriptionViewComponent2{constructor(modalService,subscriptionService,dsoNameService){this.modalService=modalService,this.subscriptionService=subscriptionService,this.dsoNameService=dsoNameService,this.reload=new core.bkB}getPageRoute(dso){return(0,app_routing_paths.wN)(dso)}deleteSubscriptionPopup(subscription){if((0,empty_util.a4)(subscription.id)){const modalRef=this.modalService.open(confirmation_modal_component.M);modalRef.componentInstance.name=this.dsoNameService.getName(this.dso),modalRef.componentInstance.headerLabel="confirmation-modal.delete-subscription.header",modalRef.componentInstance.infoLabel="confirmation-modal.delete-subscription.info",modalRef.componentInstance.cancelLabel="confirmation-modal.delete-subscription.cancel",modalRef.componentInstance.confirmLabel="confirmation-modal.delete-subscription.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.s)(1)).subscribe(confirm=>{confirm&&this.subscriptionService.deleteSubscription(subscription.id).subscribe(res=>{this.reload.emit()})})}}openSubscriptionModal(){this.modalRef=this.modalService.open(subscription_modal_component.w),this.modalRef.componentInstance.dso=this.dso,this.modalRef.componentInstance.subscription=this.subscription,this.modalRef.componentInstance.updateSubscription.pipe((0,operators.s)(1)).subscribe(subscription=>{this.subscription=subscription})}static#_=this.\u0275fac=function(t){return new(t||SubscriptionViewComponent2)(core.rXU(ng_bootstrap.Bq),core.rXU(subscriptions_data_service.SubscriptionsDataService),core.rXU(dso_name_service.f))};static#_2=this.\u0275cmp=core.VBU({type:SubscriptionViewComponent2,selectors:[["","ds-subscription-view",""]],inputs:{subscription:"subscription",dso:"dso",eperson:"eperson"},outputs:{reload:"reload"},standalone:!0,features:[core.aNF],attrs:_c0,decls:15,vars:11,consts:[[1,"dso-info"],[4,"ngIf"],["class","subscription-type",4,"ngIf"],[1,"subscription-parameters"],[1,"subscription-actions"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"click","disabled","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],[3,"object"],[3,"routerLink"],[1,"my-0"],[1,"text-muted","my-0"],[1,"subscription-type"],[4,"ngFor","ngForOf"]],template:function(rf,ctx){1&rf&&(core.j41(0,"td",0),core.DNE(1,SubscriptionViewComponent_ng_container_1_Template,5,3,"ng-container",1)(2,SubscriptionViewComponent_ng_container_2_Template,7,6,"ng-container",1),core.k0s(),core.j41(3,"td"),core.DNE(4,SubscriptionViewComponent_span_4_Template,2,1,"span",2),core.k0s(),core.j41(5,"td",3),core.DNE(6,SubscriptionViewComponent_ng_container_6_Template,2,1,"ng-container",1),core.k0s(),core.j41(7,"td",4)(8,"div",5)(9,"button",6),core.nI1(10,"translate"),core.bIt("click",function($event){return $event.preventDefault(),ctx.openSubscriptionModal()}),core.nrm(11,"i",7),core.k0s(),core.j41(12,"button",8),core.nI1(13,"translate"),core.bIt("click",function(){return ctx.deleteSubscriptionPopup(ctx.subscription)}),core.nrm(14,"i",9),core.k0s()()()),2&rf&&(core.R7$(),core.Y8G("ngIf",!!ctx.dso),core.R7$(),core.Y8G("ngIf",!ctx.dso),core.R7$(2),core.Y8G("ngIf",!!ctx.subscription),core.R7$(2),core.Y8G("ngIf",!!ctx.subscription),core.R7$(3),core.Y8G("disabled",!ctx.dso)("title",core.bMT(10,7,"subscriptions.table.edit")),core.R7$(3),core.Y8G("title",core.bMT(13,9,"subscriptions.table.delete")))},dependencies:[common.bT,themed_type_badge_component.C,router.Wk,common.pM,ngx_translate_core.h,ngx_translate_core.D9]})}return SubscriptionViewComponent2})();var var_directive=__webpack_require__(45961);function SubscriptionsPageComponent_ds_loading_8_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}function SubscriptionsPageComponent_ng_container_10_ds_pagination_1_tr_18_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"tr",13),core.nI1(1,"async"),core.nI1(2,"async"),core.bIt("reload",function(){core.eBV(_r1);const ctx_r1=core.XpG(3);return core.Njj(ctx_r1.refresh())}),core.k0s()}if(2&rf){let tmp_5_0,tmp_6_0;const subscription_r3=ctx.$implicit;core.Y8G("dso",null==(tmp_5_0=core.bMT(1,3,null==subscription_r3?null:subscription_r3.resource))?null:tmp_5_0.payload)("eperson",null==(tmp_6_0=core.bMT(2,5,null==subscription_r3?null:subscription_r3.eperson))||null==tmp_6_0.payload?null:tmp_6_0.payload.id)("subscription",subscription_r3)}}function SubscriptionsPageComponent_ng_container_10_ds_pagination_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-pagination",7)(1,"div",8)(2,"table",9)(3,"thead")(4,"tr")(5,"th",10),core.EFF(6),core.nI1(7,"translate"),core.k0s(),core.j41(8,"th",11),core.EFF(9),core.nI1(10,"translate"),core.k0s(),core.j41(11,"th",11),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"th",11),core.EFF(15),core.nI1(16,"translate"),core.k0s()()(),core.j41(17,"tbody"),core.DNE(18,SubscriptionsPageComponent_ng_container_10_ds_pagination_1_tr_18_Template,3,7,"tr",12),core.k0s()()()()),2&rf){const subscriptions_r4=core.XpG().ngVar,ctx_r1=core.XpG();core.Y8G("paginationOptions",ctx_r1.config)("collectionSize",null==subscriptions_r4||null==subscriptions_r4.pageInfo?null:subscriptions_r4.pageInfo.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),core.R7$(6),core.JRh(core.bMT(7,9,"subscriptions.table.dso")),core.R7$(3),core.JRh(core.bMT(10,11,"subscriptions.table.subscription_type")),core.R7$(3),core.JRh(core.bMT(13,13,"subscriptions.table.subscription_frequency")),core.R7$(3),core.JRh(core.bMT(16,15,"subscriptions.table.action")),core.R7$(3),core.Y8G("ngForOf",null==subscriptions_r4?null:subscriptions_r4.page)}}function SubscriptionsPageComponent_ng_container_10_ds_alert_3_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-alert",14),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const ctx_r1=core.XpG(2);core.Y8G("type",ctx_r1.AlertType.Info),core.R7$(),core.SpI(" ",core.bMT(2,2,"subscriptions.table.empty.message")," ")}}function SubscriptionsPageComponent_ng_container_10_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,SubscriptionsPageComponent_ng_container_10_ds_pagination_1_Template,19,17,"ds-pagination",5),core.nI1(2,"async"),core.DNE(3,SubscriptionsPageComponent_ng_container_10_ds_alert_3_Template,3,4,"ds-alert",6),core.nI1(4,"async"),core.bVm()),2&rf){const subscriptions_r4=ctx.ngVar,ctx_r1=core.XpG();core.R7$(),core.Y8G("ngIf",(null==subscriptions_r4||null==subscriptions_r4.pageInfo?null:subscriptions_r4.pageInfo.totalElements)>0&&!0!==core.bMT(2,2,ctx_r1.loading$)),core.R7$(2),core.Y8G("ngIf",0===(null==subscriptions_r4||null==subscriptions_r4.pageInfo?null:subscriptions_r4.pageInfo.totalElements)&&!0!==core.bMT(4,4,ctx_r1.loading$))}}const ROUTES=[{path:"",data:{title:"subscriptions.title"},children:[{path:"",component:(()=>{class SubscriptionsPageComponent2{constructor(paginationService,authService,subscriptionService){this.paginationService=paginationService,this.authService=authService,this.subscriptionService=subscriptionService,this.subscriptions$=new cjs.BehaviorSubject((0,paginated_list_model.g)(new page_info_model.Q,[])),this.config=Object.assign(new pagination_component_options_model.W,{id:"elp",pageSize:10,currentPage:1}),this.loading$=new cjs.BehaviorSubject(!1),this.sub=null,this.AlertType=alert_type.v}ngOnInit(){this.ePersonId$=this.authService.getAuthenticatedUserFromStore().pipe((0,operators.s)(1),(0,operators.Tj)(ePerson=>ePerson.id),(0,cjs.shareReplay)({refCount:!1})),this.retrieveSubscriptions()}retrieveSubscriptions(){this.sub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,cjs.combineLatestWith)(this.ePersonId$),(0,operators.Mi)(()=>this.loading$.next(!0)),(0,operators.nx)(([currentPagination,ePersonId])=>this.subscriptionService.findByEPerson(ePersonId,{currentPage:currentPagination.currentPage,elementsPerPage:currentPagination.pageSize})),(0,shared_operators.bD)()).subscribe(res=>{res.hasSucceeded&&this.subscriptions$.next(res.payload),this.loading$.next(!1)})}refresh(){(0,empty_util.a4)(this.sub)&&this.sub.unsubscribe(),this.retrieveSubscriptions()}ngOnDestroy(){(0,empty_util.a4)(this.sub)&&this.sub.unsubscribe()}static#_=this.\u0275fac=function(t){return new(t||SubscriptionsPageComponent2)(core.rXU(pagination_service.m),core.rXU(auth_service.uR),core.rXU(subscriptions_data_service.SubscriptionsDataService))};static#_2=this.\u0275cmp=core.VBU({type:SubscriptionsPageComponent2,selectors:[["ds-subscriptions-page"]],standalone:!0,features:[core.aNF],decls:12,vars:9,consts:[[1,"container"],[1,"row"],[1,"col-md-12","m-40"],[4,"ngIf"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["data-test","empty-alert",3,"type",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","formats","data-test","subscription-table",1,"table","table-striped","table-hover"],["scope","col",2,"width","50%"],["scope","col"],["ds-subscription-view","",3,"dso","eperson","subscription","reload",4,"ngFor","ngForOf"],["ds-subscription-view","",3,"reload","dso","eperson","subscription"],["data-test","empty-alert",3,"type"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"div",1)(7,"div",2),core.DNE(8,SubscriptionsPageComponent_ds_loading_8_Template,1,0,"ds-loading",3),core.nI1(9,"async"),core.DNE(10,SubscriptionsPageComponent_ng_container_10_Template,5,6,"ng-container",4),core.nI1(11,"async"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.bMT(5,3,"subscriptions.title")),core.R7$(4),core.Y8G("ngIf",core.bMT(9,5,ctx.loading$)),core.R7$(2),core.Y8G("ngVar",core.bMT(11,7,ctx.subscriptions$)))},dependencies:[common.bT,themed_loading_component.v,var_directive.r,pagination_component.e,common.pM,SubscriptionViewComponent,alert_component.C,common.Jj,ngx_translate_core.h,ngx_translate_core.D9]})}return SubscriptionsPageComponent2})()}]}]}};