"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[237],{90237:(q,u,i)=>{i.r(u),i.d(u,{ROUTES:()=>w});var r=i(54460),c=i(69685),d=i(71217),g=i(88249),f=i(64476),p=i(37610),h=i(47947),v=i(82040),S=i(22867),I=i(21706),R=i(5338),T=i(95438),y=i(12007),$=i(36423),F=i(96858),P=i(16700),l=i(72683),E=i(21548),G=i(51661),j=i(67899),t=i(53107),C=i(95968),M=i(31829),V=i(83116),N=(i(47587),i(14922)),Y=i(15614),D=(i(6548),i(49559)),b=i(75665),x=i(2155);const X=["ds-subscription-view",""];function O(s,a){if(1&s&&(t.qex(0),t.nrm(1,"ds-type-badge",10),t.j41(2,"p")(3,"a",11),t.EFF(4),t.k0s()(),t.bVm()),2&s){const n=t.XpG();t.R7$(),t.Y8G("object",n.dso),t.R7$(2),t.Y8G("routerLink",n.getPageRoute(n.dso)),t.R7$(),t.JRh(n.dsoNameService.getName(n.dso))}}function U(s,a){1&s&&(t.qex(0),t.j41(1,"p",12),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"p",13),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.bVm()),2&s&&(t.R7$(2),t.JRh(t.bMT(3,2,"subscriptions.table.not-available")),t.R7$(3),t.JRh(t.bMT(6,4,"subscriptions.table.not-available-message")))}function J(s,a){if(1&s&&(t.j41(0,"span",14),t.EFF(1),t.k0s()),2&s){const n=t.XpG();t.R7$(),t.JRh(n.subscription.subscriptionType)}}function L(s,a){1&s&&(t.j41(0,"span"),t.EFF(1,","),t.k0s())}function B(s,a){if(1&s&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"translate"),t.DNE(3,L,2,0,"span",1),t.k0s()),2&s){const n=a.$implicit,e=a.index,o=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,2,"subscriptions.frequency."+n.value),""),t.R7$(2),t.Y8G("ngIf",e<o.subscription.subscriptionParameterList.length-1)}}function W(s,a){if(1&s&&(t.qex(0),t.DNE(1,B,4,4,"span",15),t.bVm()),2&s){const n=t.XpG();t.R7$(),t.Y8G("ngForOf",n.subscription.subscriptionParameterList)}}let z=(()=>{class s{constructor(n,e,o){this.modalService=n,this.subscriptionService=e,this.dsoNameService=o,this.reload=new t.bkB}getPageRoute(n){return(0,M.wN)(n)}deleteSubscriptionPopup(n){if((0,l.a4)(n.id)){const e=this.modalService.open(N.M);e.componentInstance.name=this.dsoNameService.getName(this.dso),e.componentInstance.headerLabel="confirmation-modal.delete-subscription.header",e.componentInstance.infoLabel="confirmation-modal.delete-subscription.info",e.componentInstance.cancelLabel="confirmation-modal.delete-subscription.cancel",e.componentInstance.confirmLabel="confirmation-modal.delete-subscription.confirm",e.componentInstance.brandColor="danger",e.componentInstance.confirmIcon="fas fa-trash",e.componentInstance.response.pipe((0,p.s)(1)).subscribe(o=>{o&&this.subscriptionService.deleteSubscription(n.id).subscribe(m=>{this.reload.emit()})})}}openSubscriptionModal(){this.modalRef=this.modalService.open(D.w),this.modalRef.componentInstance.dso=this.dso,this.modalRef.componentInstance.subscription=this.subscription,this.modalRef.componentInstance.updateSubscription.pipe((0,p.s)(1)).subscribe(n=>{this.subscription=n})}static#t=this.\u0275fac=function(e){return new(e||s)(t.rXU(x.Bq),t.rXU(b.SubscriptionsDataService),t.rXU(V.f))};static#n=this.\u0275cmp=t.VBU({type:s,selectors:[["","ds-subscription-view",""]],inputs:{subscription:"subscription",dso:"dso",eperson:"eperson"},outputs:{reload:"reload"},standalone:!0,features:[t.aNF],attrs:X,decls:15,vars:11,consts:[[1,"dso-info"],[4,"ngIf"],["class","subscription-type",4,"ngIf"],[1,"subscription-parameters"],[1,"subscription-actions"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"click","disabled","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],[3,"object"],[3,"routerLink"],[1,"my-0"],[1,"text-muted","my-0"],[1,"subscription-type"],[4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.j41(0,"td",0),t.DNE(1,O,5,3,"ng-container",1)(2,U,7,6,"ng-container",1),t.k0s(),t.j41(3,"td"),t.DNE(4,J,2,1,"span",2),t.k0s(),t.j41(5,"td",3),t.DNE(6,W,2,1,"ng-container",1),t.k0s(),t.j41(7,"td",4)(8,"div",5)(9,"button",6),t.nI1(10,"translate"),t.bIt("click",function(_){return _.preventDefault(),o.openSubscriptionModal()}),t.nrm(11,"i",7),t.k0s(),t.j41(12,"button",8),t.nI1(13,"translate"),t.bIt("click",function(){return o.deleteSubscriptionPopup(o.subscription)}),t.nrm(14,"i",9),t.k0s()()()),2&e&&(t.R7$(),t.Y8G("ngIf",!!o.dso),t.R7$(),t.Y8G("ngIf",!o.dso),t.R7$(2),t.Y8G("ngIf",!!o.subscription),t.R7$(2),t.Y8G("ngIf",!!o.subscription),t.R7$(3),t.Y8G("disabled",!o.dso)("title",t.bMT(10,7,"subscriptions.table.edit")),t.R7$(3),t.Y8G("title",t.bMT(13,9,"subscriptions.table.delete")))},dependencies:[r.bT,Y.C,C.Wk,r.pM,c.h,c.D9]})}return s})();var A=i(63524);function k(s,a){1&s&&t.nrm(0,"ds-loading")}function Q(s,a){if(1&s){const n=t.RV6();t.j41(0,"tr",13),t.nI1(1,"async"),t.nI1(2,"async"),t.bIt("reload",function(){t.eBV(n);const o=t.XpG(3);return t.Njj(o.refresh())}),t.k0s()}if(2&s){let n,e;const o=a.$implicit;t.Y8G("dso",null==(n=t.bMT(1,3,null==o?null:o.resource))?null:n.payload)("eperson",null==(e=t.bMT(2,5,null==o?null:o.eperson))||null==e.payload?null:e.payload.id)("subscription",o)}}function H(s,a){if(1&s&&(t.j41(0,"ds-pagination",7)(1,"div",8)(2,"table",9)(3,"thead")(4,"tr")(5,"th",10),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"th",11),t.EFF(9),t.nI1(10,"translate"),t.k0s(),t.j41(11,"th",11),t.EFF(12),t.nI1(13,"translate"),t.k0s(),t.j41(14,"th",11),t.EFF(15),t.nI1(16,"translate"),t.k0s()()(),t.j41(17,"tbody"),t.DNE(18,Q,3,7,"tr",12),t.k0s()()()()),2&s){const n=t.XpG().ngVar,e=t.XpG();t.Y8G("paginationOptions",e.config)("collectionSize",null==n||null==n.pageInfo?null:n.pageInfo.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),t.R7$(6),t.JRh(t.bMT(7,9,"subscriptions.table.dso")),t.R7$(3),t.JRh(t.bMT(10,11,"subscriptions.table.subscription_type")),t.R7$(3),t.JRh(t.bMT(13,13,"subscriptions.table.subscription_frequency")),t.R7$(3),t.JRh(t.bMT(16,15,"subscriptions.table.action")),t.R7$(3),t.Y8G("ngForOf",null==n?null:n.page)}}function K(s,a){if(1&s&&(t.j41(0,"ds-alert",14),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&s){const n=t.XpG(2);t.Y8G("type",n.AlertType.Info),t.R7$(),t.SpI(" ",t.bMT(2,2,"subscriptions.table.empty.message")," ")}}function Z(s,a){if(1&s&&(t.qex(0),t.DNE(1,H,19,17,"ds-pagination",5),t.nI1(2,"async"),t.DNE(3,K,3,4,"ds-alert",6),t.nI1(4,"async"),t.bVm()),2&s){const n=a.ngVar,e=t.XpG();t.R7$(),t.Y8G("ngIf",(null==n||null==n.pageInfo?null:n.pageInfo.totalElements)>0&&!0!==t.bMT(2,2,e.loading$)),t.R7$(2),t.Y8G("ngIf",0===(null==n||null==n.pageInfo?null:n.pageInfo.totalElements)&&!0!==t.bMT(4,4,e.loading$))}}const w=[{path:"",data:{title:"subscriptions.title"},children:[{path:"",component:(()=>{class s{constructor(n,e,o){this.paginationService=n,this.authService=e,this.subscriptionService=o,this.subscriptions$=new d.t((0,R.g)(new $.Q,[])),this.config=Object.assign(new j.W,{id:"elp",pageSize:10,currentPage:1}),this.loading$=new d.t(!1),this.sub=null,this.AlertType=P.v}ngOnInit(){this.ePersonId$=this.authService.getAuthenticatedUserFromStore().pipe((0,p.s)(1),(0,h.T)(n=>n.id),(0,g.t)({refCount:!1})),this.retrieveSubscriptions()}retrieveSubscriptions(){this.sub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,f.v)(this.ePersonId$),(0,v.M)(()=>this.loading$.next(!0)),(0,S.n)(([n,e])=>this.subscriptionService.findByEPerson(e,{currentPage:n.currentPage,elementsPerPage:n.pageSize})),(0,y.bD)()).subscribe(n=>{n.hasSucceeded&&this.subscriptions$.next(n.payload),this.loading$.next(!1)})}refresh(){(0,l.a4)(this.sub)&&this.sub.unsubscribe(),this.retrieveSubscriptions()}ngOnDestroy(){(0,l.a4)(this.sub)&&this.sub.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||s)(t.rXU(T.m),t.rXU(I.uR),t.rXU(b.SubscriptionsDataService))};static#n=this.\u0275cmp=t.VBU({type:s,selectors:[["ds-subscriptions-page"]],standalone:!0,features:[t.aNF],decls:12,vars:9,consts:[[1,"container"],[1,"row"],[1,"col-md-12","m-40"],[4,"ngIf"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["data-test","empty-alert",3,"type",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","formats","data-test","subscription-table",1,"table","table-striped","table-hover"],["scope","col",2,"width","50%"],["scope","col"],["ds-subscription-view","",3,"dso","eperson","subscription","reload",4,"ngFor","ngForOf"],["ds-subscription-view","",3,"reload","dso","eperson","subscription"],["data-test","empty-alert",3,"type"]],template:function(e,o){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t.EFF(4),t.nI1(5,"translate"),t.k0s(),t.j41(6,"div",1)(7,"div",2),t.DNE(8,k,1,0,"ds-loading",3),t.nI1(9,"async"),t.DNE(10,Z,5,6,"ng-container",4),t.nI1(11,"async"),t.k0s()()()()()),2&e&&(t.R7$(4),t.JRh(t.bMT(5,3,"subscriptions.title")),t.R7$(4),t.Y8G("ngIf",t.bMT(9,5,o.loading$)),t.R7$(2),t.Y8G("ngVar",t.bMT(11,7,o.subscriptions$)))},dependencies:[r.bT,E.v,A.r,G.e,r.pM,z,F.C,r.Jj,c.h,c.D9]})}return s})()}]}]}}]);