(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[8176],{72553:(x,g,n)=>{"use strict";n.d(g,{Q:()=>m});class m{constructor(a,l){this.text=a,this.url=l}}},78176:(x,g,n)=>{"use strict";n.r(g),n.d(g,{ROUTES:()=>C});var m=n(32588),u=n(21124),l=(n(32598),n(53107));const p=["*"];function v(s,$){}const C=[{path:"",component:(()=>{class s extends u.J{getComponentName(){return"CommunityListPageComponent"}importThemedComponent(h){return n(24768)(`./${h}/app/community-list-page/community-list-page.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,32598))}static#t=this.\u0275fac=(()=>{let h;return function(E){return(h||(h=l.xGo(s)))(E||s)}})();static#e=this.\u0275cmp=l.VBU({type:s,selectors:[["ds-community-list-page"]],standalone:!0,features:[l.Vt3,l.aNF],ngContentSelectors:p,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(T,E){1&T&&(l.NAR(),l.DNE(0,v,0,0,"ng-template",null,0,l.C5r),l.j41(2,"div",null,1),l.SdG(4),l.k0s())},encapsulation:2})}return s})(),pathMatch:"full",resolve:{breadcrumb:m.S},data:{title:"communityList.tabTitle",breadcrumbKey:"communityList"}}]},32598:(x,g,n)=>{"use strict";n.r(g),n.d(g,{CommunityListPageComponent:()=>l});var m=n(69685),u=n(8915),a=n(53107);let l=(()=>{class p{static#t=this.\u0275fac=function(C){return new(C||p)};static#e=this.\u0275cmp=a.VBU({type:p,selectors:[["ds-base-community-list-page"]],standalone:!0,features:[a.aNF],decls:5,vars:3,consts:[[1,"container"]],template:function(C,s){1&C&&(a.j41(0,"div",0)(1,"h1"),a.EFF(2),a.nI1(3,"translate"),a.k0s(),a.nrm(4,"ds-community-list"),a.k0s()),2&C&&(a.R7$(2),a.JRh(a.bMT(3,1,"communityList.title")))},dependencies:[u.A,m.h,m.D9],encapsulation:2})}return p})()},52016:(x,g,n)=>{"use strict";n.r(g),n.d(g,{CommunityListComponent:()=>Pt});var m=n(50282),u=n(54460),a=n(95968),l=n(69685),p=n(37610),v=n(83116),y=n(89632),C=n(36705),s=n(72683),$=n(21548),h=n(37362),T=n(93527),E=n(71217),H=n(24447);class Q{constructor(c){this.communityListService=c,this.communityList$=new E.t([]),this.loading$=new E.t(!1)}connect(c){return this.communityList$.asObservable()}loadCommunities(c,e){this.loading$.next(!0),(0,s.a4)(this.subLoadCommunities)&&this.subLoadCommunities.unsubscribe(),this.subLoadCommunities=this.communityListService.loadCommunities(c,e).pipe((0,H.j)(()=>this.loading$.next(!1))).subscribe(i=>{this.communityList$.next(i)})}disconnect(c){this.communityList$.complete(),this.loading$.complete()}}var j=n(73958),M=n(76627),I=n(63016),b=n(47947),Z=n(41483),W=n(22867),w=n(18062),X=n(30661),_=n(68605),q=n(67873),tt=n(8109),et=n(63710),nt=n(5338),ot=n(82376),G=n(12007),it=n(36423),F=n(24106),st=n(42742);class at{}var t=n(53107);const O=o=>(0,M.z)([...o]).pipe((0,b.T)(c=>[].concat(...c)),(0,Z.p)(c=>c.every(e=>(0,s.a4)(e)))),V=(o,c,e,i,d)=>({isExpandable$:c,name:o.name,id:o.id,level:e,isExpanded:i,parent:d,payload:o,isShowMoreNode:!1,route:o instanceof ot.E?(0,q.c5)(o.id):(0,_.JW)(o.id)}),z=(o,c,e)=>({isExpandable$:(0,I.of)(!1),name:"Show More Flatnode",id:o,level:c,isExpanded:!1,parent:e,payload:new at,isShowMoreNode:!0}),K=o=>o.communityList,dt=(0,j.Mz)(K,o=>o.expandedNodes),rt=(0,j.Mz)(K,o=>o.loadingNode);let ct=(()=>{class o{constructor(e,i,d,r){this.appConfig=e,this.communityDataService=i,this.collectionDataService=d,this.store=r,this.configOnePage=Object.assign(new C._,{elementsPerPage:1}),this.pageSize=e.communityList.pageSize}saveCommunityListStateToStore(e,i){this.store.dispatch(new st.H(e,i))}getExpandedNodesFromStore(){return this.store.select(dt)}getLoadingNodeFromStore(){return this.store.select(rt)}loadCommunities(e,i){const d=e.currentPage,r=[];for(let f=1;f<=d;f++){const N=Object.assign({},e,{currentPage:f});r.push(this.getTopCommunities(N))}return(0,M.z)([...r]).pipe((0,b.T)(f=>{const N=f.map(k=>k.page),D=[].concat(...N);let R=new it.Q;return f&&f.length>0&&(R=Object.assign({},f[0].pageInfo,{currentPage:d})),(0,nt.g)(R,D)})).pipe((0,W.n)(f=>this.transformListOfCommunities(f,0,null,i)))}getTopCommunities(e){return this.communityDataService.findTop({currentPage:e.currentPage,elementsPerPage:this.pageSize,sort:{field:e.sort.field,direction:e.sort.direction}},(0,F.s)("subcommunities",{findListOptions:this.configOnePage}),(0,F.s)("collections",{findListOptions:this.configOnePage})).pipe((0,G.yd)(),(0,b.T)(i=>i.payload))}transformListOfCommunities(e,i,d,r){if((0,s.hj)(e.page)){let L=e.currentPage;(0,s.hj)(d)&&(L=r.find(N=>N.id===d.id).currentCommunityPage);let f=e.page.map(N=>this.transformCommunity(N,i,d,r));return L<e.totalPages&&L===e.currentPage&&(f=[...f,(0,I.of)([z(`community-${(0,X.A)()}`,i,d)])]),O(f)}return(0,I.of)([])}transformCommunity(e,i,d,r){let L=!1;(0,s.hj)(r)&&(L=(0,s.a4)(r.find(R=>R.id===e.id)));const f=this.getIsExpandable(e),N=V(e,f,i,L,d);let D=[(0,I.of)([N])];if(L){const R=r.find(P=>P.id===e.id).currentCommunityPage;let k=[];for(let P=1;P<=R;P++){const Y=this.communityDataService.findByParent(e.uuid,{elementsPerPage:this.pageSize,currentPage:P},(0,F.s)("subcommunities",{findListOptions:this.configOnePage}),(0,F.s)("collections",{findListOptions:this.configOnePage})).pipe((0,G.qD)(),(0,W.n)(S=>(0,s.a4)(S)&&(0,s.a4)(S.payload)?this.transformListOfCommunities(S.payload,i+1,N,r):(0,I.of)([])));k=[...k,Y]}D=[...D,O(k)];const B=r.find(P=>P.id===e.id).currentCollectionPage;let U=[];for(let P=1;P<=B;P++){const Y=this.collectionDataService.findByParent(e.uuid,{elementsPerPage:this.pageSize,currentPage:P}).pipe((0,G.qD)(),(0,b.T)(S=>{if((0,s.a4)(S)&&(0,s.a4)(S.payload)){let A=S.payload.page.map(Lt=>V(Lt,(0,I.of)(!1),i+1,!1,N));return B<S.payload.totalPages&&B===S.payload.currentPage&&(A=[...A,z(`collection-${(0,X.A)()}`,i+1,N)]),A}return[]}));U=[...U,Y]}D=[...D,O(U)]}return O(D)}getIsExpandable(e){const i=this.communityDataService.findByParent(e.uuid,this.configOnePage).pipe((0,b.T)(r=>!(!(0,s.a4)(r)||!(0,s.a4)(r.payload))&&r.payload.totalElements>0)),d=this.collectionDataService.findByParent(e.uuid,this.configOnePage).pipe((0,b.T)(r=>!(!(0,s.a4)(r)||!(0,s.a4)(r.payload))&&r.payload.totalElements>0));return(0,M.z)(i,d).pipe((0,b.T)(([r,L])=>r||L))}static#t=this.\u0275fac=function(i){return new(i||o)(t.KVO(w.vQ),t.KVO(et.CommunityDataService),t.KVO(tt.CollectionDataService),t.KVO(j.il))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const J=o=>({name:o});function mt(o,c){1&o&&t.nrm(0,"ds-loading",5)}function lt(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){t.eBV(e);const d=t.XpG().$implicit,r=t.XpG();return t.Njj(r.getNextPage(d))}),t.nrm(1,"i",15),t.EFF(2),t.nI1(3,"translate"),t.k0s()}2&o&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"communityList.showMore")," "))}function ut(o,c){1&o&&t.nrm(0,"ds-loading",5)}function pt(o,c){if(1&o&&(t.j41(0,"cdk-tree-node",6)(1,"div",7)(2,"span",8),t.nrm(3,"span",9),t.k0s(),t.j41(4,"div",10),t.DNE(5,lt,4,3,"button",11),t.nI1(6,"async"),t.DNE(7,ut,1,0,"ds-loading",0),t.nI1(8,"async"),t.k0s()(),t.j41(9,"div",12),t.nrm(10,"div",13),t.k0s()()),2&o){const e=c.$implicit,i=t.XpG();t.R7$(5),t.Y8G("ngIf",!0!==t.bMT(6,2,i.dataSource.loading$)),t.R7$(2),t.Y8G("ngIf",t.bMT(8,4,e===i.loadingNode&&i.dataSource.loading$))}}function gt(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",27),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(e);const d=t.XpG().$implicit,r=t.XpG();return t.Njj(r.toggleExpanded(d))}),t.nrm(2,"span",28),t.j41(3,"span",29),t.EFF(4),t.nI1(5,"translate"),t.k0s()()}if(2&o){const e=t.XpG().$implicit,i=t.XpG();t.BMQ("aria-label",t.i5U(1,5,e.isExpanded?"communityList.collapse":"communityList.expand",t.eq3(11,J,i.dsoNameService.getName(e.payload)))),t.R7$(2),t.HbH(e.isExpanded?"fa fa-chevron-down":"fa fa-chevron-right"),t.R7$(2),t.JRh(t.i5U(5,8,e.isExpanded?"communityList.collapse":"communityList.expand",t.eq3(13,J,i.dsoNameService.getName(e.payload))))}}function ft(o,c){1&o&&(t.j41(0,"span",30),t.nrm(1,"span",9),t.k0s())}function ht(o,c){if(1&o&&(t.j41(0,"span",31),t.EFF(1),t.k0s()),2&o){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.payload.archivedItemsCount)}}function yt(o,c){if(1&o&&(t.j41(0,"div",13)(1,"span",30),t.nrm(2,"span",9),t.k0s(),t.j41(3,"ds-truncatable-part",32)(4,"span"),t.EFF(5),t.k0s()()()),2&o){const e=t.XpG().$implicit;t.R7$(3),t.Y8G("id",e.id)("minLines",3),t.R7$(2),t.JRh(e.payload.shortDescription)}}function vt(o,c){1&o&&(t.j41(0,"div",33)(1,"span",30),t.nrm(2,"span",9),t.k0s(),t.nrm(3,"ds-loading",5),t.k0s())}function Ct(o,c){if(1&o&&(t.j41(0,"cdk-tree-node",16)(1,"div",7),t.DNE(2,gt,6,15,"button",17),t.nI1(3,"async"),t.DNE(4,ft,2,0,"span",18),t.nI1(5,"async"),t.j41(6,"div",19)(7,"span",20)(8,"a",21),t.EFF(9),t.k0s(),t.j41(10,"span",22),t.EFF(11,"\xa0"),t.k0s(),t.DNE(12,ht,2,1,"span",23),t.k0s()()(),t.j41(13,"ds-truncatable",24)(14,"div",12),t.DNE(15,yt,6,3,"div",25),t.k0s()(),t.DNE(16,vt,4,0,"div",26),t.nI1(17,"async"),t.k0s()),2&o){const e=c.$implicit,i=t.XpG();t.R7$(2),t.Y8G("ngIf",t.bMT(3,8,i.hasChild(null,e))),t.R7$(2),t.Y8G("ngIf",!0!==t.bMT(5,10,i.hasChild(null,e))),t.R7$(4),t.Y8G("routerLink",e.route),t.R7$(),t.JRh(i.dsoNameService.getName(e.payload)),t.R7$(3),t.Y8G("ngIf",e.payload.archivedItemsCount>=0),t.R7$(),t.Y8G("id",e.id),t.R7$(2),t.Y8G("ngIf",e.payload.shortDescription),t.R7$(),t.Y8G("ngIf",t.bMT(17,12,e===i.loadingNode&&i.dataSource.loading$))}}function Nt(o,c){if(1&o&&(t.j41(0,"div",13)(1,"span",30),t.nrm(2,"span",9),t.k0s(),t.j41(3,"ds-truncatable-part",32)(4,"span"),t.EFF(5),t.k0s()()()),2&o){const e=t.XpG().$implicit;t.R7$(3),t.Y8G("id",e.id)("minLines",3),t.R7$(2),t.JRh(e.payload.shortDescription)}}function Tt(o,c){if(1&o&&(t.j41(0,"cdk-tree-node",34)(1,"div",7)(2,"span",8),t.nrm(3,"span",9),t.k0s(),t.j41(4,"h6",10)(5,"a",21),t.EFF(6),t.k0s()()(),t.j41(7,"ds-truncatable",24)(8,"div",12),t.DNE(9,Nt,6,3,"div",25),t.k0s()()()),2&o){const e=c.$implicit,i=t.XpG();t.R7$(5),t.Y8G("routerLink",e.route),t.R7$(),t.JRh(i.dsoNameService.getName(e.payload)),t.R7$(),t.Y8G("id",e.id),t.R7$(2),t.Y8G("ngIf",e.payload.shortDescription)}}let Pt=(()=>{class o{constructor(e,i){this.communityListService=e,this.dsoNameService=i,this.expandedNodes=[],this.treeControl=new m.XW(d=>d.level,d=>!0),this.trackBy=(d,r)=>r.id,this.paginationConfig=new C._,this.paginationConfig.elementsPerPage=2,this.paginationConfig.currentPage=1,this.paginationConfig.sort=new y.z("dc.title",y.U.ASC)}ngOnInit(){this.dataSource=new Q(this.communityListService),this.communityListService.getLoadingNodeFromStore().pipe((0,p.s)(1)).subscribe(e=>{this.loadingNode=e}),this.communityListService.getExpandedNodesFromStore().pipe((0,p.s)(1)).subscribe(e=>{this.expandedNodes=[...e],this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)})}ngOnDestroy(){this.communityListService.saveCommunityListStateToStore(this.expandedNodes,this.loadingNode)}hasChild(e,i){return i.isExpandable$}isShowMore(e,i){return i.isShowMoreNode}toggleExpanded(e){this.loadingNode=e,e.isExpanded?(this.expandedNodes=this.expandedNodes.filter(i=>i.id!==e.id),e.isExpanded=!1):(this.expandedNodes.push(e),e.isExpanded=!0,(0,s.Im)(e.currentCollectionPage)&&(e.currentCollectionPage=1),(0,s.Im)(e.currentCommunityPage)&&(e.currentCommunityPage=1)),this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)}getNextPage(e){this.loadingNode=e,null!=e.parent?(e.id.startsWith("collection")&&this.expandedNodes.find(d=>e.parent.id===d.id).currentCollectionPage++,e.id.startsWith("community")&&this.expandedNodes.find(d=>e.parent.id===d.id).currentCommunityPage++):this.paginationConfig.currentPage++,this.dataSource.loadCommunities(this.paginationConfig,this.expandedNodes)}static#t=this.\u0275fac=function(i){return new(i||o)(t.rXU(ct),t.rXU(v.f))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["ds-base-community-list"]],standalone:!0,features:[t.aNF],decls:6,vars:9,consts:[["class","ds-themed-loading",4,"ngIf"],[3,"dataSource","treeControl","trackBy"],["cdkTreeNodePadding","","class","example-tree-node show-more-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],["cdkTreeNodePadding","","class","example-tree-node expandable-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],["cdkTreeNodePadding","","class","example-tree-node childless-node",4,"cdkTreeNodeDef","cdkTreeNodeDefWhen"],[1,"ds-themed-loading"],["cdkTreeNodePadding","",1,"example-tree-node","show-more-node"],[1,"btn-group"],["aria-hidden","true","cdkTreeNodeToggle","",1,"btn","btn-default","invisible"],[1,"fa","fa-chevron-right"],[1,"align-middle","my-auto"],["class","btn btn-outline-primary btn-sm","role","button",3,"click",4,"ngIf"],["cdkTreeNodePadding","",1,"text-muted"],[1,"d-flex"],["role","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fas","fa-angle-down"],["cdkTreeNodePadding","",1,"example-tree-node","expandable-node"],["type","button","class","btn btn-default","cdkTreeNodeToggle","","data-test","expand-button",3,"click",4,"ngIf"],["aria-hidden","true","class","btn btn-default invisible",4,"ngIf"],[1,"d-flex","flex-row"],[1,"d-flex","align-middle","my-auto"],[1,"lead",3,"routerLink"],[1,"pr-2"],["class","badge badge-pill badge-secondary align-top archived-items-lead my-auto",4,"ngIf"],[3,"id"],["class","d-flex",4,"ngIf"],["class","d-flex","cdkTreeNodePadding","",4,"ngIf"],["type","button","cdkTreeNodeToggle","","data-test","expand-button",1,"btn","btn-default",3,"click"],["aria-hidden","true"],[1,"sr-only"],["aria-hidden","true",1,"btn","btn-default","invisible"],[1,"badge","badge-pill","badge-secondary","align-top","archived-items-lead","my-auto"],[3,"id","minLines"],["cdkTreeNodePadding","",1,"d-flex"],["cdkTreeNodePadding","",1,"example-tree-node","childless-node"]],template:function(i,d){1&i&&(t.DNE(0,mt,1,0,"ds-loading",0),t.nI1(1,"async"),t.j41(2,"cdk-tree",1),t.DNE(3,pt,11,6,"cdk-tree-node",2)(4,Ct,18,14,"cdk-tree-node",3)(5,Tt,10,4,"cdk-tree-node",4),t.k0s()),2&i&&(t.Y8G("ngIf",t.bMT(1,7,d.dataSource.loading$)&&!d.loadingNode),t.R7$(2),t.Y8G("dataSource",d.dataSource)("treeControl",d.treeControl)("trackBy",d.trackBy),t.R7$(),t.Y8G("cdkTreeNodeDefWhen",d.isShowMore),t.R7$(),t.Y8G("cdkTreeNodeDefWhen",d.hasChild),t.R7$(),t.Y8G("cdkTreeNodeDefWhen",!(d.hasChild&&d.isShowMore)))},dependencies:[u.bT,$.v,m.Dc,m.Sz,m.aI,m.Hy,m.NL,m.xn,a.Wk,h.d,T.W,u.Jj,l.h,l.D9],styles:[".fa-chevron-right:before{display:block;width:16px}"]})}return o})()},8915:(x,g,n)=>{"use strict";n.d(g,{A:()=>v});var m=n(21124),a=(n(52016),n(53107));const l=["*"];function p(y,C){}let v=(()=>{class y extends m.J{getComponentName(){return"CommunityListComponent"}importThemedComponent(s){return n(89367)(`./${s}/app/community-list-page/community-list/community-list.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(n,52016))}static#t=this.\u0275fac=(()=>{let s;return function(h){return(s||(s=a.xGo(y)))(h||y)}})();static#e=this.\u0275cmp=a.VBU({type:y,selectors:[["ds-community-list"]],standalone:!0,features:[a.Vt3,a.aNF],ngContentSelectors:l,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function($,h){1&$&&(a.NAR(),a.DNE(0,p,0,0,"ng-template",null,0,a.C5r),a.j41(2,"div",null,1),a.SdG(4),a.k0s())},encapsulation:2})}return y})()},32588:(x,g,n)=>{"use strict";n.d(g,{S:()=>C});var m=n(53107),u=n(72683),a=n(67044),l=n(63016),p=n(72553);let y=(()=>{class s{getBreadcrumbs(h,T){return(0,l.of)([new p.Q(h+".breadcrumbs",T)])}static#t=this.\u0275fac=function(T){return new(T||s)};static#e=this.\u0275prov=m.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();const C=(s,$,h=(0,m.WQX)(y))=>{const T=s.data.breadcrumbKey;if((0,u.Tn)(T))throw new Error('You provided an i18nBreadcrumbResolver for url "'+s.url+"\" but no breadcrumbKey in the route's data");return{provider:h,key:T,url:(0,a.F)(s)}}},24768:(x,g,n)=>{var m={"./custom/app/community-list-page/community-list-page.component":[40493,493]};function u(a){if(!n.o(m,a))return Promise.resolve().then(()=>{var v=new Error("Cannot find module '"+a+"'");throw v.code="MODULE_NOT_FOUND",v});var l=m[a],p=l[0];return n.e(l[1]).then(()=>n(p))}u.keys=()=>Object.keys(m),u.id=24768,x.exports=u},89367:(x,g,n)=>{var m={"./custom/app/community-list-page/community-list/community-list.component":[88520,8520]};function u(a){if(!n.o(m,a))return Promise.resolve().then(()=>{var v=new Error("Cannot find module '"+a+"'");throw v.code="MODULE_NOT_FOUND",v});var l=m[a],p=l[0];return n.e(l[1]).then(()=>n(p))}u.keys=()=>Object.keys(m),u.id=89367,x.exports=u}}]);