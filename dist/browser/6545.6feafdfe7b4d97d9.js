"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[6545],{66545:(P,v,r)=>{r.r(v),r.d(v,{ROUTES:()=>ge});var u=r(32588),M=r(55521),d=r(54460),p=r(95968),m=r(69685),$=r(71217),I=r(35466),f=r(76627),V=r(41483),_=r(22867),g=r(37610),S=r(47947),T=r(95438),F=r(84940),y=r(12007),j=r(72683),E=r(79224),G=r(51661),X=r(36705);function x(s,l){return Object.assign(new X._,l,{currentPage:s.currentPage,elementsPerPage:s.pageSize})}var C=r(67899),e=r(53107),h=r(89593),B=r(82040),k=r(54254),N=r(28022),O=r(36590);function A(s,l){1&s&&e.nrm(0,"div")}function J(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".create"))}}function D(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".edit"))}}let L=(()=>{class s{constructor(t,a,i){this.registryService=t,this.formBuilderService=a,this.translateService=i,this.formId="metadata-schema-form",this.messagePrefix="admin.registries.metadata.form",this.formLayout={name:{grid:{host:"col col-sm-6 d-inline-block"}},namespace:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new e.bkB}ngOnInit(){(0,f.z)([this.translateService.get(`${this.messagePrefix}.name`),this.translateService.get(`${this.messagePrefix}.namespace`)]).subscribe(([t,a])=>{this.name=new h.rA_({id:"name",label:t,name:"name",validators:{required:null,pattern:"^[^. ,]*$",maxLength:32},required:!0,errorMessages:{pattern:"error.validation.metadata.name.invalid-pattern",maxLength:"error.validation.metadata.name.max-length"}}),this.namespace=new h.rA_({id:"namespace",label:a,name:"namespace",validators:{required:null,maxLength:256},required:!0,errorMessages:{maxLength:"error.validation.metadata.namespace.max-length"}}),this.formModel=[new h.iO5({id:"metadatadataschemagroup",group:[this.namespace,this.name]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.registryService.getActiveMetadataSchema().subscribe(i=>{null==i?this.clearFields():(this.formGroup.patchValue({metadatadataschemagroup:{name:i.prefix,namespace:i.namespace}}),this.name.disabled=!0)})})}onCancel(){this.registryService.cancelEditMetadataSchema()}onSubmit(){this.registryService.getActiveMetadataSchema().pipe((0,g.s)(1),(0,_.n)(t=>{const a={prefix:this.name.value,namespace:this.namespace.value};let i;if(null==t)i=this.registryService.createOrUpdateMetadataSchema(Object.assign(new k.p,a));else{const n=Object.assign(new k.p,t,{namespace:a.namespace});i=this.registryService.createOrUpdateMetadataSchema(n)}return i}),(0,B.M)(()=>{this.registryService.clearMetadataSchemaRequests().subscribe()})).subscribe(t=>{this.submitForm.emit(t),this.clearFields(),this.registryService.cancelEditMetadataSchema()})}clearFields(){this.formGroup.reset("metadatadataschemagroup"),this.name.disabled=!1}ngOnDestroy(){this.onCancel()}static#e=this.\u0275fac=function(a){return new(a||s)(e.rXU(F.x),e.rXU(N.j),e.rXU(m.c$))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-schema-form"]],outputs:{submitForm:"submitForm"},standalone:!0,features:[e.aNF],decls:7,vars:9,consts:[["createHeader",""],["editheader",""],[4,"ngIf","ngIfThen","ngIfElse"],[3,"cancel","submitForm","formId","formModel","formGroup","formLayout"]],template:function(a,i){if(1&a){const n=e.RV6();e.DNE(0,A,1,0,"div",2),e.nI1(1,"async"),e.DNE(2,J,3,3,"ng-template",null,0,e.C5r)(4,D,3,3,"ng-template",null,1,e.C5r),e.j41(6,"ds-form",3),e.bIt("cancel",function(){return e.eBV(n),e.Njj(i.onCancel())})("submitForm",function(){return e.eBV(n),e.Njj(i.onSubmit())}),e.k0s()}if(2&a){const n=e.sdS(3),c=e.sdS(5);e.Y8G("ngIf",e.bMT(1,7,i.registryService.getActiveMetadataSchema()))("ngIfThen",c)("ngIfElse",n),e.R7$(6),e.Y8G("formId",i.formId)("formModel",i.formModel)("formGroup",i.formGroup)("formLayout",i.formLayout)}},dependencies:[d.bT,d.Jj,m.h,m.D9,O.s],encapsulation:2})}return s})();const Y=s=>({"table-primary":s}),R=s=>[s];function z(s,l){if(1&s){const t=e.RV6();e.j41(0,"tr",15),e.nI1(1,"async"),e.j41(2,"td")(3,"label",16)(4,"input",17),e.nI1(5,"async"),e.bIt("change",function(i){const n=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.selectMetadataSchema(n,i))}),e.k0s(),e.j41(6,"span",13),e.EFF(7),e.nI1(8,"async"),e.nI1(9,"translate"),e.k0s()()(),e.j41(10,"td",18),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.editSchema(i))}),e.j41(11,"a",19),e.EFF(12),e.k0s()(),e.j41(13,"td",18),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.editSchema(i))}),e.j41(14,"a",19),e.EFF(15),e.k0s()(),e.j41(16,"td",18),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.editSchema(i))}),e.j41(17,"a",19),e.EFF(18),e.k0s()()()}if(2&s){const t=l.$implicit,a=e.XpG(2);e.Y8G("ngClass",e.eq3(17,Y,e.bMT(1,9,a.isActive(t)))),e.R7$(4),e.Y8G("checked",e.bMT(5,11,a.isSelected(t))),e.R7$(3),e.JRh(e.bMT(9,15,e.bMT(8,13,a.isSelected(t))?"admin.registries.metadata.schemas.deselect":"admin.registries.metadata.schemas.select")),e.R7$(4),e.Y8G("routerLink",e.eq3(19,R,t.prefix)),e.R7$(),e.JRh(t.id),e.R7$(2),e.Y8G("routerLink",e.eq3(21,R,t.prefix)),e.R7$(),e.JRh(t.namespace),e.R7$(2),e.Y8G("routerLink",e.eq3(23,R,t.prefix)),e.R7$(),e.JRh(t.prefix)}}function W(s,l){if(1&s&&(e.j41(0,"ds-pagination",9),e.nI1(1,"async"),e.j41(2,"div",10)(3,"table",11)(4,"thead")(5,"tr")(6,"th",12)(7,"span",13),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"th",12),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"th",12),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"th",12),e.EFF(17),e.nI1(18,"translate"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,z,19,25,"tr",14),e.nI1(21,"async"),e.k0s()()()()),2&s){let t,a;const i=e.XpG();e.Y8G("paginationOptions",i.config)("collectionSize",null==(t=e.bMT(1,9,i.metadataSchemas))||null==t.payload?null:t.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),e.R7$(8),e.JRh(e.bMT(9,11,"admin.registries.metadata.schemas.table.selected")),e.R7$(3),e.JRh(e.bMT(12,13,"admin.registries.metadata.schemas.table.id")),e.R7$(3),e.JRh(e.bMT(15,15,"admin.registries.metadata.schemas.table.namespace")),e.R7$(3),e.JRh(e.bMT(18,17,"admin.registries.metadata.schemas.table.name")),e.R7$(3),e.Y8G("ngForOf",null==(a=e.bMT(21,19,i.metadataSchemas))||null==a.payload?null:a.payload.page)}}function w(s,l){1&s&&(e.j41(0,"div",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"admin.registries.metadata.schemas.no-items")," "))}function H(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.deleteSchemas())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"admin.registries.metadata.schemas.table.delete")))}let K=(()=>{class s{constructor(t,a,i,n,c){this.registryService=t,this.notificationsService=a,this.router=i,this.paginationService=n,this.translateService=c,this.config=Object.assign(new C.W,{id:"rm",pageSize:25}),this.needsUpdate$=new $.t(!0),this.updateSchemas()}updateSchemas(){this.metadataSchemas=this.needsUpdate$.pipe((0,V.p)(t=>!0===t),(0,_.n)(()=>this.paginationService.getCurrentPagination(this.config.id,this.config)),(0,_.n)(t=>this.registryService.getMetadataSchemas(x(t))))}forceUpdateSchemas(){this.needsUpdate$.next(!0)}editSchema(t){this.getActiveSchema().pipe((0,g.s)(1)).subscribe(a=>{t===a?this.registryService.cancelEditMetadataSchema():this.registryService.editMetadataSchema(t)})}isActive(t){return this.getActiveSchema().pipe((0,S.T)(a=>t===a))}getActiveSchema(){return this.registryService.getActiveMetadataSchema()}selectMetadataSchema(t,a){a.target.checked?this.registryService.selectMetadataSchema(t):this.registryService.deselectMetadataSchema(t)}isSelected(t){return this.registryService.getSelectedMetadataSchemas().pipe((0,S.T)(a=>null!=a.find(i=>i===t)))}deleteSchemas(){this.registryService.getSelectedMetadataSchemas().pipe((0,g.s)(1)).subscribe(t=>{const a=[];for(const i of t)(0,j.a4)(i.id)&&a.push(this.registryService.deleteMetadataSchema(i.id).pipe((0,y.qD)()));(0,I.y)(...a).subscribe(i=>{const n=i.filter(o=>o.hasSucceeded),c=i.filter(o=>o.hasFailed);n.length>0&&this.showNotification(!0,n.length),c.length>0&&this.showNotification(!1,c.length),this.registryService.deselectAllMetadataSchema(),this.registryService.cancelEditMetadataSchema()})})}showNotification(t,a){const i="admin.registries.schema.notification",n=t?"success":"failure";(0,f.z)(this.translateService.get(`${i}.${n}`),this.translateService.get(`${i}.deleted.${n}`,{amount:a})).subscribe(([o,b])=>{t?this.notificationsService.success(o,b):this.notificationsService.error(o,b)})}ngOnDestroy(){this.paginationService.clearPagination(this.config.id)}static#e=this.\u0275fac=function(a){return new(a||s)(e.rXU(F.x),e.rXU(E.I),e.rXU(p.Ix),e.rXU(T.m),e.rXU(m.c$))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-registry"]],standalone:!0,features:[e.aNF],decls:17,vars:15,consts:[[1,"container"],[1,"metadata-registry","row"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"submitForm"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],["type","submit","class","btn btn-danger float-right",3,"click",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","metadata-schemas",1,"table","table-striped","table-hover"],["scope","col"],[1,"sr-only"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"mb-0"],["type","checkbox",3,"change","checked"],[1,"selectable-row",3,"click"],[3,"routerLink"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["type","submit",1,"btn","btn-danger","float-right",3,"click"]],template:function(a,i){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"p",4),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"ds-metadata-schema-form",5),e.bIt("submitForm",function(){return i.forceUpdateSchemas()}),e.k0s(),e.DNE(10,W,22,21,"ds-pagination",6),e.nI1(11,"async"),e.DNE(12,w,3,3,"div",7),e.nI1(13,"async"),e.j41(14,"div"),e.DNE(15,H,3,3,"button",8),e.nI1(16,"async"),e.k0s()()()()),2&a){let n,c,o;e.R7$(4),e.JRh(e.bMT(5,5,"admin.registries.metadata.head")),e.R7$(3),e.JRh(e.bMT(8,7,"admin.registries.metadata.description")),e.R7$(3),e.Y8G("ngIf",(null==(n=e.bMT(11,9,i.metadataSchemas))||null==n.payload?null:n.payload.totalElements)>0),e.R7$(2),e.Y8G("ngIf",0===(null==(c=e.bMT(13,11,i.metadataSchemas))||null==c.payload?null:c.payload.totalElements)),e.R7$(3),e.Y8G("ngIf",(null==(o=e.bMT(16,13,i.metadataSchemas))||null==o.payload||null==o.payload.page?null:o.payload.page.length)>0)}},dependencies:[L,m.h,m.D9,d.Jj,G.e,d.bT,d.Sq,d.YU,p.Wk],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]     #metadatadataschemagroup{display:flex}"]})}return s})();var q=r(63016),Q=r(63524),U=r(78827);function Z(s,l){1&s&&e.nrm(0,"div")}function ee(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".create"))}}function te(s,l){if(1&s&&(e.j41(0,"h2"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.messagePrefix+".edit"))}}let ae=(()=>{class s{constructor(t,a,i){this.registryService=t,this.formBuilderService=a,this.translateService=i,this.formId="metadata-field-form",this.messagePrefix="admin.registries.schema.form",this.formLayout={element:{grid:{host:"col col-sm-6 d-inline-block"}},qualifier:{grid:{host:"col col-sm-6 d-inline-block"}},scopeNote:{grid:{host:"col col-sm-12 d-inline-block"}}},this.submitForm=new e.bkB}ngOnInit(){(0,f.z)([this.translateService.get(`${this.messagePrefix}.element`),this.translateService.get(`${this.messagePrefix}.qualifier`),this.translateService.get(`${this.messagePrefix}.scopenote`)]).subscribe(([t,a,i])=>{this.element=new h.rA_({id:"element",label:t,name:"element",validators:{required:null,pattern:"^[^. ,]*$",maxLength:64},required:!0,errorMessages:{pattern:"error.validation.metadata.element.invalid-pattern",maxLength:"error.validation.metadata.element.max-length"}}),this.qualifier=new h.rA_({id:"qualifier",label:a,name:"qualifier",validators:{pattern:"^[^. ,]*$",maxLength:64},required:!1,errorMessages:{pattern:"error.validation.metadata.qualifier.invalid-pattern",maxLength:"error.validation.metadata.qualifier.max-length"}}),this.scopeNote=new h.Zex({id:"scopeNote",label:i,name:"scopeNote",required:!1,rows:5}),this.formModel=[new h.iO5({id:"metadatadatafieldgroup",group:[this.element,this.qualifier,this.scopeNote]})],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.registryService.getActiveMetadataField().subscribe(n=>{null==n?this.clearFields():(this.formGroup.patchValue({metadatadatafieldgroup:{element:n.element,qualifier:n.qualifier,scopeNote:n.scopeNote}}),this.element.disabled=!0,this.qualifier.disabled=!0)})})}onCancel(){this.registryService.cancelEditMetadataField()}onSubmit(){this.registryService.getActiveMetadataField().pipe((0,g.s)(1)).subscribe(t=>{null==t?this.registryService.createMetadataField(Object.assign(new U.A,{element:this.element.value,qualifier:this.qualifier.value,scopeNote:this.scopeNote.value}),this.metadataSchema).subscribe(a=>{this.submitForm.emit(a)}):this.registryService.updateMetadataField(Object.assign(new U.A,t,{id:t.id,element:t.element,qualifier:t.qualifier,scopeNote:this.scopeNote.value})).subscribe(a=>{this.submitForm.emit(a)}),this.clearFields(),this.registryService.cancelEditMetadataField()})}clearFields(){this.formGroup.reset("metadatadatafieldgroup"),this.element.disabled=!1,this.qualifier.disabled=!1}ngOnDestroy(){this.onCancel()}static#e=this.\u0275fac=function(a){return new(a||s)(e.rXU(F.x),e.rXU(N.j),e.rXU(m.c$))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-field-form"]],inputs:{metadataSchema:"metadataSchema"},outputs:{submitForm:"submitForm"},standalone:!0,features:[e.aNF],decls:7,vars:9,consts:[["createHeader",""],["editheader",""],[4,"ngIf","ngIfThen","ngIfElse"],[3,"cancel","submit","formId","formModel","formLayout","formGroup"]],template:function(a,i){if(1&a){const n=e.RV6();e.DNE(0,Z,1,0,"div",2),e.nI1(1,"async"),e.DNE(2,ee,3,3,"ng-template",null,0,e.C5r)(4,te,3,3,"ng-template",null,1,e.C5r),e.j41(6,"ds-form",3),e.bIt("cancel",function(){return e.eBV(n),e.Njj(i.onCancel())})("submit",function(){return e.eBV(n),e.Njj(i.onSubmit())}),e.k0s()}if(2&a){const n=e.sdS(3),c=e.sdS(5);e.Y8G("ngIf",e.bMT(1,7,i.registryService.getActiveMetadataField()))("ngIfThen",c)("ngIfElse",n),e.R7$(6),e.Y8G("formId",i.formId)("formModel",i.formModel)("formLayout",i.formLayout)("formGroup",i.formGroup)}},dependencies:[d.bT,O.s,m.h,m.D9,d.Jj],encapsulation:2})}return s})();const ie=s=>({namespace:s}),se=()=>["/admin/registries/metadata"],ne=s=>({"table-primary":s});function re(s,l){if(1&s){const t=e.RV6();e.j41(0,"td")(1,"input",20),e.nI1(2,"translate"),e.bIt("change",function(i){e.eBV(t);const n=e.XpG().$implicit,c=e.XpG(4);return e.Njj(c.selectMetadataField(n,i))}),e.k0s()()}if(2&s){const t=l.ngVar;e.R7$(),e.Y8G("checked",t),e.BMQ("aria-label",e.bMT(2,2,t?"admin.registries.schema.fields.deselect":"admin.registries.schema.fields.select"))}}function ce(s,l){if(1&s){const t=e.RV6();e.j41(0,"tr",18),e.nI1(1,"async"),e.DNE(2,re,3,4,"td",7),e.nI1(3,"async"),e.j41(4,"td",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.editField(i))}),e.EFF(5),e.k0s(),e.j41(6,"td",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.editField(i))}),e.EFF(7),e.k0s(),e.j41(8,"td",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(4);return e.Njj(n.editField(i))}),e.EFF(9),e.k0s()()}if(2&s){const t=l.$implicit,a=e.XpG(3).ngVar,i=e.XpG();e.Y8G("ngClass",e.eq3(11,ne,e.bMT(1,7,i.isActive(t)))),e.R7$(2),e.Y8G("ngVar",e.bMT(3,9,i.isSelected(t))),e.R7$(3),e.JRh(t.id),e.R7$(2),e.E5c("",null==a?null:a.prefix,".",t.element,"",t.qualifier?"."+t.qualifier:"",""),e.R7$(2),e.JRh(t.scopeNote)}}function le(s,l){if(1&s&&(e.j41(0,"ds-pagination",12)(1,"div",13)(2,"table",14)(3,"thead")(4,"tr")(5,"th")(6,"span",15),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"th",16),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"th",16),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"th",16),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"tbody"),e.DNE(19,ce,10,13,"tr",17),e.k0s()()()()),2&s){const t=e.XpG().ngVar,a=e.XpG(2);e.Y8G("paginationOptions",a.config)("collectionSize",null==t?null:t.totalElements)("hideGear",!1)("hidePagerWhenSinglePage",!0),e.R7$(7),e.JRh(e.bMT(8,9,"admin.registries.schema.fields.table.selected")),e.R7$(3),e.JRh(e.bMT(11,11,"admin.registries.schema.fields.table.id")),e.R7$(3),e.JRh(e.bMT(14,13,"admin.registries.schema.fields.table.field")),e.R7$(3),e.JRh(e.bMT(17,15,"admin.registries.schema.fields.table.scopenote")),e.R7$(3),e.Y8G("ngForOf",null==t?null:t.page)}}function oe(s,l){1&s&&(e.j41(0,"div",21),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&s&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"admin.registries.schema.fields.no-items")," "))}function de(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.deleteFields())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&s&&(e.R7$(),e.JRh(e.bMT(2,1,"admin.registries.schema.fields.table.delete")))}function me(s,l){if(1&s&&(e.qex(0),e.DNE(1,le,20,17,"ds-pagination",8)(2,oe,3,3,"div",9),e.j41(3,"div")(4,"button",10),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.DNE(7,de,3,3,"button",11),e.k0s(),e.bVm()),2&s){const t=l.ngVar;e.R7$(),e.Y8G("ngIf",(null==t?null:t.totalElements)>0),e.R7$(),e.Y8G("ngIf",0===(null==t?null:t.totalElements)),e.R7$(2),e.Y8G("routerLink",e.lJ4(7,se)),e.R7$(),e.JRh(e.bMT(6,5,"admin.registries.schema.return")),e.R7$(2),e.Y8G("ngIf",(null==t||null==t.page?null:t.page.length)>0)}}function he(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",3)(1,"h1",4),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"p",5),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"ds-metadata-field-form",6),e.bIt("submitForm",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.forceUpdateFields())}),e.k0s(),e.j41(8,"h2"),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.DNE(11,me,8,8,"ng-container",7),e.nI1(12,"async"),e.k0s()}if(2&s){let t;const a=l.ngVar,i=e.XpG();e.R7$(2),e.Lme("",e.bMT(3,6,"admin.registries.schema.head"),': "',null==a?null:a.prefix,'"'),e.R7$(3),e.JRh(e.i5U(6,8,"admin.registries.schema.description",e.eq3(15,ie,null==a?null:a.namespace))),e.R7$(2),e.Y8G("metadataSchema",a),e.R7$(2),e.JRh(e.bMT(10,11,"admin.registries.schema.fields.head")),e.R7$(2),e.Y8G("ngVar",null==(t=e.bMT(12,13,i.metadataFields$))?null:t.payload)}}const ge=[{path:"metadata",resolve:{breadcrumb:u.S},data:{title:"admin.registries.metadata.title",breadcrumbKey:"admin.registries.metadata"},children:[{path:"",component:K},{path:":schemaName",resolve:{breadcrumb:u.S},component:(()=>{class s{constructor(t,a,i,n,c){this.registryService=t,this.route=a,this.notificationsService=i,this.paginationService=n,this.translateService=c,this.config=Object.assign(new C.W,{id:"rm",pageSize:25,pageSizeOptions:[25,50,100,200]}),this.needsUpdate$=new $.t(!0)}ngOnInit(){this.route.params.subscribe(t=>{this.initialize(t)})}initialize(t){this.metadataSchema$=this.registryService.getMetadataSchemaByPrefix(t.schemaName).pipe((0,y.ak)()),this.updateFields()}updateFields(){this.metadataFields$=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,_.n)(t=>(0,f.z)([this.metadataSchema$,this.needsUpdate$,(0,q.of)(t)])),(0,_.n)(([t,a,i])=>(a&&this.needsUpdate$.next(!1),this.registryService.getMetadataFieldsBySchema(t,x(i),!a,!0))))}forceUpdateFields(){this.registryService.clearMetadataFieldRequests(),this.needsUpdate$.next(!0)}editField(t){this.getActiveField().pipe((0,g.s)(1)).subscribe(a=>{t===a?this.registryService.cancelEditMetadataField():this.registryService.editMetadataField(t)})}isActive(t){return this.getActiveField().pipe((0,S.T)(a=>t===a))}getActiveField(){return this.registryService.getActiveMetadataField()}selectMetadataField(t,a){a.target.checked?this.registryService.selectMetadataField(t):this.registryService.deselectMetadataField(t)}isSelected(t){return this.registryService.getSelectedMetadataFields().pipe((0,S.T)(a=>null!=a.find(i=>i===t)))}deleteFields(){this.registryService.getSelectedMetadataFields().pipe((0,g.s)(1)).subscribe(t=>{const a=[];for(const i of t)(0,j.a4)(i.id)&&a.push(this.registryService.deleteMetadataField(i.id).pipe((0,y.qD)()));(0,I.y)(...a).subscribe(i=>{const n=i.filter(o=>o.hasSucceeded),c=i.filter(o=>o.hasFailed);n.length>0&&this.showNotification(!0,n.length),c.length>0&&this.showNotification(!1,c.length),this.registryService.deselectAllMetadataField(),this.registryService.cancelEditMetadataField()})})}showNotification(t,a){const i="admin.registries.schema.notification",n=t?"success":"failure";(0,f.z)([this.translateService.get(`${i}.${n}`),this.translateService.get(`${i}.field.deleted.${n}`,{amount:a})]).subscribe(([o,b])=>{t?this.notificationsService.success(o,b):this.notificationsService.error(o,b)})}ngOnDestroy(){this.paginationService.clearPagination(this.config.id),this.registryService.deselectAllMetadataField()}static#e=this.\u0275fac=function(a){return new(a||s)(e.rXU(F.x),e.rXU(p.nX),e.rXU(E.I),e.rXU(T.m),e.rXU(m.c$))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["ds-metadata-schema"]],standalone:!0,features:[e.aNF],decls:4,vars:3,consts:[[1,"container"],[1,"metadata-schema","row"],["class","col-12",4,"ngVar"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","description",1,"pb-2"],[3,"submitForm","metadataSchema"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[1,"btn","btn-primary",3,"routerLink"],["type","submit","class","btn btn-danger float-right",3,"click",4,"ngIf"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","metadata-fields",1,"table","table-striped","table-hover"],[1,"sr-only"],["scope","col"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"selectable-row",3,"click"],["type","checkbox",3,"change","checked"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["type","submit",1,"btn","btn-danger","float-right",3,"click"]],template:function(a,i){1&a&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,he,13,17,"div",2),e.nI1(3,"async"),e.k0s()()),2&a&&(e.R7$(2),e.Y8G("ngVar",e.bMT(3,1,i.metadataSchema$)))},dependencies:[d.Jj,Q.r,ae,m.h,m.D9,G.e,d.bT,d.Sq,d.YU,p.Wk],styles:[".selectable-row[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]     #metadatadatafieldgroup{display:flex;flex-wrap:wrap}"]})}return s})(),data:{title:"admin.registries.schema.title",breadcrumbKey:"admin.registries.schema"}}]},{path:M.B,resolve:{breadcrumb:u.S},loadChildren:()=>r.e(1165).then(r.bind(r,71165)).then(s=>s.ROUTES),data:{title:"admin.registries.bitstream-formats.title",breadcrumbKey:"admin.registries.bitstream-formats"}}]},55521:(P,v,r)=>{r.d(v,{B:()=>d,J:()=>p});var u=r(87913),M=r(56405);const d="bitstream-formats";function p(){return new u.t((0,M.P$)(),d).toString()}}}]);