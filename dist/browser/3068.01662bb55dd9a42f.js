"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[3068,7897],{77897:(R,k,i)=>{i.r(k),i.d(k,{BulkAccessConfigDataService:()=>C});var c=i(45122),h=i(25718),p=i(9843),S=i(25744),D=i(16397),_=i(53107);let C=(()=>{class g extends D.O{constructor(m,b,o,d){super("bulkaccessconditionoptions",m,b,o,d),this.requestService=m,this.rdbService=b,this.objectCache=o,this.halService=d}static#e=this.\u0275fac=function(b){return new(b||g)(_.KVO(p.B),_.KVO(c.o),_.KVO(h.$),_.KVO(S.Y))};static#t=this.\u0275prov=_.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},16397:(R,k,i)=>{i.d(k,{O:()=>S});var c=i(47947),h=i(2887),p=i(12007);class S extends h.W{findByHref(_,C=!0,g=!0,...T){return super.findByHref(_,C,g,...T).pipe((0,p.qD)(),(0,c.T)(m=>{if(m.hasFailed)throw new Error("Couldn't retrieve the config");return m}))}findByName(_,C=!0,g=!0,...T){return super.findById(_,C,g,...T)}}},93068:(R,k,i)=>{i.d(k,{o:()=>ce});var c=i(54460),h=i(10936),p=i(69685),S=i(61299),D=i(88249),_=i(81459),C=i(47947),g=i(37610),T=i(77897),b=(i(21314),i(12007)),o=i(96858),d=i(16700),v=i(82219),u=i(2155),I=i(75988),e=i(53107);let A=(()=>{class a{transform(t){if(!t)return null;const n=new Date(t);return{year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()}}static#e=this.\u0275fac=function(n){return new(n||a)};static#t=this.\u0275pipe=e.EJ8({name:"toDate",type:a,pure:!1,standalone:!0})}return a})();const F=["ngForm"];function O(a,f){1&a&&(e.j41(0,"div",7),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"access-control-no-access-conditions-warning-message")," "))}function L(a,f){if(1&a&&(e.j41(0,"option",20),e.EFF(1),e.k0s()),2&a){const t=f.$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function w(a,f){if(1&a){const t=e.RV6();e.j41(0,"div",21)(1,"label",10),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",17)(5,"input",22,1),e.nI1(7,"toDate"),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG().$implicit;return e.DH7(r.startDate,s)||(r.startDate=s),e.Njj(s)}),e.k0s(),e.j41(8,"div",23)(9,"button",24),e.bIt("click",function(){e.eBV(t);const s=e.sdS(6);return e.Njj(s.toggle())}),e.k0s()()(),e.j41(10,"small",14),e.EFF(11),e.nI1(12,"translate"),e.k0s()()}if(2&a){const t=e.XpG().$implicit;e.XpG();const n=e.sdS(1);e.R7$(),e.Mz_("for","accesscontrolstartdate-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(3,11,"access-control-option-start-date")," "),e.R7$(3),e.Mz_("id","accesscontrolstartdate-",t.id,""),e.Mz_("name","startDate-",t.id,""),e.R50("ngModel",t.startDate),e.Y8G("maxDate",e.bMT(7,13,t.maxStartDate)),e.R7$(4),e.Y8G("disabled",n.disabled),e.R7$(2),e.SpI(" ",e.bMT(12,15,"access-control-option-start-date-note")," ")}}function G(a,f){if(1&a){const t=e.RV6();e.j41(0,"div",21)(1,"label",10),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",17)(5,"input",22,2),e.nI1(7,"toDate"),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG().$implicit;return e.DH7(r.endDate,s)||(r.endDate=s),e.Njj(s)}),e.k0s(),e.j41(8,"div",23)(9,"button",24),e.bIt("click",function(){e.eBV(t);const s=e.sdS(6);return e.Njj(s.toggle())}),e.k0s()()(),e.j41(10,"small",14),e.EFF(11),e.nI1(12,"translate"),e.k0s()()}if(2&a){const t=e.XpG().$implicit;e.XpG();const n=e.sdS(1);e.R7$(),e.Mz_("for","accesscontrolenddate-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(3,11,"access-control-option-end-date")," "),e.R7$(3),e.Mz_("id","accesscontrolenddate-",t.id,""),e.Mz_("name","endDate-",t.id,""),e.R50("ngModel",t.endDate),e.Y8G("maxDate",e.bMT(7,13,t.maxEndDate)),e.R7$(4),e.Y8G("disabled",n.disabled),e.R7$(2),e.SpI(" ",e.bMT(12,15,"access-control-option-end-date-note")," ")}}function $(a,f){if(1&a){const t=e.RV6();e.qex(0),e.j41(1,"div",8)(2,"div",9)(3,"div")(4,"label",10),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"select",11),e.mxI("ngModelChange",function(s){const r=e.eBV(t).$implicit;return e.DH7(r.itemName,s)||(r.itemName=s),e.Njj(s)}),e.bIt("ngModelChange",function(s){const r=e.eBV(t).$implicit,M=e.XpG();return e.Njj(M.accessControlChanged(r,s))}),e.nrm(8,"option",12),e.DNE(9,L,2,2,"option",13),e.k0s(),e.j41(10,"small",14),e.EFF(11),e.nI1(12,"translate"),e.k0s()(),e.DNE(13,w,13,17,"div",15)(14,G,13,17,"div",15),e.k0s(),e.j41(15,"div")(16,"span",16),e.EFF(17,"\xa0"),e.k0s(),e.j41(18,"div",17)(19,"button",18),e.nI1(20,"translate"),e.bIt("click",function(){const s=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.removeAccessControlItem(s.id))}),e.nrm(21,"i",19),e.k0s()()()(),e.bVm()}if(2&a){const t=f.$implicit,n=e.XpG(),s=e.sdS(1);e.R7$(),e.Mz_("ngModelGroup","access-control-item-",t.id,""),e.R7$(3),e.Mz_("for","accesscontroloption-",t.id,""),e.R7$(),e.SpI(" ",e.bMT(6,17,"access-control-option-label")," "),e.R7$(2),e.Mz_("id","accesscontroloption-",t.id,""),e.Mz_("name","itemName-",t.id,""),e.Y8G("disabled",s.disabled),e.R50("ngModel",t.itemName),e.R7$(2),e.Y8G("ngForOf",n.dropdownOptions),e.R7$(2),e.SpI(" ",e.bMT(12,19,"access-control-option-note")," "),e.R7$(2),e.Y8G("ngIf",t.hasStartDate),e.R7$(),e.Y8G("ngIf",t.hasEndDate),e.R7$(5),e.Y8G("disabled",s.disabled||1===n.form.accessControls.length),e.BMQ("aria-label",e.bMT(20,21,"access-control-remove"))}}let N=(()=>{class a{constructor(){this.dropdownOptions=[],this.form={accessControls:[y()]},this.formDisabled=!0,this.disable=()=>{this.ngForm.form.disable(),this.formDisabled=!0},this.enable=()=>{this.ngForm.form.enable(),this.formDisabled=!1}}ngOnInit(){this.disable()}get allControlsAreEmpty(){return this.form.accessControls.every(t=>null===t.itemName||""===t.itemName)}get showWarning(){return"replace"===this.mode&&this.allControlsAreEmpty&&!this.formDisabled}addAccessControlItem(t=null){this.form.accessControls=[...this.form.accessControls,{...y(),itemName:t}]}removeAccessControlItem(t){this.form.accessControls=this.form.accessControls.filter(n=>n.id!==t)}getValue(){return this.form.accessControls.filter(t=>null!==t.itemName&&""!==t.itemName).map(t=>({name:t.itemName,startDate:t.startDate?(0,I.Sd)(t.startDate):null,endDate:t.endDate?(0,I.Sd)(t.endDate):null}))}reset(){this.form.accessControls=[],this.addAccessControlItem(),this.disable()}accessControlChanged(t,n){const s=this.dropdownOptions.find(r=>r.name===n);t.startDate=null,t.endDate=null,t.hasStartDate=s?.hasStartDate||!1,t.hasEndDate=s?.hasEndDate||!1,t.maxStartDate=s?.maxStartDate||null,t.maxEndDate=s?.maxEndDate||null}trackById(t,n){return n.id}static#e=this.\u0275fac=function(n){return new(n||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["ds-access-control-array-form"]],viewQuery:function(n,s){if(1&n&&e.GBs(F,7),2&n){let r;e.mGM(r=e.lsd())&&(s.ngForm=r.first)}},inputs:{dropdownOptions:"dropdownOptions",mode:"mode",type:"type"},exportAs:["accessControlArrayForm"],standalone:!0,features:[e.aNF],decls:8,vars:9,consts:[["ngForm","ngForm"],["d","ngbDatepicker"],["d1","ngbDatepicker"],["class","alert alert-warning",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-outline-primary","mt-3",3,"click","id","disabled"],[1,"fas","fa-plus"],[1,"alert","alert-warning"],[1,"access-control-item","mt-3",3,"ngModelGroup"],[1,"d-flex","flex-column"],[3,"for"],[1,"form-control",3,"ngModelChange","id","disabled","ngModel","name"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-text","text-muted"],["class","mt-3",4,"ngIf"],["aria-hidden","true",1,"mb-2","d-inline-block"],[1,"input-group"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-trash"],[3,"value"],[1,"mt-3"],["placeholder","yyyy-mm-dd","ngbDatepicker","","placement","top-start top-end bottom-start bottom-end",1,"form-control",3,"ngModelChange","id","ngModel","name","maxDate"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","fas","fa-calendar",3,"click","disabled"]],template:function(n,s){if(1&n){const r=e.RV6();e.j41(0,"form",null,0),e.DNE(2,O,3,3,"div",3)(3,$,22,23,"ng-container",4),e.j41(4,"button",5),e.bIt("click",function(){return e.eBV(r),e.Njj(s.addAccessControlItem())}),e.nrm(5,"i",6),e.EFF(6),e.nI1(7,"translate"),e.k0s()()}if(2&n){const r=e.sdS(1);e.R7$(2),e.Y8G("ngIf",s.showWarning),e.R7$(),e.Y8G("ngForOf",s.form.accessControls)("ngForTrackBy",s.trackById),e.R7$(),e.Mz_("id","add-btn-",s.type,""),e.Y8G("disabled",r.disabled),e.R7$(2),e.SpI(" ",e.bMT(7,7,"access-control-add-more")," ")}},dependencies:[h.YN,h.qT,h.xH,h.y7,h.me,h.wz,h.BC,h.cb,h.vS,h.Y4,h.cV,c.bT,c.pM,u.IQ,u.cw,p.h,p.D9,A],styles:[".access-control-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 50px;grid-gap:10px;padding-bottom:15px;border-bottom:2px dotted gray}"]})}return a})();const y=()=>({id:P(),itemName:null,startDate:null,hasStartDate:!1,maxStartDate:null,endDate:null,hasEndDate:!1,maxEndDate:null}),P=()=>Math.floor(1e6*Math.random());var V=i(58526),U=i(71217),x=i(71526),Y=i(78052),X=i(95438),K=(i(47376),i(72683)),W=i(13943),z=i(67899);const H=a=>({repeatable:!0,listId:a});function J(a,f){if(1&a){const t=e.RV6();e.j41(0,"ds-viewable-collection",10),e.bIt("pageChange",function(s){e.eBV(t);const r=e.XpG(2);return e.Njj(r.loadForPage(s))}),e.k0s()}if(2&a){const t=e.XpG().ngIf,n=e.XpG();e.Y8G("config",n.paginationConfig)("context",n.context)("objects",t)("selectable",!0)("selectionConfig",e.eq3(6,H,n.LIST_ID))("showPaginator",!0)}}function Q(a,f){1&a&&(e.j41(0,"div",11),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&a&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"access-control-select-bitstreams-modal.no-items")," "))}function Z(a,f){if(1&a&&(e.qex(0),e.DNE(1,J,1,8,"ds-viewable-collection",8)(2,Q,3,3,"div",9),e.bVm()),2&a){const t=f.ngIf;e.R7$(),e.Y8G("ngIf",t.payload.page.length>0),e.R7$(),e.Y8G("ngIf",t&&0===t.payload.page.length)}}const E="item-access-control-select-bitstreams";let q=(()=>{class a{constructor(t,n,s,r){this.bitstreamService=t,this.paginationService=n,this.translateService=s,this.activeModal=r,this.LIST_ID=E,this.selectedBitstreams=[],this.data$=new U.t(null),this.pageSize=5,this.context=x.o.Bitstream}ngOnInit(){this.loadForPage(1),this.paginationConfig=new z.W,this.paginationConfig.id="iacsbm",this.paginationConfig.currentPage=1,(0,K.a4)(this.pageSize)&&(this.paginationConfig.pageSize=this.pageSize)}loadForPage(t){this.bitstreamService.findAllByItemAndBundleName(this.item,"ORIGINAL",{currentPage:t},!1).pipe((0,b.qD)()).subscribe(this.data$)}static#e=this.\u0275fac=function(n){return new(n||a)(e.rXU(Y.BitstreamDataService),e.rXU(X.m),e.rXU(p.c$),e.rXU(u.Lw))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["ds-item-access-control-select-bitstreams-modal"]],inputs:{item:"item",selectedBitstreams:"selectedBitstreams"},standalone:!0,features:[e.aNF],decls:14,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"config","context","objects","selectable","selectionConfig","showPaginator","pageChange",4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[3,"pageChange","config","context","objects","selectable","selectionConfig","showPaginator"],["role","alert",1,"alert","alert-info","w-100"]],template:function(n,s){1&n&&(e.j41(0,"div",0)(1,"h4",1),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return s.activeModal.dismiss("Cross click")}),e.j41(5,"span",3),e.EFF(6,"\xd7"),e.k0s()()(),e.j41(7,"div",4),e.DNE(8,Z,3,2,"ng-container",5),e.nI1(9,"async"),e.k0s(),e.j41(10,"div",6)(11,"button",7),e.bIt("click",function(){return s.activeModal.close("Close click")}),e.EFF(12),e.nI1(13,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.SpI(" ",e.bMT(3,3,"access-control-select-bitstreams-modal.title")," "),e.R7$(6),e.Y8G("ngIf",e.bMT(9,5,s.data$)),e.R7$(4),e.SpI(" ",e.bMT(13,7,"access-control-select-bitstreams-modal.close")," "))},dependencies:[c.bT,W.h,c.Jj,p.h,p.D9]})}return a})();const ee=["bitstreamAccessCmp"],te=["itemAccessCmp"],j=()=>[];function se(a,f){if(1&a&&e.nrm(0,"ds-alert",29),2&a){const t=e.XpG();e.Y8G("type",t.AlertType.Info)("content",t.titleMessage)}}function oe(a,f){if(1&a){const t=e.RV6();e.j41(0,"button",37),e.nI1(1,"translate"),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.openSelectBitstreamsModal(s.itemRD.payload))}),e.nrm(2,"i",38),e.k0s()}if(2&a){const t=e.XpG(2);e.Y8G("disabled",!t.state.bitstream.toggleStatus||"selected"!==t.state.bitstream.changesLimit),e.BMQ("aria-label",e.bMT(1,2,"access-control-bitstreams-select"))}}function ne(a,f){if(1&a){const t=e.RV6();e.j41(0,"div",11)(1,"fieldset",30)(2,"legend",31),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",14)(6,"input",32),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG();return e.DH7(r.state.bitstream.changesLimit,s)||(r.state.bitstream.changesLimit=s),e.Njj(s)}),e.k0s(),e.j41(7,"label",33),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"div",14)(11,"input",34),e.mxI("ngModelChange",function(s){e.eBV(t);const r=e.XpG();return e.DH7(r.state.bitstream.changesLimit,s)||(r.state.bitstream.changesLimit=s),e.Njj(s)}),e.k0s(),e.j41(12,"label",35),e.EFF(13),e.nI1(14,"translate"),e.DNE(15,oe,3,4,"button",36),e.k0s()()()()}if(2&a){const t=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,9,"access-control-limit-to-specific")," "),e.R7$(3),e.Y8G("disabled",!t.state.bitstream.toggleStatus),e.R50("ngModel",t.state.bitstream.changesLimit),e.R7$(2),e.SpI(" ",e.bMT(9,11,"access-control-process-all-bitstreams")," "),e.R7$(3),e.Y8G("disabled",!t.state.bitstream.toggleStatus),e.R50("ngModel",t.state.bitstream.changesLimit),e.R7$(2),e.Lme(" ",t.state.bitstream.selectedBitstreams.length," ",e.bMT(14,13,"access-control-bitstreams-selected")," "),e.R7$(2),e.Y8G("ngIf",t.itemRD)}}function ae(a,f){1&a&&e.nrm(0,"hr")}function ie(a,f){if(1&a){const t=e.RV6();e.j41(0,"div",39)(1,"button",40),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.reset())}),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"button",41),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.submit())}),e.EFF(5),e.nI1(6,"translate"),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,3,"access-control-cancel")," "),e.R7$(2),e.Y8G("disabled",!t.state.item.toggleStatus&&!t.state.bitstream.toggleStatus),e.R7$(),e.SpI(" ",e.bMT(6,5,"access-control-execute")," ")}}let ce=(()=>{class a{constructor(t,n,s,r,M){this.bulkAccessConfigService=t,this.bulkAccessControlService=n,this.selectableListService=s,this.modalService=r,this.cdr=M,this.showLimitToSpecificBitstreams=!1,this.titleMessage="",this.showSubmit=!0,this.AlertType=d.v,this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}},this.dropdownData$=this.bulkAccessConfigService.findByName("default").pipe((0,b.qD)(),(0,C.T)(l=>l.hasSucceeded?l.payload:null),(0,D.t)({refCount:!1,bufferSize:1}))}getFormValue(){return console.log({bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}),{bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}}reset(){this.bitstreamAccessCmp.reset(),this.itemAccessCmp.reset(),this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}}}submit(){const t=this.bitstreamAccessCmp.getValue(),n=this.itemAccessCmp.getValue(),{file:s}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess:t,itemAccess:n,state:this.state});this.bulkAccessControlService.executeScript([this.itemRD.payload.uuid],s).pipe((0,g.s)(1)).subscribe(r=>{console.log("success",r)})}handleStatusChange(t,n){"bitstream"===t?n?this.bitstreamAccessCmp.enable():this.bitstreamAccessCmp.disable():"item"===t&&(n?this.itemAccessCmp.enable():this.itemAccessCmp.disable())}openSelectBitstreamsModal(t){const n=this.modalService.open(q);n.componentInstance.selectedBitstreams=this.state.bitstream.selectedBitstreams,n.componentInstance.item=t,n.closed.pipe((0,_.H)(()=>this.selectableListService.getSelectableList(E)),(0,g.s)(1)).subscribe(s=>{this.state.bitstream.selectedBitstreams=s?.selection||[],this.cdr.detectChanges()})}ngOnDestroy(){this.selectableListService.deselectAll(E)}static#e=this.\u0275fac=function(n){return new(n||a)(e.rXU(T.BulkAccessConfigDataService),e.rXU(V.r),e.rXU(v.K),e.rXU(u.Bq),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["ds-access-control-form-container"]],viewQuery:function(n,s){if(1&n&&(e.GBs(ee,7),e.GBs(te,7)),2&n){let r;e.mGM(r=e.lsd())&&(s.bitstreamAccessCmp=r.first),e.mGM(r=e.lsd())&&(s.itemAccessCmp=r.first)}},inputs:{showLimitToSpecificBitstreams:"showLimitToSpecificBitstreams",titleMessage:"titleMessage",itemRD:"itemRD",showSubmit:"showSubmit"},exportAs:["dsAccessControlForm"],standalone:!0,features:[e.aNF],decls:68,vars:62,consts:[["itemAccessCmp",""],["bitstreamAccessCmp",""],[1,"container"],[1,"card","border-0"],[1,"card-body"],["class","d-block pb-3",3,"type","content",4,"ngIf"],[1,"row"],[1,"col-12","col-md-6","border-right","d-flex","flex-column","justify-content-between"],[1,"d-flex","align-items-center"],[1,"h3","mb-0","mr-4"],[3,"ngModelChange","ariaLabel","ngModel"],[1,"row","mt-3"],[1,"h4","col-12","col-md-3"],[1,"col-12","col-md-8"],[1,"form-check"],["type","radio","name","itemMode","id","itemReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemReplace",1,"form-check-label"],["type","radio","name","itemMode","id","itemAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemAdd",1,"form-check-label"],[1,"h4","mt-3"],[3,"type","mode","dropdownOptions"],[1,"col-12","col-md-6","d-flex","flex-column","justify-content-between"],["class","row mt-3",4,"ngIf"],["type","radio","name","bitstreamMode","id","bitstreamReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamReplace",1,"form-check-label"],["type","radio","name","bitstreamMode","id","bitstreamAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamAdd",1,"form-check-label"],[4,"ngIf"],["class","d-flex justify-content-end",4,"ngIf"],[1,"d-block","pb-3",3,"type","content"],[1,"col-12"],[1,"h4"],["type","radio","name","changesLimit","id","processAll","value","all",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","processAll",1,"form-check-label"],["type","radio","name","changesLimit","id","processSelected","value","selected",1,"form-check-input","mt-2",3,"ngModelChange","disabled","ngModel"],["for","processSelected",1,"form-check-label"],["class","btn btn-outline-dark border-0","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"btn","btn-outline-dark","border-0",3,"click","disabled"],[1,"fa","fa-search"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-primary","mr-3",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(n,s){if(1&n){const r=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.DNE(3,se,1,2,"ds-alert",5),e.j41(4,"div",6)(5,"div",7)(6,"div")(7,"div",8)(8,"h2",9),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"ui-switch",10),e.nI1(12,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.item.toggleStatus,l)||(s.state.item.toggleStatus=l),e.Njj(l)}),e.bIt("ngModelChange",function(l){return e.eBV(r),e.Njj(s.handleStatusChange("item",l))}),e.k0s()(),e.j41(13,"fieldset",11)(14,"legend",12),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"div",13)(18,"div",14)(19,"input",15),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.item.accessMode,l)||(s.state.item.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(20,"label",16),e.EFF(21),e.nI1(22,"translate"),e.k0s()(),e.j41(23,"div",14)(24,"input",17),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.item.accessMode,l)||(s.state.item.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(25,"label",18),e.EFF(26),e.nI1(27,"translate"),e.k0s()()()()(),e.j41(28,"div")(29,"h3",19),e.EFF(30),e.nI1(31,"translate"),e.k0s(),e.nrm(32,"ds-access-control-array-form",20,0),e.nI1(34,"async"),e.k0s()(),e.j41(35,"div",21)(36,"div")(37,"div",8)(38,"h2",9),e.EFF(39),e.nI1(40,"translate"),e.k0s(),e.j41(41,"ui-switch",10),e.nI1(42,"translate"),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.bitstream.toggleStatus,l)||(s.state.bitstream.toggleStatus=l),e.Njj(l)}),e.bIt("ngModelChange",function(l){return e.eBV(r),e.Njj(s.handleStatusChange("bitstream",l))}),e.k0s()(),e.DNE(43,ne,16,15,"div",22),e.k0s(),e.j41(44,"fieldset",11)(45,"legend",12),e.EFF(46),e.nI1(47,"translate"),e.k0s(),e.j41(48,"div",13)(49,"div",14)(50,"input",23),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.bitstream.accessMode,l)||(s.state.bitstream.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(51,"label",24),e.EFF(52),e.nI1(53,"translate"),e.k0s()(),e.j41(54,"div",14)(55,"input",25),e.mxI("ngModelChange",function(l){return e.eBV(r),e.DH7(s.state.bitstream.accessMode,l)||(s.state.bitstream.accessMode=l),e.Njj(l)}),e.k0s(),e.j41(56,"label",26),e.EFF(57),e.nI1(58,"translate"),e.k0s()()()(),e.j41(59,"div")(60,"h3",19),e.EFF(61),e.nI1(62,"translate"),e.k0s(),e.nrm(63,"ds-access-control-array-form",20,1),e.nI1(65,"async"),e.k0s()()(),e.DNE(66,ae,1,0,"hr",27)(67,ie,7,7,"div",28),e.k0s()()()}if(2&n){let r,M;e.R7$(3),e.Y8G("ngIf",s.titleMessage),e.R7$(6),e.SpI(" ",e.bMT(10,32,"access-control-item-header-toggle")," "),e.R7$(2),e.Y8G("ariaLabel",e.bMT(12,34,s.state.bitstream.toggleStatus?"access-control-item-toggle.disable":"access-control-item-toggle.enable")),e.R50("ngModel",s.state.item.toggleStatus),e.R7$(4),e.SpI(" ",e.bMT(16,36,"access-control-mode")," "),e.R7$(4),e.Y8G("disabled",!s.state.item.toggleStatus),e.R50("ngModel",s.state.item.accessMode),e.R7$(2),e.SpI(" ",e.bMT(22,38,"access-control-replace-all")," "),e.R7$(3),e.Y8G("disabled",!s.state.item.toggleStatus),e.R50("ngModel",s.state.item.accessMode),e.R7$(2),e.SpI(" ",e.bMT(27,40,"access-control-add-to-existing")," "),e.R7$(4),e.JRh(e.bMT(31,42,"access-control-access-conditions")),e.R7$(2),e.Y8G("type","item")("mode",s.state.item.accessMode)("dropdownOptions",(null==(r=e.bMT(34,44,s.dropdownData$))?null:r.itemAccessConditionOptions)||e.lJ4(60,j)),e.R7$(7),e.SpI(" ",e.bMT(40,46,"access-control-bitstream-header-toggle")," "),e.R7$(2),e.Y8G("ariaLabel",e.bMT(42,48,s.state.bitstream.toggleStatus?"access-control-bitstream-toggle.disable":"access-control-bitstream-toggle.enable")),e.R50("ngModel",s.state.bitstream.toggleStatus),e.R7$(2),e.Y8G("ngIf",s.showLimitToSpecificBitstreams),e.R7$(3),e.SpI(" ",e.bMT(47,50,"access-control-mode")," "),e.R7$(4),e.Y8G("disabled",!s.state.bitstream.toggleStatus),e.R50("ngModel",s.state.bitstream.accessMode),e.R7$(2),e.SpI(" ",e.bMT(53,52,"access-control-replace-all")," "),e.R7$(3),e.Y8G("disabled",!s.state.bitstream.toggleStatus),e.R50("ngModel",s.state.bitstream.accessMode),e.R7$(2),e.SpI(" ",e.bMT(58,54,"access-control-add-to-existing")," "),e.R7$(4),e.JRh(e.bMT(62,56,"access-control-access-conditions")),e.R7$(2),e.Y8G("type","bitstream")("mode",s.state.bitstream.accessMode)("dropdownOptions",(null==(M=e.bMT(65,58,s.dropdownData$))?null:M.bitstreamAccessConditionOptions)||e.lJ4(61,j)),e.R7$(3),e.Y8G("ngIf",s.showSubmit),e.R7$(),e.Y8G("ngIf",s.showSubmit)}},dependencies:[c.bT,o.C,S.z,h.me,h.Fm,h.BC,h.vS,S.S,h.YN,N,c.Jj,p.h,p.D9]})}return a})()},58526:(R,k,i)=>{i.d(k,{r:()=>m});var c=i(47947),h=i(72578),p=i(12007),S=i(39942),D=i(72683),_=i(79224),C=i(53107),g=i(95968),T=i(69685);let m=(()=>{class o{constructor(v,u,I,e){this.notificationsService=v,this.router=u,this.scriptService=I,this.translationService=e}createPayloadFile(v){const u=b(v),I=new Blob([JSON.stringify(u,null,2)],{type:"application/json"}),e=new File([I],"data.json",{type:"application/json"});return{url:URL.createObjectURL(e),file:e}}executeScript(v,u){console.log("execute",{uuids:v,file:u});const I=[{name:"-f",value:u.name}];return v.forEach(e=>{I.push({name:"-u",value:e})}),this.scriptService.invoke("bulk-access-control",I,[u]).pipe((0,p.qD)(),(0,c.T)(e=>{if(e.hasSucceeded){const A=this.translationService.get("process.new.notification.success.title"),F=this.translationService.get("process.new.notification.success.content");return this.notificationsService.success(A,F),(0,D.hj)(e.payload)&&this.router.navigateByUrl((0,S.yJ)(e.payload.processId)),!0}{const A=this.translationService.get("process.new.notification.error.title"),F=this.translationService.get("process.new.notification.error.content");return this.notificationsService.error(A,F),!1}}))}static#e=this.\u0275fac=function(u){return new(u||o)(C.KVO(_.I),C.KVO(g.Ix),C.KVO(h.ScriptDataService),C.KVO(T.c$))};static#t=this.\u0275prov=C.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const b=o=>{const d={},u=o.state.bitstream.toggleStatus;if(o.state.item.toggleStatus&&(d.item={mode:o.state.item.accessMode,accessConditions:o.itemAccess}),u){const I={uuid:[]};u&&"selected"===o.state.bitstream.changesLimit&&(I.uuid=o.state.bitstream.selectedBitstreams.map(e=>e.id)),d.bitstream={constraints:I,mode:o.state.bitstream.accessMode,accessConditions:o.bitstreamAccess}}return d}},61299:(R,k,i)=>{i.d(k,{S:()=>g,z:()=>T});var c=i(53107),h=i(10936),p=i(54460);const S=["*"];function D(m,b){if(1&m&&(c.j41(0,"label",2)(1,"span",3),c.EFF(2),c.k0s(),c.j41(3,"span",4),c.EFF(4),c.k0s()()),2&m){const o=c.XpG();c.R7$(),c.xc7("color",o.getColor("checkedTextColor")),c.BMQ("aria-label",o.checkedLabel),c.R7$(),c.JRh(o.checkedLabel),c.R7$(),c.xc7("color",o.getColor("uncheckedTextColor")),c.BMQ("aria-label",o.uncheckedLabel),c.R7$(),c.JRh(o.uncheckedLabel)}}const _=new c.nKC("UI_SWITCH_OPTIONS"),C={provide:h.kq,useExisting:(0,c.Rfq)(()=>g),multi:!0};let g=(()=>{class m{constructor(o={},d){this.cdr=d,this.change=new c.bkB,this.changeEvent=new c.bkB,this.valueChange=new c.bkB,this.onTouchedCallback=v=>{},this.onChangeCallback=v=>{},this.size=o&&o.size||"medium",this.color=o&&o.color,this.switchOffColor=o&&o.switchOffColor,this.switchColor=o&&o.switchColor,this.defaultBgColor=o&&o.defaultBgColor,this.defaultBoColor=o&&o.defaultBoColor,this.checkedLabel=o&&o.checkedLabel,this.uncheckedLabel=o&&o.uncheckedLabel,this.checkedTextColor=o&&o.checkedTextColor,this.uncheckedTextColor=o&&o.uncheckedTextColor}set checked(o){this._checked=!1!==o}get checked(){return this._checked}set disabled(o){this._disabled=!1!==o}get disabled(){return this._disabled}set reverse(o){this._reverse=!1!==o}get reverse(){return this._reverse}set loading(o){this._loading=!1!==o}get loading(){return this._loading}getColor(o=""){return"borderColor"===o?this.defaultBoColor:"switchColor"===o?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===o?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===o?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(o){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(o),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(o){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(d=>{d&&this.onClick(o)}):this.onClick(o))}writeValue(o){o!==this.checked&&(this.checked=!!o),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(o){this.onChangeCallback=o}registerOnTouched(o){this.onTouchedCallback=o}setDisabledState(o){this.disabled=o}ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}}return m.\u0275fac=function(o){return new(o||m)(c.rXU(_,8),c.rXU(c.gRc))},m.\u0275cmp=c.VBU({type:m,selectors:[["ui-switch"]],hostBindings:function(o,d){1&o&&c.bIt("click",function(u){return d.onToggle(u)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[c.Jv_([C])],ngContentSelectors:S,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(o,d){1&o&&(c.NAR(),c.j41(0,"button",0),c.DNE(1,D,5,8,"label",1),c.j41(2,"small"),c.SdG(3),c.k0s()()),2&o&&(c.xc7("background-color",d.getColor())("border-color",d.getColor("borderColor")),c.AVh("checked",d.checked)("disabled",d.disabled)("loading",d.loading)("switch-large","large"===d.size)("switch-medium","medium"===d.size)("switch-small","small"===d.size),c.BMQ("aria-checked",d.checked)("aria-label",d.ariaLabel),c.R7$(),c.Y8G("ngIf",d.checkedLabel||d.uncheckedLabel),c.R7$(),c.xc7("background",d.getColor("switchColor")))},dependencies:[p.bT],encapsulation:2}),m})(),T=(()=>{class m{static forRoot(o){return{ngModule:m,providers:[{provide:_,useValue:o||{}}]}}}return m.\u0275fac=function(o){return new(o||m)},m.\u0275mod=c.$C({type:m}),m.\u0275inj=c.G2t({imports:[p.MD,h.YN,h.YN]}),m})()}}]);